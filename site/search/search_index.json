{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#mapstore","title":"MapStore","text":"<p>MapStore is an highly modular Open Source WebGIS framework developed by GeoSolutions to create, manage and securely share maps and mashups. This simple and intuitive framework is able to mix map contents provided by Google Maps, OpenStreetMap, Bing or other servers compliant to OGC standards like WFS, CSW, WMC, WMS, WMTS and TMS. MapStore is used to find, view and query published geospatial data and to integrate multiple remote sources into a single map; the result is an high quality and user friendly framework that allows different kind of use cases by harmonizing remote data with smart and advanced functionalities (like chart widgets, dashboards, timelines and others). MapStore resources are not only related to Maps but also Dashboards and Stories; in MapStore you can create your own innovative and fascinating Application Context where users can save, manage and share its own resources by also managing access permissions to other groups of users.</p> <p>MapStore is not only a product but also a WebGIS framework. As a standard geoportal product, it is a web-based product that allows to provide a powerful and interactive geospatial WebGIS, it provides a direct and real-time access to geospatial data warehouses and it supports the most common  standards formats available for geospatial data. MapStore also provides advanced spatial analysis capabilities that can be used to build WebGIS solutions through a powerful, dynamic and open geospatial application. Since MapStore is also a framework, you can use it to build your own WebGIS applications by using its plugins and modules.</p> <p>Last but not the least, MapStore is map agnostic and ensures the greatest flexibility: its abstraction tier allows to work with different web mapping libraries. The mapping engines currently supported by MapStore are OpenLayers (used by default for desktops), LeafletJS (used by default for mobile devices) and Cesium 3D viewer.</p> <p>MapStore has been designed from the beginning to provide a coherent and comprehensive experience across different devices types.</p> <p>MapStore  is based on OpenLayers, Leaflet and ReactJS, and is licensed under the Simplified BSD license.</p>"},{"location":"#supported-browsers","title":"Supported Browsers","text":"<p>The browsers supported by MapStore are Google Chrome, Microsoft Edge, Mozilla Firefox and Safari. Ensure to have the latest version installed.</p>"},{"location":"#quick-start","title":"Quick Start","text":"<p>You can either choose to download a standalone binary package or a WAR file to quickly start playing with MapStore. See the Quick Start documentation for more details.</p>"},{"location":"#documentation","title":"Documentation","text":"<ul> <li>Users Guide</li> <li>Developers Guide</li> </ul>"},{"location":"quick-start/","title":"Quick Start","text":"<p>You can either choose to download a standalone binary package or a WAR file to quickly start playing with MapStore.</p>"},{"location":"quick-start/#binary-package","title":"Binary package","text":"<p>The easiest way to try out MapStore is to download and extract the binary package available on MapStore release page. Here you can find some preconfigured maps as well users and groups. The goal for this package is to ease all the requirements needed for you to take MapStore for a test-drive.</p> <p>We hope you enjoy MapStore!</p>"},{"location":"quick-start/#how-to-run","title":"How to run","text":"<p>Go to the location where you saved the zip file, unzip the contents and run:</p> <p>Windows: <code>mapstore2_startup.bat</code></p> <p>Linux: <code>./mapstore2_startup.sh</code></p> <p>Point your browser to: http://localhost:8082/mapstore</p> <p>To stop MapStore simply do:</p> <p>Windows: <code>mapstore2_shutdown.bat</code></p> <p>Linux: <code>./mapstore2_shutdown.sh</code></p>"},{"location":"quick-start/#package-contents","title":"Package Contents","text":"<ul> <li>MapStore</li> <li>Tomcat8</li> <li>Java JRE (Win and Linux)</li> </ul>"},{"location":"quick-start/#demo-maps","title":"Demo Maps","text":"<ul> <li>Aerial Imagery - Simple map demo showing some aerial imagery data</li> <li>WFS Query Map - Demo map configured with MapStore built-in ability to query feature over WFS</li> <li>User Map and User1 Map - Map only visible to user and user1 respectively, to demonstrate MapStore capabilities on user/group management and permissions.</li> </ul>"},{"location":"quick-start/#demo-accountsgroups","title":"Demo accounts/groups","text":"Users Groups admin/admin MyGroupAdmin,everyone guest everyone user/user everyone user1/user1 everyone, MyGroup"},{"location":"quick-start/#war-file","title":"WAR file","text":"<p>Download the WAR file from the latest release here.</p> <p>All the releases</p> <p>After downloading the MapStore war file, install it in your java web container (e.g. Tomcat), with usual procedures for the container (normally you only need to copy the war file in the webapps subfolder).</p> <p>If you don't have a java web container you can download Apache Tomcat from here and install it. You will also need a Java7 JRE.</p> <p>Then you can access MapStore using the following URL (assuming the web container is on the standard 8080 port):</p> <p>http://localhost:8080/mapstore</p> <p>Use the default credentials (admin / admin) to login and start creating your maps!</p>"},{"location":"developer-guide/","title":"Quick Setup and Run","text":"<p>Note</p> <p>Please make sure to have installed all the software as for requirements before to proceed.</p> <p>Clone the repository:</p> <pre><code>git clone https://github.com/geosolutions-it/MapStore2.git\n</code></pre> <p>Start the demo locally:</p> <pre><code>npm cache clean  # this is useful to prevent errors on Windows during install\n\nnpm install\n\nnpm start\n</code></pre> <p>Then point your preferred browser to http://localhost:8081.</p> <p>Note</p> <p>This application runs the Java backend at <code>localhost:8080</code>. Make sure to have both ports 8080 and 8081 free before to run.</p>"},{"location":"developer-guide/#other-useful-commands","title":"Other useful commands","text":"<pre><code># Run tests\nnpm test\n\n# run test with hot reload\nnpm run test:watch\n\n#generate test documentation\nnpm run doc:test\n</code></pre>"},{"location":"developer-guide/#quick-build-and-deploy","title":"Quick Build and Deploy","text":"<p>Install latest Maven, if needed, from here (version 3.1.0 is required).</p> <p>Build the deployable war:</p> <pre><code>./build.sh [version_identifier]\n</code></pre> <p>Where version_identifier is an optional identifier of the generated war that will be shown in the settings panel of the application.</p> <p>Deploy the generated <code>mapstore.war</code> file (in product/target) to your favourite J2EE container (e.g. Tomcat).</p> <p>Here you can find how to setup the database.</p>"},{"location":"developer-guide/API-usage/","title":"MapStore API usage","text":"<p>You can include MapStore in your application and interact with it via its JavaScript API</p>"},{"location":"developer-guide/API-usage/#how-to-use","title":"How to use","text":"<ol> <li>Create a map using the standard installation</li> <li>Go to Share -&gt; Embed</li> <li>Copy the API html code and paste it in your application page</li> </ol> <p>The map will now load inside your application</p> <pre><code>NOTE: If the map is using a Google Maps background you will have to provide your own API key.\nAdd `&amp;key=YOUR_API_KEY` in the &lt;script&gt; src value\n</code></pre>"},{"location":"developer-guide/LayerFilter/","title":"MapStore filters","text":"<p>Mapstore filtering system is trying to allow to accomplish the following goals:</p> <ul> <li>Support for multiple filters standards (CQL, OGC)</li> <li>Support for multiple filter types (spatial, temporal, attribute, etc.)</li> <li>Support for future filter standards.</li> <li>Allow to be handled independently from the data source (WFS, WMS, etc.)</li> <li>Allow to leave the entry points to manage them programmatically.</li> </ul> <p>For this reason, MapStore stores internally a filter object that is a JSON object that can be serialized in different formats (CQL, OGC, etc.) and can be used to filter data sources. This is the internal filtering system used by mapstore, that can be for instance in <code>layerFilters</code> in the layer object</p>"},{"location":"developer-guide/LayerFilter/#formats","title":"Formats","text":""},{"location":"developer-guide/LayerFilter/#mapstore-format","title":"<code>mapstore</code> Format","text":"<p>This JSON object is a container that has this shape:</p> <pre><code>{\n\"format\": \"mapstore\",\n\"version\": \"1.0.0\",\n\"filters\": [],\n// ...other fields\n}\n</code></pre> <p>By default all the filters contained in the \"filters\" array are combined with an <code>AND</code> operator. Every filter in the array is a JSON object that can be serialized in different formats (CQL, OGC, etc.). Each of them is a JSON object that must have the <code>format</code> value, to be recognized and properly converted,</p> <p>All the filters in <code>filters</code> array will have at least a <code>format</code> field and an optional <code>id</code> attribute reserved, that can be used to identify the filter from a component that wants to use it.</p> <p>Filters in the <code>filters</code> array can be combined with a logic operator (<code>AND</code>, <code>OR</code>), in this case the filter object must have the <code>logic</code> format. Moreover they can be of <code>mapstore</code> format too.</p> <p>Note</p> <p>For backward compatibility, the filter object without the \"format\" field is considered as \"mapstore\" format, version \"1.0.0\".</p> <p>Note</p> <p>For backward compatibility, the filters \"mapstore\" of version \"1.0.0\" can contain also several other fields that will be deprecated in the future in favor of a <code>mapstore-query-panel</code> format, that is the format used by the query panel, and currently mostly supported in MapStore. So a filter like this is still valid:</p> <pre><code>```json\n{\n\"format\": \"mapstore\",\n\"version\": \"1.0.0\",\n\"groupFields\": [],\n\"spatialField\": {\n\"method\": \"BBOX\",\n\"attribute\": \"the_geom\",\n\"operation\": \"INTERSECTS\",\n\"geometry\": {\n\"type\": \"Polygon\",\n\"coordinates\": [[[12.5,41.5], [12.5,  42.5], [13.5,42.5], [13.5, 41.5], [12.5,41.5]]]\n}\n},\n\"filterFields\": [{\n\"attribute\": \"name\",\n\"operator\": \"=\",\n\"type\": \"string\",\n\"value\": \"test\"\n}]\n}\n```\n</code></pre>"},{"location":"developer-guide/LayerFilter/#logic-format","title":"<code>logic</code> format","text":"<p>In order to allow to create complex filters, MapStore allows to combine filters with a logic operator (<code>AND</code>, <code>OR</code>). The <code>logic</code> format is a JSON object that has this shape:</p> <pre><code>{\n\"format\": \"logic\",\n\"version\": \"1.0.0\",\n\"logic\": \"AND\",\n\"filters\": []\n}\n</code></pre>"},{"location":"developer-guide/LayerFilter/#cql-format","title":"<code>cql</code> format","text":"<p>The <code>cql</code> format is a JSON object that has this shape:</p> <pre><code>{\n\"format\": \"cql\",\n\"version\": \"1.0.0\",\n\"body\": \"...\"\n}\n</code></pre> <p>!!! Note:     MapStore actually supports only a subset of CQL, that is the one used by GeoServer.</p>"},{"location":"developer-guide/LayerFilter/#mapstore-query-panel-format","title":"<code>mapstore-query-panel</code> format","text":"<p>The <code>mapstore-query-panel</code> format is a JSON object that has this shape:</p> <pre><code>{\n\"format\": \"mapstore-query-panel\",\n\"version\": \"1.0.0\",\n\"groupFields\": [],\n\"spatialField\": {},\n\"filterFields\": [],\n\"crossLayerFilter\": {},\n\n}\n</code></pre> <p>Now it do not have an implementation yet, but this format will replace the old legacy 'mapstore' fields in the future.</p>"},{"location":"developer-guide/LayerFilter/#supporting-new-formats","title":"Supporting new formats","text":"<p>At the moment the filter conversion system is a work in progress. The API may change in the future, keeping the <code>canConvert</code> and <code>getConverter</code> functions as external API. We actually support <code>cql</code> and <code>ogc</code> as output formats (as strings), and <code>cql</code> (partially, cannot parse spatial filters in cql yet), <code>mapstore</code> and <code>logic</code> as input formats (as JSON objects with <code>format</code> as written above).  At the moment we don't have an internal model for a filter to use as intermediate model, but a set of <code>converters</code> in <code>MapStore2/web/client/utils/filter/converters/index.js</code> file. The <code>converter</code> object is an object that implements a method for each format that you want to support, with the following signature:</p> <pre><code>{\n[format]: (filter::Object, options) =&gt; filter\n}\n</code></pre> <p>Example:</p> <pre><code>{\nogc: (filter::Object, options) =&gt; filter::String,\ncql: (filter::Object, options) =&gt; filter::String\n}\n</code></pre> <p><code>options</code> depends on the specific output format, but it can be used to pass additional parameters to the converter. For instance the <code>cql</code> convert has no options, but the <code>ogc</code> converter has an <code>options</code> object that can contain the <code>nsFilter</code> field, that is the srs of the geometry to be used in the filter. See the JSDoc of the <code>ogc</code> converter for more details.</p> <p>These methods will translate the JSON objects received as input (or in same cases the effective body of the filter) in the format specified in the method name. Future converters (maybe with a more generic method) will be added to support other formats, if needed.</p> <p>Javascript API exposed by MapStore to manage filters is in <code>MapStore2/web/client/utils/filter/converters</code>.</p> <p>the functions are:</p> <pre><code>getConverter(format::String) // return the converter for the specified format\n</code></pre> <p>The converter depends on the specific output format, but</p> <pre><code>canConvert(from::Object|String, to::Object) // return true if the filter can be converted in the specified format\n</code></pre> <p>Note</p> <p>Because there is not a generic converter, the <code>from</code> parameter can be a string or an object. If it is a string, it is considered as the format of the filter, otherwise it is considered as the filter object.</p>"},{"location":"developer-guide/LayerFilter/#appendix-a-mapstore-format-legacy-fields","title":"Appendix A: <code>mapstore</code> format legacy fields","text":"<p><code>mapstore-query-panel</code> will include all the legacy fields of the <code>mapstore</code> format, that will be deprecated in the future. For backward compatibility, the <code>mapstore</code> format will be still supported, but needs tp be converted into <code>mapstore-query-panel</code> format.</p> <p>Here a full example of the current content stored in <code>layerFilter</code> object, with all the legacy fields:</p> <pre><code>\"layerFilter\": {\n\"searchUrl\": null,\n\"featureTypeConfigUrl\": null,\n\"showGeneratedFilter\": false,\n\"attributePanelExpanded\": true,\n\"spatialPanelExpanded\": true,\n\"crossLayerExpanded\": true,\n\"showDetailsPanel\": false,\n\"groupLevels\": 5,\n\"useMapProjection\": false,\n\"toolbarEnabled\": true,\n\"groupFields\": [\n{\n\"id\": 1,\n\"logic\": \"OR\",\n\"index\": 0\n},\n{\n\"id\": 1671785737915,\n\"logic\": \"OR\",\n\"groupId\": 1,\n\"index\": 1\n}\n],\n\"maxFeaturesWPS\": 5,\n\"filterFields\": [\n{\n\"rowId\": 1671785736331,\n\"groupId\": 1,\n\"attribute\": \"LAND_KM\",\n\"operator\": \"&gt;\",\n\"value\": 1000000,\n\"type\": \"number\",\n\"fieldOptions\": {\n\"valuesCount\": 0,\n\"currentPage\": 1\n},\n\"exception\": null\n},\n{\n\"rowId\": 1671785739355,\n\"groupId\": 1671785737915,\n\"attribute\": \"STATE_NAME\",\n\"operator\": \"=\",\n\"value\": \"Alabama\",\n\"type\": \"string\",\n\"fieldOptions\": {\n\"valuesCount\": 0,\n\"currentPage\": 1\n},\n\"exception\": null,\n\"loading\": false,\n\"options\": {\n\"STATE_NAME\": []\n},\n\"openAutocompleteMenu\": false\n},\n{\n\"rowId\": 1671785746696,\n\"groupId\": 1671785737915,\n\"attribute\": \"STATE_NAME\",\n\"operator\": \"=\",\n\"value\": \"Arizona\",\n\"type\": \"string\",\n\"fieldOptions\": {\n\"valuesCount\": 0,\n\"currentPage\": 1\n},\n\"exception\": null,\n\"loading\": false,\n\"options\": {\n\"STATE_NAME\": []\n},\n\"openAutocompleteMenu\": false\n}\n],\n\"spatialField\": {\n\"method\": \"BBOX\",\n\"operation\": \"INTERSECTS\",\n\"geometry\": {\n\"id\": \"aefadb00-829f-11ed-b555-8bd9209cf0fa\",\n\"type\": \"Polygon\",\n\"extent\": [\n-13188750.608437454,\n3135752.6483710706,\n-8795761.718831802,\n4671831.168789972\n],\n\"center\": [\n-10992256.163634628,\n3903791.908580521\n],\n\"coordinates\": [\n[\n[\n-13188750.608437454,\n4671831.168789972\n],\n[\n-13188750.608437454,\n3135752.6483710706\n],\n[\n-8795761.718831802,\n3135752.6483710706\n],\n[\n-8795761.718831802,\n4671831.168789972\n],\n[\n-13188750.608437454,\n4671831.168789972\n]\n]\n],\n\"style\": {},\n\"projection\": \"EPSG:3857\"\n},\n\"attribute\": \"the_geom\"\n},\n\"simpleFilterFields\": [],\n\"crossLayerFilter\": {\n\"attribute\": \"the_geom\",\n\"collectGeometries\": {\n\"queryCollection\": {\n\"typeName\": \"gs:us_states\",\n\"filterFields\": [\n{\n\"rowId\": 1671785795624,\n\"groupId\": 1,\n\"attribute\": \"STATE_NAME\",\n\"operator\": \"=\",\n\"value\": \"Alabama\",\n\"type\": \"string\",\n\"fieldOptions\": {\n\"valuesCount\": 0,\n\"currentPage\": 1\n},\n\"exception\": null,\n\"loading\": false,\n\"openAutocompleteMenu\": false,\n\"options\": {\n\"STATE_NAME\": []\n}\n},\n{\n\"rowId\": 1671785801840,\n\"groupId\": 1,\n\"attribute\": \"STATE_NAME\",\n\"operator\": \"=\",\n\"value\": \"Arizona\",\n\"type\": \"string\",\n\"fieldOptions\": {\n\"valuesCount\": 0,\n\"currentPage\": 1\n},\n\"exception\": null,\n\"loading\": false,\n\"openAutocompleteMenu\": false,\n\"options\": {\n\"STATE_NAME\": []\n}\n}\n],\n\"geometryName\": \"the_geom\",\n\"groupFields\": [\n{\n\"id\": 1,\n\"index\": 0,\n\"logic\": \"OR\"\n}\n]\n}\n},\n\"operation\": \"INTERSECTS\"\n},\n\"autocompleteEnabled\": true\n}\n</code></pre>"},{"location":"developer-guide/advanced-project-customization/","title":"Configure multiple installations of a single project","text":"<p>The MapStore2 externalized configuration allows for setting up multiple installations withing a single project. These installations may fulfill needs such as:</p> <ul> <li>Having different use case scenarios within a single platform.</li> <li>Providing different services, based on the same framework.</li> <li>Fulfilling third-party customer requirements.</li> </ul> <p>This guideline assumes familiarity with the following sections of the documentation, so please read these first if you haven't done so already:</p> <ul> <li>MapStore projects</li> <li>Working with extensions</li> <li>Externalized configuration</li> </ul>"},{"location":"developer-guide/advanced-project-customization/#basic-setup-requirements","title":"Basic setup requirements","text":"<p>First you need to create you project following the steps outlined in the linked section.</p> <p>Then you need to create the <code>datadir</code> folder inside root. To use the contents of the datadir you need to set the JVM system property <code>datadir.location</code>, like in the example below:</p> <p>java -Ddatadir.location=/etc/mapstore/datadir</p> <p>This command will make the contents of the datadir available for the application in runtime. For further details on setting up and usage of the <code>datadir</code>, refer to the section using a data directory.</p> <p>Alternatively, for development purposes only, you can set the same property by modifying the <code>web/pom.xml</code> file inside your custom project.</p> <p>Find the entry for <code>cargo-maven3-plugin</code> and add the <code>systemProperties</code> tag within the <code>container</code> tag, so that your configuration looks like this:</p> <pre><code>        &lt;plugin&gt;\n&lt;groupId&gt;org.codehaus.cargo&lt;/groupId&gt;\n&lt;artifactId&gt;cargo-maven3-plugin&lt;/artifactId&gt;\n&lt;configuration&gt;\n&lt;container&gt;\n&lt;containerId&gt;tomcat8x&lt;/containerId&gt;\n&lt;systemProperties&gt;\n&lt;datadir.location&gt;[local_path_to_your_datadir]/datadir/[customInstallationFolder]&lt;/datadir.location&gt;\n&lt;/systemProperties&gt;\n&lt;zipUrlInstaller&gt;\n&lt;url&gt;https://repo.maven.apache.org/maven2/org/apache/tomcat/tomcat/8.5.69/tomcat-8.5.69.zip&lt;/url&gt;\n&lt;/zipUrlInstaller&gt;\n&lt;/container&gt;\n&lt;configuration&gt;\n&lt;type&gt;standalone&lt;/type&gt;\n&lt;home&gt;\n${project.build.directory}/apache-tomcat-${tomcat.version}\n                    &lt;/home&gt;\n&lt;properties&gt;\n&lt;cargo.servlet.port&gt;${tomcat.port}&lt;/cargo.servlet.port&gt;\n&lt;cargo.logging&gt;low&lt;/cargo.logging&gt;\n&lt;/properties&gt;\n&lt;/configuration&gt;\n&lt;deployables&gt;\n&lt;deployable&gt;\n&lt;groupId&gt;${project.groupId}&lt;/groupId&gt;\n&lt;artifactId&gt;${project.artifactId}&lt;/artifactId&gt;\n&lt;type&gt;war&lt;/type&gt;\n&lt;properties&gt;\n&lt;context&gt;/mapstore&lt;/context&gt;\n&lt;/properties&gt;\n&lt;/deployable&gt;\n&lt;/deployables&gt;\n&lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre> <p>In order to setup the multiple installations we can, for example, create three folders inside our <code>datadir</code>, denoting three different installations.</p> <pre><code>\u251c\u2500\u2500 datadir\n    \u251c\u2500\u2500 customA\n    \u251c\u2500\u2500 customB\n    \u251c\u2500\u2500 customC\n</code></pre> <p>Please note that the only requirement regarding folder structure is that the <code>datadir</code> exists, any content inside is optional and can be structured freely.</p> <p>As a final step, we will re-set the <code>datadir.location</code> system property outlined above to point to a specific installation, such that:</p> <p>java -Ddatadir.location=/etc/mapstore/datadir/customA</p>"},{"location":"developer-guide/advanced-project-customization/#customize-configuration-assets-and-translations","title":"Customize configuration, assets and translations","text":"<p>Inside our example installation folder <code>datadir/customA</code> we can include customizations pertinent to this instance only and excluded from the other two instances exemplified in the section above.</p> <p>For the purpose of this guideline we will adhere to the following folder structure convention, as outlined here:</p> <pre><code>\u251c\u2500\u2500 customA\n    \u251c\u2500\u2500 configs\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 localConfig.json.patch\n    \u2514\u2500\u2500 extensions\n        \u2514\u2500\u2500 customizations\n            \u251c\u2500\u2500 assets\n            \u2502\u00a0\u00a0 \u251c\u2500\u2500 css\n            \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 custom-style.css\n            \u2502\u00a0\u00a0 \u251c\u2500\u2500 img\n            \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 custom-logo.jpg\n            \u2502\u00a0\u00a0 \u2502\u00a0\u00a0            \n            \u2502\u00a0\u00a0 \u2514\u2500\u2500 js\n                    \u2514\u2500\u2500 customPlugin.js\n            \u251c\u2500\u2500 index.js\n            \u251c\u2500\u2500 index.js.LICENSE.txt\n\n            \u251c\u2500\u2500 index.json\n            \u2514\u2500\u2500 translations\n                \u251c\u2500\u2500 data.en-US.json\n            \u2502\u00a0\u00a0 \u251c\u2500\u2500 ...other translation files.\n</code></pre> <p>In the <code>customA/configs/localConfig.json.patch</code> file, we can patch the base configuration that is supplied by the <code>configs/localConfig.json</code> file inside root of the custom project, effectively customizing for this particular installation.</p> <p>In alternative to <code>localConfig.json.patch</code>, that is applied server side, you can insert in the same directory <code>localConfig.patch.json</code> (noted the inverted suffix) in the same directory, and configure MapStore to use it by editing the <code>js/app.jsx</code> file.</p> <pre><code>import { setLocalConfigurationFile} from '@mapstore/utils/ConfigUtils';\n...\n\nsetLocalConfigurationFile(['configs/localConfig.json', 'configs/localConfig.patch.json']);\n</code></pre> <p>This alternative version  uses <code>@mapstore/patcher</code> and allow perform more complex overrides, even if requires this change to be applied to the code, so it will not work with the standard product.</p> <p>The patch file can serve as the central hub for these customizations (see example below), essentially linking the whole content of the custom datadir folder and allowing for:</p> <ul> <li>Adding custom plugins in the application.</li> <li>Replacing default MapStore plugins.</li> <li>Initializing and overriding default application state.</li> <li>Initializing default component state of a particular plugin.</li> <li>Linking to assets, such as images and fonts.</li> <li>Including specific translations and language support.</li> </ul> <pre><code>[\n{\n\"op\": \"replace\",\n\"path\": \"/initialState/defaultState/locales/supportedLocales\",\n\"value\": {\n\"en\": {\n\"code\": \"en-US\",\n\"description\": \"English\"\n},\n\"it\": {\n\"code\": \"it-IT\",\n\"description\": \"Italiano\"\n}\n}\n},\n{\n\"op\": \"replace\",\n\"path\": \"/translationsPath\",\n\"value\": [\n\"./MapStore2/web/client/translations\",\n\"./extensions/customizations/translations\"\n]\n},\n{\n\"op\": \"replace\",\n\"path\": \"/initialState/defaultState/theme/selectedTheme/id\",\n\"value\": \"MyTheme\"\n},\n{\n\"op\": \"add\",\n\"path\": \"/plugins/desktop/-\",\n\"value\": {\n\"name\": \"Logo\",\n\"cfg\": {\n\"src\": \"./extensions/customizations/assets/img/custom-logo.jpg\",\n\"width\": 100,\n\"position\": \"topleft\"\n}\n}\n}\n]\n</code></pre> <p>In the example above the following modifications are made:</p> <ul> <li>Language support is changed to English and Italian only.</li> <li>Translation files for the language support are now read from a custom directory <code>./extensions/customizations/translations</code>, instead of the default one.</li> <li>A custom theme <code>MyTheme</code> is enabled for the whole application. For details see section below.</li> <li>A custom plugin <code>Logo</code> is added to the application, specifically the homepage, while being configured with the following props:</li> <li>src - for the logo image, pointing to a location in our datadir where the image is located.</li> <li>width and position - which are props used by the component internally.</li> </ul>"},{"location":"developer-guide/advanced-project-customization/#theme-customizations","title":"Theme customizations","text":"<p>Custom themes can be included in the project and applied only to a specific installation as well. Follow this guideline in order to create a custom theme.</p> <p>Once you have the required folder structure and the necessary imports in <code>theme.less</code>, as well as the required changes in your <code>webpack.config.js</code>, do the following steps:</p> <p>Check <code>configs/localConfig.json</code>, if you override the configuration, and look for <code>selectedTheme</code> property, it should be the following path.</p> <p>/initialState/defaultState/theme/selectedTheme</p> <p>If it's not configured, add the following block to <code>initialState.defaultState</code>, where <code>id</code> points to the name of the default theme (you should include one).</p> <pre><code>      \"theme\": {\n\"selectedTheme\": {\n\"id\": \"default\"\n}\n}\n</code></pre> <p>Inside the configuration patch file <code>datadir/[installationName]/configs/localConfig.patch.json</code>, modify the id we have previously set to point to the name of your custom theme, in the example below that would be <code>MyTheme</code>.</p> <p>This change will effectively change the theme for that specific installation only.</p> <pre><code>[\n{\n\"op\": \"replace\",\n\"path\": \"/initialState/defaultState/theme/selectedTheme/id\",\n\"value\": \"MyTheme\"\n}\n]\n</code></pre> <p>Please note that the <code>themes/</code> folder has to be placed outside of the <code>datadir</code> folder, as stated in the linked guideline above.</p> <p>The reason is that css / less files are assembled and packaged into a theme at build time, while the contents of the <code>datadir</code> folder are only available at runtime.</p>"},{"location":"developer-guide/building-and-deploying/","title":"Building and deploying","text":"<p>To create the final war, you have several options:</p> <ul> <li>full build (including all tests, syntax checks, frontend, backend and documentation):</li> </ul> <p><code>./build.sh [version_identifier] [profiles]</code></p> <p>Where <code>version_identifier</code> is an optional identifier of the generated war that will be shown in the settings panel of the application and profiles is an optional list of comma delimited building profiles (e.g. <code>printing</code>, <code>ldap</code>, <code>binary</code>)</p> <ul> <li>separated builds (skipping all the tests and checks, mainly for development purposes):</li> </ul> <pre><code># build the front-end\nnpm run fe:build\n\n# build the back-end, including the front-end parts build in the previous command\nmvn clean install -Dmapstore2.version=[version_identifier] [profiles]\n</code></pre> <p>In this case we have 2 separated commands that can be run separately, for instance if you are working on back-end only, so you don't need to re-compile the front-end part every time.</p>"},{"location":"developer-guide/building-and-deploying/#building-the-documentation","title":"Building the documentation","text":"<p>MapStore generates 2 types of documentation:</p> <ul> <li>JSDoc: generated from source code, provides a reference of the API and for the plugins configurations</li> <li>MkDocs: generated from markdown files, provides guides for the developers and users</li> </ul>"},{"location":"developer-guide/building-and-deploying/#api-and-plugins-documentation-jsdoc","title":"API and Plugins documentation (JSDoc)","text":"<p>The API and plugins documentation is automatically generated using docma. Docma parses the JSDoc comments in the source code and generates a static HTML documentation.</p> <p>Refer to the existing files to follow the documentation style of various parts of the application:</p> <ul> <li>actions</li> <li>reducers</li> <li>components</li> <li>epics</li> <li>plugins</li> </ul> <p>Please see http://usejsdoc.org/ for further information about how to write proper documentation in JSDoc.</p> <p>To install docma:</p> <p><code>npm install -g docma</code></p> <p>While developing you can generate the documentation to be accessible in the local machine by:</p> <p><code>npm run jsdoc:test</code></p> <p>The resulting doc will be accessible from http://localhost:8081/mapstore/docs/</p> <p>For the production deploy a different npm task must be used:</p> <p><code>npm run jsdoc:build</code></p> <p>The documentation will be accessible from the /mapstore/docs/ path</p> <p>The generated folders can be removed with:</p> <p><code>npm run jsdoc:clean</code></p>"},{"location":"developer-guide/building-and-deploying/#users-and-developers-documentation-mkdocs","title":"Users and developers documentation (MkDocs)","text":"<p>Note</p> <p>Make sure to install the proper python dependencies for Mkdocs. See the dedicated page here</p> <p>Build the mkdocs and generate md files to test in local machine by:</p> <p><code>npm run doc:build</code></p> <p>Start the built-in dev-server of mkdocs to preview and test documentation live by:</p> <p><code>npm run doc:start</code></p>"},{"location":"developer-guide/building-and-deploying/#understanding-frontend-building-tools","title":"Understanding frontend building tools","text":"<p>Frontend building is delegated to NPM and so leverages the NodeJS ecosystem.</p> <p>In particular:</p> <ul> <li>a package.json file is used to configure frontend dependencies, needed tools and building scripts</li> <li>babel is used for ES6/7 and JSX transpiling integrated with the other tools (e.g. webpack)</li> <li>webpack-dev-server is used to host the development application instance</li> <li>mocha/expect is used as a testing framework (with BDD style unit-tests)</li> <li>webpack: as the bundling tool, for development (see webpack.config.js), deploy (see prod-webpack.config.js) and test (see test.webpack.js)</li> <li>karma is used as the test suite runner, with several plugins to allow for custom reporting, browser running and so on; the test suite running is configured through different configuration files, for single running  or continuous testing</li> <li>istanbul/coveralls are used for code coverage reporting</li> </ul>"},{"location":"developer-guide/building-and-deploying/#including-the-printing-engine-in-your-build","title":"Including the printing engine in your build","text":"<p>The printing module is not included in official builds by default.</p> <p>To build your own version of MapStore with the this module, you can use the printing profile running the build script:</p> <pre><code>./build.sh [version_identifier] printing\n</code></pre> <p>For more information or troubleshooting about the printing module you can see the dedicated section</p>"},{"location":"developer-guide/code-conventions/","title":"Code conventions","text":"<p>In order to preserve quality, maintainability and testability when you develop in MapStore  you should follow the following rules and best practices.</p>"},{"location":"developer-guide/code-conventions/#tldr","title":"TL;DR","text":"<ul> <li>Access to the state using state selectors</li> <li>Prefer plugins <code>cfg</code> over <code>initialState</code> for plugins configurations</li> <li>Use <code>web/client/libs/ajax</code> in your hooks or in redux-observable for async</li> </ul>"},{"location":"developer-guide/code-conventions/#access-to-the-state-using-state-selectors","title":"Access to the state using state selectors","text":"<p>Is strongly recommended to not access to the state directly inside the <code>mapStateToProps</code> function of <code>react-redux</code> . Use (or define) selectors in the <code>selectors</code> directory. This provides the following advantages:</p> <ul> <li>Selectors can be reused in epics.</li> <li>Ready to use optimization with reselect</li> <li>Simplify future refactoring</li> <li>Easy unit testing and bug identification</li> </ul> <p>Wrapping all the access to the state inside well-defined selector makes easier to add functionalities and will increase code maintainability. You should always reuse existing selectors (or create new ones) to access to the application state for core application functionalities. It will help also future refactoring because any change to the state structure (from the reducer point of view) or data source (from the components point of view) requires only changes to the interested selectors.</p> <p>A selector should be placed into the proper <code>selectors/&lt;state-slice&gt;.js</code> file with the same name of the relative reducer. When a selector retrieves data from more than one state slices, you should place it in the selector nearest by concern. For instance <code>isFeatureGridOpen</code> should be placed into <code>featuregrid</code></p> <p>If you don't work on a core functionality, where the state is shared between many components, defining the selector directly in the plug-in is not denied.</p>"},{"location":"developer-guide/code-conventions/#prefer-plugin-configuration-over-initialstate","title":"Prefer plugin configuration over <code>initialState</code>","text":"<p>In order to create self contained plugins that can be reused you should prefer to configure the plugins using <code>cfg</code>. Using <code>initialState</code> should be considered deprecated. When the configuration is needed at an higher level (e.g. application state, for epics or to share this information), you should properly initialize the state of the plugin on your own triggering an action on mount/unmont. (<code>cfg</code> are passed to the plugin as react props).</p>"},{"location":"developer-guide/code-conventions/#use-custom-axios-version-for-async-requests","title":"Use custom axios version for async requests","text":"<p>Using <code>web/client/libs/ajax</code> (a customized axios with some interceptors)  for AJAX request contains interceptors to support <code>proxyUrl</code> and <code>authenticationRules</code> settings specified in <code>localConfig.json</code>,so you should prefer to use this enhanced version of axios.</p> <p>Using axios + RxJS means that you will have to wrap axios calls in something like:</p> <pre><code>Rx.Observable.defer( () =&gt; axios.post(...)).map...\n</code></pre> <p>Use defer to allow the usage of RxJS retry. We still not support real AJAX cancellation at all, but we would like to provide some utility function/operator to bind <code>axios</code> cancellation functionalities into the RxJS flow in the future.</p>"},{"location":"developer-guide/configuration-files/","title":"Configuring MapStore","text":"<p>MapStore (and every application developed with MapStore) allows customization through configuration. To understand how to configure MapStore you have to know that the back-end and the front-end of MapStore have two different configuration systems.</p> <p>This separation allows to:</p> <ul> <li>Make mapstore configuration system live also as a front-end only framework</li> <li>Keep the power of customization provided by spring on the back-end</li> </ul>"},{"location":"developer-guide/configuration-files/#back-end-configuration-files","title":"Back-end Configuration Files","text":"<p>They are <code>.properties</code> files or <code>.xml</code> files, and they allow to configure the various parts of the back-end. They are located in <code>java/web/src/main/resources</code> and they will be copied in  <code>MapStore.war</code> under the directory <code>/WEB-INF/classes</code>.</p> <ul> <li><code>proxy.properties</code>: configuration for the internal proxy (for cross-origin requests). More information here.</li> <li><code>geostore-datasource-ovr.properties</code>: provides settings for the database.</li> <li><code>log4j2.properties</code>: configuration for back-end logging</li> <li><code>sample-categories.xml</code>: initial set of categories for back-end resources (MAP, DASHBOARD, GEOSTORY...)</li> <li><code>mapstore.properties</code>: allow specific overrides to front-end files, See externalization system for more details</li> </ul> <p>Except for <code>mapstore.properties</code> and <code>ldap.properties</code>, all these files are simply overrides of original configuration files coming from the included sub-applications part of the back-end. In <code>WEB-INF/classes</code> you will find also some other useful files coming from the original application:</p>"},{"location":"developer-guide/configuration-files/#back-end-security-configuration-files","title":"Back-end security configuration files","text":"<p>Back-end security can be configured to use different authentication strategies. Maven profiles can be used to switch between these different strategies.</p> <p>Depending on the chosen profile a different file will be copied from the <code>product/config</code> folder to  override <code>WEB-INF/classes/geostore-spring-security.xml</code> in the final package. In particular:</p> <ul> <li>default: <code>db\\geostore-spring-security-db.xml</code> (geostore database)</li> <li>ldap: <code>ldap\\geostore-spring-security-ldap.xml</code> (LDAP source)</li> </ul> <p>Specific configuration files are available to configure connection details for the chosen profile.</p> <p>For example, if using LDAP, look at LDAP integration.</p>"},{"location":"developer-guide/configuration-files/#log4j2-configuration-file","title":"Log4j2 configuration file","text":"<p>Below will be presented some basic pointers to configure logging through the <code>log4j2.properties</code> file. For more informations see the official documentation page.</p> <p>The following is the default MapStore <code>log4j2.properties</code> file.</p> <pre><code>rootLogger.level = INFO\nappenders= console, file\n\n\nappender.console.type = Console\nappender.console.name = LogToConsole\nappender.console.layout.type = PatternLayout\nappender.console.layout.pattern = %p %d{yyyy-MM-dd HH:mm:ss.SSS} %c::%M:%L - %m%n\nrootLogger.appenderRef.stdout.ref = LogToConsole\nrootLogger.appenderRef.console.ref = LogToConsole\n\nappender.file.type = File\nappender.file.name = LogToFile\nappender.file.fileName=${sys:catalina.base}/logs/mapstore.log\nappender.file.layout.type=PatternLayout\nappender.file.layout.pattern=%p   %d{yyyy-MM-dd HH:mm:ss.SSS}   %C{1}.%M() - %m %n\nrootLogger.appenderRef.file.ref = LogToFile\n\n\nlogger.restsrv.name=it.geosolutions.geostore.services.rest\nlogger.restsrv.level=  INFO\nlogger.hibernate1.name=org.hibernate\nlogger.hibernate1.level=INFO\nlogger.trg1.name=com.trg\nlogger.trg1.level=INFO\n</code></pre> <p>The first two properties defines the rootLogger level and appenders declarations.</p> <pre><code>rootLogger.level = INFO\nappenders= console, file\n</code></pre> <p>The following properties configure two appenders: one that writes log messages to the console and the other to a log file. In both cases a pattern layout has been configured through a conversion pattern strings to format the log messages (more details about patterned layouts are available here). For the file appender we have configured as well the location of the log file to which writing log messages (property <code>appender.file.fileName</code>). Note the <code>${sys:catalina.base}</code> variable, used as a placeholder of the root folder of the tomcat instance where MapStore is deployed.</p> <pre><code>appender.console.type = Console\nappender.console.name = LogToConsole\nappender.console.layout.type = PatternLayout\nappender.console.layout.pattern = %p %d{yyyy-MM-dd HH:mm:ss.SSS} %c::%M:%L - %m%n\nrootLogger.appenderRef.stdout.ref = LogToConsole\nrootLogger.appenderRef.console.ref = LogToConsole\n\nappender.file.type = File\nappender.file.name = LogToFile\nappender.file.fileName=${sys:catalina.base}/logs/mapstore.log\nappender.file.layout.type=PatternLayout\nappender.file.layout.pattern=%p   %d{yyyy-MM-dd HH:mm:ss.SSS}   %C{1}.%M() - %m %n\nrootLogger.appenderRef.file.ref = LogToFile\n</code></pre> <p>In the final section of the properties file the loggers for specific package name are configured. In this case the syntax is <code>logger.{a_name_of_choice}.name</code> to declare the package to which the configured logger belongs and <code>logger.{a_name_of_choice}.level</code> to declare the log level of that logger.</p> <pre><code>logger.restsrv.name=it.geosolutions.geostore.services.rest\nlogger.restsrv.level=  INFO\nlogger.hibernate1.name=org.hibernate\nlogger.hibernate1.level=INFO\nlogger.trg1.name=com.trg\nlogger.trg1.level=INFO\n</code></pre>"},{"location":"developer-guide/configuration-files/#front-end-configurations-files","title":"Front-end Configurations Files","text":"<p>They are JSON files that will be loaded via HTTP from the client, keeping most of the framework working also in an html-only context (when used with different back-ends or no-backend). These JSON files are located in <code>web/client/configs</code> directory and they will be copied in the <code>configs</code> of the war file.</p> <p>Several configuration files (at development and / or run time) are available to configure all the different aspects of an application.</p> <ul> <li><code>localConfig.json</code>: Dedicated to the application configuration. Defines all general settings of the front-end part, with all the plugins for all the pages. See Application Configuration for more information.</li> <li><code>new.json</code> Can be customized to set-up the initial new map, setting the backgrounds, initial position .. See Maps configuration for more information.</li> <li><code>pluginsConfig.json</code>: Allows to configure the context editor plugins list. See Context Editor Configuration for more information.</li> </ul>"},{"location":"developer-guide/configuration-files/#externalize-configurations","title":"Externalize Configurations","text":"<p>Typically configuration customization should stay outside the effective application installation directory to simplify future updates. Updates in fact are usually replacement of the old application file package with the newer one. Changes applied directly inside the application package may be so removed on every update. For this reason MapStore provides a externalization system for both the configuration systems. See Externalize Configuration section to learn how to do this.</p>"},{"location":"developer-guide/context-editor-config/","title":"Configuration of Application Context Manager","text":"<p>The Application Context Manager can be configured editing the <code>configs/pluginsConfig.json</code> file.</p> <p>The configuration file has this shape:</p> <pre><code>{\n\"plugins\": [\n{\n\"name\": \"Map\",\n\"mandatory\": true, // &lt;-- mandatory should not be shown in editor OR not movable and directly added to the right list.\n}, {\n\"name\": \"Notifications\",\n\"mandatory\": true, // &lt;-- mandatory should not be shown in editor OR not movable and directly added to the right list.\n\"hidden\": true, // some plugins are only support, so maybe showing them in the UI is superfluous.\n}, {\n\"name\": \"TOC\",\n\"symbol\": \"layers\",\n\"title\": \"plugins.TOC.title\",\n\"description\": \"plugins.TOC.description\",\n\"defaultConfig\": {},\n\"children\": [\"TOCItemSettings\", \"FeatureEditor\"]\n}, {\n\"name\": \"FeatureEditor\",\n\"defaultConfig\":  {}\n}, {\n\"name\": \"TOCItemSettings\",\n\"...\": \"...\"\n}, {\n\"name\": \"MyPlugin\", // &lt;-- this is typically an extension,\n\"docUrl\": \"https://domain.com/documentation\"  // &lt;-- custom documentation url\n}, {\n\"name\": \"Footer\",\n\"children\": [\"MousePosition\", \"CRSSelector\",  \"ScaleBox\"]\n}, {\n\"name\": \"Widgets\",\n\"children\": [\"WidgetsBuilderPlugin\", \"WidgetsTrayPlugin\"],\n\"dependencies\": [\"WidgetsBuilderPlugin\"], // some plugins may be mandatory only if parent is added.\n}, {\n\"name\": \"WidgetsTrayPlugin\"\n},  {\n\"name\": \"WidgetsBuilderPlugin\",\n\"hidden\": true // &lt;-- This is a child. In this case it will be added automatically,\n// without showing if the parent is added\n}]\n}\n</code></pre> <p>The configuration contains the list of available plugins to display in the plugins selector. Each entry of <code>plugins</code> array is an object that describes the plugin, it's dependencies and it's properties. These are the properties allowed for the plugin entry object:</p> <ul> <li><code>name</code>: <code>{string}</code> the name (ID) of the plugin</li> <li><code>title</code>: <code>{string}</code> the title string OR messageId (from localization file)</li> <li><code>description</code>: <code>{string}</code>: the description string OR messageId (from localization file)</li> <li><code>docUrl</code>: <code>{string}</code>: the plugin/extension specific documentation url</li> <li><code>symbol</code>: {string}`: icon (or image) symbol for the plugin</li> <li><code>defaultConfig</code> <code>{object}</code>: optional object containing the default configuration to pass to the context-creator.</li> <li><code>mandatory</code> <code>{boolean}</code>: if true, the plugin must be added to the map, so not possible to remove (but can be customized)</li> <li><code>hidden</code> <code>{boolean}</code>: if true, the plugin should not be shown in UI. If mandatory, is added without showing.</li> <li><code>children</code> <code>{string[]}</code>: list of the plugins names (ID) that should be shown as children in the UI</li> <li><code>dependencies</code>: The difference between mandatory and dependencies is the \"if the parent is present\" condition.). Plugins that can not be disabled (or if are hidden, added by default) and are added ONLY if the parent plugin is added. (e.g. containers like toolbar, omnibar, footer or DrawerMenu, and other dependencies like Widgets that must contain WidgetsBuilder and so on)</li> </ul>"},{"location":"developer-guide/custom-dependencies/","title":"Custom Dependencies","text":"<p>Mapstore has some custom dependencies in order to fix bugs not integrated in the official libraries yet. All these customized libraries are available on npm registry.</p> <p>Here is a list of customizations:</p> library version issue reason github wkt-parser 1.2.1 #2175 Fixes axis order recognition. For this reason we customized it with \"@geosolutions@wkt-parser 1.2.2\" https://github.com/geosolutions-it/wkt-parser/tree/release proj4 2.4.5-alpha #2175 Fixes axis order recognition. For this reason we customized it with \"@geosolutions@proj4 2.4.6\" and its wkt-parser dependency with \"@geosolutions@wkt-parser 1.2.2\". Note that shpjs will use this customized version of proj4 and wkt-parser https://github.com/geosolutions-it/proj4js/tree/release_2.4.6 react-joyride 1.10.1 is a re-publish on npm of a fix made here , we therefore are using \"@geosolutions@react-joyride 1.10.2\" https://github.com/geosolutions-it/react-joyride/tree/release mocha 6.2.0-uncaught #3693 Customized in order to make some test run. More in detail, we removed uncaught exceptions handler because it was making some test failing (waiting for a better solution). Published \"@geosolutions/mocha 6.2.1-3\". mocha is being moved from node_modules/@geosolutions/mocha to node_modules/mocha in order to make the test be runnable https://github.com/geosolutions-it/mocha/tree/release_v6.2.1 jsdoc 3.4.3 #1978 ES6 syntax not parsed by Docma, so we published \"@geosolutions/jsdoc 3.4.4\" with other related dependencies also on our npm, like acorn-jsx, espree and tv4 https://github.com/geosolutions-it/jsdoc/tree/release acorn-jsx 4.0.1 #1978 Added support for instance properties (e.g. state), we published \"@geosolutions/acorn-jsx 4.0.2\" https://github.com/geosolutions-it/acorn-jsx/tree/release"},{"location":"developer-guide/custom-dependencies/#aliases","title":"Aliases","text":"<p>Only proj4 and react-joyride are using aliases in order to maintain original webpack requires like:</p> <ul> <li>const proj4 = require(\"proj4\");</li> <li>const joyride = require('react-joyride').default;</li> </ul> <p>see this for current status of aliases</p>"},{"location":"developer-guide/custom-dependencies/#more-info","title":"More info","text":"<p>Here you can find more information about customization</p>"},{"location":"developer-guide/customize-theme/","title":"Styling and Theming","text":"<p>The look and feel is completely customizable either using one of the included themes, or building your own. Themes are built using less. You can find the default theme here: https://github.com/geosolutions-it/MapStore2/tree/master/web/client/themes/default</p>"},{"location":"developer-guide/customize-theme/#custom-theme-for-a-downstream-project","title":"Custom theme for a downstream project","text":"<p>In a MapStore downstream project normally the theme configuration is placed in the <code>themes/</code> directory</p> <p>Styles can be overridden declaring the same rules in a less module placed in a new project.</p> <p>Below steps to configure a custom theme to override styles of the default theme:</p> <ul> <li>add the following files to the themes folder of the project:</li> </ul> <pre><code>.\n+-- themes/\n|   +-- default/\n|       +-- less/\n|           +-- my-custom-module.less\n|       +-- theme.less\n|       +-- variables.less\n</code></pre> <ul> <li>import in <code>theme.less</code> all the needed less module</li> </ul> <pre><code>@import \"../../MapStore2/web/client/themes/default/theme.less\";\n@import \"./variables.less\";\n@import \"./less/my-custom-module.less\";\n</code></pre> <ul> <li>update webpack configuration to use the custom style (webpack.config.js, prod-webpack.config.js)</li> </ul> <pre><code>module.exports = require('./MapStore2/build/buildConfig')({\n    bundles:{\n        '__PROJECTNAME__': path.join(__dirname, \"js\", \"app\"),\n        '__PROJECTNAME__-embedded': path.join(__dirname, \"MapStore2\", \"web\", \"client\", \"product\", \"embedded\"),\n        '__PROJECTNAME__-api': path.join(__dirname, \"MapStore2\", \"web\", \"client\", \"product\", \"api\")\n    },\n-   themeEntries,\n+   themeEntries: {\n+       \"themes/default\": path.join(__dirname, \"themes\", \"default\", \"theme.less\")\n+   },\n   ...\n</code></pre> <ul> <li>update <code>variables.less</code> to override existing variables</li> </ul> <pre><code>/* change primary color to blue */\n@ms-primary: #0000ff;\n</code></pre> <ul> <li>update <code>my-custom-module.less</code> to override existing rules or add new rules</li> </ul> <pre><code>/* change the background color of the page*/\n.page {\nbackground-color: #d9e6ff;\n}\n</code></pre>"},{"location":"developer-guide/customize-theme/#custom-theme-for-contexts","title":"Custom theme for contexts","text":"<p>You can configure a list of themes to be used inside a context.</p> <p>In order to do that you have to:</p> <ul> <li>create the themes in the <code>themes/</code> folder as described below</li> <li>edit ContextCreator plugin in the <code>localConfig.json</code></li> </ul> <p>example</p> <pre><code>{\n\"name\": \"ContextCreator\",\n\"cfg\": {\n\"documentationBaseURL\": \"https://mapstore.geosolutionsgroup.com/mapstore/docs/api/plugins\",\n\"backToPageDestRoute\": \"/context-manager\",\n\"backToPageConfirmationMessage\": \"contextCreator.undo\",\n\"themes\": [{\n\"id\": \"complete-theme-override\",\n\"type\": \"link\",\n\"href\": \"dist/themes/complete-theme-override.css\",\n\"defaultVariables\": {\n\"ms-main-color\": \"#000000\",\n\"ms-main-bg\": \"#FFFFFF\",\n\"ms-primary-contrast\": \"#FFFFFF\",\n\"ms-primary\": \"#078aa3\",\n\"ms-success-contrast\": \"#FFFFFF\",\n\"ms-success\": \"#398439\"\n}\n},\n{\n\"id\": \"partial-theme-override\",\n\"type\": \"link\",\n\"href\": \"dist/themes/partial-theme-override.css\"\n},\n{\n\"id\": \"only-css-variables\",\n\"type\": \"link\",\n\"href\": \"dist/themes/only-css-variables.css\"\n}\n],\n\"basicVariables\": {\n\"ms-main-color\": \"#000000\",\n\"ms-main-bg\": \"#FFFFFF\",\n\"ms-primary-contrast\": \"#FFFFFF\",\n\"ms-primary\": \"#078aa3\",\n\"ms-success-contrast\": \"#FFFFFF\",\n\"ms-success\": \"#398439\"\n}\n}\n}\n</code></pre> <p>for each theme you can define:</p> <ul> <li>id id of the theme equal to its name</li> <li>type values can be</li> <li>link will require a href property</li> <li>href path to find the css once built</li> <li>defaultVariables variables of the theme used to initialize the pickers (optional)</li> </ul> <p>basicVariables these are the variables used as default values if a theme is not selected (optional)</p>"},{"location":"developer-guide/customize-theme/#suggested-ways-to-create-a-custom-theme-for-a-context","title":"Suggested ways to create a custom theme for a context","text":""},{"location":"developer-guide/customize-theme/#complete-theme-override","title":"Complete theme override","text":"<p>This example will create a complete css file and is not recommended if you want a light version and you just need to customize the variables (for this check next paragraph)</p> <p>Add the following files to the themes folder of the project</p> <pre><code>+-- themes/\n|   +-- theme-name/\n|       +-- theme.less\n|       +-- variables.less\n</code></pre> <p>in <code>theme.less</code> put</p> <pre><code>/*\n * This example will contain a complete mapstore theme with some customization\n * it will be selectable inside context theme step selector\n*/\n\n/*\n * it includes the main theme and this will recompile the whole theme\n*/\n@import \"../../MapStore2/web/client/themes/default/theme.less\";\n\n/*\n * it includes some changes to css variables\n*/\n@import \"./variables.less\";\n\n/*\n* Note: You can always expand it with new less/css rules\n*/\n</code></pre> <p>in <code>variables.less</code> you can put the mapstore variables customizations</p> <pre><code>/*\n * A variable that will override the default css one\n*/\n@ms-primary: #2E13FE;\n</code></pre>"},{"location":"developer-guide/customize-theme/#only-css-variables","title":"Only css variables","text":"<p>This example is perfect if you just want to customize a few colors of the theme</p> <pre><code>+-- themes/\n|   +-- theme-name/\n|       +-- theme.less\n|       +-- variables.less\n</code></pre> <p>in <code>theme.less</code> put</p> <pre><code>/*\n * This example is the lightest version of all three examples\n * it will be selectable inside context theme step selector\n * this examples is limited to changing the css variables only,\n * but you can always expand it as we did for partial-theme-override\n*/\n\n/*\n * This will import as (reference) https://lesscss.org/features/#import-atrules-feature-reference\n * It's used to import external files, but without adding the imported styles\n * to the compiled output unless referenced.\n *\n*/\n@import (reference) \"../../MapStore2/web/client/themes/default/theme.less\";\n\n/*\n * it includes some changes to css variables\n*/\n@import \"./variables.less\";\n\n/*\n * this will create only one class with the :root selector inside\n * it's important to place the variable overrides before calling the css-variable mixin generator\n * which is called .get-root-css-variables\n*/\n.get-root-css-variables(@ms-theme-vars);\n\n/*\n* Note: You can always expand it with new less/css rules\n*/\n</code></pre> <p>In the <code>variables.less</code> you can do put your variable customizations</p>"},{"location":"developer-guide/customize-theme/#partial-theme-override","title":"partial theme override","text":"<pre><code>+-- themes/\n|   +-- theme-name/\n|       +-- less/\n    |       +-- plugin-name.less\n</code></pre> <pre><code>/*\n * We can use this method when we want to customize some part of the theme\n * without the need to include the theme in its completeness\n*/\n\n/*\n * here you can apply some other overrides, like the size of thumbnails for backgrounds\n*/\n@import \"./less/drawer-menu.less\";\n\n/*\n* Note: You can always expand it with new less/css rules\n*/\n</code></pre> <p>Note: These three styles are an example on how is possible to approach on the mapstore customizations. You could extend/combine them together to create a more complex theme.</p>"},{"location":"developer-guide/customize-theme/#tips","title":"Tips","text":"<ul> <li>When you develop locally</li> <li>and you want to reduce the building time</li> <li>and you don't need themes that are not the default theme</li> <li>then  you can comment this in the <code>webpack-config.js</code></li> </ul> <pre><code>    {\n[\"themes/default\"]: path.join(__dirname, \"themes\", \"default\", \"theme.less\")\n/*,\n        [\"themes/complete-theme-override\"]: path.join(__dirname, \"themes\", \"complete-theme-override\", \"theme.less\"),\n        [\"themes/partial-theme-override\"]: path.join(__dirname, \"themes\", \"partial-theme-override\", \"theme.less\"),\n        [\"themes/only-css-variables\"]: path.join(__dirname, \"themes\", \"only-css-variables\", \"theme.less\")\n        */\n},\n</code></pre>"},{"location":"developer-guide/customize-theme/#structure-of-less-files","title":"Structure of .less files","text":"<p>Each less file that represent a MapStore plugin or component is composed by two sections:</p> <ul> <li> <p>Theme section includes all the styles and classes that should change based on css variables. All the new declared selector must be included in a special function called <code>#ms-components-theme</code>. The <code>#ms-components-theme</code> function provide access to all the available variables of the theme via the <code>@theme-vars</code> argument.</p> </li> <li> <p>Layout section includes all the styles and classes that should not change in a simple customization.</p> </li> </ul> <p>Example:</p> <pre><code>// **************\n// Theme\n// **************\n#ms-components-theme(@theme-vars) {\n// here all the selectors related to the theme\n// use the mixins declared in the web/client/theme/default/less/mixins/css-properties.less\n// to use one of the @theme-vars\n\n// eg: use the main background and text colors to paint my plugin\n.my-plugin-class {\n.color-var(@theme-vars[main-color]);\n.background-color-var(@theme-vars[main-bg]);\n}\n}\n\n// **************\n// Layout\n// **************\n\n// eg: fill all the available space in the parent container with my plugin\n.my-plugin-class {\nposition: absolute;\nheight: 100%;\nwidth: 100%;\n}\n\n// here\n</code></pre>"},{"location":"developer-guide/customize-theme/#ms-variablesless","title":"ms-variables.less","text":"<p>MapStore uses basic less variables to change theme colors, buttons sizes and fonts. It possible also to override bootstrap less variable for advanced customization. Basic variables can be found in the ms-variable.less file</p> <p>New declarations in MapStore should have the following structure:</p> <p>global: <code>@ms-rule-value</code></p> <p>local: <code>@ms-name-of-plugin--rule-value</code></p> <ul> <li><code>@ms</code> suffix for MapStore variable</li> <li><code>name-of-plugin</code> for local variable it's important to write the name of plugin in kebab-case</li> <li><code>rule-value</code> value to use in compiled CSS, some examples:</li> <li><code>color</code> generic color variable</li> <li><code>text-color</code> color for text</li> <li><code>background-color</code> color for background</li> <li><code>border-color</code> color for border</li> </ul>"},{"location":"developer-guide/customize-theme/#less-directory","title":"less/ directory","text":"<p>The <code>less/</code> directory contains all the modules needed to create the final CSS of MapStore.</p> <p>Each file in this directory is related to a specific plugin or component and the files are named based on the plugin's name are referring to.</p> <p><code>common.less</code> file can be used for generic styles.</p>"},{"location":"developer-guide/customize-theme/#inline-styles","title":"inline styles","text":"<p>Inline styles should be applied only for values that change dynamically during the lifecycle of the application, all others style should be moved to the related .less file.</p> <p>The main reason of this choice is to allow easier overrides of styles in custom projects.</p>"},{"location":"developer-guide/database-setup/","title":"Database Setup","text":"<p>MapStore can use 3 types of database:</p> <ul> <li>H2</li> <li>PostgreSQL</li> <li>Oracle</li> </ul> <p>MapStore uses an H2 in-memory DB as the default DBMS to persist the data. This configuration is useful for development and test purposes, or to evaluate the project but it is obviously NOT RECOMMENDED for production usage; moreover the H2 DB cannot be used for the integration with GeoServer.</p> <p>In the following guide you will learn how to configure MapStore to use an external database.</p> <p>Note</p> <p>Database recommendations are reported in the Requirements page.</p>"},{"location":"developer-guide/database-setup/#externalize-properties-files","title":"Externalize properties files","text":"<p>MapStore has a file called <code>geostore-datasource-ovr.properties</code>. This file is on the repository in the folder <code>java/web/src/main/resources</code>, in the final <code>mapstore.war</code> package it will be copied into <code>WEB-INF/classes</code> path. It contains the set-up for the database connection. Anyway if you edit the file in <code>WEB-INF/classes</code> this file will be overridden on the next re-deploy. To preserve your configuration on every deploy you can use an environment variable, <code>geostore-ovr</code>, to configure the path to an override file in a different, external directory. In this file the user can re-define the default configuration and so set-up the database configuration.</p> <p>For instance using tomcat on linux you will have to do something like this to add the environment variable to the JAVA_OPTS</p> <p>where to add your JAVA_OPTS depends on your operating system. For instance the file could be <code>/etc/default/tomcat8</code>, or similar, in linux debian</p> <pre><code># here the path to the ovr file\nGEOSTORE_OVR_FILE=file:///var/lib/tomcat/conf/geostore-ovr.properties\n\n# add the env. variable 'geostore-ovr' to JAVA_OPTS\nJAVA_OPTS=\"-Dgeostore-ovr=$GEOSTORE_OVR_FILE [other opts]\"\n</code></pre> <p>So your file <code>/var/lib/tomcat/conf/geostore-ovr.properties</code> will contain the overrides to the database set-up.</p>"},{"location":"developer-guide/database-setup/#database-creation-mode","title":"Database creation Mode","text":"<p>By default MapStore automatically populates the database on it's own. If you want to disable this functionality (e.g. if you don't want to allow the database user to have permission to create tables) then you have to set-up the following property in the ovr file to 'validate'</p> <pre><code>geostoreEntityManagerFactory.jpaPropertyMap[hibernate.hbm2ddl.auto]=validate\n</code></pre> <p>Options are:</p> <ul> <li><code>validate</code>: validate the schema, makes no changes to the database.</li> <li><code>update</code>: update the schema.</li> <li><code>create</code>: creates the schema, destroying previous data.</li> <li><code>create-drop</code>: drop the schema when the SessionFactory is closed explicitly, typically when the &gt; application is stopped.</li> </ul> <p>In this case it is necessary to manually create the required tables using the scripts available here for the needed DBMS.</p> <p>The <code>update</code> mode is usually discouraged in production. On production servers you should always use <code>validate</code> mode and apply SQL scripts and/or patches manually. Anyway before every update a database backup is strongly suggested.</p>"},{"location":"developer-guide/database-setup/#h2","title":"H2","text":"<p>If you download or build mapStore.war, it's default configuration will be this one:</p> <pre><code>geostoreDataSource.url=jdbc:h2:./webapps/mapstore/geostore\ngeostoreEntityManagerFactory.jpaPropertyMap[hibernate.hbm2ddl.auto]=update\n</code></pre> <p>This configuration creates a file called <code>geostore</code> in the webapp folder. You can change the <code>geostoreDataSource.url</code> to set the path to the database you want to use. Make you sure that the user of the project that executes Tomcat has write permissions on the folder where you want to create the database.</p>"},{"location":"developer-guide/database-setup/#postgresql","title":"PostgreSQL","text":"<p>All the following configurations will use <code>geostore</code> as password of the user <code>geostore</code>. Of course you can change it according to your needings.</p>"},{"location":"developer-guide/database-setup/#database-creation-and-setup","title":"Database Creation and Setup","text":"<p>To use postgreSQL DBMS as MapStore you have to create the \"geostore\" DB.</p> <ul> <li>Log in as user postgres</li> <li>Create the geostore DB:</li> </ul> <pre><code>createdb geostore\n</code></pre> <p>Create users and schemas:</p> <pre><code>psql geostore &lt; 001_setup_db.sql\n</code></pre> <p>Here below the required part of the file <code>001_setup_db.sql</code>, available here (creation of test user and schema for <code>geostore_test</code> in the original file is not strictly required for MapStore)</p> <p>Write the password you prefer instead of 'geostore'</p> <pre><code>-- CREATE SCHEMA geostore (set the password you prefer)\nCREATE user geostore LOGIN PASSWORD 'geostore' NOSUPERUSER INHERIT NOCREATEDB NOCREATEROLE;\n\nCREATE SCHEMA geostore;\n\nGRANT USAGE ON SCHEMA geostore TO geostore ;\nGRANT ALL ON SCHEMA geostore TO geostore ;\n\nalter user geostore set search_path to geostore , public;\n</code></pre> <p>If you need to create the database schema manually (validate mode), you have also this script.</p> <p>At the end, make you sure that the user <code>geostore</code> has access to the database from the address of MapStore application. You can give permission by editing pg_hba.conf</p>"},{"location":"developer-guide/database-setup/#connection-to-the-database","title":"Connection to the Database","text":"<p>To configure MapStore to connect it to the new created database you have to edit your override file like below (change the connection parameters accordingly):</p> <pre><code># Setup driver and dialect for PostgreSQL database\ngeostoreDataSource.driverClassName=org.postgresql.Driver\ngeostoreVendorAdapter.databasePlatform=org.hibernate.dialect.PostgreSQLDialect\n\n# Connection parameters\ngeostoreDataSource.url=jdbc:postgresql://localhost:5432/geostore\ngeostoreDataSource.username=geostore\ngeostoreDataSource.password=geostore\ngeostoreEntityManagerFactory.jpaPropertyMap[hibernate.default_schema]=geostore\n\n# Automatic create-update database mode\ngeostoreEntityManagerFactory.jpaPropertyMap[hibernate.hbm2ddl.auto]=update\n\n# Other options\ngeostoreVendorAdapter.generateDdl=true\ngeostoreVendorAdapter.showSql=false\n</code></pre>"},{"location":"developer-guide/database-setup/#migrate-an-existing-h2-database-to-postgresql","title":"Migrate an existing H2 database to PostgreSQL","text":"<p>If you used an H2 database during development, and you want to deploy the application in production, migrating the database to PostgreSQL is not that easy.</p> <p>For this reason we have created a specific tool for this task, called H2ToPgSQLExport that is part of the GeoStore CLI.</p> <p>More information on the migration tool is available in the GeoStore CLI documentation page.</p>"},{"location":"developer-guide/database-setup/#oracle","title":"Oracle","text":""},{"location":"developer-guide/database-setup/#database-creation-and-setup_1","title":"Database Creation and Setup","text":"<p>Create a database geostore, a schema called GEOSTORE and a user <code>geostore</code> that has write access to them.</p> <p>Use this SQL script to create the DB schema.</p>"},{"location":"developer-guide/database-setup/#connection-to-the-database_1","title":"Connection to the Database","text":"<p>To configure MapStore to connect to the new created database you have to edit your override file like reported below:</p> <pre><code># Setup driver and dialect for Oracle Database\ngeostoreDataSource.driverClassName=oracle.jdbc.OracleDriver\ngeostoreVendorAdapter.databasePlatform=org.hibernate.dialect.Oracle10gDialect\n\n# Connection parameters\ngeostoreDataSource.url=jdbc:oracle:thin:@localhost:1521/ORCL\ngeostoreEntityManagerFactory.jpaPropertyMap[hibernate.default_schema]=GEOSTORE\ngeostoreDataSource.username=geostore\ngeostoreDataSource.password=geostore\n\n# Automatic create-update database mode\ngeostoreEntityManagerFactory.jpaPropertyMap[hibernate.hbm2ddl.auto]=\n\n# Other options\ngeostoreVendorAdapter.generateDdl=true\ngeostoreVendorAdapter.showSql=false\n</code></pre>"},{"location":"developer-guide/dev-faq/","title":"FAQ","text":""},{"location":"developer-guide/dev-faq/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/dev-faq/#autowatch-doesnt-work-on-linux","title":"Autowatch doesn't work on Linux","text":"<p>You should need to increase <code>max_user_watches</code> variable for inotify.</p> <pre><code>echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &amp;&amp; sudo sysctl -p\n</code></pre>"},{"location":"developer-guide/dev-faq/#other-references","title":"Other References","text":"<ul> <li>How to use a CDN</li> </ul>"},{"location":"developer-guide/dev-how-to/","title":"Developer Generic Guidelines","text":"<p>This guide wants to provide general information and suggestions about how to write code for MapStore. It contains a practical guide to write plugins for MapStore, then some general information about writing redux actions, reducers and redux-observble epics, with some hints specific of MapStore.</p> <p>Still to do:</p> <ul> <li>Writing enhancers</li> <li>Writing components</li> <li>Using JS API</li> </ul> <p>Work in progress:</p> <ul> <li>Extensions</li> </ul>"},{"location":"developer-guide/developing-with-mapstore-2-intro/","title":"Developing with MapStore","text":"<p>MapStore is both an application and a framework. This guide is both for developers who want to extend MapStore and for those who want to create their custom application using MapStore as a framework.</p>"},{"location":"developer-guide/developing-with-mapstore-2-intro/#mapstore-as-an-application","title":"MapStore as an application","text":"<p>MapStore is 99% client side, and uses some Java back-end services</p> <p>Back-end mainly consists in services included from external projects (GeoStore, MapFish Print, HTTP-Proxy...) plus some small service owned by MapStore, all written in Java.</p> <p>Developing with MapStore as an application means to develop directly on the project. You can add plugins or improve the existing code base and, hopefully, send pull requests on GitHub to include your improvements in the main project.</p>"},{"location":"developer-guide/developing-with-mapstore-2-intro/#mapstore-as-a-framework","title":"MapStore as a Framework","text":"<p>The recommended way to use MapStore as a framework is to create a project that includes MapStore as a sub-folder. For this purpose we created a script that generates the main folder structure and the necessary files Project Creation Script.</p> <p>This setup allows to create your application or customizations inside the <code>js</code> directory and/or add custom back-end services (the set-up allows to create a project that builds a Java WAR package). Keeping your customization separated and MapStore as a git sub-modules has the followind advantages:</p> <ul> <li>Clear separation between the framework and your customization</li> <li>Easy framework update: updating the git sub-module.</li> <li>Easy customization of MapStore: You can fork the project, if you need hard customization. If your customization can be included in MapStore, you can do a pull request to the main project and work on a branch while waiting the pull request merge.</li> </ul>"},{"location":"developer-guide/developing/","title":"Developing with MapStore","text":"<p>Due to the dual nature of the project (Java backend and JavaScript frontend) building and developing using the MapStore framework requires two distinct set of tools</p> <ul> <li>Apache Maven for Java</li> <li>NPM for JavaScript.</li> </ul> <p>A basic knowledge of both tools is required.</p>"},{"location":"developer-guide/developing/#start-developing","title":"Start developing","text":"<p>To start developing the MapStore framework you have to:</p> <ul> <li>download developer tools and install frontend dependencies locally:</li> </ul> <pre><code>npm install\n</code></pre> <p>After a while (depending on the network bandwidth) the full set of dependencies and tools will be downloaded to the node_modules sub-folder.</p> <ul> <li>start the local dev server instances with:</li> </ul> <pre><code>npm start\n</code></pre> <p>Then point your preferred browser to http://localhost:8081/?debug=true#/. By default the frontend works using the local dev server as backend. This configuration is suggested if you want to develop.</p> <p>Note</p> <p><code>npm start</code> will run both front-end on port 8081 and back-end on port 8080 (make sure to have both the ports available). The first time back-end will take a lot to start, downloading all the dependencies.</p> <p>If you still want to start only the frontend because you have the backend running in a tomcat container for example you may simply run</p> <pre><code>npm start\n</code></pre> <p>See the dedicated section in this page for more info</p>"},{"location":"developer-guide/developing/#frontend","title":"Frontend","text":"<p>You can run only the front-end running <code>npm run fe:start</code>. Running this script MapStore will run on port <code>8081</code> and will look for the back-end at port <code>8080</code>.</p> <p>If you want to use an online instance of MapStore as backend, instead of the local one, you can define the environment variable <code>MAPSTORE_BACKEND_URL</code> to the desired URL.</p> <pre><code>export MAPSTORE_BACKEND_URL=https://dev-mapstore.geosolutionsgroup.com/mapstore\nnpm run fe:start # this command lunches only the front-end\n</code></pre> <p>Note</p> <p>for more customizations on devServer you can edit the <code>build/devServer.js</code> file.</p>"},{"location":"developer-guide/developing/#debugging","title":"Debugging","text":"<p>The development instance uses file watching and live reload, so each time a MapStore file is changed, the browser will reload the updated application.</p> <p>Use your favorite editor / IDE to develop and debug on the browser as needed.</p> <p>We suggest to use one of the following:</p> <ul> <li>Visual Studio Code with the following plugins:</li> <li>ESLint <code>dbaeumer.vscode-eslint</code></li> <li>EditorConfig for VSCode <code>editorconfig.editorconfig</code></li> <li>Atom with the following plugins:</li> <li>editorconfig</li> <li>linter</li> <li>linter-eslint</li> <li>react</li> <li>lcovinfo</li> <li>minimap &amp; minimap-highlight-selected</li> <li>highlight-line &amp; highlight-selected</li> <li>Sublime Text Editor with the following plugins:</li> <li>Babel</li> <li>Babel snippets</li> <li>Emmet</li> </ul>"},{"location":"developer-guide/developing/#redux-dev-tools","title":"Redux Dev Tools","text":"<p>When you are running the application locally using <code>npm start</code> you can debug the application with redux dev tools using the flag ?debug=true</p> <pre><code>http://localhost:8081/?debug=true#/\n</code></pre> <p>It also integrates with the browser's extension, if installed.</p> <p>This way you can monitor the application's state evolution and the action triggered by your application.</p>"},{"location":"developer-guide/developing/#unit-tests","title":"Unit tests","text":"<p>To run the MapStore frontend test suite you can use:</p> <pre><code>npm test\n</code></pre> <p>You can also have a continuously running watching test runner, that will execute the complete suite each time a file is changed, launching:</p> <pre><code>npm run test:watch\n</code></pre> <p>Usually during the development you may need to execute less tests, when working on some specific files.</p> <p>You can reduce the tests invoked in <code>npm run test:watch</code> execution by editing the file <code>tests.webpack.js</code> and modifying the directory (<code>/web</code>) and/or the regular expression that intercept the files to execute.</p> <p>To run ESLint checks launch:</p> <pre><code>npm run lint\n</code></pre> <p>More information on frontend building tools and configuration is available here</p>"},{"location":"developer-guide/developing/#backend","title":"Backend","text":"<p>In order to have a full running MapStore in development environment, you need to run also the backend java part locally. This runs automatically with <code>npm start</code>. If you want to run only the backend, you can use <code>npm run be:start</code>.</p> <p>The back end will run on port 8080 and will look for the front-end at port 8081. If you want to change the back-end port, you can set the environment variable <code>MAPSTORE_BACKEND_PORT</code> to the desired port. Optionally you can set the data dir location by setting the environment variable <code>MAPSTORE_DATA_DIR</code>.</p> <p>For Linux:</p> <pre><code>export MAPSTORE_BACKEND_PORT=8082 # set a different backend port\nexport MAPSTORE_DATA_DIR=/usr/datadir # set the datadir location\nnpm start # or npm run be:start\n</code></pre> <p>For Windows:</p> <pre><code>set MAPSTORE_BACKEND_PORT=8082 \nset MAPSTORE_DATA_DIR=C:/Users/user/datadir\nnpm start # or npm run be:start\n</code></pre> <p>Note</p> <p>When the data directory is set using <code>npm start</code>, the <code>/configs</code> folder used by the dev server is anyway the one in <code>web/client/configs</code>. If you want to use the configuration override functionalities of the data directory of MapStore, you have to edit the <code>devServer.js</code> to proxy also the <code>/configs</code> directory and use the remote service running by the backend. Noticed that in this case the configuration files in <code>web/client/configs</code> will not be used anymore. Here a sample of the config to add to <code>devServer.js</code>.</p> <pre><code>'/configs': {\ntarget: MAPSTORE_BACKEND_URL,\nsecure: false,\nheaders: {\nhost: domain\n}\n},\n</code></pre>"},{"location":"developer-guide/developing/#defaults-users-and-database","title":"Defaults Users and Database","text":"<p>Running MapStore backend locally, on start-up you will find the following users:</p> <ul> <li><code>admin</code>, with ADMIN role and password <code>admin</code></li> <li><code>user</code> with USER role with password <code>user</code></li> </ul> <p>You can login as <code>admin</code> to set-up new users and access to all the features reserved to <code>ADMIN</code> users.</p> <p>The database used by default in this mode is H2 on disk. You can find the files of the database in the directory <code>webapps/mapstore/</code> starting from your execution context. Check how to set-up database in the dedicated section of the documentation.</p>"},{"location":"developer-guide/developing/#running-backend","title":"Running Backend","text":"<p>When we say \"running the backend\", in fact we say that we are running some sort of a whole instance of MapStore locally, that can be used as backend for your frontend dev server, or for debugging of the backend itself.</p>"},{"location":"developer-guide/developing/#embedded-tomcat","title":"Embedded tomcat","text":"<p>MapStore is configured to use a maven plugin-in to build and run mapstore locally in tomcat. To use it you have to:</p> <ul> <li><code>npm run be:start</code></li> </ul> <p>Now you are good to go, and you can start the frontend</p> <p>Your local backend will now start at http://localhost:8080/mapstore/. If you want to change the port you can edit the dedicated entry in <code>product/pom.xml</code>, just remember to change also the dev-server proxy configuration on the frontend in the same way.</p>"},{"location":"developer-guide/developing/#embedded-tomcat-properties","title":"Embedded tomcat properties","text":"<p>The command <code>npm run be:start</code> internally runs the maven command <code>mvn cargo:run</code> with some properties set. You can customize the properties by passing them as arguments to the command.</p> <pre><code>npm run be:start -- &lt;java-properties&gt;\n</code></pre> <p>The java properties are passed to the maven command as <code>-D&lt;property-name&gt;=&lt;property-value&gt;</code>.</p> <p>For example:</p> <pre><code>npm run be:start -- -Dsecurity.integration=ldap-direct -Ddatadir.location=/usr/datadir -Dbackend.debug.args=\"-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8000\"\n</code></pre> <p>Here the list of the properties that you can set:</p> <ul> <li><code>datadir.location</code> : the location of the data directory. This can be set also as environment variable <code>MAPSTORE_DATA_DIR</code>.</li> <li><code>backend.debug.args</code> : the arguments to pass to the JVM for debugging. If you want to enable remote debugging, you can set this property to <code>-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8000</code></li> <li><code>security.integration</code> : the security integration to use. Possible values are <code>default</code>, <code>keycloak-direct</code></li> </ul>"},{"location":"developer-guide/developing/#local-tomcat-instance","title":"Local tomcat instance","text":"<p>If you prefer, or if you have some problems with <code>mvn cargo:run</code>, you can run MapStore backend in a tomcat instance instead of using the embedded one. To do so, you can :</p> <ul> <li>download a tomcat standalone here and extract to a folder of your choice</li> <li>To generate a war file that will be deployed on your tomcat server, go to the root of the Mapstore project that was git cloned and run <code>./build.sh</code>. This might take some time but at the end a war file named <code>mapstore.war</code> will be generated into the <code>product/target</code> folder.</li> <li>Copy the <code>mapstore.war</code> and then head back to your tomcat folder. Look for a <code>webapps</code> folder and paste the <code>mapstore.war</code> file there.</li> <li>To start tomcat server, go to the terminal, <code>cd</code> into the root of your tomcat extracted folder and run <code>./bin/startup.sh</code> ( unix systems) or <code>./bin/startup.bat</code> (Windows). The server will start on port <code>8080</code> and Mapstore will be running at <code>http://localhost:8080/mapstore</code>. For development purposes we're only interested in the backend that was started on the tomcat server along with Mapstore.</li> </ul> <p>Even in this case you can connect your frontend to point to this instance of MapStore.</p>"},{"location":"developer-guide/developing/#debug","title":"Debug","text":"<p>To run or debug the server side part of MapStore we suggest to run the backend in tomcat (embedded or installed) and connect in remote debugging to it.</p>"},{"location":"developer-guide/developing/#enable-remote-debugging","title":"Enable Remote Debugging","text":"<p>for embedded tomcat you can run the following:</p> <pre><code>npm run be:start -- backend.debug.args\"-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8000\"\n</code></pre> <p>For your local tomcat, you can follow the standard procedure to debug with tomcat.</p>"},{"location":"developer-guide/developing/#setup-eclipse-project","title":"Setup eclipse project","text":"<ul> <li>Run eclipse plugin</li> </ul> <pre><code>mvn eclipse:eclipse </code></pre> <ul> <li>Import the project in eclipse from File --&gt; Import</li> <li>Then select Existing project into the Workspace</li> <li>Select root directory as MapStore root (to avoid eclipse to iterate over all node_modules directories looking for eclipse project)</li> <li>import all projects</li> </ul>"},{"location":"developer-guide/developing/#start-debugging-with-eclipse","title":"Start Debugging with eclipse","text":"<ul> <li>Start Eclipse and open Run --&gt; Debug Configurations</li> <li>Create a new Remote Java Application selecting the project \"mapstore-product\" setting:</li> <li>host localhost</li> <li>port 4000</li> <li>Click on Debug Remote debugging is now available.</li> </ul> <p>NOTE With some version of eclipse you will have to set <code>suspend=y</code> in mvn options to make it work. In this case the server will wait for the debug connection at port 4000 (<code>address=4000</code>)</p>"},{"location":"developer-guide/documentation-guidelines/","title":"Documentation guidelines","text":"<p>Each new feature/tool in MapStore should be documented in the User Guide in order to explain the involved functionalities and illustrate how it works.</p> <p>All new front-end technologies, development procedures, best practices and guidelines on the involved components in MapStore should be properly documented too: the Developers Guide must be kept up-to-date for this.</p> <p>The Developer and User guide documentation are built on the Read the Docs hosting platform. The MapStore's documentation files are available in the docs/ section of this repository; Mkdocs is used in MapStore as documentation generator, you can look at the available online documentation for more information on how to use it (MapStore uses his own customized MkDocs Material theme for both User and Developer documentations).</p>"},{"location":"developer-guide/documentation-guidelines/#general-guidelines","title":"General Guidelines","text":""},{"location":"developer-guide/documentation-guidelines/#internal-links","title":"Internal links","text":"<p>When creating internal links between pages (<code>.md</code> files), make sure to use full link to the paragraph instead of using only the relative path to the file. As using relative path will not work in exported PDF document.</p> <p>Example</p> <p>Instead of creating a link <code>[FAQ]('../dev-faq/')</code>, use <code>[FAQ]('../dev-faq/#faq')</code> or <code>[FAQ]('../dev-faq.md#faq')</code> or <code>[FAQ]('dev-faq.md#faq')</code></p>"},{"location":"developer-guide/documentation-guidelines/#building-documentation","title":"Building documentation","text":"<p>The documentation is built on RTD (Read the Docs) documentation hosting platform.</p> <p>But in order to build it locally, there are certain steps that needs to be followed:</p>"},{"location":"developer-guide/documentation-guidelines/#1-python-installation","title":"1. Python installation","text":"<p>Install Python 3 and pip following the instructions on the python web site for your operating system.</p> <p>Note</p> <p>Pip is automatically installed when python is downloaded from python.org, if not, follow this instruction to install it</p>"},{"location":"developer-guide/documentation-guidelines/#2-libraries-installation","title":"2. Libraries installation","text":"<p>Install all the libraries/plugins in <code>docs/requirements.txt</code> using pip while matching the exact version present.</p> <p><code>pip install -r docs/requirements.txt</code></p>"},{"location":"developer-guide/documentation-guidelines/#3-build-the-documentation","title":"3. Build the documentation","text":"<p>Build the docs using the command <code>mkdocs build</code>.</p> <p>If you want to generate also the PDF, you need to add set the environment variable <code>ENABLE_PDF_EXPORT</code> to <code>1</code> before to run <code>mkdocs build</code>. The build with the PDF option takes around 5 minutes to finish.</p> <pre><code>export ENABLE_PDF_EXPORT=1\nmkdocs build\n</code></pre> <p>This will build the documentation and puts the built files into <code>site</code> folder and the pdf generated into <code>site\\pdf\\mapstore_documentation.pdf</code></p> <p>The documentation can be launched using <code>index.html</code> in <code>site</code> folder</p>"},{"location":"developer-guide/documentation-guidelines/#4-editing-the-documentation","title":"4. Editing the documentation","text":"<p>To live build and test the documentation locally, run the following command:</p> <pre><code>mkdocs serve\n</code></pre> <p>This command will start the built-in dev-server of MkDocs that lets us preview the documentation as we work on it.</p> <p>The documentation will be available at http://localhost:8000. Every time you save some documentation file, the page will be automatically updated.</p> <p>Note</p> <p>make you sure to not have set <code>ENABLE_PDF_EXPORT=1</code> while testing live, in order to avoid build the pdf every time that takes a long time to be generated.</p>"},{"location":"developer-guide/extensions/","title":"Working with Extensions","text":"<p>The MapStore2 plugins architecture allows building your own independent modules that will integrate seamlessly into your project.</p> <p>Extensions are plugins that can be distributed as a separate package (a zip file), and be installed, activated and used at runtime. Creating an extension is similar to creating a plugin. If you are not familiar with plugins, please, read the Plugins HowTo page first.</p>"},{"location":"developer-guide/extensions/#developing-an-extension","title":"Developing an extension","text":"<p>The easiest way to develop an extension is to start from the MapStoreExtension project that gives you a sandbox to create/test and build your extension.</p> <p>Read the readme of the project to understand how to run, debug and build a new extension starting from the sampleExtension in the project.</p> <p>Here you can find some details about the structure extension files, useful for development and debugging.</p>"},{"location":"developer-guide/extensions/#an-extension-example","title":"An extension example","text":"<p>A MapStore extension is a plugin, with some additional features.</p> <pre><code>import {connect} from \"react-redux\";\n\nimport Extension from \"../components/Extension\";\nimport Rx from \"rxjs\";\nimport { changeZoomLevel } from \"../../../web/client/actions/map\";\n\nexport default {\nname: \"SampleExtension\",\ncomponent: connect(state =&gt; ({\nvalue: state.sampleExtension &amp;&amp; state.sampleExtension.value\n}), {\nonIncrease: () =&gt; {\nreturn {\ntype: 'INCREASE_COUNTER'\n};\n}, changeZoomLevel\n})(Extension),\nreducers: {\nsampleExtension: (state = { value: 1 }, action) =&gt; {\nif (action.type === 'INCREASE_COUNTER') {\nreturn { value: state.value + 1 };\n}\nreturn state;\n}\n},\nepics: {\nlogCounterValue: (action$, store) =&gt; action$.ofType('INCREASE_COUNTER').switchMap(() =&gt; {\n/* eslint-disable */\nconsole.log('CURRENT VALUE: ' + store.getState().sampleExtension.value);\n/* eslint-enable */\nreturn Rx.Observable.empty();\n})\n},\ncontainers: {\nToolbar: {\nname: \"SampleExtension\",\nposition: 10,\ntext: \"INC\",\ndoNotHide: true,\naction: () =&gt; {\nreturn {\ntype: 'INCREASE_COUNTER'\n};\n},\npriority: 1\n}\n}\n};\n</code></pre> <p>As you can see from the code, the most important difference is that you need to export the plugin descriptor WITHOUT invoking <code>createPlugin</code> on it (this is done in <code>extensions.js</code> in dev environment and when installed it will be done by the extensions load system). The extension definition will import or define all the needed dependencies (components, reducers, epics) as well as the plugin configuration elements (e.g. containers).</p>"},{"location":"developer-guide/extensions/#dynamic-import-of-extension","title":"Dynamic import of extension","text":"<p>MapStore supports dynamic import of plugins and extensions.</p> <p>Dynamically imported plugins or extensions uses lazy-loading: components, reducers and epics will be loaded once plugin or extension is in the list of plugins configured for the current page (eg. via <code>localConfig.json</code> or plugins selected to be included in a context).</p> <p>Note</p> <p>Application context could have plugins configured to be loaded optionally using the Extensions Library. Such plugins will be loaded only after being directly activated by the user in the extensions library UI.</p> <p>Regardless if extension uses lazy-loading or not, its epics will be muted once extension is not rendered on the page. For more details see Epic state.</p> <p>There are few changes required to make extension loaded dynamically:</p> <ol> <li>Create <code>Module.jsx</code> file in <code>js/extension/plugins/</code> and populate it with <code>js/extension/plugins/Extension.jsx</code> content.</li> <li> <p>Update content of <code>js/extension/plugins/Extension.jsx</code> to be like:</p> <pre><code>import {toModulePlugin} from \"@mapstore/utils/ModulePluginsUtils\";\nimport { name } from '../../../config';\n\nexport default toModulePlugin(name, () =&gt; import(/* webpackChunkName: 'extensionName' */ './Module'));\n</code></pre> </li> <li> <p>Update <code>js/extensions.js</code> and remove <code>createPlugin</code> wrapper from <code>Extension</code> export. File content should look like:</p> <pre><code>import Extension from './extension/plugins/Extension';\nimport { name } from '../config';\n\n\nexport default {\n[name]: Extension\n};\n</code></pre> </li> </ol>"},{"location":"developer-guide/extensions/#distributing-your-extension-as-an-uploadable-module","title":"Distributing your extension as an uploadable module","text":"<p>The sample project allow you to create the final zip file for you.</p> <p>The final zip file must have this form:</p> <ul> <li>the file named <code>index.js</code> is the main entry point, for the module.</li> <li>an <code>index.json</code> file that describes the extension, an example follows</li> <li><code>assets</code> folder, that contains additional bundles (js, css) came out from the bundle compilation. All additional files (js chunks, css ...) must stay in this folder.</li> <li>optionally, a <code>translations</code> folder with localized message files used by the extension (in one or more languages of your choice)</li> </ul> <pre><code>my-extension.zip\n|\u2500\u2500 index.js\n\u251c\u2500\u2500 index.json\n\u251c\u2500\u2500 assets\n    \u251c\u2500\u2500 css\n        \u2514\u2500\u2500 123.abcd.css\n        \u2514\u2500\u2500 ...\n    \u2514\u2500\u2500 js\n        \u2514\u2500\u2500 456.abcd.js\n        \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 translations\n    \u2514\u2500\u2500 data.en_EN.json\n    \u2514\u2500\u2500 ...\n</code></pre>"},{"location":"developer-guide/extensions/#indexjson","title":"index.json","text":"<p>The `index.json file should contain all the information about the extension:</p> <ul> <li>An <code>id</code> that identifies the extension</li> <li> <p>A <code>version</code> to show in UI. Semantic versioning is suggested.+</p> </li> <li> <p><code>title</code> and <code>description</code> to display in UI, mnemonic hints for the administrator</p> </li> <li><code>plugins</code> the list of plugins that it adds to the application, with all the data useful for the context manager. Format of the JSON object for plugins is suggested here</li> </ul> <pre><code>{\n\"id\": \"a_unique_extension_identifier\",\n\"version\": \"1.0.0\",\n\"title\": \"the title of the description\",\n\"description\": \"a description of the extension\",\n\"plugins\": [{\n\"name\": \"MYPlugin\",\n\"title\": \"extensions.a_unique_extension_identifier.title\",\n\"description\": \"\",\n\"defaultConfig\": {},\n\"...\": \"...\"\n}]\n}\n</code></pre> <p><code>plugins</code> section contains the plugins defined in the extension, and it is needed to be configured in the context-editor. See Context Editor Configuration</p>"},{"location":"developer-guide/extensions/#installing-extensions","title":"Installing Extensions","text":"<p>Extensions can be uploaded using the context creator UI of MapStore. The storage and configuration of the uploaded zip bundle is managed by a dedicated MapStore backend service, the Upload Service. The Upload Service is responsible for unzipping the bundle, storing javascript and the other extension assets in the extensions folder and updating the configuration files needed by MapStore to use the extension:</p> <ul> <li><code>extensions.json</code> (the extensions registry)</li> <li><code>pluginsConfig.json.patch</code> (the context creator plugins catalog patch file)</li> </ul>"},{"location":"developer-guide/extensions/#updating-extensions","title":"Updating Extensions","text":"<p>Please refer to the How to update extensions section of user guide to get more information about extensions update workflow.</p>"},{"location":"developer-guide/extensions/#extensions-and-datadir","title":"Extensions and datadir","text":"<p>Extensions work better if you use a datadir, because when a datadir is configured, extensions are uploaded inside it, so they can live outside the application main folder (and you don't risk to overwrite them when you upgrade MapStore to a newer version).</p>"},{"location":"developer-guide/extensions/#extensions-for-dependent-projects","title":"Extensions for dependent projects","text":"<p>Extensions build in MapStore actually can run only in MapStore product. They can not be installed in dependent projects. If you have a custom project, and you want to add support for extensions, you will have to create your build system for extensions dedicated to your application, to build the Javascript with the correct paths. Moreover, to enable extensions to work with the datadir in a dependent project (MapStore product is already configured to use it) you need to configure (or customize) the following configuration properties in your <code>app.jsx</code>:</p>"},{"location":"developer-guide/extensions/#externalize-the-extensions-configuration","title":"Externalize the extensions configuration","text":"<p>Change <code>app.jsx</code> to include the following statement:</p> <pre><code>ConfigUtils.setConfigProp(\"extensionsRegistry\", \"rest/config/load/extensions.json\");\n</code></pre>"},{"location":"developer-guide/extensions/#externalize-the-context-plugins-configuration","title":"Externalize the context plugins configuration","text":"<p>Change <code>app.jsx</code> to include the following statement:</p> <pre><code>ConfigUtils.setConfigProp(\"contextPluginsConfiguration\", \"rest/config/load/pluginsConfig.json\");\n</code></pre>"},{"location":"developer-guide/extensions/#externalize-the-extensions-assets-folder","title":"Externalize the extensions assets folder","text":"<p>Change <code>app.jsx</code> to include the following statement:</p> <pre><code>ConfigUtils.setConfigProp(\"extensionsFolder\", \"rest/config/loadasset\");\n</code></pre> <p>Assets are loaded using a different service, <code>/rest/config/loadasset</code>.</p>"},{"location":"developer-guide/extensions/#managing-drawing-interactions-conflict-in-extension","title":"Managing drawing interactions conflict in extension","text":"<p>Extension could implement drawing interactions, and it's necessary to prevent a situation when multiple tools from different plugins or extensions have active drawing, otherwise it could end up in an unpredicted or buggy behavior.</p> <p>There are two ways how drawing interaction can be implemented in plugin or extension:</p> <ul> <li> <p>Using DrawSupport (e.g. Annotations plugin)</p> </li> <li> <p>By intercepting click on the map interactions (e.g. Measure plugin)</p> </li> </ul>"},{"location":"developer-guide/extensions/#making-another-plugins-aware-of-your-extension-starts-drawing","title":"Making another plugins aware of your extension starts drawing","text":"<p>If your extension using DrawSupport - you're on the safe side. Extension will dispatch <code>CHANGE_DRAWING_STATUS</code> action. This action can be traced by another plugins or extensions, and they can control their tools accordingly.</p> <p>If your extension is using <code>CLICK_ON_MAP</code> action and intercepts it perform any manipulations on click - you need to make sure that your extension also dispatch <code>REGISTER_EVENT_LISTENER</code> action (see <code>Measure</code> plugin as an example) when your extension activates drawing.</p> <p>It should also dispatch <code>UNREGISTER_EVENT_LISTENER</code> once drawing interaction stops.</p>"},{"location":"developer-guide/extensions/#making-your-extension-aware-of-another-plugin-drawing","title":"Making your extension aware of another plugin drawing","text":"<p>There is a helper utility named <code>shutdownToolOnAnotherToolDrawing</code>. This is a wrapper for a common approach to dispatch actions that will toggle off drawing interactions of your extension whenever another plugin or extension starts drawing.</p> <p>extensionEpics.js:</p> <pre><code>export const toggleToolOffOnDrawToolActive = (action$, store) =&gt; shutdownToolOnAnotherToolDrawing(action$, store, 'yourToolName');\n</code></pre> <p>with this code located in extension's epics your tool <code>yourToolName</code> will be closed whenever:</p> <ul> <li>feature editor is open</li> <li>another plugin or extension starts drawing.</li> </ul> <p>\"shutdownToolOnAnotherToolDrawing\" supports passing custom callback to determine whether your tool is active (to prevent garbage action dispatching if it's already off) and custom callback to list actions to be dispatched.</p>"},{"location":"developer-guide/extensions/#using-responsivecontainer-for-dock-panels","title":"Using \"ResponsiveContainer\" for dock panels","text":"<p>Starting with MapStore v2022.02.00, layout improvements have been introduced which, in addition to other changes, introduce a new sidebar menu to be used instead of the burger menu.</p> <p>All extensions using <code>DockPanel</code> or <code>DockablePanel</code> components have to be updated if their dock panel is rendered on the right side of the screen, next to the new sidebar menu.</p> <p>Following changes should be applied (<code>MapTemplates</code> plugin can be a reference for the changes needs to be applied):</p> <ol> <li> <p>Make your extension aware of the map layout changes by getting corresponding state value using following selector:</p> <pre><code>createSelector(\n...\nstate =&gt; mapLayoutValuesSelector(state, { height: true, right: true }, true),\n...\n(dockStyle) =&gt; ({\ndockStyle\n})\n)\n</code></pre> <p>It will get offset from the right and the bottom that needs to be applied to the <code>ResponsiveContainer</code></p> </li> <li> <p>Replace <code>DockPanel</code>, <code>DockablePanel</code>, <code>ContainerDimensions</code> (if used) with the <code>ResponsiveContainer</code> and make sure that dock content is a child of <code>ResponsiveContainer</code>:</p> <p>was:</p> <pre><code>return (\n&lt;DockPanel\nopen={props.active}\nposition=\"right\"\nsize={props.size}\nbsStyle=\"primary\"\ntitle={&lt;Message msgId=\"mapTemplates.title\"/&gt;}\nstyle={{ height: 'calc(100% - 30px)' }}\nonClose={props.onToggleControl}&gt;\n{!props.templatesLoaded &amp;&amp; &lt;div className=\"map-templates-loader\"&gt;&lt;Loader size={352}/&gt;&lt;/div&gt;}\n{props.templatesLoaded &amp;&amp; &lt;MapTemplatesPanel\ntemplates={props.templates}\nonMergeTemplate={props.onMergeTemplate}\nonReplaceTemplate={props.onReplaceTemplate}\nonToggleFavourite={props.onToggleFavourite}/&gt;}\n&lt;/DockPanel&gt;\n)\n</code></pre> <p>become:</p> <pre><code>return (\n&lt;ResponsivePanel\ncontainerStyle={props.dockStyle}\nstyle={props.dockStyle}\ncontainerId=\"map-templates-container\"\ncontainerClassName=\"dock-container\"\nclassName=\"map-templates-dock-panel\"\nopen={props.active}\nposition=\"right\"\nsize={props.size}\nbsStyle=\"primary\"\ntitle={&lt;Message msgId=\"mapTemplates.title\"/&gt;}\nonClose={props.onToggleControl}\n&gt;\n{!props.templatesLoaded &amp;&amp; &lt;div className=\"map-templates-loader\"&gt;&lt;Loader size={352}/&gt;&lt;/div&gt;}\n{props.templatesLoaded &amp;&amp; &lt;MapTemplatesPanel\ntemplates={props.templates}\nonMergeTemplate={props.onMergeTemplate}\nonReplaceTemplate={props.onReplaceTemplate}\nonToggleFavourite={props.onToggleFavourite}/&gt;}\n&lt;/ResponsivePanel&gt;\n);\n</code></pre> <p>With the applied changes dock will be rendered properly both for layout with <code>BurgerMenu</code> and <code>SidebarMenu</code>.</p> </li> </ol>"},{"location":"developer-guide/extensions/#making-other-dock-panels-closed-automatically-when-extension-panel-is-open","title":"Making other dock panels closed automatically when extension panel is open","text":"<p>All the dock panels open next to the sidebar should be mutually excluded. Active dock panel should be closed whenever another panel is open.</p> <p>Array at <code>state.maplayout.dockPanels.right</code> contains list of panels that can be extended or modified by extension by dispatching <code>updateDockPanelsList</code> action.</p> <p>Please note that adding dock into the list will automatically close previously active panel, so it's a good idea to dispatch the action on app initializing or when dock panel is open. Measurement plugin can be used as a reference of implementation, see <code>openMeasureEpic</code> &amp; <code>closeMeasureEpic</code> in <code>epics/measurement.js</code>.</p>"},{"location":"developer-guide/externalized-configuration/","title":"Externalized Configuration","text":"<p>The data directory is a directory on the file-system, configured for an instance of MapStore, that will be used to externalize configuration of MapStore.</p> <p>Configuring this directory you will be able to:</p> <ul> <li>Externalize database configuration</li> <li>Externalize proxy configuration</li> <li>Externalize JSON configs files for the application (<code>localConfig.json</code>, <code>new.json</code>)</li> <li>Apply patches to default JSON config files (e.g. to store only the differences)</li> <li>Store extensions installed</li> </ul> <p>All the configuration stored here will persist across MapSore updates.</p>"},{"location":"developer-guide/externalized-configuration/#using-a-data-directory","title":"Using a data directory","text":"<p>To use a data directory, this must be configured through a specific JVM system property: <code>datadir.location</code></p> <pre><code>java -Ddatadir.location=/etc/mapstore/datadir\n</code></pre> <p>The data-directory must exist, but all the files inside it are optional. Due to some particular operations (e.g. installation of extensions), some files may be stored in data-dir by the application itself.</p> <p>The structure of the data-dir is the following:</p> <pre><code>.\n\u251c\u2500\u2500 configs                  (JSON configs)\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 pluginsConfig.json.patch\n\u251c\u2500\u2500 extensions\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 extensions.json      (extensions index)\n|   \u2514\u2500\u2500 SampleExtension      (One directory for each extension installed)\n|       \u251c\u2500\u2500 index.js\n|       \u251c\u2500\u2500 assets\n|       \u2514\u2500\u2500 translations\n\u251c\u2500\u2500 geostore-datasource-ovr.properties (database configuration)\n\u251c\u2500\u2500 ldap.properties\n\u251c\u2500\u2500 mapstore-ovr.properties\n\u2514\u2500\u2500 mapstore.properties\n</code></pre> <ul> <li><code>configs</code>: files in this folder can override the files in <code>configs</code> file of the application (<code>pluginsConfig.json</code>, <code>localConfig.json</code>).</li> <li>If a file with the same name is present, it will be provided instead of the original one</li> <li>If a patch file is present,(e.g. <code>localConfig.json.patch</code>) the patch will be applied to the JSON (original or overridden) and provided patched to the client</li> <li><code>extensions</code>: this folder contains all the files for the installed extensions, one folder for each installed extension</li> <li><code>extensions.json</code>: the index of the current extensions installed.</li> </ul>"},{"location":"developer-guide/externalized-configuration/#multiple-data-directory-locations","title":"Multiple data directory locations","text":"<p>It is possible to specify more than one datadir location path, separated by commas. This can be useful if you need to have different places for static configuration and dynamic one. A dynamic configuration file is one that is updated by MapStore using the UI, while static ones can only updated manually by an administrator of the server. An example are uploaded extensions, and their configuration files.</p> <p>MapStore looks for configuration resources in these places in order:</p> <ul> <li>the first datadir.location path  other datadir.location paths, if any, in order</li> <li>the application root folder</li> </ul> <p>Dynamic files will always be written by the UI in the first location in the list, so the first path is for dynamic stuff.</p> <p>Example:</p> <pre><code>-Ddatadir.location=/etc/mapstore_extensions,/etc/mapstore_static_config\n</code></pre>"},{"location":"developer-guide/externalized-configuration/#logging","title":"Logging","text":"<p>Logging has not been externalized yet, You can manually do this change in <code>WEB-INF/web.xml</code> file to externalize also this file:</p> <pre><code>&lt;context-param&gt;\n&lt;param-name&gt;log4jConfigLocation&lt;/param-name&gt;\n&lt;param-value&gt;file:${datadir.location}/log4j2.properties&lt;/param-value&gt;\n&lt;/context-param&gt;\n</code></pre>"},{"location":"developer-guide/externalized-configuration/#print-configuration","title":"Print Configuration","text":"<p>The <code>config.yaml</code> is by default in the <code>printing</code> folder of the webapp root. You can externalize the path to this resource (and all relative files) by setting the system variable <code>mapfish-print-config</code>. Make you sure the file exists and all the required files (header, images ...) are also available (typically they are the same directory, identified by relative paths. For more information, see mapfish-print documentation ).</p> <p>Example:</p> <pre><code>-Dmapfish-print-config=/etc/mapstore/datadir/printing/config.yaml\n</code></pre> <p>We suggest to put your customizations for printing inside the data directory in a folder named <code>printing</code>, using the same structure of the <code>printing</code> folder of the application. (<code>config.yaml</code>, images and so on...). Doing it this way makes the application ready for future updates.</p>"},{"location":"developer-guide/externalized-configuration/#database-connection","title":"Database Connection","text":"<p>If you create a file in the datadir called <code>geostore-datasource-ovr.properties</code> , it will be used and override the current</p> <p>Example:</p> <pre><code>geostoreDataSource.driverClassName=org.postgresql.Driver\ngeostoreDataSource.url=jdbc:postgresql://localhost:5432/geostore\ngeostoreDataSource.username=geostore\ngeostoreDataSource.password=geostore\ngeostoreVendorAdapter.databasePlatform=org.hibernate.dialect.PostgreSQLDialect\ngeostoreEntityManagerFactory.jpaPropertyMap[hibernate.hbm2ddl.auto]=validate\ngeostoreEntityManagerFactory.jpaPropertyMap[hibernate.default_schema]=geostore\ngeostoreVendorAdapter.generateDdl=true\ngeostoreVendorAdapter.showSql=false\n</code></pre> <p>NOTE: this file simply overrides the values in <code>geostore-datasource-ovr.properties</code> in the web-application, it will not replace it usually it is configured by default to use h2 database, so configuring the database (h2, postgreSQL or oracle) will override all the properties. Anyway if you changed this file in your project, you may need to override more variables to make it work</p>"},{"location":"developer-guide/externalized-configuration/#overriding-front-end-configuration","title":"Overriding front-end configuration","text":"<p>Externalizing the whole <code>localConfig.json</code> file allows to keep your configurations during the various updates. Anyway keeping this long file in sync can become hard. You can use patch files, and this is the first suggested option.</p> <p>Anyway if you need to specify something in <code>localConfig.json</code> that comes from your Java application, MapStore gives you the possibility to override only some specific properties of this big file and keep these changes separated from the application, allowing an easier updates. This is particularly useful for example when you have to change only a bunch of settings on a specific instance, and use the standard configuration for everything else.</p> <p>You can override one or more properties in the file using the following JVM flags:</p> <ul> <li><code>overrides.config</code>: the path of a properties file (relative to the datadir) where override values are stored</li> <li><code>overrides.mappings</code>: comma limited list of JSONPath=property values to override</li> </ul> <p>An example of overrides that will replace the default WMS service url:</p> <p>In <code>mapstore.properties</code>:</p> <pre><code>overrides.config=env.properties\noverrides.mappings=initialState.defaultState.catalog.default.services.gs_stable_wms.url=geoserverUrl\n</code></pre> <p>In <code>datadir_path/env.properties</code>:</p> <pre><code>geoserverUrl=https://demo.geo-solutions.it/geoserver/wms\n</code></pre> <p>This allows to have in <code>datadir_path/env.properties</code> a set of variables that can be used in overrides (even in different places) that are indicated by <code>overrides.mappings</code>.</p> <p>Note: <code>env.properties</code> should not be placed in classpath folder</p>"},{"location":"developer-guide/externalized-configuration/#patching-front-end-configuration","title":"Patching front-end configuration","text":"<p>Another option is to patch the frontend configuration files, instead of overriding them completely, using a patch file in json-patch format.</p> <p>To patch one of the allowed resources you can put a file with a .patch extension in the datadir folder (e.g. localConfig.json.patch) and that file will be merged with the main localConfig.json to produce the final resource.</p> <p>This allows easier migration to a new MapStore version. Please notice that when you use a patch file, any new configuration from the newer version will be applied automatically. This can be good or bad: the good part is that new plugins and features will be available without further configuration after the migration, the bad part is that you won't be aware that new plugins and features will be automatically exposed to the final user.</p> <p>Example: adding a plugin to the localConfig.json configuration file:</p> <pre><code>[{\"op\": \"add\", \"path\": \"/plugins/desktop/-\", \"value\": \"MyAwesomePlugin\"}]\n</code></pre>"},{"location":"developer-guide/externalized-configuration/#externalize-front-end-configurations","title":"Externalize front-end Configurations","text":"<p>From version 2021.02.xx, the externalization of the front-end files is automatic on the back-end, as well as you configure the data-directory. Anyway for your custom application you may want to customize the following paths to point your own services for configuration, extensions, and so on. The paths can be customized by adding the relative line in the <code>app.jsx</code> :</p> <ul> <li>Application (<code>localConfig.json</code>):</li> </ul> <pre><code>ConfigUtils.setLocalConfigurationFile(\"configs/localConfig.json\");\n</code></pre> <ul> <li>Static maps (<code>new.json</code> and <code>config.json</code>):</li> </ul> <pre><code>ConfigUtils.setConfigProp(\"configurationFolder\", \"configs/\");\n</code></pre> <ul> <li>Extensions configuration (<code>extensions.json</code>):</li> </ul> <pre><code>ConfigUtils.setConfigProp(\"extensionsRegistry\", \"extensions/extensions.json\");\n</code></pre> <ul> <li>Context Editor (<code>pluginsConfig.json</code>):</li> </ul> <pre><code>ConfigUtils.setConfigProp(\"contextPluginsConfiguration\", \"configs/pluginsConfig.json\");\n</code></pre> <ul> <li>Extensions folder ( folder where to get the extensions found in <code>extensions.json</code>):</li> </ul> <pre><code>ConfigUtils.setConfigProp(\"extensionsFolder\", \"extensions/\");\n</code></pre> <p>Note</p> <p>Because in this case we are modifying the <code>app.jsx</code> file, these changes can be applied only at build time in a custom project. Future improvements will allow to externalize these files also in the main product, without any need to rebuild the application.</p>"},{"location":"developer-guide/how-to-use-a-cdn/","title":"How to use a CDN","text":"<p>The LeafletDraw plugin and the MapStore theme are linked via rawgit.com but in production it should be used a proper CDN. Once you have a stable version:</p> <ul> <li>upload the LeafletDraw plugin and the MapStore theme on your CDN</li> <li>edit the index.html file to use your published resources.</li> </ul>"},{"location":"developer-guide/infrastructure-and-general-architecture/","title":"Infrastructure","text":"<p>MapStore leverages a full separation of concerns between the backend and the frontend.</p> <p>The frontend is a Javascript web application communicating with MapStore own web services using AJAX and external ones through an internal, configurable, proxy.</p> <p>The backend is a suite of web services, developed in Java and deployed into a J2EE container (e.g. Apache Tomcat).</p> <p></p>"},{"location":"developer-guide/infrastructure-and-general-architecture/#frontend","title":"Frontend","text":"<p>The frontend is based on the ReactJS library and the Redux architecture, which is a specific implementation of the Flux architecture.</p> <p></p> <p>It allows plugging different mapping libraries (with Leaflet and OpenLayers as our first implementation targets) abstracting libraries implementation details using ReactJS web components and actions based communication.</p> <p></p>"},{"location":"developer-guide/infrastructure-and-general-architecture/#backend","title":"Backend","text":"<p>Backend services include at least (but not only) these ones:</p> <ul> <li>Generic, configurable, HTTP-Proxy to avoid CORS issues when the frontend tries to communicate with external services, based on the GeoSolutions http-proxy project.</li> <li>Internal storage for non structured resources (json, XML, etc.) based  on the GeoSolutions GeoStore project.</li> <li>Configuration services, to allow full application(s) and services configurability</li> <li>Security with the ability to configure authentication using an internal or external service, and a flexible authorization policy for services and resources access.</li> </ul> <p></p>"},{"location":"developer-guide/internationalization/","title":"Internationalization","text":"<p>MapStore offers the support for internationalization (I18N). To provide this functionality MapStore uses react-intl. In this section you can find which configuration and JS files are involved in the I18N system.</p>"},{"location":"developer-guide/internationalization/#how-mapstore-chooses-the-current-language","title":"How MapStore chooses the current language","text":"<p>MapStore first checks the browser's language. If it is not supported, MapStore will be visible in english, if present, or the first language available. Anyway the locale can be forced using a flag locale=codeLang where codeLang can be one en,it,de... e.g.</p> <pre><code>localhost:8081/?locale=en#/\n</code></pre> <p>A user can change the selected language from UI. MapStore will load the proper files to update the page localized in the selected language.</p>"},{"location":"developer-guide/internationalization/#configuration-files","title":"Configuration files","text":"<p>To provide support to a specific language MapStore need to have the necessary setup in the LocaleUtils.js file (see below [section for details about to configure this file]). In addition you need the proper translations files.</p> <p>Let's imagine that the variable code is 'en', CODE is 'EN' standing for english. For each language you need to have messages file containing the localized strings, a flag image to identify the language and some html fragments (optional) for some specific plugins.</p> <ul> <li>Messages: located in <code>web\\client\\translations</code> folder. For each language there is a json file named data.code-CODE.json. e.g. <code>data.en-EN.json</code>.</li> <li>Flags: located in <code>web\\client\\components\\I18N\\images\\flags</code> folder. For each language flag image named code-CODE.png of 16px x 11px is required.</li> <li>Fragments: actually only for cookies policy ....  (required only if the Cookie plugin is present) located in <code>web\\client\\translations\\fragments\\cookie</code> folder and named cookieDetails-code-CODE.html. We recommend to add it for any language you want to support at least by copying the english version.</li> </ul>"},{"location":"developer-guide/internationalization/#how-to-configure-supported-languages-in-mapstore","title":"How to configure supported languages in MapStore","text":"<p>You can configure MapStore to provide to the user only a restricted list of selectable languages by setting \"initialState.defaultState.locales\" variable in <code>localConfig.json</code>. e.g :</p> <pre><code>\"defaultState\":\n{\n\"locales\": {\n\"supportedLocales\": {\n\"en\": {\n\"code\": \"en-US\",\n\"description\": \"English\"\n},\n\"it\": {\n\"code\": \"it-IT\",\n\"description\": \"Italiano\"\n}\n}\n}\n}\n</code></pre> <p>Setting locales in localConfig.json file is doable only for supported locales present in LocaleUtils.js. The default behavior is to use those already configured in \"supportedLocales\" object. You can customize the messages by editing the data.code-CODE.json files.</p> <p>The <code>locale</code> property determines the language to use for the application. If not specified, the language will be selected checking the browser's locale first. If the browser locale is not supported, MapStore will select the first language available in <code>supportedLocales</code>.</p> <p>Example of localConfig.json with the optional locale property.</p> <pre><code>{\n\"locale\": \"it-IT\", // locale code\n\n\"defaultState\": {\n\"locales\": {\n\"supportedLocales\": {\n\"en\": {\n\"code\": \"en-US\",\n\"description\": \"English\"\n},\n\"it\": {\n\"code\": \"it-IT\",\n\"description\": \"Italiano\"\n}\n}\n}\n}\n}\n</code></pre> <p>The property <code>locale</code> could be useful inside custom application where the locale is stored in other sources rather than using the browser language:</p> <pre><code>// example\nimport { getConfigProp } from '@mapstore/framework/utils/ConfigUtils';\nimport cookies from 'js-cookie';\n\n// ...\nconst locale = cookies.get('app_locale'); // locale code it-IT for example\nif (locale) {\nsetConfigProp('locale', locale);\n}\n// ...\n</code></pre>"},{"location":"developer-guide/internationalization/#how-to-add-a-new-language","title":"How to add a new language","text":"<p>Let's say we want to add the russian language. In order to add a new language to MapStore you need to follow these steps:</p> <ul> <li>Update the <code>localConfig.json</code> file in <code>web\\client</code> folder adding the new language entry:   Add the following in the <code>initialState.defaultState.locales</code> object</li> </ul> <pre><code>\"ru\": {\ncode: \"ru-RU\",\ndescription: \"P\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0439\"\n}\n</code></pre> <ul> <li>Update the LocaleUtils.js file in <code>web\\client\\utils</code>:   add a param in the ensureIntl() function like and the relative require i.e: <code>'intl/locale-data/jsonp/ru.js'</code></li> </ul> <pre><code>require('intl/locale-data/jsonp/ru.js');\n</code></pre> <ul> <li>update the addLocaleData() call with the new locale obj i.e.:</li> </ul> <pre><code>const ru = require('react-intl/locale-data/ru');\naddLocaleData([...en, ...it, ...fr, ...de, ...es, ...ru]);\n</code></pre> <ul> <li>add the flag image for the selected language inside <code>web\\client\\components\\I18N\\images\\flags</code> naming it <code>ru-RU.png</code></li> <li>add the new translations file inside <code>web\\client\\translations</code> naming it <code>data.ru-RU.json</code> (remember to change the locale property of this file into <code>ru-RU</code>)</li> <li>create a fragment related to the cookie module inside <code>web\\client\\translations\\fragments\\cookie</code> naming it <code>cookieDetails-ru-RU.html</code></li> </ul>"},{"location":"developer-guide/local-config/","title":"Application configuration","text":"<p>The application will load by default it will load the <code>localConfig.json</code> which is now stored in the configs\\ folder</p> <p>You can load a custom configuration by passing the <code>localConfig</code> argument in query string:</p> <pre><code>localhost:8081/?localConfig=myConfig#/viewer/openlayers/0\n</code></pre> <p>The localConfig file contains the main information about URLs to load and plugins to load in the various modes.</p> <p>This is the main structure:</p> <pre><code>{\n// URL of geoStore\n\"geoStoreUrl\": \"rest/geostore/\",\n// printURL the url of the print service, if any\n\"printUrl\": \"/geoserver-test/pdf/info.json\",\n// a string or an object for the proxy URL.\n\"proxyUrl\": {\n// When autoDetectCORS is not present or false, the application will use the proxy for all the requests except the ones in the useCORS array.\n// if autoDetectCORS=true, the application will try the CORS request first, than will try to use the proxy if the request fails.\n// note: this parameter is actually not supported by Cesium, that will always use the proxy or the CORS request when in useCORS array.\n\"autoDetectCORS\": false,\n// if it is an object, the url entry holds the url to the proxy\n\"url\": \"/MapStore2/proxy/?url=\",\n// useCORS array contains a list of services that support CORS and so do not need a proxy.\n// if autoDetectCORS is true, this array will be ignored (except for Cesium)\n\"useCORS\": [\"http://nominatim.openstreetmap.org\", \"https://nominatim.openstreetmap.org\"]\n},\n// JSON file where uploaded extensions are configured\n\"extensionsRegistry\": \"extensions.json\",\n// URL of the folder from where extensions bundles and other assets are loaded\n\"extensionsFolder\": \"\",\n// API keys for bing and mapquest services\n\"bingApiKey\",\n// force dates to be in this specified format. use moment js format pattern\n\"forceDateFormat\": \"YYYY-MM-DD\",\n// force time to be in this specified format. use moment js format pattern\n\"forceTimeFormat\": \"hh:mm A\",\n\"mapquestApiKey\",\n// list of actions types that are available to be launched dynamically from query param (#3817)\n\"initialActionsWhiteList\": [\"ZOOM_TO_EXTENT\", \"ADD_LAYER\", ...],\n// path to the translation files directory (if different from default)\n\"translationsPath\",\n// if true, every ajax and mapping request will be authenticated with the configurations if match a rule (default: true)\n\"useAuthenticationRules\": true\n// the authentication rules to match\n\"authenticationRules\": [\n{ // every rule has a `urlPattern` regex to match\n\"urlPattern\": \".*geostore.*\",\n// and a authentication `method` to use (basic, authkey, browserWithCredentials, header)\n\"method\": \"basic\"\n}, {\n\"urlPattern\": \"\\\\/geoserver.*\",\n\"method\": \"authkey\"\n}],\n// flag for postponing mapstore 2 load time after theme\n\"loadAfterTheme\": false,\n// if defined, WMS layer styles localization will be added\n\"localizedLayerStyles\": {\n// name of the ENV parameter variable that is needed for localization proposes\n\"name\": \"mapstore_language\"\n},\n// flag for abandon map edit confirm popup, by default is enabled\n\"unsavedMapChangesDialog\": false,\n// optional flag to set default coordinate format (decimal, aeronautical)\n\"defaultCoordinateFormat\": \"aeronautical\",\n// optionals misc settings\n\"miscSettings\": {\n// Use POST requests for each WMS length URL highter than this value.\n\"maxURLLength\": 5000,\n// Custom path to home page\n\"homePath\": '/home',\n// If true it enables interactive legend for GeoServer WMS layers\n\"experimentalInteractiveLegend\": true\n},\n// optional state initializer (it will override the one defined in appConfig.js)\n\"initialState\": {\n// default initial state for every mode (will override initialState imposed by plugins reducers)\n\"defaultState\": {\n...\n// if you want to customize the supported locales put here the languages you want and follow instruction linked below\n\"locales\": {\n\"supportedLocales\": {\n\"it\": {\n\"code\": \"it-IT\",\n\"description\": \"Italiano\"\n},\n\"en\": {\n\"code\": \"en-US\",\n\"description\": \"English\"\n}\n}\n}\n},\n// mobile override (defined properties will override default in mobile mode)\n\"mobile\": {\n...\n}\n},\n// allows to apply map options configuration to all the Map plugins instances defined in the plugins configuration.\n// The mapOptions in the plugin configuration have priority so they will overrides this global config\n\"defaultMapOptions\": {\n\"openlayers\": { ... },\n\"leaflet\": { ... },\n\"cesium\": { ... }\n},\n// allow to define the default visualization mode of the app and\n// which 2D or 3D map library should be used based on the device\n// the configuration below is the default one\n// note: this configuration does not support expressions\n\"mapType\": {\n// the default visualization mode of the app, it could be \"2D\" or \"3D\"\n\"defaultVisualizationMode\": \"2D\",\n// map library to use based on the visualization mode and device\n// structure -&gt; { visualizationModes: { [visualizationMode]: { [deviceType]: mapLibrary } } }\n\"visualizationModes\": {\n\"2D\": {\n\"desktop\": \"openlayers\",\n\"mobile\": \"leaflet\"\n},\n\"3D\": {\n\"desktop\": \"cesium\",\n\"mobile\": \"cesium\"\n}\n}\n},\n\"plugins\": {\n// plugins to load for the mobile mode\n\"mobile\": [...]\n// plugins to load for the desktop mode\n\"desktop\": [...]\n// plugins to load for the embedded mode\n\"embedded\": [...]\n// plugins to load for the myMode mode\n\"myMode\": [...]\n}\n}\n</code></pre> <p>If you are building your own app, you can choose to create your custom modes or force one of them by passing the <code>mode</code> parameter in the query string.</p> <p>For adding a new locale or configuring currently supported locales, go check this out.</p> <p>For configuring plugins, see the Configuring Plugins Section and the plugin reference page</p>"},{"location":"developer-guide/local-config/#explanation-of-some-config-properties","title":"Explanation of some config properties","text":"<ul> <li><code>loadAfterTheme</code>: is a flag that allows to load mapstore.js after the theme which can be versioned or not(default.css). default is false</li> <li><code>initialState</code>: is an object that will initialize the state with some default values and this WILL OVERRIDE the initialState imposed by plugins &amp; reducers.</li> <li><code>projectionDefs</code>: is an array of objects that contain definitions for Coordinate Reference Systems</li> <li><code>useAuthenticationRules</code>: if this flag is set to true, the <code>authenticationRules</code> will be used to authenticate every ajax and mapping request. If the flag is set to false, the <code>authenticationRules</code> will be ignored.</li> <li><code>authenticationRules</code>: is an array of objects that contain rules to match for authentication. Each rule has a <code>urlPattern</code> regex to match and a <code>method</code> to use (<code>basic</code>, <code>authkey</code>, <code>header</code>, <code>browserWithCredentials</code>). If the URL of a request matches the <code>urlPattern</code> of a rule, the <code>method</code> will be used to authenticate the request. The <code>method</code> can be:</li> <li><code>basic</code> will use the basic authentication method getting the credentials from the user that logged in (adding the header <code>Authorization</code> <code>Basic &lt;base64(username:password)&gt;</code> to the request). Note: this method is not implemented for image tile requests (e.g. layers) but only for ajax requests.</li> <li><code>authkey</code> will use the authkey method getting the credentials from the user that logged in. The token of the current MapStore session will be used as the authkey value, so this works only with the geoserver integration.</li> <li><code>bearer</code> will use the header <code>Authorization</code> <code>Bearer &lt;token&gt;</code> getting the credentials from the user that logged in. The token of the current MapStore session will be used as the bearer value, so this works only with the geoserver integration.</li> <li><code>header</code> will use the header method getting the credentials from the user that logged in. You can add an <code>headers</code> object containing the static headers to this rule to specify witch headers to use. e.g.</li> <li><code>browserWithCredentials</code> will add the <code>withCredentials</code> parameter to ajax requests, so the browser will send the cookies and the authentication headers to the server. This method is useful when you have a proxy that needs to authenticate the user. Note: this method is not implemented for image tile requests (e.g. layers) but only for ajax requests.</li> </ul> <p><code>json     {         \"urlPattern\": \".*geostore.*\",         \"method\": \"header\",         \"headers\": {             \"X-Auth-Token\": \"mytoken\"         }     }</code></p>"},{"location":"developer-guide/local-config/#initialstate-configuration","title":"initialState configuration","text":"<p>It can contain:</p> <ol> <li>a defaultState valid for every mode</li> <li>a piece of state for each mode (mobile, desktop, embedded)</li> </ol>"},{"location":"developer-guide/local-config/#catalog-tool-configuration","title":"Catalog Tool configuration","text":"<p>Inside defaultState you can set default catalog services adding the following key</p> <pre><code>\"catalog\": {\n\"default\": {\n\"newService\": {\n\"url\": \"\",\n\"type\": \"wms\",\n\"title\": \"\",\n\"isNew\": true,\n\"editable\": true,\n\"autoload\": false\n},\n\"selectedService\": \"Demo CSW Service\",\n\"services\": {\n\"Demo CSW Service\": {\n\"url\": \"https://demo.geo-solutions.it/geoserver/csw\",\n\"type\": \"csw\",\n\"title\": \"A title for Demo CSW Service\",\n\"autoload\": true\n},\n\"Demo WMS Service\": {\n\"url\": \"https://demo.geo-solutions.it/geoserver/wms\",\n\"layerOptions\": {\n\"tileSize\": 512\n},\n\"format\": \"image/png8\"\n\"type\": \"wms\",\n\"title\": \"A title for Demo WMS Service\",\n\"autoload\": false\n},\n\"Demo WMTS Service\": {\n\"url\": \"https://demo.geo-solutions.it/geoserver/gwc/service/wmts\",\n\"type\": \"wmts\",\n\"title\": \"A title for Demo WMTS Service\",\n\"autoload\": false\n}\n}\n}\n}\n</code></pre> <p>Set <code>selectedService</code> value to one of the ID of the services object (\"Demo CSW Service\" for example). This will become the default service opened and used in the catalog panel. For each service set the key of the service as the ID.</p> <pre><code>\"ID_CATALOG_SERVICE\": {\n\"url\": \"the url pointing to the catalog web service\",\n\"type\": \"the type of webservice used. (this need to be consistent with the web service pointed by the url)\",\n\"title\": \"the label used for recognizing the catalog service\",\n\"autoload\": \"if true, when selected or when catalog panel is opened it will trigger an automatic search of the layers. if false, search must be manually performed.\"\n\"readOnly\": \"if true, makes the service not editable from catalog plugin\"\n\"titleMsgId\": \"optional, string used to localize the title of the service, the string must be present in translations\",\n\"format\": \"image/png8\" // the image format to use by default for layers coming from this catalog (or tiles).\n\"layerOptions\": { // optional\n\"format\": \"image/png8\", // image format needs to be configured also inside layerOptions\n\"serverType\": \"geoserver or no-vendor, depending on this some geoserver vendor extensions will be used for WMS requests.\",\n\"tileSize\": 512 // determine the default tile size for the catalog, valid for WMS and CSW catalogs\n},\n\"filter\": { // applicable only for CSW service\n\"staticFilter\": \"filter is always applied, even when search text is NOT PRESENT\",\n\"dynamicFilter\": \"filter is used when search text is PRESENT and is applied in `AND` with staticFilter. The template is used with ${searchText} placeholder to append search string\"\n},\n\"fetchMetadata\": true, // \"if true, the metadata is fetched for the service, applicable only for COG service\n\"records\": [{ // array of the COG layers of the service, applicable only for COG service\n\"sourceMetadata\": \"metadata of the COG layer\",\n\"bbox\": \"bbox formulated for the COG layer\",\n\"url\": \"the url pointing to the COG layer data\"\n}]\n}\n</code></pre> <p>CSW service  <code>filter</code> - For both static and dynamic filter, input only xml element contained within  (i.e. Do not enclose the filter value in ) Example: <pre><code>{\n\"filter\": { // Default filter values\n\"staticFilter\": \"&lt;ogc:Or&gt;&lt;ogc:PropertyIsEqualTo&gt;&lt;ogc:PropertyName&gt;dc:type&lt;/ogc:PropertyName&gt;&lt;ogc:Literal&gt;dataset&lt;/ogc:Literal&gt;&lt;/ogc:PropertyIsEqualTo&gt;&lt;ogc:PropertyIsEqualTo&gt;&lt;ogc:PropertyName&gt;dc:type&lt;/ogc:PropertyName&gt;&lt;ogc:Literal&gt;http://purl.org/dc/dcmitype/Dataset&lt;/ogc:Literal&gt;&lt;/ogc:PropertyIsEqualTo&gt;&lt;/ogc:Or&gt;\",\n\"dynamicFilter\": \"&lt;ogc:PropertyIsLike wildCard='%' singleChar='_' escapeChar='\\\\'&gt;&lt;ogc:PropertyName&gt;csw:AnyText&lt;/ogc:PropertyName&gt;&lt;ogc:Literal&gt;%${searchText}%&lt;/ogc:Literal&gt;&lt;/ogc:PropertyIsLike&gt;\"\n}\n}\n</code></pre> <p>COG service  <code>fetchMetadata</code> - By default, the metadata is fetched on saving the COG service for each layer (url) configured <code>records</code> -  Records of the COG layer  Example:</p> <pre><code>{\n\"fetchMetadata\": true,\n\"records\": [{\n\"url\": \"https://example.tif\",\n\"sourceMetadata\": {\n\"crs\": \"EPSG:32632\",\n\"extent\": [463560, 5758030, 469410, 5767210],\n\"height\": 900,\n\"width\": 500,\n\"tileWidth\": 256,\n\"tileHeight\": 256,\n\"origin\": [463560, 5767210, 0],\n\"resolution\": [10, -10, 0]\n},\n\"bbox\": {\n\"crs\": \"EPSG:32632\"\n\"bounds\": {minx: 463560, miny: 5758030, maxx: 469410, maxy: 5767210}\n}\n}]\n}\n</code></pre> <p>Be careful to use unique IDs Future implementations will try to detect the type from the url. newService is used internally as the starting object for an empty service.</p> <p></p>"},{"location":"developer-guide/local-config/#projectiondefs-configuration","title":"projectionDefs configuration","text":"<p>Custom CRS can be configured here, at root level of localConfig.json file. For example:</p> <pre><code>\"projectionDefs\": [{\n\"code\": \"EPSG:3003\",\n\"def\": \"+proj=tmerc +lat_0=0 +lon_0=9 +k=0.9996 +x_0=1500000 +y_0=0 +ellps=intl+towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68 +units=m +no_defs\",\n\"extent\": [1241482.0019, 973563.1609, 1830078.9331, 5215189.0853],\n\"worldExtent\": [6.6500, 8.8000, 12.0000, 47.0500]\n}]\n</code></pre> <p>Explanation of these properties:</p> <ul> <li>code - a code string that will identify the added projection</li> <li>def - projection definition in PROJ.4 format</li> <li>extent - projected bounds of the projection</li> <li>worldExtent - bounds of the projection in WGS84</li> </ul> <p>These parameters for a projection of interest can be found on epsg.io</p>"},{"location":"developer-guide/local-config/#crs-selector-configuration","title":"CRS Selector configuration","text":"<p>CRS Selector is a plugin, that is configured in the plugins section. It should look like this:</p> <pre><code>\"plugins\": {\n...\n\"desktop\": [\n...}, {\n\"name\": \"CRSSelector\",\n\"cfg\": {\n\"additionalCRS\": {\n\"EPSG:3003\": {\nlabel: \"Monte Mario\"\n}\n},\n\"filterAllowedCRS\": [\n\"EPSG:4326\",\n\"EPSG:3857\"\n],\n\"allowedRoles\": [\n\"ADMIN\"\n]\n}\n}, {\n]\n}\n</code></pre> <p>Configuration parameters are to be placed in the \"cfg\" object. These parameters are:</p> <ul> <li>additionalCRS - object, that contains additional Coordinate Reference Systems. This configuration parameter lets you specify which projections, defined in projectionDefs, should be displayed in the CRS Selector, alongside default projections. Every additional CRS is a property of additionalCRS object. The name of that property is a code of a corresponding projection definition in projectionDefs. The value of that property is an object with the following properties:</li> <li>label - a string, that will be displayed in the CRS Selector as a name of the projection</li> <li>filterAllowedCRS - which default projections are to be available in the selector. Default projections are:</li> <li>EPSG:3857</li> <li>EPSG:4326</li> <li>allowedRoles - CRS Selector will be accessible only to these roles. By default, CRS Selector will be available for any logged in user.</li> </ul>"},{"location":"developer-guide/local-config/#search-plugin-configuration","title":"Search plugin configuration","text":"<p>The search plugin provides several configurations to customize the services behind the search bar in the map:</p> <ul> <li>Allow to configure more many services to use in parallel, in the <code>services</code> array.</li> <li>Natively supports nominatim and WFS protcols</li> <li>Allows to register your own custom services to develop and use in your custom project</li> <li>Allows to configure services in cascade, typically when you have a hierarchical data structures ( e.g. search for municipality, then for street name, than for house number, or search state,then region, then specific feature, and so on...)</li> </ul> <p>Following you can find some examples of the various configurations. For more details about the properties, please check to plugin API documentation: https://mapstore.geosolutionsgroup.com/mapstore/docs/api/plugins#plugins.Search</p> <p>Nominatim configuration:</p> <pre><code>{\n\"type\": \"nominatim\",\n\"searchTextTemplate\": \"${properties.display_name}\", // text to use as searchText when an item is selected. Gets the result properties.\n\"options\": {\n\"polygon_geojson\": 1,\n\"limit\": 3\n}\n</code></pre> <p>WFS configuration:</p> <pre><code>\"plugins\": {\n...\n\"desktop\": [\n...}, {\n\"name\": \"Search\",\n\"cfg\": {\n\"showCoordinatesSearchOption\": false,\n\"maxResults\": 20,\n\"searchOptions\": {\n\"services\": [{\n\"type\": \"wfs\",\n\"priority\": 3,\n\"displayName\": \"${properties.propToDisplay}\",\n\"subTitle\": \" (a subtitle for the results coming from this service [ can contain expressions like ${properties.propForSubtitle}])\",\n\"options\": {\n\"url\": \"/geoserver/wfs\",\n\"typeName\": \"workspace:layer\",\n\"queriableAttributes\": [\"attribute_to_query\"],\n\"sortBy\": \"id\",\n\"srsName\": \"EPSG:4326\",\n\"maxFeatures\": 20,\n\"blacklist\": [\"... an array of strings to exclude from the final search filter \"]\n}\n]\n}\n}\n}, {\n]\n}\n</code></pre> <p>WFS configuration with nested services:</p> <pre><code>\"plugins\": {\n...\n\"desktop\": [\n...}, {\n\"name\": \"Search\",\n\"cfg\": {\n\"showCoordinatesSearchOption\": false,\n\"maxResults\": 20,\n\"searchOptions\": {\n\"services\": [{\n\"type\": \"wfs\",\n\"priority\": 3,\n\"displayName\": \"${properties.propToDisplay}\",\n\"subTitle\": \" (a subtitle for the results coming from this service [ can contain expressions like ${properties.propForSubtitle}])\",\n\"options\": {\n\"url\": \"/geoserver/wfs\",\n\"typeName\": \"workspace:layer\",\n\"queriableAttributes\": [\"attribute_to_query\"],\n\"sortBy\": \"id\",\n\"srsName\": \"EPSG:4326\",\n\"maxFeatures\": 20,\n\"blacklist\": [\"... an array of strings to exclude from the final search filter \"]\n},\n\n\"nestedPlaceholder\": \"the placeholder will be displayed in the input text, after you have performed the first search\",\n\"then\": [{\n\"type\": \"wfs\",\n\"priority\": 1,\n\"displayName\": \"${properties.propToDisplay} ${properties.propToDisplay}\",\n\"subTitle\": \" (a subtitle for the results coming from this service [ can contain expressions like ${properties.propForSubtitle}])\",\n\"searchTextTemplate\": \"${properties.propToDisplay}\",\n\"options\": {\n\"staticFilter\": \" AND SOMEPROP = '${properties.OLDPROP}'\", // will be appended to the original filter, it gets the properties of the current selected item (of the parent service)\n\"url\": \"/geoserver/wfs\",\n\"typeName\": \"workspace:layer\",\n\"queriableAttributes\": [\"attribute_to_query\"],\n\"srsName\": \"EPSG:4326\",\n\"maxFeatures\": 10\n}\n}]\n}\n\n]\n}\n}\n}, {\n]\n}\n</code></pre> <p>Custom services configuration:</p> <pre><code>{\n\"type\": \"custom Service Name\",\n\"searchTextTemplate\": \"${properties.propToDisplay}\",\n\"displayName\": \"${properties.propToDisplay}\",\n\"subTitle\": \" (a subtitle for the results coming from this service [ can contain expressions like ${properties.propForSubtitle}])\",\n\"options\": {\n\"pathname\": \"/path/to/service\",\n\"idVia\": \"${properties.code}\"\n},\n\"priority\": 2,\n\"geomService\" : {\n\"type\": \"wfs\",\n\"options\": {\n\"url\": \"/geoserver/wfs\",\n\"typeName\":  \"workspace:layer\",\n\"srsName\": \"EPSG:4326\",\n\"staticFilter\": \"ID = ${properties.code}\"\n}\n}\n}\n</code></pre>"},{"location":"developer-guide/main-scripts/","title":"Main scripts","text":"<p>Here a summary of the main utility scripts to run and build MapStore.</p>"},{"location":"developer-guide/main-scripts/#npm-scripts","title":"npm scripts","text":"Command Description <code>npm install</code> download dependencies and init the front-end environment <code>npm start</code> start development instance (both front end and back-end) <code>npm run app:start</code> start development instance (both front end and back-end) <code>npm run fe:start</code> start front-end dev server <code>npm run be:start</code> start backend dev server (embedded in tomcat, with cargo) <code>npm run fe:build</code> build front-end <code>npm run be:build</code> build backend <code>npm test</code> run test suite once <code>npm run test:watch</code> run continuous test suite running (useful during developing) <code>npm run lint</code> run ESLint checks <code>npm run i18n</code> checks missing strings in mandatory i18n files (ref to en-US) <code>npm run jsdoc:build</code> build JSDoc <code>npm run jsdoc:test</code> build JSDoc in a directory available running npm start (for test) <code>npm run jsdoc:clean</code> clean JSDoc <code>npm run doc:build</code> build MkDocs documentation <code>npm run doc:start</code> start <code>mkdocs serve</code> to have a live preview while editing documentation <code>npm run generate:icons</code> generate icons from svg files <code>npm run generate:changelog</code> generate changelog for the MapStore release <p>Other scripts are present for backward compatibility, but they are deprecated and will be removed in the future.</p>"},{"location":"developer-guide/main-scripts/#bash-scripts","title":"bash scripts","text":"Command Description <code>./build.sh [version_identifier] [profiles]</code> build the deployable war (in <code>product/target</code>) <p>Where <code>version_identifier</code> is an optional identifier of the generated war that will be shown in the settings panel of the application and profiles is an optional list of comma delimited building profiles (e.g. <code>printing</code>, <code>ldap</code>).</p>"},{"location":"developer-guide/map-query-parameters/","title":"MapViewer query parameters","text":"<p>In this section we will describe the available MapViewer query parameters that can be used when the map is loaded.</p> <p>MapStore allows to manipulate the map by passing some parameters. This allows external application to open a customized viewer generating these parameters externally. With this functionality you can modify for instance the initial position of the map, the entire map and even trigger some actions.</p>"},{"location":"developer-guide/map-query-parameters/#passing-parameters-to-the-map","title":"Passing parameters to the map","text":""},{"location":"developer-guide/map-query-parameters/#get-request","title":"Get Request","text":"<p>The parameters can be passed in a query-string-like section, after the <code>#&lt;path&gt;?</code> of the request.</p> <p>Example:</p> <pre><code>#/viewer/new?center=0,0&amp;zoom=5\n</code></pre> <p>Note</p> <p>The parameters in the request should be URL encoded. In order to make them more readable, the examples in this page will now apply the URL encoding.</p>"},{"location":"developer-guide/map-query-parameters/#post-request","title":"POST Request","text":"<p>Sometimes the request parameters can be too big to be passed in the URL, for instance when dealing with an entire map, or complex data. To overcome this kind of situations, an adhoc <code>POST</code> service available at <code>&lt;mapstore-base-path&gt;/rest/config/setParams</code> allows to pass the parameters in the request payload <code>application/x-www-form-urlencoded</code>. The parameters will be then passed to the client (using a temporary <code>queryParams-{random-UUID}</code> variable in <code>sessionStorage</code>). Near the parameters, an additional <code>page</code> value can be passed together with the params to specify to which url be redirect. If no page attribute is specified by default redirection happens to <code>#/viewer/config</code>. The UUID used in the <code>queryParams-{random-UUID}</code> variable name is being added to the redirect URL in a query parameter named <code>queryParamsID=</code>. Assuming to use the default redirect value, the url will then look like the following: <code>#/viewer/config?queryParamsID={random-UUID}</code>.</p> <p>Example <code>application/x-www-form-urlencoded</code> request payload (URL encoded):</p> <pre><code>page=..%2F..%2F%23%2Fviewer%2Fopenlayers%2Fnew&amp;featureinfo=&amp;bbox=&amp;center=1%2C1&amp;zoom=4\n</code></pre> <p>Here a sample page you can create to test the service:</p> <pre><code>&lt;html&gt;&lt;head&gt;&lt;meta charset=\"UTF-8\"&gt;\n    &lt;script&gt;\nconst POST_PATH = \"rest/config/setParams\";\nconst queryParameters = {\n\"page\": '../../#/viewer/config',\n\"map\": {\"version\":2,\"map\":{\"projection\":\"EPSG:900913\",\"units\":\"m\",\"center\":{\"x\":1250000,\"y\":5370000,\"crs\":\"EPSG:900913\"},\"zoom\":5,\"maxExtent\":[-20037508.34,-20037508.34,20037508.34,20037508.34],\"layers\":[{\"type\":\"osm\",\"title\":\"Open Street Map\",\"name\":\"mapnik\",\"source\":\"osm\",\"group\":\"background\",\"visibility\":true}]}},\n\"featureinfo\": '',\n\"bbox\": '',\n\"center\": '',\n\"zoom\": 4,\n\"actions\": [],\n};\nlet i = 0;\nfunction createIframe() {\ni++;\nconst iframe = document.createElement('iframe');\niframe.name = `_iframe-${i}`;\niframe.id = `_iframe-${i}`;\niframe.style.width = \"100%\";\niframe.style.height = \"400px\";\ndocument.body.appendChild(iframe);\nreturn iframe.name;\n}\nwindow.onload = function(){\nObject.keys(queryParameters).forEach(function (key) {\nconst element = document.getElementById(key);\nif (element) element.value = typeof queryParameters[key] === \"object\" || Array.isArray(queryParameters[key]) ? JSON.stringify(queryParameters[key]) : queryParameters[key];\n});\nconst form = document.getElementById(\"post-form\");\nform.addEventListener('submit', function() {\nconst base_url = document.getElementById('mapstore-base').value.replace(/\\/?$/, '/');\nconst method = document.getElementById(\"method\").value;\n// handle GET URL\nif(method === \"GET\") {\nevent.preventDefault();\nconst page = document.getElementById(\"page\")?.value;\nconst data = new FormData(event.target);\nconst values = Array.from(data.entries());\nconst queryString = values\n.filter(([k, v]) =&gt; !!v)\n.reduce((qs = \"\", [k, v]) =&gt; `${qs}&amp;${k}=${encodeURIComponent(v)}`, \"\");\nwindow.open(`${base_url}${page}?${queryString}`, \"_blank\");\nreturn false;\n} else if (method === \"GET_IFRAME\") {\nevent.preventDefault();\nconst page = document.getElementById(\"page\")?.value;\nconst data = new FormData(event.target);\nconst values = Array.from(data.entries());\nconst queryString = values\n.filter(([k, v]) =&gt; !!v)\n.reduce((qs = \"\", [k, v]) =&gt; `${qs}&amp;${k}=${encodeURIComponent(v)}`, \"\");\nconst iframeName = createIframe();\nconst iframe = document.getElementById(iframeName);\niframe.src = `${base_url}${page}?${queryString}`;\nreturn false;\n}\n// handle POST and POST_IFRAME\nif(method === \"POST_IFRAME\") {\nconst iframeName = createIframe();\nform.target = iframeName;\n} else if(method === \"POST\") {\nform.target = \"_blank\";\n}\nform.action = base_url + POST_PATH;\nreturn true;\n})\n}\n&lt;/script&gt;\n&lt;/head&gt;&lt;body&gt;\n    &lt;fieldset&gt;\n        &lt;legend&gt;Options:&lt;/legend&gt;\n        &lt;label&gt;method:&lt;/label&gt;&lt;select id=\"method\"&gt;\n            &lt;option value=\"POST\"&gt;POST&lt;/option&gt;\n            &lt;option value=\"GET\"&gt;GET&lt;/option&gt;\n            &lt;option value=\"GET_IFRAME\"&gt;GET_IFRAME&lt;/option&gt;\n            &lt;option value=\"POST_IFRAME\"&gt;POST_IFRAME&lt;/option&gt;\n        &lt;/select&gt;\n    &lt;br/&gt;\n    &lt;label&gt;MapStore Base URL:&lt;/label&gt;&lt;input type=\"text\" id=\"mapstore-base\" value=\"http://localhost:8080/mapstore/\"&gt;\n&lt;/input&gt;&lt;br/&gt;\n&lt;/fieldset&gt;\n&lt;!-- Place the URL of your MapStore in \"action\" --&gt;\n&lt;form id=\"post-form\" action=\"http://localhost:8080/mapstore/rest/config/setParams\" method=\"POST\" target=\"_blank\"&gt;\n    &lt;fieldset&gt;\n        &lt;legend&gt;Params:&lt;/legend&gt;\n        &lt;label for=\"map\"&gt;map:&lt;/label&gt;&lt;br/&gt;&lt;textarea id=\"map\" name=\"map\"&gt;&lt;/textarea&gt;&lt;br/&gt;\n        &lt;label for=\"page\"&gt;page:&lt;/label&gt;&lt;br/&gt;&lt;input type=\"text\" id=\"page\" name=\"page\" value=\"../../#/viewer/config\"&gt;&lt;/input&gt;&lt;br/&gt;\n        &lt;label for=\"featureinfo\"&gt;featureinfo:&lt;/label&gt;&lt;br/&gt;&lt;textarea id=\"featureinfo\" name=\"featureinfo\"&gt;&lt;/textarea&gt;&lt;br/&gt;\n        &lt;label for=\"bbox\"&gt;bbox:&lt;/label&gt;&lt;br/&gt;&lt;input type=\"text\" id=\"bbox\" name=\"bbox\"&gt;&lt;/input&gt;&lt;br/&gt;\n        &lt;label for=\"center\"&gt;center:&lt;/label&gt;&lt;br/&gt;&lt;input type=\"text\" id=\"center\" name=\"center\"&gt;&lt;/input&gt;&lt;br/&gt;\n        &lt;label for=\"zoom\"&gt;zoom:&lt;/label&gt;&lt;br/&gt;&lt;input type=\"text\" id=\"zoom\" name=\"zoom\"&gt;&lt;/input&gt;&lt;br/&gt;\n        &lt;label for=\"marker\"&gt;marker:&lt;/label&gt;&lt;br/&gt;&lt;input type=\"text\" id=\"marker\" name=\"marker\"&gt;&lt;/input&gt;&lt;br/&gt;\n        &lt;label for=\"actions\"&gt;actions:&lt;/label&gt;&lt;br/&gt;&lt;textarea id=\"actions\" name=\"actions\"&gt;&lt;/textarea&gt;&lt;br/&gt;\n    &lt;/fieldset&gt;\n    &lt;br/&gt;\n    &lt;input id=\"submit-form\" value=\"Submit\" type=\"submit\"&gt;&lt;br/&gt;\n&lt;/form&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>"},{"location":"developer-guide/map-query-parameters/#available-parameters","title":"Available Parameters","text":""},{"location":"developer-guide/map-query-parameters/#feature-info","title":"Feature Info","text":"<p>Allows to trigger identify tool for the coordinates passed in \"lat\"/\"lng\" parameters.</p> <p>Optional parameter \"filterNameList\" allows limiting request to the specific layer names. It will be effectively used only if it's passed as non-empty array of layer names. Omitting or passing an empty array will have the same effect.</p> <p>GET: <code>#/viewer/config?featureinfo={\"lat\": 43.077, \"lng\": 12.656, \"filterNameList\": []}</code></p> <p>GET: <code>#/viewer/config?featureinfo={\"lat\": 43.077, \"lng\": 12.656, \"filterNameList\": [\"layerName1\", \"layerName2\"]}</code></p>"},{"location":"developer-guide/map-query-parameters/#simplified-syntax","title":"Simplified syntax","text":"<p>GET: <code>#/viewer/config?featureInfo=38.72,-95.625</code></p> <p>Where lon,lat values are comma-separated respecting order.</p>"},{"location":"developer-guide/map-query-parameters/#map","title":"Map","text":"<p>Allows to pass the entire map JSON definition (see the map configuration format of MapStore).</p> <p>GET:</p> <pre><code>#/viewer/config?map={\"version\":2,\"map\":{\"projection\":\"EPSG:900913\",\"units\":\"m\",\"center\":{\"x\":1250000,\"y\":5370000,\"crs\":\"EPSG:900913\"},\"zoom\":5,\"maxExtent\":[-20037508.34,-20037508.34,20037508.34,20037508.34],\"layers\":[{\"type\":\"osm\",\"title\":\"Open Street Map\",\"name\":\"mapnik\",\"source\":\"osm\",\"group\":\"background\",\"visibility\":true}]}}\n</code></pre> <p>It also allows partial overriding of existing map configuration by passing only specific properties of the root object and/or the internal \"map\" object.</p> <p>Following example will override \"catalogServices\" and \"mapInfoConfiguration\":</p> <pre><code>#/viewer/config?map={\"mapInfoConfiguration\":{\"trigger\":\"click\",\"infoFormat\":\"text/html\"},\"catalogServices\":{\"services\": {\"wms\": {\"url\": \"http://example.com/geoserver/wms\",\"type\": \"wms\",\"title\": \"WMS\",\"autoload\": true}},\"selectedService\": \"wms\"}}\n</code></pre>"},{"location":"developer-guide/map-query-parameters/#center-zoom","title":"Center / Zoom","text":"<p>GET: <code>#/viewer/config?center=0,0&amp;zoom=5</code></p> <p>Where lon,lat values are comma-separated respecting order.</p>"},{"location":"developer-guide/map-query-parameters/#marker-zoom","title":"Marker / Zoom","text":"<p>GET: <code>#/viewer/config?marker=0,0&amp;zoom=5</code></p> <p>Where lon,lat values are comma-separated respecting order.</p>"},{"location":"developer-guide/map-query-parameters/#bbox","title":"Bbox","text":"<p>GET: <code>#/viewer/config?bbox=8,8,53,53</code></p> <p>Where values are <code>minLongitude, minLatitude, maxLongitude, maxLatitude</code> respecting order.</p>"},{"location":"developer-guide/map-query-parameters/#addlayers","title":"AddLayers","text":"<p>This is a shortened syntax for <code>CATALOG:ADD_LAYERS_FROM_CATALOGS</code> action described down below.</p> <p>GET: <code>#/viewer/config?addLayers=layer1;service,layer2&amp;layerFilters=attributeLayer1='value';attributeLayer2='value2'</code></p> <p><code>addLayers</code> parameter is a comma separated list of <code>&lt;layerName&gt;;&lt;service&gt;</code> (<code>service</code> is optional, and if present is separated from the layerName by a <code>;</code>.</p> <p>In the example above:</p> <ul> <li><code>layer1</code> and <code>layer2</code> are layer names;</li> <li><code>service</code> is the service identifier of the catalog. If no service is provided, the default service will be used.</li> <li><code>layerFilters</code> is a list of cql filters to apply to the corresponding layer in the same position of the <code>addLayers</code> parameter, separated by <code>;</code></li> </ul>"},{"location":"developer-guide/map-query-parameters/#mapinfo","title":"MapInfo","text":"<p>This is a shortened syntax for <code>SEARCH:SEARCH_WITH_FILTER</code> action described down below. In opposite to direct usage of action, <code>mapInfo</code> parameter can work with layers added by <code>addLayers</code> parameter. In this case search execution will be postponed up to the moment when layer is added to the map.</p> <p><code>mapInfo</code> handler will check if <code>addLayers</code> parameter is present and if it lists layer name used in <code>mapInfo</code> parameter. If so, it will postpone search to ensure that layer is added to the map. Otherwise, in case of no matches, search will execute immediately.</p> <p>GET: <code>#/viewer/new?addLayers=layer1;service&amp;mapinfo=layer1&amp;mapInfoFilter=BB='cc'</code></p> <p>Where:</p> <ul> <li><code>layer1</code> is layer name.</li> <li><code>service</code> is the service name providing layer data. Service name is optional. If no service is provided, the default service of the catalog will be used.</li> <li><code>mapInfoFilter</code> is a cql filter applied to the layer.</li> </ul>"},{"location":"developer-guide/map-query-parameters/#background","title":"Background","text":"<p>Allows to dynamically add background to the map and activate it. Supports default backgrounds provided by static service defined in <code>localConfig.json</code> (<code>default_map_backgrounds</code>) as well as other layers:</p> <p><code>#/viewer/new?background=Sentinel;default_map_backgrounds</code></p> <p><code>#/viewer/new?background=layer1;service</code></p> <p><code>#/viewer/new?background=layer2</code></p> <p>Where:</p> <ul> <li><code>Sentinel</code>, <code>layer1</code>, <code>layer2</code> are layer names,</li> <li><code>service</code>, <code>default_map_backgrounds</code> are the service names providing layer data. Service name is optional. If no service is provided, the default service of the catalog will be used.</li> </ul> <p>According to the implementation of <code>default_map_backgrounds</code> service, it is enough to pass desired layer name even partially, e.g. <code>background=Sen;default_map_backgrounds</code>, it will use the closest layer name match in this case.</p>"},{"location":"developer-guide/map-query-parameters/#actions","title":"Actions","text":"<p>To dispatch additional actions when the map viewer is started, the actions query parameter can be used. Only actions from a configured whitelist can be dispatched in this way (see the configuration section for more details).</p> <pre><code>// list of actions types that are available to be launched dynamically from query param (#3817)\n\"initialActionsWhiteList\": [\"ZOOM_TO_EXTENT\", \"ADD_LAYER\", ...]\n</code></pre> <p>The value of this parameter is a JSON string containing an array with an object per action. The structure of the object consist of a property type and a bunch of other properties depending on the action.</p>"},{"location":"developer-guide/map-query-parameters/#available-actions","title":"Available actions","text":"<p>Only the following actions can be used in the actions json string.</p>"},{"location":"developer-guide/map-query-parameters/#zoom-to-extent","title":"Zoom to extent","text":"<p>It zooms the map to the defined extent.</p> <p>Example:</p> <pre><code>{\n\"type\": \"ZOOM_TO_EXTENT\",\n\"extent\": [1,2,3,4],\n\"crs\": \"EPSG:4326\",\n\"maxZoom\": 8\n}\n</code></pre> <p>GET: <code>#/viewer/config?actions=[{\"type\": \"ZOOM_TO_EXTENT\",\"extent\": [1,2,3,4],\"crs\": \"EPSG:4326\",\"maxZoom\": 8}]</code></p> <p>For more details check out the zoomToExtent in the framework documentation.</p>"},{"location":"developer-guide/map-query-parameters/#map-info","title":"Map info","text":"<p>It performs a GetFeature request on the specified layer and then a GetFeatureInfo by taking a point from the retrieved features's geometry. This action can be used only for existing maps (map previously created).</p> <p>With the GetFeature request it takes the first coordinate of the geometry of the first retrieved feature; that coordinates are then used for an usual GFI (WMS GetFeatureInfo) request by limiting it to the specified layer.</p> <p>A cql_filter is also mandatory for that action to properly filter required data: that filter will be used in both request (GetFeature and GFI). If you don't need to apply a filter, you can use the standard INCLUDE clause (cql_filter=INCLUDE) so the whole dataset will be queried.</p> <p>Requirements:</p> <ul> <li>The layer specified must be visible in the map</li> <li>There must be a geometry that can be retrieved from the GetFeature request</li> </ul> <p>Example:</p> <pre><code>{\n\"type\": \"SEARCH:SEARCH_WITH_FILTER\",\n\"cql_filter\": \"ID=75\",\n\"layer\": \"WORKSPACE:LAYER_NAME\"\n}\n</code></pre> <p>GET: <code>#/viewer/config?actions=[{\"type\":\"SEARCH:SEARCH_WITH_FILTER\",\"cql_filter\":\"ID=75\",\"layer\":\"WORKSPACE:LAYER_NAME\"}]</code></p> <p>The sample request below illustrates how two actions can be concatenated:</p> <pre><code>https://dev-mapstore.geosolutionsgroup.com/mapstore/#/viewer/4093?actions=[{\"type\":\"SEARCH:SEARCH_WITH_FILTER\",\"cql_filter\":\"STATE_FIPS=34\",\"layer\":\"topp:states\"},{\"type\":\"ZOOM_TO_EXTENT\",\"extent\":[-77.48202256347649,38.74612266051003,-72.20858506347648,40.66664704515103],\"crs\":\"EPSG:4326\",\"maxZoom\":8}]\n</code></pre> <p>The MapStore invocation URL above executes the following operations:</p> <ul> <li>Execution of a search request filtering by STATE_FIPS with value 34 on the topp:states layer</li> <li>Execution of a map zoom to the provided extent</li> </ul> <p>For more details check out the searchLayerWithFilter in the framework documentation</p>"},{"location":"developer-guide/map-query-parameters/#scheduled-map-info","title":"Scheduled Map Info","text":"<p>It works similarly to the <code>Map Info</code> action, but supports delaying of the search execution up to the moment when layer is added to the map. This behavior is used when search should be applied to the dynamically added layer (e.g. using <code>addLayer</code> parameter) :</p> <p>Example:</p> <pre><code>{\n\"type\": \"SEARCH:SCHEDULE_SEARCH_WITH_FILTER\",\n\"cql_filter\": \"ID=75\",\n\"layer\": \"WORKSPACE:LAYER_NAME\"\n}\n</code></pre> <p>GET: <code>#/viewer/config?actions=[{\"type\":\"SEARCH:SCHEDULE_SEARCH_WITH_FILTER\",\"cql_filter\":\"ID=75\",\"layer\":\"WORKSPACE:LAYER_NAME\"},{\"type\":\"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\"layers\":[\"WORKSPACE:LAYER_NAME\"],\"sources\":[\"catalog1\"]}]</code></p>"},{"location":"developer-guide/map-query-parameters/#add-layers","title":"Add Layers","text":"<p>This action allows to add layers directly to the map by taking them from the catalogs configured, or passed.</p> <p>Requirements:</p> <ul> <li>The number of layers should match the number of sources</li> <li>The source name can be a string that must match a catalog service name present in the map or an object that defines an external catalog (see example)</li> </ul> <p>Supported layer types are WMS, WMTS, WFS, COG, 3D Tiles and GeoJSON.</p> <p>Example:</p> <pre><code>{\n\"type\": \"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\n\"layers\": [\"workspace1:layer1\", \"workspace2:layer2\", \"workspace:externallayername\"],\n\"sources\": [\"catalog1\", \"catalog2\", {\"type\":\"WMS\",\"url\":\"https://example.com/wms\"}]\n}\n</code></pre> <p>GET: <code>#/viewer/config?actions=[{\"type\":\"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\"layers\":[\"layer1\", \"layer2\", \"workspace:externallayername\"],\"sources\":[\"catalog1\", \"catalog2\", {\"type\":\"WMS\",\"url\":\"https://example.com/wms\"}]}]</code></p> <p>Data of resulting layer can be additionally filtered by passing \"CQL_FILTER\" into the options array. Each element of array corresponds to the layer defined in action:</p> <pre><code>{\n\"type\": \"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\n\"layers\": [\"workspace1:layer1\", \"workspace2:layer2\", \"workspace:externallayername\"],\n\"sources\": [\"catalog1\", \"catalog2\", {\"type\":\"WMS\",\"url\":\"https://example.com/wms\"}],\n\"options\": [{\"params\":{\"CQL_FILTER\":\"NAME='value'\"}}, {}, {\"params\":{\"CQL_FILTER\":\"NAME='value2'\"}}]\n}\n</code></pre> <p>GET <code>#/viewer/config?actions=[{\"type\":\"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\"layers\":[\"layer1\",\"layer2\",\"workspace:externallayername\"],\"sources\":[\"catalog1\",\"catalog2\",{\"type\":\"WMS\",\"url\":\"https://example.com/wms\"}],\"options\": [{\"params\":{\"CQL_FILTER\":\"NAME='value'\"}}, {}, {\"params\":{\"CQL_FILTER\":\"NAME='value2'\"}}]}]</code></p> <p>Number of objects passed to the options can be different to the number of layers, in this case options will be applied to the first X layers, where X is the length of options array.</p> <p>The COG service endpoint does not contain a default property for the name of the layer and it returns only a single record for this reason the name used in the layers array will be used to apply the title to the added COG layer:</p> <pre><code>{\n\"type\": \"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\n\"layers\": [\"My huge remote satellite COG\"],\n\"sources\": [{ \"type\":\"cog\", \"url\":\"https://example.com/satellite_imagery.tif\" }]\n}\n</code></pre> <p>GET: <code>#/viewer/config?actions=[{\"type\":\"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\"layers\":[\"My huge remote satellite COG\"],\"sources\":[{\"type\":\"cog\",\"url\":\"https://example.com/satellite_imagery.tif\"}]}]</code></p> <p>Note</p> <p>Depending on the internal structure optimization done on the remote COG source, the map load time might be long. Furthermore, it is not feasible to cancel metadata fetching for the COG layer(s) when loading layers via query parameters.</p> <p>The 3D tiles service endpoint does not contain a default property for the name of the layer and it returns only a single record for this reason the name used in the layers array will be used to apply the title to the added 3D Tiles layer:</p> <pre><code>{\n\"type\": \"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\n\"layers\": [\"My 3D Tiles Layer\"],\n\"sources\": [{ \"type\":\"3dtiles\", \"url\":\"https://example.com/tileset-pathname/tileset.json\" }]\n}\n</code></pre> <p>GET: <code>#/viewer/config?actions=[{\"type\":\"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\"layers\":[\"My 3D Tiles Layer\"],\"sources\":[{\"type\":\"3dtiles\",\"url\":\"https://example.com/tileset-pathname/tileset.json\"}]}]</code></p> <p>For the 3D Tiles you can pass also the layer options, to customize the layer. Here and example to localize the title:</p> <pre><code>{\n\"type\": \"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\n\"layers\": [\"My 3D Tiles Layer\"],\n\"sources\": [{ \"type\":\"3dtiles\", \"url\":\"https://example.com/tileset-pathname/tileset.json\" }],\n\"options\":[{ \"title\": { \"en-US\": \"LayerTitle\", \"it-IT\": \"TitoloLivello\" }}]\n}\n</code></pre> <p>GET: <code>#/viewer/config?actions=[{\"type\":\"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\"layers\":[\"My 3D Tiles Layer\"],\"sources\":[{\"type\":\"3dtiles\",\"url\":\"https://example.com/tileset-pathname/tileset.json\"}],\"options\":[{\"title\":{\"en-US\":\"LayerTitle\",\"it-IT\":\"TitoloLivello\"}}]}]</code></p> <p>It is possible to add GeoJSON layer using the following configuration:</p> <pre><code>{\n\"type\": \"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\n\"layers\": [\"My GeoJSON Layer\"],\n\"sources\": [{ \"type\":\"GEOJSON\", \"url\":\"https://example.com/example.geojson\" }]\n}\n</code></pre> <p>GET: <code>#/viewer/config?actions=[{\"type\":\"CATALOG:ADD_LAYERS_FROM_CATALOGS\",\"layers\":[\"My GeoJSON Layer\"],\"sources\":[{\"type\":\"GEOJSON\",\"url\":\"https://example.com/example.geojson\"}]}]</code></p> <p>This GeoJSON catalog will return a single record similar to the 3D Tiles catalog and for this reason the name used in the layers array will be used to apply the title to the added vector layer.</p>"},{"location":"developer-guide/maps-configuration/","title":"Map Configuration","text":"<p>By default MapStore is able to open maps with this path in the URL:</p> <pre><code>http://localhost:8081/#viewer/&lt;mapId&gt;\n</code></pre> <p>Where:</p> <ul> <li><code>mapId</code> can be a number or a string.</li> <li>A number represents standard maps, stored on the database.</li> <li>A string instead represents a static json file in the root of the application.</li> </ul> <p>The first case can be used to load a map from the maps database, using its id.</p> <p>There is a special mapId, 0 (zero), that is used to load a basic OSM map for demo purposes.</p> <pre><code>http://localhost:8081/#viewer/openlayers/0\n</code></pre> <p>The configuration of this map is stored in the static <code>config.json</code> file in the root of the project.</p> <p>The second case can be used to define standard map contexts.</p> <p>This is used for the new map. If you're logged in and allowed to create maps, when you try to create a new map you will see the the application will bring you to the URL:</p> <pre><code>http://localhost:8081/#viewer/openlayers/new\n</code></pre> <p>This page uses the <code>new.json</code> file as a template configuration to start creating a new map. You can find this file in <code>web/client/configs</code> directory for standard MapStore or in <code>configs/</code> folder for a custom projects. You can edit <code>new.json</code> to customize this initial template. It typically contains the map backgrounds you want to use for all the new maps (identified by the special property <code>\"group\": \"background\"</code>).</p> <p>If you have enabled the datadir, then you can externalize the new.json or config.json files. (see here for more details)</p> <p><code>new.json</code> and <code>config.json</code> are special cases, but you can configure your own static map context creating these json files in the root of the project, for instance <code>mycontext.json</code> and accessing them at the URL:</p> <pre><code>http://localhost:8081/#viewer/openlayers/mycontext\n</code></pre> <p>important note: <code>new.json</code> and <code>config.json</code> are special files and don't require the version. For other map context, you must specify the version of the map file type in the root of the json file:</p> <pre><code>    {\n\"version\": 2,\n// ...\n}\n</code></pre> <p>These static map contexts are accessible by anyone. If you want to customize standard maps (that are listed in home page and where you can define) manually, you will have to edit the maps using the GeoStore REST API.</p>"},{"location":"developer-guide/maps-configuration/#map-options","title":"Map options","text":"<p>The following options define the map options (projection, position, layers):</p> <ul> <li><code>projection: {string}</code> expressed in EPSG values</li> <li><code>units: {string}</code> uom of the coordinates</li> <li><code>center: [object]</code> center of the map with starting point in the bottom-left corner</li> <li><code>zoom: {number}</code> level of zoom</li> <li><code>resolutions: {number[]}</code> resolutions for each level of zoom</li> <li><code>scales: {number[]}</code> scales used to compute the map resolutions</li> <li><code>maxExtent: {number[]}</code> max bbox of the map expressed [minx, miny, maxx, maxy]</li> <li><code>layers: {object[]}</code> list of layers to be loaded on the map</li> <li><code>groups {object[]}</code>: contains information about the layer groups</li> <li><code>visualizationMode: {string}</code> defines if the map should be visualized in \"2D\" or \"3D\"</li> <li><code>viewerOptions: {object}</code> could contain viewer specific properties, eg. camera orientation and camera position for 3D visualization mode</li> </ul> <p>i.e.</p> <pre><code>{\n\"version\": 2,\n\"projection\": \"EPSG:900913\",\n\"units\": \"m\",\n\"center\": {\"x\": 1000000.000000, \"y\": 5528000.000000, \"crs\": \"EPSG:900913\"},\n\"zoom\": 15,\n\"visualizationMode\": \"2D\",\n\"viewerOptions\": {\n\"cameraPosition\": {\n\"longitude\": 0,\n\"latitude\": 0,\n\"height\": 0\n},\n\"orientation\": {\n\"heading\": 0,\n\"pitch\": 0,\n\"roll\": 0\n}\n},\n\"mapOptions\": {\n\"view\": {\n\"scales\": [175000, 125000, 100000, 75000, 50000, 25000, 10000, 5000, 2500],\n\"resolutions\": [\n84666.66666666688,\n42333.33333333344,\n21166.66666666672,\n10583.33333333336,\n5291.66666666668,\n2645.83333333334,\n1322.91666666667,\n661.458333333335000,\n529.166666666668000,\n396.875000000001000,\n264.583333333334000,\n132.291666666667000,\n66.145833333333500,\n39.687500000000100,\n26.458333333333400,\n13.229166666666700,\n6.614583333333350,\n3.968750000000010,\n2.645833333333340,\n1.322916666666670,\n0.661458333333335\n]\n}\n},\n\"maxExtent\": [\n-20037508.34, -20037508.34,\n20037508.34, 20037508.34\n],\n\"layers\": [{...},{...}]\n}\n</code></pre> <p>Note</p> <p>The option to configure a list of scale denominators allow to have them in human friendly format, and calculate the map resolutions from scales.</p> <p>Warning</p> <p>If the scales and resolutions property are declared, in the same json object, the scales have priority. In the array, the values have be in descending order.</p> <p>Warning</p> <p>Actually the custom resolution values are valid for one single CRS. It's therefore suggested to avoid to add this parameter when multiple CRSs in the same map configuration are needed.</p>"},{"location":"developer-guide/maps-configuration/#layers-options","title":"Layers options","text":"<p>Every layer has it's own properties. Anyway there are some options valid for every layer:</p> <ul> <li><code>title</code>: <code>{object|string}</code> the title of the layer, can be an object to support i18n.</li> <li><code>type</code>: <code>{string}</code> the type of the layer. Can be <code>wms</code>, <code>wmts</code>, <code>osm</code>...</li> <li><code>name</code>: <code>{string}</code> the name is used as general reference to the layer, or as title, if the title is not specified. Anyway, it's usage depends on the specific layer type.</li> <li><code>group</code>: <code>{string}</code>: the group of the layer (in the TOC). Nested groups can be indicated using <code>/</code>. i.e. <code>Group/SubGroup</code>. A special group, <code>background</code>, is used to identify background layers. These layers will not be available in the TOC, but only in the background switcher, and only one layer of this group can be visible.</li> <li><code>thumbURL</code>: <code>{string}</code>: the URL of the thumbnail for the layer, used in the background switcher ( if the layer is a background layer )</li> <li><code>visibility</code>: <code>{boolean}</code>: indicates if the layer is visible or not</li> <li><code>queriable</code>: <code>{boolean}</code>: Indicates if the layer is queriable (e.g. getFeatureInfo). If not present the default is true for every layer that have some implementation available (WMS, WMTS). Usually used to set it explicitly to false, where the query service is not available.</li> <li><code>hideLoading</code>: {boolean}. If true, loading events will be ignored ( useful to hide loading with some layers that have problems or trigger errors loading some tiles or if they do not have any kind of loading.).</li> <li><code>minResolution</code>: <code>{number}</code>: layer is visible if zoom resolution is greater or equal than this value (inclusive)</li> <li><code>maxResolution</code>: <code>{number}</code>: layer is visible if zoom resolution is less than this value (exclusive)</li> <li><code>disableResolutionLimits</code>: <code>{boolean}</code>: this property disables the effect of minResolution and maxResolution if set to true</li> </ul> <p>i.e.</p> <pre><code>{\n\"title\": \"Open Street Map\",\n\"name\": \"mapnik\",\n\"group\": \"background\",\n\"visibility\": false,\n\"hidden\": true\n}\n</code></pre> <p>Localized titles: In these configuration files you can localize titles using an object instead of a string in the <code>title</code> entry. In this case the <code>title</code> object has this shape:</p> <pre><code>title: {\n'default': 'Meteorite Landings from NASA Open Data Portal', // default title, used in case the localized entry is not present\n'it-IT': 'Atterraggi meteoriti', // one string for each IETF language tag you want to support.\n'en-US': 'Meteorite Landings',\n'fr-FR': 'D\u00e9barquements de m\u00e9t\u00e9orites'\n},\n</code></pre> <p>The layers can belong to the <code>background</code> group, in this case they will be available in the background switcher, and only one layer of this group can be visible at the same time.</p> <pre><code>    {\n\"format\": \"image/jpeg\",\n\"name\": \"workspace:layername\",\n\"params\": {},\n\"singleTile\": false,\n\"title\": \"My WMS Background\",\n\"type\": \"wms\",\n\"group\": \"background\",\n\"thumbURL\": \"http://some.wms.service/geoserver/ows?SERVICE=WMS&amp;REQUEST=GetMap&amp;VERSION=1.3.0&amp;LAYERS=rv%3Arv1&amp;STYLES=&amp;FORMAT=image%2Fjpeg&amp;TRANSPARENT=true&amp;HEIGHT=256&amp;WIDTH=256&amp;TILED=true&amp;ZINDEX=2&amp;SRS=EPSG%3A3857&amp;CRS=EPSG%3A3857&amp;BBOX=3757032.814272983,5009377.08569731,5009377.085697311,6261721.35712164\",\n\"url\": \"http://some.wms.service/geoserver/ows\",\n\"visibility\": false\n},\n</code></pre> <p>In the case of the background the <code>thumbURL</code> is used to show a preview of the layer in the background switcher.</p>"},{"location":"developer-guide/maps-configuration/#layer-types","title":"Layer types","text":"<ul> <li><code>wms</code>: WMS - Web Mapping Service layers</li> <li><code>osm</code>: OpenStreetMap layers format</li> <li><code>tileprovider</code>: Some other mixed specific tile providers</li> <li><code>wmts</code>: WMTS: Web Map Tile Service layers</li> <li><code>bing</code>: Bing Maps layers</li> <li><code>google</code>: Google Maps layers</li> <li><code>mapquest</code>: MapQuest layers</li> <li><code>graticule</code>: Vector layer that shows a coordinates grid over the map, with optional labels</li> <li><code>empty</code>: special type for empty background</li> <li><code>3dtiles</code>: 3d tiles layers</li> <li><code>terrain</code>: layers that define the elevation profile of the terrain</li> <li><code>cog</code>: Cloud Optimized GeoTIFF layers</li> <li><code>model</code>: 3D model layers like: IFC</li> </ul>"},{"location":"developer-guide/maps-configuration/#wms","title":"WMS","text":"<p>i.e.</p> <pre><code>{\n\"type\": \"wms\",\n\"url\": \"http...\" // URL of the WMS Service\n\"name\": \"TEST:TEST\", // The name of the layer\n\"format\": \"image/png8\" // format\n\"title\": \"Open Street Map\",\n\"name\": \"mapnik\",\n\"group\": \"background\",\n\"visibility\": false,\n\"params\": {}, // can be used to add parameters to the request, or override the default ones\n\"layerFilter\": {} // a layer filter object, to filter the layer\n\"search\": {}, // object to configure the features URL in the layer\n\"fields\": [{\"name\": \"attr1\", \"alias\": \"Attribute 1\", \"type\": \"string\"},{...}] // array of fields\n\"credits\": { // optional\n\"imageUrl\": \"somePic.png\", // URL for the image to put in attribution\n\"link\": \"http://someURL.org\", // URL where attribution have to link to\n\"title\": \"text to render\" // title to show (as image title or as text)\n}\n}\n</code></pre> <p>Details:</p> <ul> <li><code>url</code>: the URL of the WMS service</li> <li><code>name</code>: name of the layer</li> <li><code>format</code>: the format of the WMS requests to use</li> <li><code>params</code>: an object with additional parameters to add to the WMS request</li> <li><code>layerFilter</code>: an object to filter the layer. See LayerFilter for details.</li> <li><code>search</code>: an object to configure the search features service. It is used to link a WFS service, typically with this shape: <code>{url: 'http://some.wfs.service', type: 'wfs'}</code>.</li> <li><code>fields</code>: if the layer has a wfs service configured, this can contain the fields (attributes) of the features, with custom configuration (e.g. aliases, types, etc.). See Fields for details.</li> <li><code>credits</code>: includes the information to show in attribution.(<code>imageUrl</code>, <code>link</code>, <code>title</code>).</li> <li><code>singleTile</code>: By default, WMS is invoked using tiled requests. If you want to use a single tile request, you can set this property to <code>true</code>.</li> <li><code>tileSize</code>: defines the size of the tiles in pixels for tiled requests. It is a number and it can be <code>256</code> or <code>512</code>. Default is <code>256</code>.</li> </ul>"},{"location":"developer-guide/maps-configuration/#fields","title":"Fields","text":"<p>The <code>fields</code> array is used to configure the attributes of the features of the layer. They can be used in the Identify tool, in the FeatureGrid plugin, in the FeatureInfo popup, etc. It is supported by <code>wms</code> and <code>wfs</code> layers. The supported attributes are:</p> <ul> <li><code>name</code>: the name of the attribute</li> <li><code>alias</code>: the alias of the attribute (used in the Identify tool, in the FeatureGrid plugin, in the FeatureInfo popup, etc.). If not present, the <code>name</code> will be used. It can be an object to support i18n.</li> <li><code>type</code>: the type of the attribute. Supported types are: <code>string</code>, <code>number</code>, <code>date</code>, <code>boolean</code>. If not present, the default type is <code>string</code>.</li> <li><code>filterRenderer</code>: an object to configure the filter renderer in feature grid (for custom projects)</li> <li><code>name</code>: the name of the filter renderer (for custom projects)</li> <li><code>featureGridFormatter</code>: an object to configure the feature grid formatter in feature grid.</li> <li><code>name</code>: the name of the feature grid formatter .</li> <li><code>config</code>: the configuration of the feature grid formatter.</li> </ul> <p>Example:</p> <pre><code>{\n\"fields\": [{\n\"name\": \"attr1\",\n\"alias\": \"Attribute 1\",\n\"type\": \"string\",\n\"filterRenderer\": {\n\"name\": \"customFilterRenderer\"\n},\n\"featureGridFormatter\": {\n\"name\": \"customFeatureGridFormatter\",\n\"config\": {\n\"someConfig\": \"someValue\"\n}\n}\n}, {\n\"name\": \"attr2\",\n\"alias\": {\n\"default\": \"Attribute 2\",\n\"en-US\": \"Attribute 2\",\n\"it-IT\": \"Attributo 2\"\n},\n\"type\": \"number\"\n}]\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#multiple-urls","title":"Multiple URLs","text":"<p>This feature is not yet fully supported by all the plugins, but OpenLayers supports it so if you put an array of urls instead of a single string in the layer url. Some other feature will break, for example the layer properties will stop working, so it is safe to use only on background layers.</p> <pre><code>{\n\"type\": \"wms\",\n\"url\": [\n\"https://a.maps.geosolutionsgroup.com/geoserver/wms\",\n\"https://b.maps.geosolutionsgroup.com/geoserver/wms\",\n\"https://c.maps.geosolutionsgroup.com/geoserver/wms\",\n\"https://d.maps.geosolutionsgroup.com/geoserver/wms\",\n\"https://e.maps.geosolutionsgroup.com/geoserver/wms\",\n\"https://f.maps.geosolutionsgroup.com/geoserver/wms\"\n],\n\"visibility\": true,\n\"opacity\": 1,\n\"title\": \"OSM\",\n\"name\": \"osm:osm\",\n\"group\": \"Meteo\",\n\"format\": \"image/png8\",\n\"bbox\": {\n\"bounds\": {\"minx\": -180, \"miny\": -90, \"maxx\": 180, \"maxy\": 90},\n\"crs\": \"EPSG:4326\"\n}\n},\n</code></pre>"},{"location":"developer-guide/maps-configuration/#useforelevation-deprecated","title":"useForElevation [Deprecated]","text":"<p>This configuration is deprecated. It should be used a terrain layer and elevation layer instead.</p> <p>Note</p> <p>This type of layer configuration is still needed to show the elevation data inside the MousePosition plugin. The <code>terrain</code> layer section shows a more versatile way of handling elevation but it will work only as visualization in the 3D map viewer.</p> <p>WMS layers can be configured to be used as a source for elevation related functions.</p> <p>This requires:</p> <ul> <li>a GeoServer WMS service with the DDS/BIL plugin</li> <li>A WMS layer configured with BIL 16 bit output in big endian mode and -9999 nodata value</li> <li>a static layer in the Map plugin configuration (use the additionalLayers configuration option):</li> </ul> <p>in <code>localConfig.json</code></p> <pre><code>{\n\"name\": \"Map\",\n\"cfg\": {\n\"additionalLayers\": [{\n\"url\": \"http...\",\n\"format\": \"application/bil16\",\n\"type\": \"wms\",\n...\n\"name\": \"elevation\",\n\"littleendian\": false,\n\"visibility\": true,\n\"useForElevation\": true\n}]\n}\n}\n</code></pre> <p>The layer will be used for:</p> <ul> <li>showing elevation in the MousePosition plugin (requires showElevation: true in the plugin configuration)</li> <li>as a TerrainProvider if the maptype is Cesium</li> </ul> <p>in <code>localConfig.json</code></p> <pre><code>{\n\"name\": \"MousePosition\",\n\"cfg\": {\n\"showElevation\": true,\n...\n}\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#wmts","title":"WMTS","text":"<p>The WMTS Layer configuration has a <code>availableTileMatrixSets</code> object that lists all the available tile matrix sets for the specific layer. Every entry of <code>availableTileMatrixSets</code>, identified by the ID of the tile matrix set, contains the <code>crs</code> and one of <code>tileMatrixSet</code> or <code>tileMatrixSetLink</code>. The first contains the definition of the tile matrix set, while the second contain the path to the tile matrix set definition in the JSON of the map configuration. This object can also optionally contain a <code>limits</code> entry, containing the specific limits of the layer inside the tile matrix set.</p> <pre><code>{\n\"type\": \"wmts\",\n\"availableTileMatrixSets\": {\n\"google3857\": {\n\"crs\": \"EPSG:3857\",\n\"tileMatrixSetLink\": \"sources['https://sampleServer.org/wmts/1.0.0/WMTSCapabilities.xml'].tileMatrixSet['EPSG:3857']\"\n}\n}\n</code></pre> <p>The <code>sources</code> entry of the map configuration usually contains the tile matrix sets definitions of the layers of the map, stored by their <code>capabilitiesURL</code> (if <code>capabilitiesURL</code> is not present it will use the <code>url</code> of the layer, in case of multiple URLs, the first one.).</p> <p>A WMTS layer has also a <code>requestEncoding</code> entry that can be valued with <code>RESTful</code> or <code>KVP</code>. In case of <code>RESTful</code> the URL is a template where to place the request parameters ( see the example below ), while in the <code>KVP</code> case the request parameters will be passed in the query string. See the WMTS standard for more details.</p> <p>e.g. (RESTful):</p> <pre><code>{\n\"version\": 2,\n// ...\n\"map\": {\n// ...\n\"layers\": [\n// WMTS layer sample\n{\n\"id\": \"bmapoberflaeche__11\",\n\"name\": \"layer_name\",\n// ...\n\"type\": \"wmts\",\n\"url\": [ // MULTIPLE URLS are allowed\n\"https://maps1.sampleServer/{Style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.jpeg\",\n\"https://maps2.sampleServer/{Style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.jpeg\",\n\"https://maps3.sampleServer/{Style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.jpeg\",\n\"https://maps4.sampleServer/{Style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.jpeg\",\n\"https://maps.sampleServer/{Style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.jpeg\"\n],\n\"allowedSRS\": {\n\"EPSG:3857\": true\n},\n\"availableTileMatrixSets\": {\n\"google3857\": {\n\"crs\": \"EPSG:3857\",\n\"tileMatrixSetLink\": \"sources['https://sampleServer.org/wmts/1.0.0/WMTSCapabilities.xml'].tileMatrixSet['EPSG:3857']\"\n}\n},\n// KVP (By default) or RESTful\n\"requestEncoding\": \"RESTful\",\n// identifier for the source\n\"capabilitiesURL\": \"https://sampleServer.org/wmts/1.0.0/WMTSCapabilities.xml\",\n}\n],\n\"sources\": {\n// source of the layer above\n\"https://sampleServer.org/wmts/1.0.0/WMTSCapabilities.xml\": {\n\"tileMatrixSet\": {\n\"google3857\": {\n\"ows:Identifier\": \"google3857\",\n\"ows:BoundingBox\": {\n\"$\": {\n\"crs\": \"urn:ogc:def:crs:EPSG:6.18.3:3857\"\n},\n\"ows:LowerCorner\": \"977650 5838030\",\n\"ows:UpperCorner\": \"1913530 6281290\"\n},\n\"ows:SupportedCRS\": \"urn:ogc:def:crs:EPSG:6.18.3:3857\",\n\"WellKnownScaleSet\": \"urn:ogc:def:wkss:OGC:1.0:GoogleMapsCompatible\",\n\"TileMatrix\": [\n{\n\"ows:Identifier\": \"0\",\n\"ScaleDenominator\": \"559082264.029\",\n\"TopLeftCorner\": \"-20037508.3428 20037508.3428\",\n\"TileWidth\": \"256\",\n\"TileHeight\": \"256\",\n\"MatrixWidth\": \"1\",\n\"MatrixHeight\": \"1\"\n},\n{\n\"ows:Identifier\": \"1\",\n\"ScaleDenominator\": \"279541132.015\",\n\"TopLeftCorner\": \"-20037508.3428 20037508.3428\",\n\"TileWidth\": \"256\",\n\"TileHeight\": \"256\",\n\"MatrixWidth\": \"2\",\n\"MatrixHeight\": \"2\"\n},\n// ...more levels\n]\n}\n}\n}\n}\n}\n}\n</code></pre> <p>e.g. (KVP)</p> <pre><code>{\n\"version\": 2,\n\"map\": {\n// ...\n\"projection\": \"EPSG:900913\",\n\"layers\": [\n// ...\n{\n// requestEncoding is KVP by default\n\"id\": \"EMSA:S52 Standard__6\",\n\"name\": \"EMSA:S52 Standard\",\n\"description\": \"S52 Standard\",\n\"title\": \"S52 Standard\",\n\"type\": \"wmts\",\n// if the capabilitiesURL is not present, the `url` will be used to identify the source.\n// (for retro-compatibility with existing layers)\n\"url\": \"http://some.domain/geoserver/gwc/service/wmts\",\n\"bbox\": {\n\"crs\": \"EPSG:4326\",\n\"bounds\": {\n\"minx\": \"-180.0\",\n\"miny\": \"-79.99999999999945\",\n\"maxx\": \"180.0\",\n\"maxy\": \"83.99999999999999\"\n}\n},\n// list of allowed SRS\n\"allowedSRS\": {\n\"EPSG:4326\": true,\n\"EPSG:3857\": true,\n\"EPSG:900913\": true\n},\n\"availableTileMatrixSets\": {\n\"EPSG:32761\": {\n\"crs\": \"EPSG:32761\",\n\"tileMatrixSetLink\": \"sources['http://some.domain/geoserver/gwc/service/wmts'].tileMatrixSet['EPSG:32761']\"\n},\n\"EPSG:3857\": {\n\"crs\": \"EPSG:3857\",\n\"tileMatrixSetLink\": \"sources['http://some.domain/geoserver/gwc/service/wmts'].tileMatrixSet['EPSG:3857']\"\n},\n\"EPSG:4326\": {\n\"crs\": \"EPSG:4326\",\n\"tileMatrixSetLink\": \"sources['http://some.domain/geoserver/gwc/service/wmts'].tileMatrixSet['EPSG:4326']\"\n},\n\"EPSG:32661\": {\n\"crs\": \"EPSG:32661\",\n\"tileMatrixSetLink\": \"sources['http://some.domain/geoserver/gwc/service/wmts'].tileMatrixSet['EPSG:32661']\"\n},\n\"EPSG:3395\": {\n\"crs\": \"EPSG:3395\",\n\"tileMatrixSetLink\": \"sources['http://some.domain/geoserver/gwc/service/wmts'].tileMatrixSet['EPSG:3395']\"\n},\n\"EPSG:900913\": {\n\"crs\": \"EPSG:900913\",\n// these ranges limit the tiles available for the grid level\n\"limits\": [\n{\n\"identifier\": \"EPSG:900913:0\",\n\"ranges\": {\n\"cols\": {\n\"min\": \"0\",\n\"max\": \"0\"\n},\n\"rows\": {\n\"min\": \"0\",\n\"max\": \"0\"\n}\n}\n},\n{\n\"identifier\": \"EPSG:900913:1\",\n\"ranges\": {\n\"cols\": {\n\"min\": \"0\",\n\"max\": \"1\"\n},\n\"rows\": {\n\"min\": \"0\",\n\"max\": \"1\"\n}\n}\n},\n{\n\"identifier\": \"EPSG:900913:2\",\n\"ranges\": {\n\"cols\": {\n\"min\": \"0\",\n\"max\": \"3\"\n},\n\"rows\": {\n\"min\": \"0\",\n\"max\": \"3\"\n}\n}\n}\n],\n\"tileMatrixSetLink\": \"sources['http://some.domain/geoserver/gwc/service/wmts'].tileMatrixSet['EPSG:900913']\"\n}\n}\n}\n],\n// ...\n\"sources\": {\n\"http://some.domain/geoserver/gwc/service/wmts\": {\n\"tileMatrixSet\": {\n\"EPSG:32761\": {/*...*/},\n\"EPSG:3857\": {/*...*/},\n\"EPSG:4326\": {/*...*/},\n\"EPSG:32661\": {/*...*/},\n\"EPSG:3395\": {/*...*/},\n\"EPSG:900913\": {\n\"ows:Identifier\": \"EPSG:900913\",\n// the supported CRS\n\"ows:SupportedCRS\": \"urn:ogc:def:crs:EPSG::900913\",\n\"TileMatrix\": [\n{\n\"ows:Identifier\": \"EPSG:900913:0\",\n\"ScaleDenominator\": \"5.590822639508929E8\",\n\"TopLeftCorner\": \"-2.003750834E7 2.0037508E7\",\n\"TileWidth\": \"256\",\n\"TileHeight\": \"256\",\n\"MatrixWidth\": \"1\",\n\"MatrixHeight\": \"1\"\n},\n{\n\"ows:Identifier\": \"EPSG:900913:1\",\n\"ScaleDenominator\": \"2.7954113197544646E8\",\n\"TopLeftCorner\": \"-2.003750834E7 2.0037508E7\",\n\"TileWidth\": \"256\",\n\"TileHeight\": \"256\",\n\"MatrixWidth\": \"2\",\n\"MatrixHeight\": \"2\"\n},\n{\n\"ows:Identifier\": \"EPSG:900913:2\",\n\"ScaleDenominator\": \"1.3977056598772323E8\",\n\"TopLeftCorner\": \"-2.003750834E7 2.0037508E7\",\n\"TileWidth\": \"256\",\n\"TileHeight\": \"256\",\n\"MatrixWidth\": \"4\",\n\"MatrixHeight\": \"4\"\n}\n]\n}\n}\n}\n}\n}\n</code></pre> <p>e.g. (embed tileMatrixSet without link to sources)</p> <pre><code>{\n\"version\": 2,\n\"map\": {\n// ...\n\"projection\": \"EPSG:900913\",\n\"layers\": [\n// ...\n{\n// requestEncoding is KVP by default\n\"id\": \"EMSA:S52 Standard__6\",\n\"name\": \"EMSA:S52 Standard\",\n\"description\": \"S52 Standard\",\n\"title\": \"S52 Standard\",\n\"type\": \"wmts\",\n// if the capabilitiesURL is not present, the `url` will be used to identify the source.\n// (for retro-compatibility with existing layers)\n\"url\": \"http://some.domain/geoserver/gwc/service/wmts\",\n\"bbox\": {\n\"crs\": \"EPSG:4326\",\n\"bounds\": {\n\"minx\": \"-180.0\",\n\"miny\": \"-79.99999999999945\",\n\"maxx\": \"180.0\",\n\"maxy\": \"83.99999999999999\"\n}\n},\n// list of allowed SRS\n\"allowedSRS\": {\n\"EPSG:3857\": true,\n\"EPSG:900913\": true\n},\n\"availableTileMatrixSets\": {\n\"EPSG:900913\": {\n\"crs\": \"EPSG:900913\",\n\"tileMatrixSet\": {\n\"ows:Identifier\": \"EPSG:900913\",\n\"ows:SupportedCRS\": \"urn:ogc:def:crs:EPSG::900913\",\n\"TileMatrix\": [\n{\n\"ows:Identifier\": \"EPSG:900913:0\",\n\"ScaleDenominator\": \"5.590822639508929E8\",\n\"TopLeftCorner\": \"-2.003750834E7 2.0037508E7\",\n\"TileWidth\": \"256\",\n\"TileHeight\": \"256\",\n\"MatrixWidth\": \"1\",\n\"MatrixHeight\": \"1\"\n},\n{\n\"ows:Identifier\": \"EPSG:900913:1\",\n\"ScaleDenominator\": \"2.7954113197544646E8\",\n\"TopLeftCorner\": \"-2.003750834E7 2.0037508E7\",\n\"TileWidth\": \"256\",\n\"TileHeight\": \"256\",\n\"MatrixWidth\": \"2\",\n\"MatrixHeight\": \"2\"\n},\n{\n\"ows:Identifier\": \"EPSG:900913:2\",\n\"ScaleDenominator\": \"1.3977056598772323E8\",\n\"TopLeftCorner\": \"-2.003750834E7 2.0037508E7\",\n\"TileWidth\": \"256\",\n\"TileHeight\": \"256\",\n\"MatrixWidth\": \"4\",\n\"MatrixHeight\": \"4\"\n}\n]\n}\n}\n}\n}\n]\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#bing","title":"Bing","text":"<p>TODO</p>"},{"location":"developer-guide/maps-configuration/#google","title":"Google","text":"<p>Note</p> <p>The use of Google maps tiles in MapStore is not enabled and maintained due to licensing reasons. If your usage conditions respect the google license, you can enable the google layers by:</p> <ul> <li>Adding <code>&lt;script src=\"https://maps.google.com/maps/api/js?v=3\"&gt;&lt;/script&gt;</code> to all <code>html</code> files you need it.</li> <li>Add your API-KEY to the request</li> <li>Fix the code, if needed.</li> </ul> <p>example:</p> <pre><code>    {\n\"type\": \"google\",\n\"title\": \"Google HYBRID\",\n\"name\": \"HYBRID\",\n\"source\": \"google\",\n\"group\": \"background\",\n\"visibility\": false\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#osm","title":"OSM","text":"<p>example:</p> <pre><code>{\n\"type\": \"osm\",\n\"title\": \"Open Street Map\",\n\"name\": \"mapnik\",\n\"source\": \"osm\",\n\"group\": \"background\",\n\"visibility\": true\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#tileprovider","title":"TileProvider","text":"<p>TileProvider is a shortcut to easily configure many different layer sources. It's enough to add <code>provider</code> property and 'tileprovider' as type property to the layer configuration object. <code>provider</code> should be in the form of <code>ProviderName.VariantName</code>.</p> <p>i.e.</p> <pre><code>{\n\"type\": \"tileprovider\",\n\"title\": \"Title\",\n\"provider\": \"Stamen.Toner\", // \"ProviderName.VariantName\"\n\"name\": \"Name\",\n\"group\": \"GroupName\",\n\"visibility\": false\n}\n</code></pre> <p>Options passed in configuration object, if already configured by TileProvider,  will be overridden.</p> <p>Openlayers' TileProvider at the moment doesn't support <code>minZoom</code> configuration property and high resolution map.</p> <p>In case of missing <code>provider</code> or if <code>provider: \"custom\"</code>, the tile provider can be customized and configured internally. You can configure the <code>url</code> as a template, than you can configure options add specific options (<code>maxNativeZoom</code>, <code>subdomains</code>).</p> <pre><code>{\n\"type\": \"tileprovider\",\n\"title\": \"Title\",\n\"provider\": \"custom\", // or undefined\n\"name\": \"Name\",\n\"group\": \"GroupName\",\n\"visibility\": false,\n\"url\": \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n\"options\": {\n\"subdomains\": [ \"a\", \"b\"]\n}\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#providers-and-variants","title":"Providers and variants","text":"<p>This is a not maintained list of providers and variants. For the most updated list check the code here</p> <p>Some of them may need some additional configuration or API keys.</p> <pre><code>OpenStreetMap.Mapnik\nOpenStreetMap.BlackAndWhite\nOpenStreetMap.DE\nOpenStreetMap.France\nOpenStreetMap.HOT\nThunderforest.OpenCycleMap\nThunderforest.Transport\nThunderforest.TransportDark\nThunderforest.Landscape\nThunderforest.Outdoors\nOpenMapSurfer.Roads\nOpenMapSurfer.AdminBounds\nOpenMapSurfer.Grayscale\nHydda.Full\nHydda.Base\nHydda.RoadsAndLabels\nMapQuestOpen.OSM\nMapQuestOpen.Aerial\nMapQuestOpen.HybridOverlay\nStamen.Toner\nStamen.TonerBackground\nStamen.TonerHybrid\nStamen.TonerLines\nStamen.TonerLabels\nStamen.TonerLite\nStamen.Watercolor\nStamen.Terrain\nStamen.TerrainBackground\nStamen.TopOSMRelief\nStamen.TopOSMFeatures\nEsri.WorldStreetMap\nEsri.DeLorme\nEsri.WorldTopoMap\nEsri.WorldImagery\nEsri.WorldTerrain\nEsri.WorldShadedRelief\nEsri.WorldPhysical\nEsri.OceanBasemap\nEsri.NatGeoWorldMap\nEsri.WorldGrayCanvas\nOpenWeatherMap.Clouds\nOpenWeatherMap.CloudsClassic\nOpenWeatherMap.Precipitation\nOpenWeatherMap.PrecipitationClassic\nOpenWeatherMap.Rain\nOpenWeatherMap.RainClassic\nOpenWeatherMap.Pressure\nOpenWeatherMap.PressureContour\nOpenWeatherMap.Wind\nOpenWeatherMap.Temperature\nOpenWeatherMap.Snow\nHERE.normalDay\nHERE.normalDayCustom\nHERE.normalDayGrey\nHERE.normalDayMobile\nHERE.normalDayGreyMobile\nHERE.normalDayTransit\nHERE.normalDayTransitMobile\nHERE.normalNight\nHERE.normalNightMobile\nHERE.normalNightGrey\nHERE.normalNightGreyMobile\nHERE.carnavDayGrey\nHERE.hybridDay\nHERE.hybridDayMobile\nHERE.pedestrianDay\nHERE.pedestrianNight\nHERE.satelliteDay\nHERE.terrainDay\nHERE.terrainDayMobile\nAcetate.basemap\nAcetate.terrain\nAcetate.all\nAcetate.foreground\nAcetate.roads\nAcetate.labels\nAcetate.hillshading\nCartoDB.Positron\nCartoDB.PositronNoLabels\nCartoDB.PositronOnlyLabels\nCartoDB.DarkMatter\nCartoDB.DarkMatterNoLabels\nCartoDB.DarkMatterOnlyLabels\nHikeBike.HikeBike\nHikeBike.HillShading\nBasemapAT.basemap\nBasemapAT.grau\nBasemapAT.overlay\nBasemapAT.highdpi\nBasemapAT.orthofoto\nNASAGIBS.ModisTerraTrueColorCR\nNASAGIBS.ModisTerraBands367CR\nNASAGIBS.ViirsEarthAtNight2012\nNASAGIBS.ModisTerraLSTDay\nNASAGIBS.ModisTerraSnowCover\nNASAGIBS.ModisTerraAOD\nNASAGIBS.ModisTerraChlorophyll\nNLS.OS_1900\nNLS.OS_1920\nNLS.OS_opendata\nNLS.OS_6inch_1st\nNLS.OS_6inch\nNLS.OS_25k\nNLS.OS_npe\nNLS.OS_7th\nNLS.OS_London\nNLS.GSGS_Ireland\nPDOK.brtachtergrondkaart\nPDOK.brtachtergrondkaartgrijs\nPDOK.brtachtergrondkaartpastel\nPDOK.brtachtergrondkaartwater\nPDOK.luchtfotoRGB\nPDOK.luchtfotoIR\n</code></pre>"},{"location":"developer-guide/maps-configuration/#vector","title":"Vector","text":"<p>The layer type vector is the type used for imported data (geojson, shapefile) or for annotations. Generally speaking, any vector data added directly to the map. This is the typical fields of a vector layer</p> <pre><code>{\n\"type\":\"vector\",\n\"features\":[\n{\n\"type\":\"Feature\",\n\"geometry\":{\n\"type\":\"Point\",\n\"coordinates\":[\n12.516431808471681,\n41.89817370656741\n]\n},\n\"properties\":{\n},\n\"id\":0\n}\n],\n\"style\":{\n\"weight\":5,\n\"radius\":10,\n\"opacity\":1,\n\"fillOpacity\":0.1,\n\"color\":\"rgba(0, 0, 255, 1)\",\n\"fillColor\":\"rgba(0, 0, 255, 0.1)\"\n},\n\"hideLoading\":true\n}\n</code></pre> <ul> <li><code>features</code>: features in GeoJSON format.</li> <li><code>style</code>: the style object of the layer. See vector style for details.</li> <li><code>styleName</code>: name of a style to use (e.g. \"marker\").</li> <li><code>hideLoading</code>: boolean. if true, the loading will not be taken into account.</li> </ul>"},{"location":"developer-guide/maps-configuration/#wfs-layer","title":"WFS Layer","text":"<p>A vector layer, whose data source is a WFS service. The configuration has properties in common with both WMS and vector layers. it contains the search entry that allows to browse the data on the server side. The styling system is the same of the vector layer.</p> <p>This layer differs from the \"vector\" because all the loading/filtering/querying operations are applied directly using the WFS service, without storing anything locally.</p> <pre><code>{\n\"type\":\"wfs\",\n\"search\":{\n\"url\":\"https://myserver.org/geoserver/wfs\",\n\"type\":\"wfs\"\n},\n\"fields\": [{\"name\": \"attr1\", \"alias\": \"Attribute 1\", \"type\": \"string\"}],\n\"name\":\"workspace:layer\",\n\"styleName\":\"marker\",\n\"url\":\"https://myserver.org/geoserver/wfs\"\n}\n</code></pre> <ul> <li><code>name</code>: the name of the layer in the WFS service.</li> <li><code>style</code>: the style object of the layer. See vector style for details.</li> <li><code>url</code>: the url of the WFS service.</li> <li><code>fields</code>: if the layer has a wfs service configured, this can contain the fields (attributes) of the features, with custom configuration (e.g. aliases, types, etc.)</li> </ul>"},{"location":"developer-guide/maps-configuration/#experimental-properties","title":"Experimental properties","text":"<p>Here a list of experimental properties that can be used in the WFS layer configuration, they may change in the future.</p> <ul> <li><code>serverType</code>: analogous to the <code>serverType</code> of the WMS layer. It can be <code>geoserver</code> or <code>no-vendor</code>. If <code>no-vendor</code> is used, the requests will not contain vendor specific parameters like <code>cql_filter</code>, and the layer will be treated as a generic WFS layer. The filtering will be done on the \"WFS client\" side, using the <code>filter</code> property. Actually this property is supported only in OpenLayers and only for the map viewer.</li> <li> <p><code>security</code>: this is an object that can contain the security configuration for the layer. It allows to specify if some particular security is configured for this layer, apart from the usual <code>securityRules</code> configured globally. It can contain the following properties. Actually this property is supported only in OpenLayers and only for the map viewer:</p> </li> <li> <p><code>type</code>: the type of security to use. It can be <code>Basic</code>.</p> </li> <li><code>sourceType</code>: the type of source to use. It can be  <code>sessionStorage</code>. In case of sessionStorage, a <code>sourceId</code> must be provided to get the credentials from the sessionStorage.</li> <li> <p><code>sourceId</code>: the id of the source to use. It can be any string.</p> <pre><code>{\n\"security\": {\n\"type\": \"Basic\",\n\"sourceType\": \"sessionStorage\",\n\"sourceId\": \"source-identifier\"\n}\n}\n</code></pre> </li> </ul>"},{"location":"developer-guide/maps-configuration/#graticule","title":"Graticule","text":"<p>i.e.</p> <pre><code>{\n\"type\": \"graticule\",\n\"labels\": true,\n\"frame\": true, // adds a frame to the map, to better highlight labels\n\"frameRatio\": 0.07, // frame percentage size (7%)\n\"style\": { // style for the grid lines\n\"color\": \"#000000\",\n\"weight\": 1,\n\"lineDash\": [0.5, 4],\n\"opacity\": 0.5\n},\n\"frameStyle\": { // style for the optional frame\n\"color\": \"#000000\",\n\"weight\": 1,\n\"fillColor\": \"#FFFFFF\"\n},\n\"labelXStyle\": { // style for X coordinates labels\n\"color\": \"#000000\",\n\"font\": \"sans-serif\",\n\"fontWeight\": \"bold\",\n\"fontSize\": \"20\",\n\"labelOutlineColor\": \"#FFFFFF\",\n\"labelOutlineWidth\": 2\n},\n\"labelYStyle\": { // style for Y coordinates labels\n\"color\": \"#000000\",\n\"font\": \"sans-serif\",\n\"fontWeight\": \"bold\",\n\"fontSize\": \"20\",\n\"labelOutlineColor\": \"#FFFFFF\",\n\"labelOutlineWidth\": 2,\n\"rotation\": 90,\n\"verticalAlign\": \"top\",\n\"textAlign\": \"center\"\n}\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#3d-tiles","title":"3D tiles","text":"<p>This type of layer shows 3d tiles version 1.0 inside the Cesium viewer. This layer will not be visible inside 2d map viewer types: openlayer or leaflet. See specification for more info about 3d tiles here.</p> <p>i.e.</p> <pre><code>{\n\"type\": \"3dtiles\",\n\"url\": \"http...\" // URL of tileset.json file\n\"title\": \"3D tiles layer\",\n\"visibility\": true,\n// optional\n\"heightOffset\": 0, // height offest applied to the complete tileset\n\"style\": {\n\"format\": \"3dtiles\",\n\"body\": { // 3d tiles style\n\"color\": \"color('#43a2ca', 1)\"\n}\n}\n}\n</code></pre> <p>The style body object for the format 3dtiles accepts rules described in the 3d tiles styling specification version 1.0 available here.</p>"},{"location":"developer-guide/maps-configuration/#model-layer","title":"Model Layer","text":"<p>This type of layer shows ifc models with different versions including referenced and non-georeferenced ifc models inside the Cesium viewer. This layer will not be visible inside 2d map viewer types: openlayer or leaflet. See specification for more info about IFC here.</p> <p>i.e.</p> <pre><code>{\n\"type\": \"model\",\n\"url\": \"http...\" // URL of ifc file with \".ifc\" format\n\"title\": \"IFC Model Layer\",\n\"visibility\": true,\nfeatures: [\n{\ntype: 'Feature',\nid: 'model-origin',\nproperties: {\nheading: 0,\npitch: 0,\nroll: 0,\nscale: scale\n},\ngeometry: {\ntype: 'Point',\ncoordinates: [longitude, latitude, height]\n}\n}\n],\nbbox: {\ncrs: \"EPSG:4326\",\nbounds: {\nminx: 0,\nminy: 0,\nmaxx: 0,\nmaxy: 0\n}\n},\n// optional\nproperties: {}\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#terrain","title":"Terrain","text":"<p>The <code>terrain</code> layer allows the customization of the elevation profile of the globe mesh in the Cesium 3d viewer.</p> <p>Mapstore supports 3 different types of terrain providers:</p> <ul> <li><code>wms</code>: Supports <code>DDL/BIL</code> types of assets using WMS OGC protocol.</li> <li><code>cesium</code>: Support resources compliant with the Cesium terrain format.</li> </ul> <p>If no <code>terrain</code> layer is defined the default elevation profile for the globe will be the ellipsoid, that is the 3rd type, that provides a rather flat profile.</p> <p>In order to use these layers with all the maps, they need to be incorporated into the <code>additionalLayers</code> configuration of the <code>Map</code> plugin (in <code>localConfig.json</code> and/or in the context configuration). The globe accepts only one terrain provider so in case of adding more than one the last one will take precedence to be used to create the elevation profile.</p> <pre><code>{\n\"name\": \"Map\",\n\"cfg\": {\n\"additionalLayers\": [{\n\"type\": \"terrain\",\n\"provider\": \"wms\",\n\"url\": \"https://host-sample/geoserver/wms\",\n\"name\": \"workspace:layername\",  // name of the geoserver resource\n\"littleEndian\": false,\n\"visibility\": true,\n\"crs\": \"CRS:84\"\n}]\n}\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#wms-terrain-provider","title":"WMS terrain provider","text":"<p>In order to create a <code>wms</code> based mesh there are some requirements that need to be fulfilled:</p> <ul> <li>A GeoServer WMS service with the DDS/BIL plugin</li> <li>The Layer to use for the terrain model have to be configured in GeoServer with BIL 16 bit output, big endian mode, -9999 as no-data value</li> <li>A layer of <code>\"type\": \"terrain\"</code> configured in MapStore (map or <code>additionalLayers</code>) that uses the <code>\"provider\": \"wms\"</code> .</li> </ul> <p>The layer configuration can be done in 3 different ways:</p> <ol> <li> <p>Layer configuration with sufficient metadata of the layer. This prevents a call to <code>getCapabilities</code> eventually improving performance of the parsing of the layer.     Mandatory fields are <code>url</code>, <code>name</code>, <code>crs</code>.</p> <pre><code>{\n\"type\": \"terrain\",\n\"provider\": \"wms\",\n\"url\": \"http://hot-sample/geoserver/wms\",\n\"name\": \"workspace:layername\",\n\"littleEndian\": false,\n\"visibility\": true,\n\"crs\": \"CRS:84\" // Supports only CRS:84 | EPSG:4326 | EPSG:3857 | OSGEO:41001\n}\n</code></pre> </li> <li> <p>Layer configuration of <code>geoserver</code> layer with layer name prefixed with workspace, then the <code>getCapabilities</code> is requested only for that layer</p> <pre><code>{\n\"type\": \"terrain\",\n\"provider\": \"wms\",\n\"url\": \"https://host-sample/geoserver/wms\", // 'geoserver' url\n\"name\": \"workspace:layername\", // name of the geoserver resource with workspace prefixed\n\"littleEndian\": false\n}\n</code></pre> </li> <li> <p>Layer configuration of geoserver layer with layer name not prefixed with workspace then <code>getCapabilities</code> is requested in global scope.</p> <pre><code>{\n\"type\": \"terrain\",\n\"provider\": \"wms\",\n\"url\": \"https://host-sample/geoserver/wms\",\n\"name\": \"layername\",\n\"littleEndian\": false\n}\n</code></pre> </li> </ol> <p>Note</p> <p>With <code>wms</code> as provider, the <code>format</code> option is not needed, as Mapstore supports only <code>image/bil</code> format and is used by default</p> <p>Here all the available properties for the <code>wms</code> terrain provider:</p> <pre><code>{\n\"type\": \"terrain\",\n\"provider\": \"wms\",\n\"url\": \"https://host-sample/geoserver/wms\",\n\"name\": \"workspace:layername\", // name of the geoserver resource\n\"littleEndian\": false, // defines whether buffer is in little or big endian\n\"visibility\": true,\n// optional properties\n\"crs\": \"CRS:84\", // projection of the layer, support only CRS:84 | EPSG:4326 | EPSG:3857 | OSGEO:41001\n\"version\": \"1.3.0\", // version used for the WMS request\n\"heightMapWidth\": 65, // width  of a tile in pixels, default value 65\n\"heightMapHeight\": 65, // height of a tile in pixels, default value 65\n\"waterMask\": false,\n\"offset\": 0, // offset of the tiles (in meters)\n\"highest\": 12000, // highest altitude in the tiles (in meters)\n\"lowest\": -500, // lowest altitude in the tiles\n\"sampleTerrainZoomLevel\": 18 // zoom level used to perform sampleTerrain and get the height value given a point, used by measure components\n\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#cesium-terrain-provider","title":"Cesium terrain provider","text":"<p>The <code>terrain</code> layer of <code>cesium</code> type allows using Cesium terrain format compliant services (like Cesium Ion resources or MapTiler meshes). The options attribute allows for further customization of the terrain properties (see available options on the Cesium documentation for the cesium terrain provider)</p> <pre><code>{\n\"type\": \"terrain\",\n\"provider\": \"cesium\",\n\"url\": \"https://terrain-provider-service-url/?key={apiKey}\",\n\"visibility\": true,\n\"options\": {\n// requestVertexNormals, requestWatermask, credit...\n}\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#elevation","title":"Elevation","text":"<p>This layer provides information related to elevation based on a provided DTM layer. It does not provide the terrain profile for 3D visualization, see terrain layer type for this feature.</p> <p>Note</p> <p>In the Cesium 3D viewer all the heights are relative to the WGS84 ellipsoid while usually DTM/DEM files could have an elevation value relative to the mean sea level (MSL). So with this layer it's possible to have a terrain layer with the correct WGS84 ellipsoidal height while querying the mouse position with a MSL height.</p> <p>This requires:</p> <ul> <li>a GeoServer WMS service with the DDS/BIL plugin</li> <li>A WMS layer configured with BIL 16 bit output in big endian mode and -9999 nodata value</li> <li>a static layer in the Map plugin configuration (use the <code>additionalLayers</code> configuration option to share it with all the maps):</li> </ul> <p>in <code>localConfig.json</code></p> <pre><code>{\n\"name\": \"Map\",\n\"cfg\": {\n\"additionalLayers\": [{\n\"type\": \"elevation\",\n\"provider\": \"wms\",\n\"url\": \"/geoserver/wms\",\n\"name\": \"elevation\",\n\"visibility\": true,\n// optional\n\"littleEndian\": false,\n\"nodata\": -9999\n}]\n}\n}\n</code></pre> <p>The layer will be used for showing elevation in the <code>MousePosition</code> plugin (it requires <code>\"showElevation\": true</code> in the plugin configuration)</p> <p>in <code>localConfig.json</code></p> <pre><code>{\n\"name\": \"MousePosition\",\n\"cfg\": {\n\"showElevation\": true,\n...\n}\n}\n</code></pre> <p>Note</p> <p>This type of layer is introduced in substitution of the of the wms layer useForElevation and the main reason is to separate the visualization from the information displayed with the mouse position plugin aligning the behavior of the 2D/3D viewers. The current implementation supports only a WMS layer in format <code>application/bil16</code>.</p>"},{"location":"developer-guide/maps-configuration/#cloud-optimized-geotiff-cog","title":"Cloud Optimized GeoTIFF (COG)","text":"<p>i.e.</p> <pre><code>{\n\"type\": \"cog\",\n\"title\": \"Title\",\n\"group\": \"background\",\n\"visibility\": false,\n\"name\": \"Name\",\n\"sources\": [\n{ \"url\": \"https://host-sample/cog1.tif\", min: 1, max: 100, nodata: 0},\n{ \"url\": \"https://host-sample/cog2.tif\", min: 1, max: 100, nodata: 255}\n],\n\"style\": {\n\"body\": { // cog style currently supports only RGB with alpha band or single/gray band\n\"color\": [\"array\", [\"band\", 1], [\"band\", 2], [\"band\", 3], [\"band\", 4]] // RGB with alpha band\n// \"color\": [\"array\", [\"band\", 1], [\"band\", 1], [\"band\", 1], [\"band\", 2]]  - single/gray band\n},\n\"format\": \"openlayers\",\n}\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#arcgis-mapserver-layer","title":"ArcGIS MapServer layer","text":"<p>This layer type allows to render an ArcGIS MapServer layer.</p> <p>An ArcGIS MapServer source is a composition of different layers to create a map. The layer is identified by the <code>arcgis</code> type, containing <code>url</code> and <code>options.layers</code> properties . e.g.</p> <pre><code>{\n\"type\": \"arcgis\",\n\"url\": \"https://arcgis-example/rest/services/MyService/MapServer\",\n\"options\": {\n\"layers\": [{ \"id\": 0 }, { \"id\": 1 }]\n},\n\"title\": \"Title\",\n\"group\": \"\",\n\"visibility\": true\n}\n</code></pre> <p>Where:</p> <ul> <li><code>url</code> is the URL of the MapServer source.</li> <li><code>options.layers</code> is the list of object containing the ids of the layers. Required to support <code>queriable</code> option and legend support.</li> <li><code>name</code> (optional). When present, the MapStore layer will show only the layer with the id specified in the <code>name</code> attribute. e.g.</li> </ul> <pre><code>{\n\"type\": \"arcgis\",\n\"name\": \"0\",\n\"url\": \"https://arcgis-example/rest/services/MyService/MapServer\"\n\"url\": \"https://arcgis-example/rest/services/MyService/MapServer\",\n\"options\": {\n\"layers\": [{ \"id\": 0 }, { \"id\": 1 }]\n},\n\"title\": \"Title\",\n\"group\": \"\",\n\"visibility\": true,\n\"queriable\": true\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#layer-groups","title":"Layer groups","text":"<p>Inside the map configuration, near the <code>layers</code> entry, you can find also the <code>groups</code> entry. This array contains information about the groups in the TOC. A group entry has this shape:</p> <ul> <li><code>id</code>: the id of the group.</li> <li><code>expanded</code>: boolean that keeps the status (expanded/collapsed) of the group.</li> <li><code>title</code>: a string or an object (for i18n) with the title of the group. i18n object format is the same of layer's title.</li> </ul> <pre><code>\"title\": {\n\"default\": \"Root Group\",\n\"it-IT\": \"Gruppo radice\",\n\"en-US\": \"Root Group\",\n\"de-DE\": \"Wurzelgruppe\",\n\"fr-FR\": \"Groupe Racine\",\n\"es-ES\": \"Grupo Ra\u00edz\"\n},\n</code></pre> <p>i.e.</p> <pre><code>{\n\"id\": \"GROUP_ID\",\n\"title\": \"Some default title\"\n\"expanded\": true\n}\n</code></pre>"},{"location":"developer-guide/maps-configuration/#other-supported-formats","title":"Other supported formats","text":"<p>The JSON format above is the standard MapStore format. Anyway MapStore allows to import/export different kinds of formats for maps.</p>"},{"location":"developer-guide/maps-configuration/#web-map-context","title":"Web Map Context","text":"<p>MapStore provides support for OGC Web Map Context(WMC) files. They can be imported either using Import plugin functionality, or from within a context using Map Templates plugin. MapStore maps can also be exported in WMC format through Export plugin.</p> <p>The important thing to remember when exporting MapStore maps to WMC format is that it only supports WMS layers, meaning any non-WMS layers(such as tiled OSM backgrounds for example) will not be preserved in the resulting WMC file. The exact way in which the conversion happens is described in further detail throughout this document.</p>"},{"location":"developer-guide/maps-configuration/#wmc-file-structure","title":"WMC File Structure","text":"<p>WMC context file generated by MapStore is an XML file with the following structure:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ViewContext xmlns=\"http://www.opengis.net/context\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"1.1.0\" xsi:schemaLocation=\"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd\"&gt;\n&lt;General&gt;\n&lt;Title&gt;MapStore Context&lt;/Title&gt;\n&lt;Abstract&gt;This is a map exported from MapStore2.&lt;/Abstract&gt;\n&lt;BoundingBox minx=\"-20037508.34\" miny=\"-20037508.34\" maxx=\"20037508.34\" maxy=\"20037508.34\" SRS=\"EPSG:900913\"/&gt;\n&lt;Extension&gt;\n&lt;!--general extensions go here--&gt;\n&lt;/Extension&gt;\n&lt;/General&gt;\n&lt;LayerList&gt;\n&lt;Layer queryable=\"0\" hidden=\"0\"&gt;\n&lt;Name&gt;topp:states&lt;/Name&gt;\n&lt;Title&gt;USA Population&lt;/Title&gt;\n&lt;Server service=\"OGC:WMS\" version=\"1.3.0\"&gt;\n&lt;OnlineResource xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:type=\"simple\" xlink:href=\"https://demo.geo-solutions.it/geoserver/wms\"/&gt;\n&lt;/Server&gt;\n&lt;DimensionList&gt;\n&lt;Dimension name=\"elevation\" units=\"EPSG:5030\" unitSymbol=\"m\" default=\"0.0\" multipleValues=\"1\"&gt;0.0,200.0,400.0,600.0&lt;/Dimension&gt;\n&lt;Dimension name=\"time\" units=\"ISO8601\" default=\"current\" multipleValues=\"1\"&gt;2016-02-23T03:00:00.000Z,2016-02-23T06:00:00.000Z&lt;/Dimension&gt;\n&lt;!--...other dimensions--&gt;\n&lt;/DimensionList&gt;\n&lt;FormatList&gt;\n&lt;Format current=\"1\"&gt;image/png&lt;/Format&gt;\n&lt;!--...other formats--&gt;\n&lt;/FormatList&gt;\n&lt;StyleList&gt;\n&lt;Style&gt;\n&lt;Name&gt;population&lt;/Name&gt;\n&lt;Title&gt;Population in the United States&lt;/Title&gt;\n&lt;LegendURL width=\"81\" height=\"80\" format=\"image/png\"&gt;\n&lt;OnlineResource xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:type=\"simple\" xlink:href=\"https://demo.geo-solutions.it:443/geoserver/topp/states/ows?service=WMS&amp;amp;request=GetLegendGraphic&amp;amp;format=image%2Fpng&amp;amp;width=20&amp;amp;height=20&amp;amp;layer=states\"/&gt;\n&lt;/LegendURL&gt;\n&lt;/Style&gt;\n&lt;!--...other styles--&gt;\n&lt;/StyleList&gt;\n&lt;Extension&gt;\n&lt;!--layer extensions go here--&gt;\n&lt;/Extension&gt;\n&lt;!--...other layers--&gt;\n&lt;/LayerList&gt;\n&lt;/ViewContext&gt;\n</code></pre> <p>More information about each of the elements in the example above can be looked up in OGC WMC implementation specification</p> <p>Apart from standard WMC XML elements, MapStore provides support for various extensions. These are placed inside <code>Extension</code> tag, and are not gueranteed to be supported outside MapStore, as they are not a part of OGC Web Map Context specification. MapStore provides two types of extensions: openlayers and mapstore-specific elements. WMC can have an <code>Extension</code> element inside <code>General</code>, and each of the <code>Layer</code> elements. Supported extensions in <code>General</code> are:</p> <p>Openlayers:</p> <ul> <li><code>maxExtent</code> if present, it's attributes are used as map's bounding box, instead of the values specified in <code>BoundingBox</code> tag. The values are assumed to be in a projection, specified in SRS attribute of <code>BoundingBox</code></li> </ul> <pre><code>&lt;ol:maxExtent xmlns:ol=\"http://openlayers.org/context\" minx=\"-20037508.34\" miny=\"-20037508.34\" maxx=\"20037508.34\" maxy=\"20037508.34\"/&gt;\n</code></pre> <p>MapStore specific:</p> <ul> <li><code>GroupList</code> defines a mapstore group list. Contains <code>Group</code> elements that describe a particular layer group:</li> </ul> <pre><code>&lt;ms:GroupList xmlns:ms=\"https://mapstore.geosolutionsgroup.com/mapstore/context\"&gt;\n&lt;ms:Group xmlns:ms=\"https://mapstore.geosolutionsgroup.com/mapstore/context\" id=\"Default\" title=\"Default\" expanded=\"true\"/&gt;\n&lt;/ms:GroupList&gt;\n</code></pre> <ul> <li><code>center</code> defines a center of map view</li> </ul> <pre><code>&lt;ms:center xmlns:ms=\"https://mapstore.geosolutionsgroup.com/mapstore/context\" x=\"1.5\" y=\"2.5\" crs=\"EPSG:3857\"/&gt;\n</code></pre> <ul> <li><code>zoom</code> map zoom level</li> </ul> <pre><code>&lt;ms:zoom xmlns:ms=\"https://mapstore.geosolutionsgroup.com/mapstore/context\"&gt;7&lt;/ms:zoom&gt;\n</code></pre> <p>Supported extensions for each <code>Layer</code> element are:</p> <p>Openlayers:</p> <ul> <li><code>maxExtent</code> if present, used for the value of layer's bbox. Values are assumed to be in a projection, specified in SRS attribute of \"BoundingBox\"</li> <li><code>singleTile</code> specifies layer's \"singleTile\" property value</li> <li><code>transparent</code> is layer transparent or not, true by default</li> <li><code>isBaseLayer</code> if true, the layer is put into \"backgrounds\" group</li> <li><code>opacity</code> layer's opacity value</li> </ul> <pre><code>&lt;ol:maxExtent xmlns:ol=\"http://openlayers.org/context\" minx=\"-13885038.382960921\" miny=\"2870337.130793682\" maxx=\"-7455049.489182421\" maxy=\"6338174.0557576185\"/&gt;\n&lt;ol:singleTile xmlns:ol=\"http://openlayers.org/context\"&gt;false&lt;/ol:singleTile&gt;\n&lt;ol:transparent xmlns:ol=\"http://openlayers.org/context\"&gt;true&lt;/ol:transparent&gt;\n&lt;ol:isBaseLayer xmlns:ol=\"http://openlayers.org/context\"&gt;false&lt;/ol:isBaseLayer&gt;\n&lt;ol:opacity xmlns:ol=\"http://openlayers.org/context\"&gt;1&lt;/ol:opacity&gt;\n</code></pre> <p>Cesium:</p> <ul> <li><code>tileDiscardPolicy</code> sets a policy for discarding (missing/broken) tiles (https://cesium.com/learn/cesiumjs/ref-doc/TileDiscardPolicy.html). If it is not specified the NeverTileDiscardPolicy will be used. If \"none\" is specified, no policy at all will be set.</li> </ul> <p>MapStore specific:</p> <ul> <li><code>group</code> specifies to which group, among listed in \"GroupList\" element, the layer belongs to</li> <li><code>search</code> JSON describing a filter that is applied to the layer</li> <li><code>DimensionList</code> contains <code>Dimension</code> elements that describe dimensions that cannot be described using standard \"Dimension\" tag. Currently supports dimensions of multidim-extension type:</li> <li><code>CatalogServices</code> contains <code>Service</code> elements that describe services available for use in Catalog.</li> </ul> <pre><code>&lt;ms:DimensionList xmlns:ms=\"https://mapstore.geosolutionsgroup.com/mapstore/context\"&gt;\n&lt;ms:Dimension xmlns:ms=\"https://mapstore.geosolutionsgroup.com/mapstore/context\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" name=\"time\" type=\"multidim-extension\" xlink:type=\"simple\" xlink:href=\"https://cloudsdi.geo-solutions.it/geoserver/gwc/service/wmts\"/&gt;\n&lt;/ms:DimensionList&gt;\n&lt;ms:CatalogServices selectedService=\"gs_stable_csw\"&gt;\n&lt;ms:Service serviceName=\"gs_stable_csw\"&gt;\n&lt;ms:Attribute name=\"url\" type=\"string\"&gt;https://gs-stable.geosolutionsgroup.com/geoserver/csw&lt;/ms:Attribute&gt;\n&lt;ms:Attribute name=\"type\" type=\"string\"&gt;csw&lt;/ms:Attribute&gt;\n&lt;ms:Attribute name=\"title\" type=\"string\"&gt;GeoSolutions GeoServer CSW&lt;/ms:Attribute&gt;\n&lt;ms:Attribute name=\"autoload\" type=\"boolean\"&gt;true&lt;/ms:Attribute&gt;\n&lt;/ms:Service&gt;\n&lt;ms:Service serviceName=\"gs_stable_wms\"&gt;\n&lt;ms:Attribute name=\"url\" type=\"string\"&gt;https://gs-stable.geosolutionsgroup.com/geoserver/wms&lt;/ms:Attribute&gt;\n&lt;ms:Attribute name=\"type\" type=\"string\"&gt;wms&lt;/ms:Attribute&gt;\n&lt;ms:Attribute name=\"title\" type=\"string\"&gt;GeoSolutions GeoServer WMS&lt;/ms:Attribute&gt;\n&lt;ms:Attribute name=\"autoload\" type=\"boolean\"&gt;false&lt;/ms:Attribute&gt;\n&lt;/ms:Service&gt;\n&lt;ms:Service serviceName=\"gs_stable_wmts\"&gt;\n&lt;ms:Attribute name=\"url\" type=\"string\"&gt;https://gs-stable.geosolutionsgroup.com/geoserver/gwc/service/wmts&lt;/ms:Attribute&gt;\n&lt;ms:Attribute name=\"type\" type=\"string\"&gt;wmts&lt;/ms:Attribute&gt;\n&lt;ms:Attribute name=\"title\" type=\"string\"&gt;GeoSolutions GeoServer WMTS&lt;/ms:Attribute&gt;\n&lt;ms:Attribute name=\"autoload\" type=\"boolean\"&gt;false&lt;/ms:Attribute&gt;\n&lt;/ms:Service&gt;\n&lt;/ms:CatalogServices&gt;\n</code></pre> <p>Note, that during the exporting process, some sort of fallback for dimensions, listed as extensions, is provided inside the standard <code>DimensionList</code> tag whenever possible, to ensure interoperability with other geospatial software. When such a context is imported back into MapStore, the values of dimensions inside extensions will override the ones specified inside the standard <code>DimensionList</code> tag.</p> <p>Also note, that the extension elements would be read correctly only if they belong to appropriate XML namespaces:</p> <ul> <li><code>http://openlayers.org/context</code> for openlayers extensions</li> <li><code>https://mapstore.geosolutionsgroup.com/mapstore/context</code> for mapstore specific extensions</li> </ul>"},{"location":"developer-guide/maps-configuration/#usage-inside-maptemplates-plugin","title":"Usage inside MapTemplates plugin","text":"<p>As stated previously, WMC files can be used as map templates inside contexts. New WMC templates can be uploaded in context creation tool, after enabling the MapTemplates plugin for a context. When the context is loaded, for every template inside MapTemplates there are two options available:</p> <ul> <li><code>Replace map with this template</code> replace the currently loaded map with the one described by the template. Upon loading, the map will zoom to the extent specified in <code>maxExtent</code> extension or in <code>BoundingBox</code> tag. If the template has no visible background layers available, the default empty background will be added and set to be visible automatically.</li> <li><code>Add this template to map</code> merges layers and groups inside the template with the current map configuration. If the WMC template does not contain <code>GroupList</code> extension, a new group with the name extracted from <code>Title</code> tag of the template will be created and will contain all the layers of the template. Zoom and projection will remain unchanged.</li> </ul>"},{"location":"developer-guide/maps-configuration/#other-considerations","title":"Other considerations","text":"<p>Due to the limitations posed by WMC format the conversion process will not preserve the map state in it's entirety. The only supported way to do this is to export to MapStore JSON format. The WMC export option presumably should be used in cases when the WMS layers inside a MapStore map need to be used in some way with a different geospatial software suite, or to import such layers from outside MapStore or if you already have WMC context files that you want to use.</p>"},{"location":"developer-guide/maps-configuration/#additional-map-configuration-options","title":"Additional map configuration options","text":"<p>Map configuration also contains the following additional options:</p> <ul> <li><code>catalogServices</code> object describing services configuration for Catalog</li> <li><code>widgetsConfig</code> configuration of map widgets</li> <li><code>mapInfoConfiguration</code> map info configuration options</li> <li><code>dimensionData</code> contains map time information</li> <li><code>currentTime</code> currently selected time; the beginning of a time range if offsetTime is set</li> <li><code>offsetTime</code> the end of a time range</li> <li><code>timelineData</code> timeline options</li> <li><code>selectedLayer</code> selected layer id; if not present time cursor will be unlocked</li> <li><code>mapViews</code> map views options</li> </ul>"},{"location":"developer-guide/maps-configuration/#mapviews","title":"mapViews","text":"<p>Example:</p> <pre><code>{\n\"mapViews\": {\n\"active\": true,\n\"selectedId\": \"view.id.01\",\n\"views\": [\n{\n\"id\": \"view.id.01\",\n\"title\": \"Title\",\n\"description\": \"&lt;p&gt;Description&lt;/p&gt;\",\n\"duration\": 10,\n\"flyTo\": true,\n\"center\": {\n\"longitude\": 8.93690091201193,\n\"latitude\": 44.39522451776296,\n\"height\": -0.0022900843616703204\n},\n\"cameraPosition\": {\n\"longitude\": 8.93925651181738,\n\"latitude\": 44.38698231953802,\n\"height\": 655.705914040523\n},\n\"zoom\": 17.89659156734602,\n\"bbox\": [\n8.920925393119584,\n44.39084055670365,\n8.948118718933738,\n44.40554444092288\n],\n\"mask\": {\n\"enabled\": true,\n\"resourceId\": \"resource.id.01\",\n\"inverse\": true,\n\"offset\": 10000\n},\n\"terrain\": {\n\"clippingLayerResourceId\": \"resource.id.02\",\n\"clippingPolygonFeatureId\": \"feature.id.01\",\n\"clippingPolygonUnion\": true\n},\n\"globeTranslucency\": {\n\"enabled\": true,\n\"fadeByDistance\": false,\n\"nearDistance\": 500,\n\"farDistance\": 50000,\n\"opacity\": 0.5\n},\n\"layers\": [\n{\n\"id\": \"layer.id.01\",\n\"visibility\": true,\n\"opacity\": 0.5\n},\n{\n\"id\": \"layer.id.04\",\n\"visibility\": true,\n\"clippingLayerResourceId\": \"resource.id.02\",\n\"clippingPolygonFeatureId\": \"feature.id.01\",\n\"clippingPolygonUnion\": false\n}\n]\n}\n],\n\"resources\": [\n{\n\"id\": \"resource.id.01\",\n\"data\": {\n\"type\": \"vector\",\n\"name\": \"mask\",\n\"title\": \"Mask\",\n\"id\": \"layer.id.02\"\n}\n},\n{\n\"id\": \"resource.id.02\",\n\"data\": {\n\"type\": \"wfs\",\n\"url\": \"/service/wfs\",\n\"name\": \"clip\",\n\"title\": \"Clip\",\n\"id\": \"layer.id.03\"\n}\n}\n]\n}\n}\n</code></pre> <p>The mapViews properties</p> Name Type Description active boolean if true the map view tool will be active at initialization selectedId string id of the selected view views array array of views configurations (see below) resources array resources configurations (see below) <p>View configuration object</p> Name Type Description id string identifier of the view title string title of the view description string an html string to describe the view duration number when playing, duration in seconds of the view flyTo boolean enable animation transition during navigation center object center target position as cameraPosition object point of view position as zoom number zoom level bbox array bounding box in WGS84 as [minx, miny, maxx, maxy] mask object optional configuration for the 3D tiles mask mask.enabled boolean if true enables the mask mask.resourceId string identifier of a resource configuration in the <code>resources</code> array mask.inverse boolean if true enables the inverse mask mask.offset number offset in meters for the inverse mask terrain object optional configurations for terrain clipping terrain.clippingLayerResourceId string identifier of a resource configuration in the <code>resources</code> array terrain.clippingPolygonFeatureId string identifier of a polygonal feature available in the selected layer source to use to apply the clipping terrain.clippingPolygonUnion boolean if true it applies inverse clipping globeTranslucency object optional configuration for the globe translucency globeTranslucency.enabled boolean if true enables translucency globeTranslucency.opacity number opacity of the globe translucency, it should be a value between 0 and 1 where 1 is fully opaque globeTranslucency.fadeByDistance boolean if true the translucency is visible only between the <code>nearDistance</code> and <code>farDistance</code> values globeTranslucency.nearDistance number when <code>fadeByDistance</code> is true it indicates the minimum distance to apply translucency globeTranslucency.farDistance number when <code>fadeByDistance</code> is true it indicates the maximum distance to apply translucency layers array array of layer configuration overrides, default properties override <code>visibility</code> and <code>opacity</code> <p>Resource object configuration</p> Name Type Description id string identifier for the resource data object properties related to the layer used for the resource (wfs or vector type)"},{"location":"developer-guide/mapstore-migration-guide/","title":"Migration Guidelines","text":""},{"location":"developer-guide/mapstore-migration-guide/#general-update-checklist","title":"General update checklist","text":"<ul> <li>updating an existing installation</li> <li>updating a MapStore project created for a previous version</li> </ul> <p>To update an existing installation you usually have to do nothing except eventually to execute queries on your database to update the changes to the database schema.</p> <p>In case of a project it becomes a little more complicated, depending on the customization.</p> <p>This is a list of things to check if you want to update from a previous version valid for every version.</p> <ul> <li>Take a list to migration notes below for your version</li> <li>Take a look to the release notes</li> <li>update your <code>package.json</code> to latest libs versions</li> <li>take a look at your custom files to see if there are some changes (e.g. <code>localConfig.js</code>, <code>proxy.properties</code>)</li> <li>Some changes that may need to be ported could be present also in <code>pom.xml</code> files and in <code>configs</code> directory.</li> <li>check for changes also in <code>web/src/main/webapp/WEB-INF/web.xml</code>.</li> <li>Optionally check also accessory files like <code>.eslinrc</code>, if you want to keep aligned with lint standards.</li> <li>Follow the instructions below, in order, from your version to the one you want to update to.</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20240102-to-20240200","title":"Migration from 2024.01.02 to 2024.02.00","text":""},{"location":"developer-guide/mapstore-migration-guide/#nodejs-and-npm-update","title":"NodeJS and NPM update","text":"<p>From this version the recommended version to build MapStore or for development is Node 20 (minimum version will be Node 16). Please update your Node version accordingly on your develop machine or CI/CD.</p> <p>See the requirements section of the documentation for the details.</p> <p>The same for projects of derived <code>MapStoreExtensions</code>. Make sure to:</p> <ul> <li>Update <code>package.json</code> with the new versions of webpack and other dependencies.</li> <li>Remove and regenerate your <code>package-lock.json</code> with <code>npm install</code> after updating the Node version.</li> </ul> <p>Here the diff used for MapStore Extensions to update the <code>package.json</code> file:</p> <pre><code>diff --git a/package.json b/package.json\nindex 62ddda0..62ce070 100644\n--- a/package.json\n+++ b/package.json\n@@ -44,6 +44,7 @@\n    \"@geosolutions/jsdoc\": \"3.4.4\",\n     \"@geosolutions/mocha\": \"6.2.1-3\",\n     \"@mapstore/eslint-config-mapstore\": \"1.0.5\",\n+    \"@testing-library/react\": \"12.1.5\",\n    \"axios-mock-adapter\": \"1.16.0\",\n     \"babel-loader\": \"8.0.5\",\n     \"babel-plugin-add-module-exports\": \"0.1.4\",\n@@ -66,8 +67,8 @@\n    \"expect\": \"1.20.1\",\n     \"file-loader\": \"2.0.0\",\n     \"glob\": \"7.1.1\",\n-        \"html-loader\": \"0.5.1\",\n-        \"html-webpack-plugin\": \"4.5.0\",\n+    \"html-loader\": \"2.0.0\",\n+    \"html-webpack-plugin\": \"5.2.0\",\n    \"jsdoc-jsx\": \"0.1.0\",\n     \"karma\": \"6.4.0\",\n     \"karma-chrome-launcher\": \"3.1.1\",\n@@ -104,9 +105,10 @@\n    \"rimraf\": \"2.5.2\",\n     \"simple-git\": \"2.20.1\",\n     \"style-loader\": \"2.0.0\",\n+    \"terser\": \"5.18.1\",\n    \"url-loader\": \"0.5.7\",\n     \"vusion-webfonts-generator\": \"0.4.1\",\n-        \"webpack\": \"5.9.0\",\n+    \"webpack\": \"5.54.0\",\n    \"webpack-bundle-size-analyzer\": \"2.0.2\",\n     \"webpack-cli\": \"4.10.0\",\n     \"webpack-dev-server\": \"3.11.0\",\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#java-dependencies-update","title":"Java dependencies update","text":"<p>Some libraries has been updated. if you have a MapStore project make sure to keep the versions aligned with the main product.</p>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20240100-to-20240102","title":"Migration from 2024.01.00 to 2024.01.02","text":""},{"location":"developer-guide/mapstore-migration-guide/#enable-showing-creditsattribution-text-in-print-config","title":"Enable showing credits/attribution text in Print config","text":"<p>Due to showing layers' credits/attributions of printed map which will be displayed at the bottom of the map section, the MapStore <code>config.yaml</code> file should be reviewed and updated. Below are reported the relevant changes that need to be applied also to <code>config.yaml</code> of MapStore downstream projects where the printing engine is present.</p> <ul> <li>Added a section for credits into <code>config.yaml</code> file at the end of the mainPage for each layout, for more details see here</li> <li>In this added section, proper values for <code>absoluteX</code> and <code>absoluteY</code> should be applied to be consistent with overall layout</li> <li>There are some edits to the value of <code>absoluteY</code> for the section located directly above credit/attribution section based on the layout</li> </ul> <p>example:</p> <pre><code>    mainPage:\n....\nitems:\n....\n- !columns\nabsoluteX: 42\nabsoluteY: 35\nwidth: 1111\nitems:\n- !text\nalign: left\nvertAlign: middle\nfontSize: 6\ntext: '${credits}'\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#option-to-hide-the-group-info-of-logged-in-user-from-user-details-modal-window","title":"Option to hide the group info of logged in user from user details modal window","text":"<p>Recently, we have added the option to hide the <code>user group info</code> from the user details modal. To enable this, you have to add a cfg in all <code>Login</code> plugin into <code>localConfig.json</code> like:</p> <pre><code>{\n\"name\": \"Login\",\n\"cfg\": { \"toolsCfg\": [{\"hideGroupUserInfo\": true}] }\n}\n</code></pre> <p>where the first index of toolsCfg is for <code>userDetails</code> component that is responsible for displaying the user details including <code>user group info</code></p> <p>!!! note important notes should be considered:</p> <ul> <li>if you have customized the Login plugin and in particular the order of toolsCfg, make sure to override the correct one as the propagation of cfg for the tools is based on index value.</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#integration-with-openid-connect","title":"Integration with openID Connect","text":"<p>A generic OpenID Connect (OIDC) authentication support has been introduced in MapStore. This feature allows to authenticate users using an OIDC provider, like Keycloak, Okta, Google, Azure, etc.</p> <p>To provide this functionality, it is necessary to update the project's <code>geostore-spring-security.xml</code> file, if the default one is not used. If you are using the default one, you can skip this step.</p> <p>Here the changes to apply if needed:</p> <pre><code>@@ -24,6 +24,7 @@\n        &lt;security:custom-filter ref=\"sessionTokenProcessingFilter\" after=\"FORM_LOGIN_FILTER\"/&gt;\n         &lt;security:custom-filter ref=\"keycloakFilter\" before=\"BASIC_AUTH_FILTER\"/&gt;\n         &lt;security:custom-filter ref=\"googleOpenIdFilter\" after=\"BASIC_AUTH_FILTER\"/&gt;\n+        &lt;security:custom-filter ref=\"oidcOpenIdFilter\" before=\"OPENID_FILTER\"/&gt; &lt;!-- ADD a filter with this ref --&gt;\n        &lt;security:anonymous /&gt;\n     &lt;/security:http&gt;\n\n@@ -52,6 +53,7 @@\n\n    &lt;!-- OAuth2 beans --&gt;\n     &lt;context:annotation-config/&gt;\n+    &lt;bean id=\"oidcSecurityConfiguration\" class=\"it.geosolutions.geostore.services.rest.security.oauth2.openid_connect.OpenIdConnectSecurityConfiguration\"/&gt; &lt;!-- add this bean to configure the integration --&gt;\n\n    &lt;bean id=\"googleSecurityConfiguration\" class=\"it.geosolutions.geostore.services.rest.security.oauth2.google.OAuthGoogleSecurityConfiguration\"/&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20230202-to-20240100","title":"Migration from 2023.02.02 to 2024.01.00","text":""},{"location":"developer-guide/mapstore-migration-guide/#toc-plugin-refactor","title":"TOC plugin refactor","text":"<p>The table of content (TOC) has been refactored with following changes:</p> <ul> <li>Removal of hardcoded tools from the toolbar. Now all the toolbar's elements are injected by related plugins. This includes also the introduction of a new plugin called <code>MetadataInfo</code> for layer metadata.</li> <li>Refactors of TOC components</li> <li>Review of plugin configuration (cfg). List of changed configuration properties:</li> <li><code>activateSettingsTool</code> removed property, now the button will be added directly from <code>TOCItemsSettings</code> when available</li> <li><code>activateQueryTool</code> removed property, now the button will be directly added by <code>FilterLayer</code> plugin, when available</li> <li><code>activateDownloadTool</code> removed property, now the button will be added directly from <code>LayerDownload</code> when available</li> <li><code>activateMetedataTool</code> removed property, now the button will be added directly from <code>MetadataInfo</code> when availables</li> <li><code>checkPlugins</code> remove property, now availability of tools rely on the related plugin so this check is not needed anymore</li> <li><code>showFullTitleOnExpand</code>  removed property, the new style allows for seeing the full title inline without duplicating it</li> <li><code>metadataTemplate</code> this configuration has been moved to <code>MetadataInfo</code> plugin</li> <li><code>metadataOptions</code> this configuration has been moved to <code>MetadataInfo</code> plugin</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#introduction-of-metadatainfo-plugin","title":"Introduction of MetadataInfo plugin","text":"<p>The <code>MetadataInfo</code> plugin has been introduced to include the layer metadata info button of the TOC toolbar has separated plugin as expected by the new TOC. Some steps are needed to correctly configure it:</p> <ul> <li>Ensure to import the <code>MetadataInfo</code> plugin in the downstream project</li> <li>Include the plugin definition in the <code>pluginsConfig.json</code> to make it available inside contexts</li> <li>Move the related configuration (cfg) from the TOC to the <code>MetadataInfo</code> plugin definition in <code>localConfig.json</code> file. This is only necessary if the layer metadata button was configured at the application level</li> <li>Update your contexts to use <code>MetadataInfo</code> plugin, properly configured, when needed</li> </ul> <p>expected changes in the <code>pluginsConfig.json</code> file:</p> <ul> <li>add <code>MetadataInfo</code> entry to the list</li> </ul> <pre><code>{\n\"name\": \"MetadataInfo\"\n}\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#maven-project-update","title":"Maven project update","text":"<p>With this release the maven <code>pom.xml</code> files has been restructured to centralize dependencies version in the <code>dependencyManagement</code> section and then in some properties in the root <code>pom.xml</code> file. This regards also the projects that now hold the versions of the dependencies in the properties section. Your projects will work in any case, but we suggest to update your <code>pom.xml</code> files to align them to the new structure (see template file in the MapStore2 repository for more details).</p>"},{"location":"developer-guide/mapstore-migration-guide/#database-update","title":"Database update","text":"<p>The resource metadata has been recently extented to include  information about resource creator and editor and to provide the advertises/unadvertised resource functionalities. If your installation has the database creation mode set to <code>update</code> (the default), the columns will be added automatically and you do not have to do any action. If it is set to <code>validate</code> instead you will have to run the update scripts.</p> <p>In any case, the update scripts contain also a part to populate the <code>creator</code> column, that can not be applied automatically with  database creation mode set to <code>update</code>. So if you want to see this information, even if it is not strictily required, you will have to run the migration scripts anyway.</p> <ul> <li> <p>For script reference see:</p> <p>postgresql migration script 2.0.0 to 2.1.0</p> <p>h2 migration script 2.0.0 to 2.1.0</p> <p>oracle migration script 2.0.0 to 2.1.0</p> </li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#restructuring-of-login-and-home-in-dashboard-page","title":"Restructuring of Login and Home in Dashboard page","text":"<p>We recently added the sidebar to the dashboard page and by doing so we wanted to keep a uniform position of login and home plugins, by putting them in the omnibar container rather than the sidebar one. The viewer is a specific case that will be reviewed in the future.</p> <p>In order to align the configuration of the two mentioned plugin you have to:</p> <ul> <li>edit <code>localConfig.json</code> <code>plugins.dashboard</code> section</li> <li>remove <code>BurgerMenu</code>, <code>Home</code> and <code>Login</code> items</li> <li>add the following</li> </ul> <pre><code>\"Details\",\n\"AddWidgetDashboard\",\n\"MapConnectionDashboard\",\n{\n\"name\": \"SidebarMenu\",\n\"cfg\": {\n\"containerPosition\": \"columns\"\n}\n},\n{\n\"name\": \"Home\",\n\"override\": {\n\"OmniBar\": {\n\"priority\": 5\n}\n}\n},\n{\n\"name\": \"Login\",\n\"override\": {\n\"OmniBar\": {\n\"priority\": 5\n}\n}\n},\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#using-elevation-layer-type-instead-of-wms-layer-with-useforelevation-property","title":"Using <code>elevation</code> layer type instead of wms layer with useForElevation property","text":"<p>The wms layer with <code>useForElevation</code> property is deprecated and a <code>elevation</code> layer introduced in substitution. The new <code>elevation</code> layer is used only to display height information inside the mouse position plugin and it will not provide a support for terrain model of the 3D visualziation mode. In order to provide this support, you need to add a <code>terrain</code> layer too. See documentation about Elevation layer and Terrain layer for more details. A configuration update example:</p> <pre><code>{\n    \"name\": \"Map\",\n    \"cfg\": {\n        \"additionalLayers\": [\n            {\n-               \"type\": \"wms\",\n+               \"type\": \"elevation\",\n               \"url\": \"/geoserver/wms\",\n                \"name\": \"workspace:layername\",\n-               \"format\": \"application/bil16\",\n               \"visibility\": true,\n-               \"useForElevation\": true,\n               \"littleEndian\": false\n            },\n            // only needed for 3D terrain\n+           {\n+               \"type\": \"terrain\",\n+               \"provider\": \"wms\",\n+               \"url\": \"/geoserver/wms\",\n+               \"name\": \"workspace:layername\",\n+               \"littleEndian\": false,\n+               \"visibility\": true,\n+               \"crs\": \"CRS:84\"\n           }\n        ]\n    }\n}\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#removing-possibility-to-add-custom-fonts-to-the-map","title":"Removing possibility to add custom fonts to the Map","text":"<p>From this version we limited the load of the font to FontAwesome.</p> <p>If you have changed the property fonts inside Map plugin it will not longer load the font. A possible fix would be to add the font to the <code>*.html</code> files in your application.</p> <ul> <li>make sure that the <code>localConfig.json</code> does not have fonts property in  Map  plugin</li> </ul> <p>The following css is added automatically if needed <code>&lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\"/&gt;</code> inside the head tag.</p>"},{"location":"developer-guide/mapstore-migration-guide/#fixing-background-config","title":"Fixing background config","text":"<p>From this version in order to fix default 3d background config a change is needed here:</p> <ul> <li>update <code>localConfig.json</code> by adding visibility: false  to the Empty Background entry in <code>intialState.defaultState.catalog.default.staticServices.default_map_backgrounds.backgrounds</code></li> <li>update <code>new.json</code> by adding visibility: false  to the Empty Background entry.</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#adding-spatial-filter-to-dashboard-widgets","title":"Adding spatial filter to dashboard widgets","text":"<p>In order to enable the possibility to add in and the spatial filter to the widgets ( see #9098 ) you have to edit the <code>QueryPanel</code> config in the <code>plugins.dashboard</code> array of the <code>localConfig.json</code> file by adding:</p> <ul> <li>useEmbeddedMap: flag to enable the embedded map</li> <li>spatialOperations: The list of spatial operations allowed for this plugin</li> <li>spatialMethodOptions: the list of spatial methods to use.</li> </ul> <pre><code>...\n\"dashboard\": [\n...\n{\n\"name\": \"QueryPanel\",\n\"cfg\": {\n\"toolsOptions\": {\n\"hideCrossLayer\": true,\n\"useEmbeddedMap\": true\n},\n\"spatialPanelExpanded\": false,\n\"spatialOperations\": [\n{\"id\": \"INTERSECTS\", \"name\": \"queryform.spatialfilter.operations.intersects\"},\n{\"id\": \"CONTAINS\", \"name\": \"queryform.spatialfilter.operations.contains\"},\n{\"id\": \"WITHIN\", \"name\": \"queryform.spatialfilter.operations.within\"}\n],\n\"spatialMethodOptions\": [\n{\"id\": \"BBOX\", \"name\": \"queryform.spatialfilter.methods.box\"},\n{\"id\": \"Circle\", \"name\": \"queryform.spatialfilter.methods.circle\"},\n{\"id\": \"Polygon\", \"name\": \"queryform.spatialfilter.methods.poly\"}\n],\n\"containerPosition\": \"columns\"\n}\n}\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#mapfish-print-update","title":"MapFish Print update","text":"<p>The MapFish Print library has been updated to work with the latest GeoTools version and Java 11 as well as being aligned with the same dependency used by the official GeoServer printing extension (see this issue https://github.com/geosolutions-it/mapfish-print/issues/65) For this reason, if you are using the printing plugin in your project you have to update it by following the following steps:</p> <ul> <li>Change the version of the mapfish-print dependency in the project <code>pom.xml</code> file:</li> </ul> <pre><code>                &lt;!-- mapfish-print --&gt;\n                &lt;dependency&gt;\n                    &lt;groupId&gt;org.mapfish.print&lt;/groupId&gt;\n                    &lt;artifactId&gt;print-lib&lt;/artifactId&gt;\n-                    &lt;version&gt;geosolutions-2.3-SNAPSHOT&lt;/version&gt;\n+                    &lt;version&gt;2.4-SNAPSHOT&lt;/version&gt;\n</code></pre> <ul> <li>Add the mvn repository where this library is hosted in the <code>repositories</code> section of the same <code>pom.xml</code> (usually in <code>web</code> folder of a project)</li> </ul> <pre><code>        &lt;repository&gt;\n            &lt;id&gt;osgeo-snapshot&lt;/id&gt;\n            &lt;name&gt;Open Source Geospatial Foundation Repository&lt;/name&gt;\n            &lt;url&gt;https://repo.osgeo.org/repository/snapshot/&lt;/url&gt;\n            &lt;snapshots&gt;\n                &lt;enabled&gt;true&lt;/enabled&gt;\n            &lt;/snapshots&gt;\n        &lt;/repository&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#print-config-file-update","title":"Print config file update","text":"<p>Due to the introduction of the new <code>Jackson Yaml</code> parser, the MapStore <code>config.yaml</code> file has been reviewed and updated. Below are reported all the relevant changes that need to be applied also to <code>config.yaml</code> of MapStore donwstream projects where the printing engine is present.</p> <p>Due to the new library being stricter on the format of the Yaml, some changes in the configuration files were made, to make them compliant with yaml format:</p> <ul> <li>Removed not allowed characters from property values (<code>@</code> in <code>@shared.privileged.geoserver.pass@</code>)</li> <li>Removed references without anchors (document declares link to <code>*commonFooter</code> but anchor <code>&amp;commonFooter</code> was not defined previously)</li> <li>Added a space between key\\value pairs (<code>\"absoluteX: 30\"</code> instead of <code>\"absoluteX:30\"</code>)</li> </ul> <p>Some additional updates has been provided due to parsing issue with the new library:</p> <pre><code>- !ipMatch\nhost: 127.0.0.1\n# Allow to all hosts\nmask: 0.0.0.0\n</code></pre> <p><code>!ipMatch</code> is mapped to AddressHostMatcher, which does not have host property. Should instead use ip property (e.g IP: 127.0.0.1)</p> <pre><code>- !text\nwidth: 300\ntext: '${comment}'\n...\n</code></pre> <p><code>!text</code> is mapped to TextBlock class. It does not have width property, so it should be removed.</p> <pre><code>lastPage:\nrotation: true\n...\n</code></pre> <p>lastPage is mapped to LastPage class, and does not have rotation property.</p>"},{"location":"developer-guide/mapstore-migration-guide/#annotations-plugin-refactor","title":"Annotations plugin refactor","text":"<p>The Annotation plugin has been updated to be supported also in 3D maps. This update introduced some changes:</p> <ul> <li>All the configurations related to the \"Annotations\" plugin has been removed from <code>localConfig.json</code> <code>defaultState</code> entry and moved to the <code>cfg</code> property of the plugin</li> <li>The annotations reducers is not needed anymore inside the default reducers of the app</li> </ul> <p>Please update by:</p> <ul> <li>Removing <code>annotations</code> entry from your <code>localConfig.json</code> <code>defaultState</code></li> <li>If you customized the app, you can remove the <code>annotations</code> reducer from default reducers.</li> <li>If some customizations were applied to the Annotations plugin in <code>defaultState</code>, apply these changes to the plugin configuration, following the documentation of the plugin.</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20230102-to-20230200","title":"Migration from 2023.01.02 to 2023.02.00","text":""},{"location":"developer-guide/mapstore-migration-guide/#about-plugin-cfg-changes","title":"About plugin cfg changes","text":"<p>Starting this release 2023.02.00 we have included a new cfg option the About plugin called githubUrl</p> <p>We suggest you to edit About plugin cfg of localConfig.json adding the following</p> <pre><code>{\n-    \"name\": \"About\"\n+    \"name\": \"About\",\n+    \"cfg\": {\n+      \"githubUrl\": \"https://github.com/GITHUB_USER/REPO_NAME/tree/\"\n+    }\n</code></pre> <p>inside <code>configs/pluginsConfig.json</code> you can add this to the About plugin definition</p> <pre><code>      \"name\": \"About\",\n      \"glyph\": \"info-sign\",\n      \"title\": \"plugins.About.title\",\n      \"description\": \"plugins.About.description\",\n      \"dependencies\": [\n        \"SidebarMenu\"\n-      ]\n+      ],\n+      \"defaultConfig\": {\n+        \"githubUrl\": \"https://github.com/GITHUB_USER/REPO_NAME/tree/\"\n+      }\n   },\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#nodejsnpm-upgrade","title":"NodeJS/NPM upgrade","text":"<p>In this release we updated all our systems to use node 16/NPM 8. This because Node 12 is actually out of maintenance. We are going to support soon more recent versions of NodeJS solving the related issues. So make you sure to use the correct version of NodeJS/NPM to build things correctly. See the requirements section of the document for the details.</p>"},{"location":"developer-guide/mapstore-migration-guide/#visualization-mode-in-map-configuration","title":"Visualization mode in map configuration","text":"<p>The map configuration stores the information related to the visualization mode 2D or 3D after saving a map. This update include also following changes:</p> <ul> <li><code>maptype</code> default state configuration inside the initialState of <code>localConfig.json</code> needs to be removed. If a MapStore project needs a particular setup (eg. use only OpenLayers for 2D maps, initialize the app in 3D, ...) it is possible to override the default map libraries configuration with the new <code>mapType</code> property in the <code>localConfig.json</code> file, see documentation here.</li> </ul> <pre><code>{\n    // ...\n    \"initialState\": {\n        \"defaultState\": {\n            // ...\n-           \"maptype\": {\n-               \"mapType\": \"{context.mode === 'desktop' ? 'openlayers' : 'leaflet'}\"\n-           },\n           // ...\n        }\n    }\n    // ...\n}\n</code></pre> <ul> <li> <p>the <code>changeMapType</code> action has been deprecated in favor of the <code>changeVisualizationMode</code> action</p> </li> <li> <p>the application does not expose the pathname of the viewer with <code>mapType</code> anymore. Example: the old path <code>/viewer/openlayers/1</code> becomes <code>/viewer/1</code></p> </li> <li> <p>the app pages inside a MapStore project must be updated with a new entry, only for projects with custom pages and that are using context applications, here an example:</p> </li> </ul> <pre><code>import MapViewer from '@mapstore/product/pages/MapViewer';\nimport productAppConfig from \"@mapstore/product/appConfig\";\n\nconst appConfig = {\n...productAppConfig,\npages: [\n// my custom pages ...,\n{\nname: \"mapviewer\",\npath: \"/viewer/:mapId/context/:contextId\",\ncomponent: MapViewer\n}\n]\n};\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#clean-up-of-old-maven-repositories","title":"Clean up of old maven repositories","text":"<p>The old spring maven repositories that do not exist anymore have been removed from the <code>pom.xml</code> files. They are not needed anymore, so you can remove them from your <code>pom.xml</code> files too.</p> <pre><code>-        &lt;!-- Spring --&gt;\n-        &lt;repository&gt;\n-            &lt;id&gt;spring-release&lt;/id&gt;\n-            &lt;name&gt;Spring Portfolio Release Repository&lt;/name&gt;\n-            &lt;url&gt;https://maven.springframework.org/release&lt;/url&gt;\n-            &lt;snapshots&gt;\n-                &lt;enabled&gt;false&lt;/enabled&gt;\n-            &lt;/snapshots&gt;\n-        &lt;/repository&gt;\n-        &lt;repository&gt;\n-            &lt;id&gt;spring-external&lt;/id&gt;\n-            &lt;name&gt;Spring Portfolio External Repository&lt;/name&gt;\n-            &lt;url&gt;https://maven.springframework.org/external&lt;/url&gt;\n-            &lt;snapshots&gt;\n-                &lt;enabled&gt;false&lt;/enabled&gt;\n-            &lt;/snapshots&gt;\n-        &lt;/repository&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#new-permalink-plugin","title":"New Permalink plugin","text":"<p>As part this release, permalink plugin is added to MapStore. The new plugin is already configured in standard MapStore application, but if you are working on a project or if you customized the configuration files, you may need to update them to introduce the new plugin.</p> <p>In any case on an existing installation you must update the database adding the category to make the plugin work.</p>"},{"location":"developer-guide/mapstore-migration-guide/#add-permalink-plugin-to-localconfigjson","title":"Add Permalink plugin to localConfig.json","text":"<p>In the case you customized your <code>configs/localConfig.json</code> file in your project/installation, to add the permalink plugin you will have to update it as following:</p> <ul> <li>Add the \"Permalink\" plugin to the pages you want to use this plugin. Pages plugins are in the <code>plugins</code> section in the root of <code>localConfig.json</code>,  so you have to add \"Permalink\" entry to <code>desktop</code>, <code>dashboard</code> and <code>geostory</code> arrays, like this:</li> </ul> <pre><code>{\n\"desktop\": [\n...\n\"Permalink\",\n...\n],\n\"dashboard\": [\n...\n\"Permalink\",\n...\n],\n\"geostory\": [\n...\n\"Permalink\",\n...\n]\n}\n</code></pre> <ul> <li>To activate the functionality, you must add a new <code>permalink</code> section to <code>plugins</code> root object of <code>localConfig.json</code>, as shown below</li> </ul> <pre><code>{\n\"permalink\": [\n\"Permalink\",\n\"FeedbackMask\"\n]\n}\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#using-permalink-in-new-contexts","title":"Using Permalink in new contexts","text":"<p>The plugins available for contexts are listed in the file <code>configs/pluginsConfig.json</code>. In your project/installation, you may need to edit this configuration to make the plugin selectable for your context. Existing contexts need to be updated separately, after applying these changes</p> <ul> <li>Find the \"Share\" plugin configuration in the <code>plugins</code> array in the root of  <code>pluginsConfig.json</code> configuration file and modify it as shown below (adding <code>children</code> and <code>autoEnableChildren</code> sections:</li> </ul> <pre><code>    {\n\"name\": \"Share\",\n\"glyph\": \"share\",\n\"title\": \"plugins.Share.title\",\n\"description\": \"plugins.Share.description\",\n\"dependencies\": [\n\"SidebarMenu\"\n],\n\"children\": [\n\"Permalink\"\n],\n\"autoEnableChildren\": [\n\"Permalink\"\n]\n}\n</code></pre> <ul> <li>Add \"Permalink\" plugin configuration to the <code>plugins</code> array in the root of <code>pluginsConfig.json</code></li> </ul> <pre><code>    {\n\"name\": \"Permalink\",\n\"glyph\": \"link\",\n\"title\": \"plugins.Permalink.title\",\n\"description\": \"plugins.Permalink.description\"\n},\n</code></pre> <ul> <li>the app pages inside a MapStore project must be updated with a new entry, only for projects using permalink feature, here an example:</li> </ul> <pre><code>import Permalink from '@mapstore/product/pages/Permalink';\nimport productAppConfig from \"@mapstore/product/appConfig\";\n\nconst appConfig = {\n...productAppConfig,\npages: [\n// my custom pages ...,\n{\nname: \"permalink\",\npath: \"/permalink/:pid\",\ncomponent: Permalink\n}\n]\n};\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#database-update_1","title":"Database Update","text":"<p>Add new category <code>PERMALINK</code> to <code>gs_category</code> table. To update your database you need to apply this SQL scripts to your database</p>"},{"location":"developer-guide/mapstore-migration-guide/#postgresql","title":"PostgreSQL","text":"<pre><code>-- New PERMALINK category\nINSERT INTO geostore.gs_category(id, name) VALUES (nextval('geostore.hibernate_sequence'), 'PERMALINK') ON CONFLICT DO NOTHING;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#h2","title":"H2","text":"<pre><code>-- New PERMALINK category\nINSERT INTO gs_category(name) VALUES ('PERMALINK');\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#oracle","title":"Oracle","text":"<pre><code>-- New PERMALINK category\nINSERT INTO gs_category(id, name) VALUES (hibernate_sequence.nextval, \u2018PERMALINK');\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20220202-to-20230100","title":"Migration from 2022.02.02 to 2023.01.00","text":""},{"location":"developer-guide/mapstore-migration-guide/#log4j-update-to-log4j2","title":"Log4j update to Log4j2","text":"<p>With this release Log4j has been updated to Log4j2. The Log4j API has changed with version 2. Basically if you customized logging properties, you have to update the properties file following the <code>log4j properties file migration</code> section.</p> <p>If you have a downstream project, you will have also to update your dependencies in <code>pom.xml</code> and your Java code, following the suggestions in <code>log4j2 dependencies and code update</code> section.</p> <p>For more information or more details about how to migrate, follow the official documentation.</p> <p>!!! note:     A compatibility tier has been added in order to allow to use old configurations. Anyway it is strongly suggested to update your files as soon as possible.</p>"},{"location":"developer-guide/mapstore-migration-guide/#log4j2-properties-file-migration","title":"log4j2 properties file migration","text":"<p>To have logging properly work on MapStore then it is needed to:</p> <ul> <li> <p>Rename <code>log4j.properties</code> file to <code>log4j2.properties</code>.</p> </li> <li> <p>Edit the <code>properties</code> to configure it according to the log4j2 syntax. See the <code>Configuration with Properties</code> section on the official documentation page. Below the old and the new default log4j configuration files are juxtaposed:</p> </li> </ul> <p><code>log4j.properties</code></p> <pre><code>log4j.rootLogger=INFO, fileAppender\n\nlog4j.appender.consoleAppender=org.apache.log4j.ConsoleAppender\nlog4j.appender.consoleAppender.layout=org.apache.log4j.PatternLayout\nlog4j.appender.consoleAppender.layout.ConversionPattern=%p %d{yyyy-MM-dd HH:mm:ss.SSS} %c::%M:%L - %m%n\n\nlog4j.logger.it.geosolutions.geostore.services.rest=INFO\nlog4j.logger.org.hibernate=INFO\nlog4j.logger.com.trg=INFO\n\n# File appender\nlog4j.appender.fileAppender=org.apache.log4j.RollingFileAppender\nlog4j.appender.fileAppender.layout=org.apache.log4j.PatternLayout\nlog4j.appender.fileAppender.layout.ConversionPattern=%p   %d{yyyy-MM-dd HH:mm:ss.SSS}   %C{1}.%M() - %m %n\nlog4j.appender.fileAppender.File=${catalina.base}/logs/mapstore.log\n</code></pre> <p><code>log42.properties</code></p> <pre><code>rootLogger.level = INFO\nappenders= console, file\n\n\nappender.console.type = Console\nappender.console.name = LogToConsole\nappender.console.layout.type = PatternLayout\nappender.console.layout.pattern = %p %d{yyyy-MM-dd HH:mm:ss.SSS} %c::%M:%L - %m%n\nrootLogger.appenderRef.stdout.ref = LogToConsole\nrootLogger.appenderRef.console.ref = LogToConsole\n\nappender.file.type = File\nappender.file.name = LogToFile\nappender.file.fileName=${sys:catalina.base}/logs/mapstore.log\nappender.file.layout.type=PatternLayout\nappender.file.layout.pattern=%p   %d{yyyy-MM-dd HH:mm:ss.SSS}   %C{1}.%M() - %m %n\nrootLogger.appenderRef.file.ref = LogToFile\n\n\nlogger.restsrv.name=it.geosolutions.geostore.services.rest\nlogger.restsrv.level=  INFO\nlogger.hibernate1.name=org.hibernate\nlogger.hibernate1.level=INFO\nlogger.trg1.name=com.trg\nlogger.trg1.level=INFO\n</code></pre> <p>The main difference applies to how define the Log level on a per package basis. If in previous version of log4j a single property was defining both the package and the level now we need two distinct properties, one to define the name (the package) and the other for the level:</p> <ul> <li>before</li> </ul> <pre><code>log4j.logger.it.geosolutions.geostore.services.rest=INFO\n</code></pre> <ul> <li>now</li> </ul> <pre><code>logger.restsrv.name=it.geosolutions.geostore.services.rest\nlogger.restsrv.level=  INFO\n</code></pre> <p>Note that the second part of the property key in the log4j2 (<code>restsrv</code> in the example) can be whatever string of choice, with the only requirement to be the same for the <code>name</code> and the <code>level</code> property.</p>"},{"location":"developer-guide/mapstore-migration-guide/#log4j2-dependencies-and-code-update","title":"log4j2 dependencies and code update","text":"<p>In your downstream project you will have to replace, where you used (typically in <code>backend</code> and <code>web</code> folders) the following dependencies:</p> <pre><code>            &lt;dependency&gt;\n&lt;groupId&gt;log4j&lt;/groupId&gt;\n&lt;artifactId&gt;log4j&lt;/artifactId&gt;\n&lt;version&gt;${log4j.version}&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n&lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n&lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n&lt;version&gt;${slf4j.version}&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n&lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n&lt;artifactId&gt;jcl-over-slf4j&lt;/artifactId&gt;\n&lt;version&gt;${slf4j.version}&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n&lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n&lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\n&lt;version&gt;${slf4j.version}&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>with</p> <pre><code> &lt;dependency&gt;\n&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n&lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\n&lt;version&gt;2.19.0&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n&lt;artifactId&gt;log4j-api&lt;/artifactId&gt;\n&lt;version&gt;2.19.0&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n&lt;artifactId&gt;log4j-slf4j-impl&lt;/artifactId&gt;\n&lt;version&gt;2.19.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>!!! note:     of course you can use <code>properties</code> of maven to not repeat the version numbers everytime, or dependency management.</p> <p>Moreover, if you have some custom code, you will hae to replace  the use of <code>getLogger</code>. Example:</p> <pre><code>private static final Logger LOGGER = Logger.getLogger(MyClass.class);\n</code></pre> <p>with</p> <pre><code>private static final Logger LOGGER = LogManager.getLogger(MyClass.class);\n</code></pre> <p>where <code>LogManager</code> can be imported as:</p> <pre><code>import org.apache.logging.log4j.LogManager;\n</code></pre> <p>and <code>Logger</code> can be imported as:</p> <pre><code>import org.apache.logging.log4j.Logger;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#update-database-schema","title":"Update database schema","text":"<p>This new version introduced the attributes for user groups. This requires an update to your database applying the scripts available here. You have to apply the script <code>*-migration-from-v.1.5.0-to-v2.0.0</code> of your database. For instance on postgreSQL, you will have to execute the script <code>postgresql/postgresql-migration-from-v.1.5.0-to-v2.0.0</code>.</p> <p>!!! note:     The script assumes you set the search path for your db schema. Usually in postgres it is <code>geostore</code>. So make you sure to set the proper search path before to execute the script in postgres. (e.g. <code>SET search_path TO geostore;</code> )</p> <p>!!! note:     If you don't want to or you can not execute the migration script, you can set in <code>geostore-datasource-ovr.properities</code> the following property to make MapStore update the database for you</p> <pre><code>```properties\ngeostoreEntityManagerFactory.jpaPropertyMap[hibernate.hbm2ddl.auto]=update\n``\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20220200-to-20220201","title":"Migration from 2022.02.00 to 2022.02.01","text":""},{"location":"developer-guide/mapstore-migration-guide/#packagejson-scripts-migration","title":"Package.json scripts migration","text":"<p>With this release we are refactoring a bit the naming of the scripts maintaining retro compatibility avoiding builds on ci/cd systems to break. Anyway we suggest to align them as listed here</p> <p>The main changes are:</p> <ul> <li>We have removed <code>travis</code> and <code>mvntest</code> scripts.</li> <li>Most of the scripts are now prefixed with <code>app</code> or <code>fe</code> or <code>be</code> to make them more clear.</li> <li>Now <code>npm start</code> is an alias of <code>npm run app:start</code> and starts both front-end and back-end.</li> </ul> <p>Although it is optional we suggest to align your project to these changes. In order to align your repository you should:</p> <ul> <li>update your <code>package.json</code> to latest scripts, you can copy them from <code>utility/projects/projectScripts.json</code> in MapStore2 repository.</li> <li>update your <code>build.sh</code> to use the latest scripts, instead of the old ones. See <code>project/standard/templates/build.sh</code> in MapStore2 repository.</li> <li>update in your repository <code>web/pom.xml</code> of your project to receive the backend property from ENV variables.</li> </ul> <pre><code>@@ -14,6 +14,7 @@\n  &lt;properties&gt;\n     &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n     &lt;tomcat.version&gt;8.5.69&lt;/tomcat.version&gt;\n+    &lt;tomcat.port&gt;8080&lt;/tomcat.port&gt;\n  &lt;/properties&gt;\n\n   &lt;dependencies&gt;\n@@ -400,7 +401,7 @@\n                        ${project.build.directory}/apache-tomcat-${tomcat.version}\n                     &lt;/home&gt;\n                     &lt;properties&gt;\n-                        &lt;cargo.servlet.port&gt;8080&lt;/cargo.servlet.port&gt;\n+                        &lt;cargo.servlet.port&gt;${tomcat.port}&lt;/cargo.servlet.port&gt;\n                        &lt;cargo.logging&gt;low&lt;/cargo.logging&gt;\n                     &lt;/properties&gt;\n                 &lt;/configuration&gt;\n@@ -419,6 +420,18 @@\n    &lt;/plugins&gt;\n   &lt;/build&gt;\n     &lt;profiles&gt;\n+        &lt;profile&gt;\n+            &lt;id&gt;dev-custom-port&lt;/id&gt;\n+            &lt;activation&gt;\n+                &lt;property&gt;\n+                    &lt;name&gt;env.MAPSTORE_BACKEND_PORT&lt;/name&gt;\n+                &lt;/property&gt;\n+            &lt;/activation&gt;\n+            &lt;properties&gt;\n+                &lt;!-- Override only if necessary --&gt;\n+                &lt;tomcat.port&gt;${env.MAPSTORE_BACKEND_PORT}&lt;/tomcat.port&gt;\n+            &lt;/properties&gt;\n+        &lt;/profile&gt;\n        &lt;profile&gt;\n             &lt;id&gt;printing&lt;/id&gt;\n             &lt;activation&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20220102-to-20220200","title":"Migration from 2022.01.02 to 2022.02.00","text":""},{"location":"developer-guide/mapstore-migration-guide/#html-pages-optimization","title":"HTML pages optimization","text":"<p>We removed script and css link to leaflet CDN in favor of a dynamic import of the libraries in the main bundle, now leaflet is only loaded when the library is selected as map type of the viewer. You can update the project HTML files by removing these tags:</p> <pre><code>- &lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/leaflet.css\" /&gt;\n- &lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.css\" /&gt;\n&lt;link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\" /&gt;\n&lt;link rel=\"shortcut icon\" type=\"image/png\" href=\"https://cdn.jslibs.mapstore2.geo-solutions.it/leaflet/favicon.ico\" /&gt;\n&lt;!--script src=\"https://maps.google.com/maps/api/js?v=3\"&gt;&lt;/script--&gt;\n- &lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/leaflet.js\"&gt;&lt;/script&gt;\n- &lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.js\"&gt;&lt;/script&gt;\n</code></pre> <p>We also made asynchronous the script to detect valid browser. This should slightly improve the initial requests time.  You can updated the script in your project as following:</p> <pre><code>&lt;script async type=\"text/javascript\" src=\"https://unpkg.com/bowser@2.7.0/es5.js\" onload=\"checkBrowser()\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\"&gt;\nfunction checkBrowser() {\nvar browserInfo = bowser.getParser(window.navigator.userAgent);\nvar isValidBrowser = browserInfo.satisfies({\n\"edge\": \"&gt;1\",\n\"chrome\": \"&gt;1\",\n\"safari\": \"&gt;1\",\n\"firefox\": \"&gt;1\"\n});\nif (!isValidBrowser) {\nwindow.location.href = \"unsupportedBrowser.html\"\ndocument.querySelector(\"container\").style.display = \"none\";\n}\n}\n&lt;/script&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#update-pluginsjs-to-make-upstream-plugins-use-dynamic-import","title":"Update plugins.js to make upstream plugins use dynamic import","text":"<p>We've updated <code>plugins.js</code> in MapStore to make most of the plugins use dynamic import. <code>plugins.js</code> of your project have to be updated separately.</p> <p>Please use <code>web\\client\\product\\plugins.js</code> file as a reference listing plugins whose definition can be changed to support dynamic import.</p> <p>To use dynamic import for plugin, please update its definition to look like:</p> <pre><code>{\n...\nAnnotationsPlugin: toModulePlugin('Annotations', () =&gt; import(/* webpackChunkName: 'plugins/annotations' */ '../plugins/Annotations')),\n...\n}\n</code></pre> <p>See Dynamic import of extension to have more details about transforming extensions to use dynamic import.</p>"},{"location":"developer-guide/mapstore-migration-guide/#version-plugin-has-been-removed","title":"Version plugin has been removed","text":"<p>We no longer maintain the Version plugin since we have moved its content inside the About plugin (see here for more details)</p> <p>We suggest you to clean up your project as well:</p> <ul> <li>remove Version entry it from a local list of plugins.js</li> <li>remove Version entries it from a localConfig.json and pluginConfig.json</li> <li> <p>add About entry into other pages of mapstore plugins array:</p> </li> <li> <p>dashboard</p> </li> <li>geostory</li> <li>mobile</li> <li>remove <code>DefinePlugin</code> entries dedicated to git revision retrieved by <code>git-revision-webpack-plugin</code>, if any, from <code>webpack-config.js</code> or <code>prod.webpack-config.js</code>, because they have been moved to the file <code>build/BuildUtils.js</code></li> <li>check that in your package.json you have this extends rule</li> </ul> <pre><code>\"eslintConfig\": {\n\"extends\": [\n\"@mapstore/eslint-config-mapstore\"\n],\n...\n</code></pre> <ul> <li>edit the version of the @mapstore/eslint-config-mapstore to 1.0.5 in your package.json so that the new globals config will be inherited</li> </ul> <p>Note</p> <p>this may fail on gha workflows, in that case we suggest to edit directly your package.json with globals taken from mapstore framework</p>"},{"location":"developer-guide/mapstore-migration-guide/#support-for-openid","title":"Support for OpenID","text":"<p>MapStore introduced support for OpenID for google and keycloak. In order to have this functionalities and to be aligned with the latest version of MapStore you have to update the following files in your projects:</p> <ul> <li><code>geostore-spring-security.xml</code> (your custom spring security context) have to be updated adding the beans and the <code>security:custom-filter</code> entry in the <code>&lt;security:http&gt;</code> entry, as here below:</li> </ul> <pre><code>        &lt;security:csrf disabled=\"true\"/&gt;\n        &lt;security:custom-filter ref=\"authenticationTokenProcessingFilter\" before=\"FORM_LOGIN_FILTER\"/&gt;\n        &lt;security:custom-filter ref=\"sessionTokenProcessingFilter\" after=\"FORM_LOGIN_FILTER\"/&gt;\n+        &lt;security:custom-filter ref=\"keycloakFilter\" before=\"BASIC_AUTH_FILTER\"/&gt;\n+        &lt;security:custom-filter ref=\"googleOpenIdFilter\" after=\"BASIC_AUTH_FILTER\"/&gt;\n       &lt;security:anonymous /&gt;\n    &lt;/security:http&gt;\n\n    &lt;security:authentication-manager&gt;\n        &lt;security:authentication-provider ref='geoStoreUserServiceAuthenticationProvider' /&gt;\n    &lt;/security:authentication-manager&gt;\n+\n+\n+    &lt;bean id=\"preauthenticatedAuthenticationProvider\" class=\"it.geosolutions.geostore.services.rest.security.PreAuthenticatedAuthenticationProvider\"&gt;\n+    &lt;/bean&gt;\n+\n+    &lt;!-- OAuth2 beans --&gt;\n+    &lt;context:annotation-config/&gt;\n+\n+    &lt;bean id=\"googleSecurityConfiguration\" class=\"it.geosolutions.geostore.services.rest.security.oauth2.google.OAuthGoogleSecurityConfiguration\"/&gt;\n+\n+    &lt;!-- Keycloak --&gt;\n+\n+   &lt;bean id=\"keycloakConfig\" class=\"it.geosolutions.geostore.services.rest.security.keycloak.KeyCloakSecurityConfiguration\"/&gt;\n+\n+    &lt;!-- END OAuth2 beans--&gt;\n+\n+    &lt;!--  security integration inclusions  --&gt;\n+    &lt;import resource=\"classpath*:security-integration-${security.integration:default}.xml\"/&gt;\n\n&lt;/beans&gt;\n</code></pre> <ul> <li><code>web.xml</code>: add the following content to the file:</li> </ul> <pre><code>@@ -34,6 +34,17 @@\n       &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n    &lt;/listener&gt;\n\n+    &lt;!-- Allow to use RequestContextHolder --&gt;\n+    &lt;filter&gt;\n+        &lt;filter-name&gt;springRequestContextFilter&lt;/filter-name&gt;\n+        &lt;filter-class&gt;org.springframework.web.filter.RequestContextFilter&lt;/filter-class&gt;\n+    &lt;/filter&gt;\n+    &lt;filter-mapping&gt;\n+        &lt;filter-name&gt;springRequestContextFilter&lt;/filter-name&gt;\n+        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n+    &lt;/filter-mapping&gt;\n+\n+\n   &lt;!-- Spring Security Servlet --&gt;\n    &lt;filter&gt;\n</code></pre> <ul> <li><code>applicationContext.xml</code> for consistency, we added <code>mapstore-ovr.properties</code> files to be searched in class-path and in the data-dir, as for the other properties files:</li> </ul> <pre><code>@@ -49,6 +49,7 @@\n        &lt;property name=\"order\" value=\"10\"/&gt;\n         &lt;property name=\"locations\"&gt;\n             &lt;list&gt;\n+                 &lt;value&gt;classpath:mapstore-ovr.properties&lt;/value&gt;\n                &lt;value&gt;file:${datadir.location:}/geostore-datasource-ovr.properties&lt;/value&gt;\n                 &lt;value&gt;file:${datadir.location:}/mapstore-ovr.properties&lt;/value&gt;\n             &lt;/list&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#upgrading-the-printing-engine","title":"Upgrading the printing engine","text":"<p>The mapfish-print based printing engine has been upgraded to align to the latest official 2.1.5 in term of functionalities.</p> <p>An update to the MapStore printing engine context file (<code>applicationContext-print.xml</code>) is needed for all projects built with the printing profile enabled. The following sections should be added to the file:</p> <pre><code>&lt;bean id=\"configFactory\" class=\"org.mapfish.print.config.ConfigFactory\"&gt;&lt;/bean&gt;\n+&lt;bean id=\"threadResources\" class=\"org.mapfish.print.ThreadResources\"&gt;\n+    &lt;property name=\"connectionTimeout\" value=\"30000\"/&gt;\n+    &lt;property name=\"socketTimeout\" value=\"30000\" /&gt;\n+    &lt;property name=\"globalParallelFetches\" value=\"200\"/&gt;\n+    &lt;property name=\"perHostParallelFetches\" value=\"30\" /&gt;\n+&lt;/bean&gt;\n\n&lt;bean id=\"pdfOutputFactory\" class=\"org.mapfish.print.output.PdfOutputFactory\"/&gt;\n+\n+&lt;bean id=\"metricRegistry\" class=\"com.codahale.metrics.MetricRegistry\" lazy-init=\"false\"/&gt;\n+&lt;bean id=\"healthCheckRegistry\" class=\"com.codahale.metrics.health.HealthCheckRegistry\" lazy-init=\"false\"/&gt;\n+&lt;bean id=\"loggingMetricsConfigurator\" class=\"org.mapfish.print.metrics.LoggingMetricsConfigurator\"  lazy-init=\"false\"/&gt;\n+&lt;bean id=\"jvmMetricsConfigurator\" class=\"org.mapfish.print.metrics.JvmMetricsConfigurator\" lazy-init=\"false\"/&gt;\n+&lt;bean id=\"jmlMetricsReporter\" class=\"org.mapfish.print.metrics.JmxMetricsReporter\" lazy-init=\"false\"/&gt;\n</code></pre> <p>Also, remember to update your project pom.xml with the updated dependency:</p> <ul> <li>locate the print-lib dependency in the pom.xml file</li> <li>replace the dependency with the following snippet</li> </ul> <pre><code>&lt;dependency&gt;\n&lt;groupId&gt;org.mapfish.print&lt;/groupId&gt;\n&lt;artifactId&gt;print-lib&lt;/artifactId&gt;\n&lt;version&gt;geosolutions-2.1.0&lt;/version&gt;\n&lt;exclusions&gt;\n&lt;exclusion&gt;\n&lt;groupId&gt;commons-codec&lt;/groupId&gt;\n&lt;artifactId&gt;commons-codec&lt;/artifactId&gt;\n&lt;/exclusion&gt;\n&lt;exclusion&gt;\n&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n&lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt;\n&lt;/exclusion&gt;\n&lt;exclusion&gt;\n&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n&lt;artifactId&gt;jackson-core&lt;/artifactId&gt;\n&lt;/exclusion&gt;\n&lt;exclusion&gt;\n&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n&lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n&lt;/exclusion&gt;\n&lt;exclusion&gt;\n&lt;groupId&gt;org.springframework&lt;/groupId&gt;\n&lt;artifactId&gt;spring-web&lt;/artifactId&gt;\n&lt;/exclusion&gt;\n&lt;exclusion&gt;\n&lt;groupId&gt;org.springframework&lt;/groupId&gt;\n&lt;artifactId&gt;spring-context&lt;/artifactId&gt;\n&lt;/exclusion&gt;\n&lt;/exclusions&gt;\n&lt;/dependency&gt;\n</code></pre> <p>Finally, to enable printing in different formats than PDF, you should add the following to your <code>config.yml</code> file (at the top level):</p> <pre><code>formats:\n  - '*'\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#replacing-burgermenu-with-sidebarmenu","title":"Replacing BurgerMenu with SidebarMenu","text":"<p>There were several changes applied to the application layout, one of them is the Sidebar Menu that comes to replace Burger menu on map viewer and in contexts. Following actions need to be applied to make a switch:</p> <ul> <li>Update localConfig.json and add \"SidebarMenu\" entry to the \"desktop\" section:</li> </ul> <pre><code>{\n\"desktop\": [\n...\n\"SidebarMenu\",\n...\n]\n}\n</code></pre> <ul> <li>Remove \"BurgerMenu\" entry from \"desktop\" section.</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#using-sidebar-menu-in-new-contexts","title":"Using Sidebar Menu in new contexts","text":"<p>Contents of your <code>pluginsConfig.json</code> need to be reviewed to allow usage of new \"SidebarMenu\" in new contexts. Existing contexts need to be updated separately, please refer to the next chapter for instructions.</p> <ul> <li>Find \"BurgerMenu\" plugin configuration in <code>pluginsConfig.json</code> and remove <code>\"hidden\": true</code> line from it:</li> </ul> <pre><code>    {\n\"name\": \"BurgerMenu\",\n\"glyph\": \"menu-hamburger\",\n\"title\": \"plugins.BurgerMenu.title\",\n\"description\": \"plugins.BurgerMenu.description\",\n\"dependencies\": [\n\"OmniBar\"\n]\n}\n</code></pre> <ul> <li>Add <code>SidebarMenu</code> entry to the \"plugins\" array:</li> </ul> <pre><code>{\n\"plugins\": [\n...\n{\n\"name\": \"SidebarMenu\",\n\"hidden\": true\n}\n...\n]\n}\n</code></pre> <ul> <li>Go through all plugins definitions and replace <code>BurgerMenu</code> dependency with <code>SidebarMenu</code>, e.g.:</li> </ul> <pre><code>    {\n\"name\": \"MapExport\",\n\"glyph\": \"download\",\n\"title\": \"plugins.MapExport.title\",\n\"description\": \"plugins.MapExport.description\",\n\"dependencies\": [\n\"SidebarMenu\"\n]\n}\n</code></pre> <ul> <li>Also the <code>StreetView</code> plugin needs to depend from <code>SidebarMenu</code>.</li> </ul> <pre><code>{\n\"name\": \"StreetView\",\n\"glyph\": \"road\",\n\"title\": \"plugins.StreetView.title\",\n\"description\": \"plugins.StreetView.description\",\n\"dependencies\": [\n\"SidebarMenu\"\n]\n}\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#updating-existing-contexts-to-use-sidebar-menu","title":"Updating existing contexts to use Sidebar Menu","text":"<p>Contexts created in previous versions of MapStore will maintain old Burger Menu. There are two options allowing to replace it with the new Sidebar Menu:</p> <ul> <li>Using manual update.</li> <li>Using SQL query to update all contexts at once.</li> </ul> <p>Before going with one of the approaches, please make sure that changes to <code>pluginsConfig.json</code> from previous chapter are applied.</p> <p>To update context manually:</p> <ol> <li>Go to the context manager (#/context-manager) and edit context you want to update.</li> <li>Move to the step 3: Configure Plugins.</li> <li>Find \"Burger Menu\" on the right side (enabled plugins) and move it to the left column.</li> <li>Save context</li> </ol> <p>Note: \"Burger Menu\" has higher priority over the \"Sidebar Menu\", so it will always be used if it's added to the list of enabled plugins of the context.</p> <p>To update all contexts at once:</p> <p>This is a sample SQL query that can be executed against the MapStore DB to replace the Burger Menu with the new Sidebar for existing application contexts previously created:</p> <pre><code>UPDATE geostore.gs_stored_data SET stored_data = regexp_replace(gs_stored_data.stored_data,'{\"name\":\"BurgerMenu\"},','{\"name\":\"SidebarMenu\"},')\nFROM geostore.gs_resource\nWHERE gs_stored_data.resource_id = gs_resource.id AND\ngs_resource.category_id = (SELECT id FROM geostore.gs_category WHERE name = 'CONTEXT') AND\ngs_stored_data.stored_data ~ '.*{\"name\":\"BurgerMenu\"},.*';\n</code></pre> <p>Note: Schema name could vary depending on your installation configuration.</p>"},{"location":"developer-guide/mapstore-migration-guide/#updating-extensions","title":"Updating extensions","text":"<p>Please refer to the extensions documentation to know how to update your extensions.</p>"},{"location":"developer-guide/mapstore-migration-guide/#using-terrain-layer-type-to-define-3d-map-elevation-profile","title":"Using <code>terrain</code> layer type to define 3D map elevation profile","text":"<p>A new <code>terrain</code> layer type has been created in order to provide more options and versatility when defining an elevation profile for the 3D map terrain. This <code>terrain</code> layer will substitute the former <code>wms</code> layer (with <code>useForElevation</code> attribute) used to define the elevation profile.</p> <p>Note</p> <p>The <code>wms</code> layer (with <code>useForElevation</code> attribute) configuration is still needed to show the elevation data inside the MousePosition plugin and it will display the terrain at the same time. The <code>terrain</code> layer type allows a more versatile way of handling elevation but it will work only as terrain visualization in the 3D map viewer.</p> <p>The <code>additionalLayers</code> object on the <code>localConfig.json</code> file should adhere now to the terrain layer configuration. Serve the following code as an example:</p> <pre><code>{\n\"name\": \"Map\",\n\"cfg\": {\n\"additionalLayers\": [{\n\"type\": \"terrain\",\n\"provider\": \"wms\",\n\"url\": \"https://host-sample/geoserver/wms\",\n\"name\": \"workspace:layername\",  // name of the geoserver resource\n\"littleendian\": false,\n\"visibility\": true\n}]\n}\n}\n</code></pre> <p>Note</p> <p>When using <code>terrain</code> layer with <code>wms</code> provider, the format option in layer configuration is not needed anymore as Mapstore supports only <code>image/bil</code> format and is used by default</p>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20220100-to-20220101","title":"Migration from 2022.01.00 to 2022.01.01","text":""},{"location":"developer-guide/mapstore-migration-guide/#mailinglists-plugin-has-been-removed","title":"MailingLists plugin has been removed","text":"<p><code>MailingLists</code> plugin has ben removed from the core of MapStore. This means you can remove it from your <code>localConfig.json</code> (if present, it will be anyway ignored by the plugin system).</p>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20210202-to-20220100","title":"Migration from 2021.02.02 to 2022.01.00","text":"<p>This release includes several libraries upgrade on the backend side, in particular the following have been migrated to the latest available versions:</p> Library Old New Spring 3.0.5 5.3.9 Spring-security 3.0.5 5.3.10 CXF 2.3.2 3.4.4 Hibernate 3.3.2 5.5.0 JPA 1.0 2.1 hibernate-generic-dao 0.5.1 1.3.0-SNAPSHOT h2 1.3.168 1.3.175 javax-servlet-api 2.5 3.1.0 <p>This requires also the upgrade of Tomcat to at least version 8.5.x.</p>"},{"location":"developer-guide/mapstore-migration-guide/#updating-projects-configuration","title":"Updating projects configuration","text":"<p>Projects need the following to update to this MapStore release:</p> <ul> <li>update dependencies (in <code>web/pom.xml</code>) copying those in <code>MapStore2/java/web/pom.xml</code>, in particular (where present):</li> </ul> Dependency Version Notes mapstore-services 1.3.0 Replaces mapstore-backend geostore-webapp 1.8.0 <ul> <li>update packagingExcludes in <code>web/pom.xml</code> to this list:</li> </ul> <pre><code>WEB-INF/lib/commons-codec-1.2.jar,\nWEB-INF/lib/commons-io-1.1.jar,\nWEB-INF/lib/commons-logging-1.0.4.jar,\nWEB-INF/lib/commons-pool-1.3.jar,\nWEB-INF/lib/slf4j-api-1.5*.jar,\nWEB-INF/lib/slf4j-log4j12-1.5*.jar,\nWEB-INF/lib/spring-tx-5.2.15*.jar\n</code></pre> <ul> <li>upgrade Tomcat to 8.5 or greater</li> <li>update your <code>geostore-spring-security.xml</code> file to add the following setting, needed to disable CSRF validation, that MapStore services do not implement yet:</li> </ul> <pre><code>&lt;security:http ... &gt;\n...\n    &lt;security:csrf disabled=\"true\"/&gt;\n...\n&lt;/security:http&gt;\n</code></pre> <ul> <li>remove the spring log4j listener from <code>web.xml</code></li> </ul> <pre><code> &lt;!-- spring context loader\n    &lt;listener&gt;\n        &lt;listener-class&gt;org.springframework.web.util.Log4jConfigListener&lt;/listener-class&gt;\n    &lt;/listener&gt;--&gt;\n</code></pre> <ul> <li>If one of the libraries updated is used in your project, you should align the version with the newer one to avoid jar duplications</li> <li>Some old project may define versions of spring and/or jackson in maven properties. You can remove these definition and the dependency from main <code>pom.xml</code> since they should be inherited from spring. In particular you may need to remove these properties :</li> </ul> <pre><code>-        &lt;jackson.version&gt;1.9.10&lt;/jackson.version&gt;\n-        &lt;jackson.databind-version&gt;2.2.3&lt;/jackson.databind-version&gt;\n-        &lt;jackson.annotations-version&gt;2.5.3&lt;/jackson.annotations-version&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#upgrading-cesiumjs","title":"Upgrading CesiumJS","text":"<p>CesiumJS has been upgraded to version 1.90 (from 1.17) and included directly in the mapstore bundle as async import.</p> <p>Downstream project should update following configurations:</p> <ul> <li>remove all executions related to the cesium library from the pom.xml</li> </ul> <pre><code>&lt;execution&gt;\n    &lt;id&gt;html, configuration files and images&lt;/id&gt;\n    &lt;phase&gt;process-classes&lt;/phase&gt;\n    &lt;goals&gt;\n        &lt;goal&gt;copy-resources&lt;/goal&gt;\n    &lt;/goals&gt;\n    &lt;configuration&gt;\n        &lt;outputDirectory&gt;${basedir}/target/mapstore&lt;/outputDirectory&gt;\n        &lt;encoding&gt;UTF-8&lt;/encoding&gt;\n        &lt;resources&gt;\n            &lt;resource&gt;\n                &lt;directory&gt;${basedir}/../web/client&lt;/directory&gt;\n                &lt;includes&gt;\n                    &lt;include&gt;**/*.html&lt;/include&gt;\n                    &lt;include&gt;**/*.json&lt;/include&gt;\n                    &lt;include&gt;**/img/*&lt;/include&gt;\n                    &lt;include&gt;product/assets/symbols/*&lt;/include&gt;\n                    &lt;include&gt;**/*.less&lt;/include&gt;\n                &lt;/includes&gt;\n                &lt;excludes&gt;\n                    &lt;exclude&gt;node_modules/*&lt;/exclude&gt;\n                    &lt;exclude&gt;node_modules/**/*&lt;/exclude&gt;\n-                    &lt;exclude&gt;**/libs/Cesium/**/*&lt;/exclude&gt;\n                   &lt;exclude&gt;**/test-resources/*&lt;/exclude&gt;\n                &lt;/excludes&gt;\n            &lt;/resource&gt;\n        &lt;/resources&gt;\n    &lt;/configuration&gt;\n&lt;/execution&gt;\n-&lt;execution&gt;\n-    &lt;id&gt;CesiumJS-navigation&lt;/id&gt;\n-    &lt;phase&gt;process-classes&lt;/phase&gt;\n-    &lt;goals&gt;\n-        &lt;goal&gt;copy-resources&lt;/goal&gt;\n-    &lt;/goals&gt;\n-    &lt;configuration&gt;\n-        &lt;outputDirectory&gt;${basedir}/target/mapstore/libs/cesium-navigation&lt;/outputDirectory&gt;\n-        &lt;encoding&gt;UTF-8&lt;/encoding&gt;\n-        &lt;resources&gt;\n-            &lt;resource&gt;\n-                &lt;directory&gt;${basedir}/../web/client/libs/cesium-navigation&lt;/directory&gt;\n-            &lt;/resource&gt;\n-        &lt;/resources&gt;\n-    &lt;/configuration&gt;\n-&lt;/execution&gt;\n</code></pre> <ul> <li>remove all the external script and css related to cesium and cesium-navigation now included as packages</li> </ul> <pre><code>-&lt;script src=\"https://cesium.com/downloads/cesiumjs/releases/1.42/Build/Cesium/Cesium.js\"&gt;&lt;/script&gt;\n-&lt;link rel=\"stylesheet\" href=\"https://cesium.com/downloads/cesiumjs/releases/1.42/Build/Cesium/Widgets/widgets.css\" /&gt;\n-&lt;script src=\"libs/cesium-navigation/cesium-navigation.js\"&gt;&lt;/script&gt;\n-&lt;link rel=\"stylesheet\" href=\"libs/cesium-navigation/cesium-navigation.css\" /&gt;\n</code></pre> <ul> <li>This step is needed only for custom project with a specific <code>publicPath</code> different from the default one. In this case you may need to specify what folder deliver the  cesium build ( by default <code>dist/cesium</code>). To do that, you can add the  <code>cesiumBaseUrl</code> parameter in the webpack dev and prod configs to the correct location of the cesium static assets, widgets and workers folder.</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20210201-to-20210202","title":"Migration from 2021.02.01 to 2021.02.02","text":""},{"location":"developer-guide/mapstore-migration-guide/#style-parsers-dynamic-import","title":"Style parsers dynamic import","text":"<p>The style parser libraries introduced a dynamic import to reduce the initial bundle size. This change reflects to the <code>getStyleParser</code> function provided by the VectorStyleUtils module. If a downstream project of MapStore is using <code>getStyleParser</code> it should update it to this new version:</p> <pre><code>// example\n\n- // old use of parser\n- const parser = getStyleParser('sld');\n\n+ // new use of parser\n+ getStyleParser('sld')\n+     .then((parser) =&gt; {\n+         // use parser\n+     });\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20210200-to-20210201","title":"Migration from 2021.02.00 to 2021.02.01","text":"<p>This update contains a fix for a minor vulnerability found in <code>log4j</code> library. For this reason you may need to update the dependencies of your project</p> <p>Note</p> <p>This vulnerability is not CVE-2021-44228 but only a couple of smaller ones, that involve <code>Log4J</code> ( CVE-2021-44228 is for <code>Log4J2</code> ). Anyway MapStore is not prone to these vulnerabilities with the default configuration. For more information, see the dedicated blog post</p> <p>here the instructions:</p>"},{"location":"developer-guide/mapstore-migration-guide/#align-pomxml-files","title":"Align <code>pom.xml</code> files","text":"<p>Here the changes in <code>pom.xml</code> and <code>web/pom.xml</code> to update:</p> <ul> <li>Change <code>mapstore-backend</code> into <code>mapstore-services</code> and set the version to <code>1.2.2</code></li> </ul> <pre><code>&lt;!-- MapStore backend --&gt;\n    &lt;dependency&gt;\n    &lt;groupId&gt;it.geosolutions.mapstore&lt;/groupId&gt;\n-      &lt;artifactId&gt;mapstore-backend&lt;/artifactId&gt;\n-      &lt;version&gt;1.2.1&lt;/version&gt;\n+      &lt;artifactId&gt;mapstore-services&lt;/artifactId&gt;\n+      &lt;version&gt;1.2.2&lt;/version&gt;\n   &lt;/dependency&gt;\n</code></pre> <ul> <li>Set <code>geostore-webapp</code> version to <code>1.7.1</code></li> </ul> <pre><code>    &lt;dependency&gt;\n    &lt;groupId&gt;it.geosolutions.geostore&lt;/groupId&gt;\n    &lt;artifactId&gt;geostore-webapp&lt;/artifactId&gt;\n-      &lt;version&gt;1.7.0&lt;/version&gt;\n+      &lt;version&gt;1.7.1&lt;/version&gt;\n   &lt;type&gt;war&lt;/type&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n</code></pre> <ul> <li>Set <code>http_proxy</code> version to <code>1.1.1</code> (should already be there)</li> </ul> <pre><code>    &lt;dependency&gt;\n    &lt;!-- ... --&gt;\n    &lt;groupId&gt;proxy&lt;/groupId&gt;\n    &lt;artifactId&gt;http_proxy&lt;/artifactId&gt;\n-      &lt;version&gt;1.1.0&lt;/version&gt;\n+      &lt;version&gt;1.1.1&lt;/version&gt;\n   &lt;type&gt;war&lt;/type&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n</code></pre> <ul> <li>Set <code>print-lib</code> version <code>geosolutions-2.0</code> to version <code>geosolutions-2.0.1</code></li> </ul> <pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.mapfish.print&lt;/groupId&gt;\n        &lt;artifactId&gt;print-lib&lt;/artifactId&gt;\n-        &lt;version&gt;geosolutions-2.0&lt;/version&gt;\n+        &lt;version&gt;geosolutions-2.0.1&lt;/version&gt;\n   &lt;/dependency&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20210104-to-20210200","title":"Migration from 2021.01.04 to 2021.02.00","text":""},{"location":"developer-guide/mapstore-migration-guide/#theme-updates-and-css-variables","title":"Theme updates and CSS variables","text":"<p>The theme of MapStore has been updated to support CSS variables for some aspects of the style, in particular colors and font families. The <code>web/client/themes/default/variables.less</code> file contains all the available variables described under the <code>@ms-theme-vars</code> ruleset. It is suggested to :</p> <ul> <li>update the lesscss variables in the projects because the variables starting with <code>@ms2-</code> will be deprecated soon:</li> </ul> <p><code>@ms2-color-text</code> -&gt; <code>@ms-main-color</code> <code>@ms2-color-background</code> -&gt; <code>@ms-main-bg</code> <code>@ms2-color-shade-lighter</code> -&gt; <code>@ms-main-border-color</code></p> <p><code>@ms2-color-code</code> -&gt; <code>@ms-code-color</code></p> <p><code>@ms2-color-text-placeholder</code> -&gt; <code>@ms-placeholder-color</code></p> <p><code>@ms2-color-disabled</code> -&gt; <code>@ms-disabled-bg</code> <code>@ms2-color-text-disabled</code> -&gt; <code>@ms-disabled-color</code></p> <p><code>@ms2-color-text-primary</code> -&gt; <code>@ms-primary-contrast</code></p> <p><code>@ms2-color-primary</code> -&gt; <code>@ms-primary</code> <code>@ms2-color-info</code> -&gt; <code>@ms-info</code> <code>@ms2-color-success</code> -&gt; <code>@ms-success</code> <code>@ms2-color-warning</code> -&gt; <code>@ms-warning</code> <code>@ms2-color-danger</code> -&gt; <code>@ms-danger</code></p> <ul> <li>The font family has been update to <code>Noto Sans</code> so all the html need to be updated removing the previous font link with:</li> </ul> <pre><code>&lt;link rel=\"preconnect\" href=\"https://fonts.gstatic.com\"&gt;\n&lt;link href=\"https://fonts.googleapis.com/css2?family=Noto+Sans&amp;display=swap\" rel=\"stylesheet\"&gt;\n</code></pre> <ul> <li>if you are importing <code>react-select</code> or <code>react-widgets</code> inline css/less in your own project, you have to remove the import. Now the stile of these libraries is managed at project level</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#project-system","title":"Project system","text":"<p>During this release MapStore we started an rewrite of the project system, organized in different phases.</p> <p>The first phase of this migration has been identified by this pull request. In this phase we are supporting the backward compatibility as much as possible, introducing the new project system in parallel with the new one (experimental). In the future the current script will be deprecated in favor of the new one.</p> <p>Here below the breaking changes introduced in this release to support this new system:</p> <p>This section will tell you how to migrate to support the following changes:</p> <ul> <li>Minor changes to <code>prod-webpack.config.js</code></li> <li>Move front-end configuration files in <code>configs</code> folder</li> <li>Back-end has been reorganized</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#minor-changes-to-prod-webpackconfigjs","title":"Minor changes to <code>prod-webpack.config.js</code>","text":"<p>Minor changes to <code>prod-webpack.config.js</code>:</p> <pre><code>diff --git a/project/standard/templates/prod-webpack.config.js b/project/standard/templates/prod-webpack.config.js\nindex 175bf3398..6d97e2c0f 100644\n--- a/project/standard/templates/prod-webpack.config.js\n+++ b/project/standard/templates/prod-webpack.config.js\n@@ -2,8 +2,8 @@ const path = require(\"path\");\n\nconst themeEntries = require('./MapStore2/build/themes.js').themeEntries;\n const extractThemesPlugin = require('./MapStore2/build/themes.js').extractThemesPlugin;\n-const ModuleFederationPlugin = require('./MapStore2/build/moduleFederation').plugin;\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\n+const ModuleFederationPlugin = require('./MapStore2/build/moduleFederation').plugin;\n\nconst paths = {\n     base: __dirname,\n@@ -24,17 +24,19 @@ module.exports = require('./MapStore2/build/buildConfig')(\n    paths,\n     [extractThemesPlugin, ModuleFederationPlugin],\n     true,\n-    \"dist/\",\n+    undefined,\n    '.__PROJECTNAME__',\n     [\n         new HtmlWebpackPlugin({\n             template: path.join(__dirname, 'indexTemplate.html'),\n+            publicPath: 'dist/',\n            chunks: ['__PROJECTNAME__'],\n             inject: \"body\",\n             hash: true\n         }),\n         new HtmlWebpackPlugin({\n             template: path.join(__dirname, 'embeddedTemplate.html'),\n+            publicPath: 'dist/',\n            chunks: ['__PROJECTNAME__-embedded'],\n             inject: \"body\",\n             hash: true,\n@@ -42,13 +44,15 @@ module.exports = require('./MapStore2/build/buildConfig')(\n        }),\n         new HtmlWebpackPlugin({\n             template: path.join(__dirname, 'apiTemplate.html'),\n+            publicPath: 'dist/',\n            chunks: ['__PROJECTNAME__-api'],\n-            inject: 'head',\n+            inject: 'body',\n            hash: true,\n             filename: 'api.html'\n         }),\n         new HtmlWebpackPlugin({\n             template: path.join(__dirname, 'geostory-embedded-template.html'),\n+            publicPath: 'dist/',\n            chunks: ['geostory-embedded'],\n             inject: \"body\",\n             hash: true,\n@@ -56,6 +60,7 @@ module.exports = require('./MapStore2/build/buildConfig')(\n        }),\n         new HtmlWebpackPlugin({\n             template: path.join(__dirname, 'dashboard-embedded-template.html'),\n+            publicPath: 'dist/',\n            chunks: ['dashboard-embedded'],\n             inject: 'body',\n             hash: true,\n@@ -63,6 +68,7 @@ module.exports = require('./MapStore2/build/buildConfig')(\n        })\n     ],\n     {\n+        \"@mapstore/patcher\": path.resolve(__dirname, \"node_modules\", \"@mapstore\", \"patcher\"),\n        \"@mapstore\": path.resolve(__dirname, \"MapStore2\", \"web\", \"client\"),\n         \"@js\": path.resolve(__dirname, \"js\")\n     }\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#move-front-end-configuration-files-in-configs-folder","title":"Move front-end configuration files in <code>configs</code> folder","text":"<p>We suggest you to move them as well from root to configs folder, and align your <code>app.jsx</code> configuration with the new standard (if you changed the location of configs). This will allow to use the data dir in an easy way. So:</p> <ul> <li>Move the following files in <code>configs</code> directory:</li> <li><code>localConfig.json</code></li> <li><code>new.json</code></li> <li><code>pluginsConfig.json</code></li> <li><code>config.json</code></li> <li><code>simple.json</code></li> <li>If changed something in <code>app.jsx</code> about configuration, align to get the files moved in config.</li> <li>To allow MapStore to copy the correct file in the final war, you have to change <code>web/pom.xml</code> execution <code>copy-resources</code> for id <code>config files</code> this way (this only if you didn't customized <code>localConfig.json</code>):</li> </ul> <pre><code>        &lt;goal&gt;copy-resources&lt;/goal&gt;\n                &lt;/goals&gt;\n                    &lt;goal&gt;copy-resources&lt;/goal&gt;\n                &lt;/goals&gt;\n                    &lt;configuration&gt;\n-                        &lt;outputDirectory&gt;${basedir}/target/__PROJECTNAME__/MapStore2/web/client&lt;/outputDirectory&gt;\n+                        &lt;outputDirectory&gt;${basedir}/target/__PROJECTNAME__/MapStore2/web/client/configs&lt;/outputDirectory&gt;\n                       &lt;encoding&gt;UTF-8&lt;/encoding&gt;\n                        &lt;resources&gt;\n                            &lt;resource&gt;\n-                                &lt;directory&gt;${basedir}/../MapStore2/web/client&lt;/directory&gt;\n+                                &lt;directory&gt;${basedir}/../MapStore2/web/client/configs&lt;/directory&gt;\n                               &lt;includes&gt;\n                                    &lt;include&gt;localConfig.json&lt;/include&gt;\n                                &lt;/includes&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#back-end-has-been-reorganized","title":"Back-end has been reorganized","text":"<p>In particular:</p> <ul> <li>all the java code has been moved from <code>web/src/</code> to the <code>java/</code> and <code>product/</code> directories (and <code>release</code>, already existing).</li> <li><code>mapstore-backend</code> has been renamed into <code>mapstore-services</code>.</li> <li>Some servlets have been added in order to provide native support to data dir and make it work with the new <code>configs</code> directory.</li> </ul> <p>So you will have to:</p> <ul> <li>Align the <code>pom.xml</code> to the latest versions of the libs</li> <li>Edit the <code>web.xml</code> and change the <code>*-servlet.xml</code> files to expose the new services</li> </ul> <p>Note</p> <p>Future evolution of the project will avoid you to keep your own copies of the pom files as much as possible, reducing the boilerplate and making migration a lot easier. For this reasons these migration guidelines will change soon.</p> <p>Here below the details of the changes.</p>"},{"location":"developer-guide/mapstore-migration-guide/#align-pomxml-files-to-latest-versions-of-the-libs","title":"Align <code>pom.xml</code> files to latest versions of the libs","text":"<p>Here the changes in <code>pom.xml</code> and `web/pom.xml to update:</p> <ul> <li>Change <code>mapstore-backend</code> into <code>mapstore-services</code> and set the version to <code>1.2.1</code></li> </ul> <pre><code>&lt;!-- MapStore backend --&gt;\n    &lt;dependency&gt;\n    &lt;groupId&gt;it.geosolutions.mapstore&lt;/groupId&gt;\n-      &lt;artifactId&gt;mapstore-backend&lt;/artifactId&gt;\n-      &lt;version&gt;1.1.2&lt;/version&gt;\n+      &lt;artifactId&gt;mapstore-services&lt;/artifactId&gt;\n+      &lt;version&gt;1.2.1&lt;/version&gt;\n   &lt;/dependency&gt;\n</code></pre> <ul> <li>Set <code>geostore-webapp</code> version to <code>1.7.0</code></li> </ul> <pre><code>    &lt;dependency&gt;\n    &lt;groupId&gt;it.geosolutions.geostore&lt;/groupId&gt;\n    &lt;artifactId&gt;geostore-webapp&lt;/artifactId&gt;\n-      &lt;version&gt;1.6.0&lt;/version&gt;\n+      &lt;version&gt;1.7.0&lt;/version&gt;\n   &lt;type&gt;war&lt;/type&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n</code></pre> <ul> <li>Set <code>http_proxy</code> version to <code>1.1.0</code> (should already be there)</li> </ul> <pre><code>    &lt;dependency&gt;\n    &lt;!-- ... --&gt;\n    &lt;groupId&gt;proxy&lt;/groupId&gt;\n    &lt;artifactId&gt;http_proxy&lt;/artifactId&gt;\n-      &lt;version&gt;1.1.0&lt;/version&gt;\n+      &lt;version&gt;1.1-SNAPSHOT&lt;/version&gt;\n   &lt;type&gt;war&lt;/type&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#edit-the-webxml-and-change-the-servletxml-files-to-expose-the-new-services","title":"Edit the <code>web.xml</code> and change the <code>*-servlet.xml</code> files to expose the new services","text":"<ul> <li>Copy from mapstore to folder <code>web/src/main/webapp/WEB-INF/</code> the files:</li> <li><code>configs-servlet.xml</code></li> <li><code>extensions-servlet.xml</code></li> <li><code>loadAssets-servlet.xml</code></li> <li>Remove the old <code>dispatcher-servlet.xml</code> (it has been replaced by <code>loadAssets-servlet.xml</code> for backward compatibility)</li> <li>Align <code>web/src/main/webapp/WEB-INF/web.xml</code> with the new servlets as changes below (remove <code>dispatcher</code> entry in favour of the following).</li> </ul> <pre><code>@@ -1,6 +1,6 @@\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n &lt;web-app id=\"WebApp_ID\" version=\"2.4\"\n-    xmlns=\"http://java.sun.com/xml/ns/j2ee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+    xmlns:javaee=\"http://java.sun.com/xml/ns/j2ee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd\"&gt;\n\n     &lt;!-- pick up all spring application contexts --&gt;\n@@ -19,13 +19,16 @@\n\n    &lt;context-param&gt;\n       &lt;param-name&gt;proxyPropPath&lt;/param-name&gt;\n-      &lt;param-value&gt;/proxy.properties&lt;/param-value&gt;\n+      &lt;param-value&gt;/proxy.properties,${datadir.location}/proxy.properties&lt;/param-value&gt;\n    &lt;/context-param&gt;\n\n-    &lt;!-- spring context loader --&gt;\n-    &lt;listener&gt;\n+    &lt;!-- &lt;context-param&gt; &lt;param-name&gt;log4jConfigLocation&lt;/param-name&gt; &lt;param-value&gt;file:${config.dir}/log4j.xml&lt;/param-value&gt;\n+        &lt;/context-param&gt; --&gt;\n+\n+    &lt;!-- spring context loader --&gt;\n+    &lt;listener&gt;\n        &lt;listener-class&gt;org.springframework.web.util.Log4jConfigListener&lt;/listener-class&gt;\n-    &lt;/listener&gt;\n+    &lt;/listener&gt;\n\n    &lt;!--\n       - Loads the root application context of this web app at startup.\n@@ -33,8 +36,8 @@\n      - WebApplicationContextUtils.getWebApplicationContext(servletContext).\n     --&gt;\n     &lt;listener&gt;\n-        &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n-    &lt;/listener&gt;\n+        &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n+    &lt;/listener&gt;\n\n    &lt;!-- Spring Security Servlet --&gt;\n     &lt;filter&gt;\n@@ -46,7 +49,7 @@\n        &lt;url-pattern&gt;/rest/*&lt;/url-pattern&gt;\n     &lt;/filter-mapping&gt;\n\n-  &lt;!-- GZip compression --&gt;\n+    &lt;!-- GZip compression --&gt;\n    &lt;filter&gt;\n         &lt;filter-name&gt;CompressionFilter&lt;/filter-name&gt;\n         &lt;filter-class&gt;net.sf.ehcache.constructs.web.filter.GzipFilter&lt;/filter-class&gt;\n@@ -65,17 +68,38 @@\n    &lt;/filter-mapping&gt;\n\n     &lt;!--  Backend Spring MVC controllers --&gt;\n+    &lt;!--  Backward compatibility --&gt;\n    &lt;servlet&gt;\n-        &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n+        &lt;servlet-name&gt;loadAssets&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n         &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n     &lt;/servlet&gt;\n     &lt;servlet-mapping&gt;\n-        &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n+        &lt;servlet-name&gt;loadAssets&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/rest/config/*&lt;/url-pattern&gt;\n     &lt;/servlet-mapping&gt;\n+    &lt;!--  Configs --&gt;\n+    &lt;servlet&gt;\n+        &lt;servlet-name&gt;configs&lt;/servlet-name&gt;\n+        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n+        &lt;load-on-startup&gt;2&lt;/load-on-startup&gt;\n+    &lt;/servlet&gt;\n+    &lt;servlet-mapping&gt;\n+        &lt;servlet-name&gt;configs&lt;/servlet-name&gt;\n+        &lt;url-pattern&gt;/configs/*&lt;/url-pattern&gt;\n+    &lt;/servlet-mapping&gt;\n+    &lt;!-- Extensions --&gt;\n+    &lt;servlet&gt;\n+        &lt;servlet-name&gt;extensions&lt;/servlet-name&gt;\n+        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n+        &lt;load-on-startup&gt;3&lt;/load-on-startup&gt;\n+    &lt;/servlet&gt;\n+    &lt;servlet-mapping&gt;\n+        &lt;servlet-name&gt;extensions&lt;/servlet-name&gt;\n+        &lt;url-pattern&gt;/extensions/*&lt;/url-pattern&gt;\n+    &lt;/servlet-mapping&gt;\n\n-    &lt;!-- CXF Servlet --&gt;\n+    &lt;!-- CXF Servlet --&gt;\n    &lt;servlet&gt;\n         &lt;servlet-name&gt;CXFServlet&lt;/servlet-name&gt;\n         &lt;servlet-class&gt;org.apache.cxf.transport.servlet.CXFServlet&lt;/servlet-class&gt;\n@@ -97,7 +121,7 @@\n      &lt;url-pattern&gt;/proxy/*&lt;/url-pattern&gt;\n     &lt;/servlet-mapping&gt;\n\n-   &lt;!-- Printing Servlet --&gt;\n+    &lt;!-- Printing Servlet --&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;mapfish.print&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;org.mapfish.print.servlet.MapPrinterServlet&lt;/servlet-class&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#data-directory-has-been-reorganized-and-is-now-available-also-for-product","title":"Data directory has been reorganized and is now available also for product","text":"<p>The new organization of the data directory is:</p> <ul> <li><code>configs</code> will contain all json files (<code>localConfig.json</code>, <code>new.json</code>, <code>pluginsConfig.json</code>, ...) and all the <code>.patch</code> files applied to them.</li> <li><code>extensions</code> folder contains all the data for the extensions, including <code>extensions.json</code></li> <li>The root contains the properties files to configure database, proxy and other configs</li> </ul> <p>To organize your old data directory accordingly to the new specification.</p> <ul> <li>Move all <code>.json</code> and <code>.json.patch</code> files in <code>configs</code> folder (except <code>extensions.json</code>)</li> <li>Move the directory <code>dist/extensions</code> to simply <code>extensions</code>.</li> <li>The file <code>extensions.json</code> have to be moved in <code>extensions/extensions.json</code>.</li> <li>Edit the file <code>extensions/extensions.json</code> changing the paths from <code>dist/extensions/&lt;Plugin-Name&gt;/...</code> to <code>&lt;Plugin-Name&gt;/...</code></li> </ul> <p>You can set it up by configuring <code>datadir.location</code> java system property. Changes to paths or configuration files are not required anymore.</p>"},{"location":"developer-guide/mapstore-migration-guide/#configurations","title":"Configurations","text":"<ul> <li>Embedded now uses popup as default. Align localConfig.json <code>plugins --&gt; embedded --&gt; Identify</code> with the latest one:</li> </ul> <pre><code>{\n\"name\": \"Identify\",\n\"cfg\": {\n\"showInMapPopup\":true,\n\"viewerOptions\": {\n\"container\": \"{context.ReactSwipe}\"\n}\n}\n}\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20210101-to-20210103","title":"Migration from 2021.01.01 to 2021.01.03","text":"<p>Generally speaking this is not properly a breaking change, but more a fix to apply to your installations. Certificate for 'cesiumjs.org' has expired at 2021.05.05, so to continue using CesiumJS with MapStore you will have to replace all the URLs like <code>https://cesiumjs.org/releases/1.17</code> in <code>https://cesium.com/downloads/cesiumjs/releases/1.17</code>. This is the main fix of this minor release. See this pull request on GitHub as a sample to apply these changes to your project.</p>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20210100-to-20210101","title":"Migration from 2021.01.00 to 2021.01.01","text":""},{"location":"developer-guide/mapstore-migration-guide/#update-embedded-entry-to-load-the-correct-configuration","title":"Update embedded entry to load the correct configuration","text":"<p>Existing MapStore project could have an issue with the loading of map embedded page due to the impossibility to change some configuration such as localConfig.json or translations path in the javascript entry. This issue can be solved following these steps: 1 - add a custom entry named <code>embedded.jsx</code> in the <code>js/</code> directory of the project with the content:</p> <pre><code>import {\nsetConfigProp,\nsetLocalConfigurationFile\n} from '@mapstore/utils/ConfigUtils';\n\n// Add custom (overriding) translations\n// example for additional translations in the project folder\n// setConfigProp('translationsPath', ['./MapStore2/web/client/translations', './translations']);\nsetConfigProp('translationsPath', './MapStore2/web/client/translations');\n// __PROJECTNAME__ is the name of the project used in the creation process\nsetConfigProp('themePrefix', '__PROJECTNAME__');\n\n// Use a custom plugins configuration file\n// example if localConfig.json is located in the root of the project\n// setLocalConfigurationFile('localConfig.json');\nsetLocalConfigurationFile('MapStore2/web/client/localConfig.json');\n\n// async load of the standard embedded bundle\nimport('@mapstore/product/embedded');\n</code></pre> <p>2 - update the path of the embedded entry inside the <code>webpack.config.js</code> and <code>prod-webpack.config.js</code> files with:</p> <pre><code>// __PROJECTNAME__ is the name of the project used in the creation process\n'__PROJECTNAME__-embedded': path.join(__dirname, \"js\", \"embedded\"),\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#locate-plugin-configuration","title":"Locate plugin configuration","text":"<p>Configuration for Locate plugin has changed and it is not needed anymore inside the Map plugin</p> <ul> <li>old localConfig.json configuration needed 'locate' listed as tool inside the Map plugin and as a separated Locate plugin</li> </ul> <pre><code>// ...\n{\n\"name\": \"Map\",\n\"cfg\": {\n\"tools\": [\"locate\"],\n// ...\n}\n},\n{\n\"name\": \"Locate\",\n// ...\n}\n// ...\n</code></pre> <ul> <li>new localConfig.json configuration removes 'locate' from tools array and it keeps only the plugin configuration</li> </ul> <pre><code>// ...\n{\n\"name\": \"Map\",\n\"cfg\": {\n// ...\n}\n},\n{\n\"name\": \"Locate\",\n// ...\n}\n// ...\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#update-an-existing-project-to-include-embedded-dashboards-and-geostories","title":"Update an existing project to include embedded Dashboards and GeoStories","text":"<p>Embedded Dashboards and GeoStories need a new set of javascript entries, html templates and configuration files to make them completely available in an existing project.</p> <p>The steps described above assume this structure of the MapStore2 project for the files that need update:</p> <pre><code>MapStore2Project/\n|-- ...\n|-- js/\n|    |-- ...\n|    |-- dashboardEmbedded.jsx (new)\n|    |-- geostoryEmbedded.jsx (new)\n|-- MapStore2/\n|-- web/\n|    |-- ...\n|    |-- pom.xml\n|-- ...\n|-- dashboard-embedded-template.html (new)\n|-- dashboard-embedded.html (new)\n|-- ...\n|-- geostory-embedded-template.html (new)\n|-- geostory-embedded.html (new)\n|-- ...\n|-- prod-webpack.config.js\n|-- ...\n|-- webpack.config.js\n</code></pre> <p>1) create the entries files for the embedded application named <code>dashboardEmbedded.jsx</code> and <code>geostoryEmbedded.jsx</code> in the js/ folder with the following content (see links):     - dashboardEmbedded.jsx     - geostoryEmbedded.jsx</p> <p>2) add the html files and templates in the root directory of the project with these names and content (see links):     - dashboard-embedded-template.html     - dashboard-embedded.html     - geostory-embedded-template.html     - geostory-embedded.html</p> <p>3) update webpack configuration for development and production with the new entries and the related configuration:</p> <pre><code>- webpack.config.js\n\n```js\nmodule.exports = require('./MapStore2/build/buildConfig')(\n{\n// other entries...,\n// add new embedded entries to entry object\n\"geostory-embedded\": path.join(__dirname, \"js\", \"geostoryEmbedded\"),\n\"dashboard-embedded\": path.join(__dirname, \"js\", \"dashboardEmbedded\")\n},\n// ...\n);\n```\n\n- prod-webpack.config.js\n\n```js\n\nmodule.exports = require('./MapStore2/build/buildConfig')(\n{\n// other entries...,\n// add new embedded entries to entry object\n\"geostory-embedded\": path.join(__dirname, \"js\", \"geostoryEmbedded\"),\n\"dashboard-embedded\": path.join(__dirname, \"js\", \"dashboardEmbedded\")\n},\n// ...\n[\n// new HtmlWebpackPlugin({ ... }),\n// add plugin to copy all the embedded html and inject the correct bundle\nnew HtmlWebpackPlugin({\ntemplate: path.join(__dirname, 'geostory-embedded-template.html'),\nchunks: ['geostory-embedded'],\ninject: \"body\",\nhash: true,\nfilename: 'geostory-embedded.html'\n}),\nnew HtmlWebpackPlugin({\ntemplate: path.join(__dirname, 'dashboard-embedded-template.html'),\nchunks: ['dashboard-embedded'],\ninject: 'body',\nhash: true,\nfilename: 'dashboard-embedded.html'\n})\n],\n// ...\n);\n```\n</code></pre> <p>4) Add configuration to localConfig.json in the plugins section related to Share functionalities (Only with custom localConfig.json in the project):     - Dashboard share configuration</p> <pre><code>```js\n\"dashboard\": [\n    // ...\n    {\n        \"name\": \"Share\",\n        \"cfg\": {\n            \"showAPI\": false,\n            \"advancedSettings\": false,\n            \"shareUrlRegex\": \"(h[^#]*)#\\\\/dashboard\\\\/([A-Za-z0-9]*)\",\n            \"shareUrlReplaceString\": \"$1dashboard-embedded.html#/$2\",\n            \"embedOptions\": {\n                \"showTOCToggle\": false,\n                \"showConnectionsParamToggle\": true\n            }\n        }\n    },\n    // ...\n]\n```\n\n- Dashboard share configuration\n\n```js\n\"geostory\": [\n    // ...\n    {\n        \"name\": \"Share\",\n        \"cfg\": {\n            \"embedPanel\": true,\n            \"showAPI\": false,\n            \"advancedSettings\": {\n                \"hideInTab\": \"embed\",\n                \"homeButton\": true,\n                \"sectionId\": true\n            },\n            \"shareUrlRegex\": \"(h[^#]*)#\\\\/geostory\\\\/([^\\\\/]*)\\\\/([A-Za-z0-9]*)\",\n            \"shareUrlReplaceString\": \"$1geostory-embedded.html#/$3\",\n            \"embedOptions\": {\n                \"showTOCToggle\": false\n            }\n        }\n    },\n    // ...\n]\n```\n</code></pre> <p>5) update the web/pom.xml to copy all the related resources in the final *.war file with these new executions</p> <pre><code>&lt;!-- __PROJECTNAME__ should be equal to the one in use in the project, see other executions how they define the outputDirectory path  --&gt;\n&lt;execution&gt;\n&lt;id&gt;only dashboard-embedded.html&lt;/id&gt;\n&lt;phase&gt;process-classes&lt;/phase&gt;\n&lt;goals&gt;\n&lt;goal&gt;copy-resources&lt;/goal&gt;\n&lt;/goals&gt;\n&lt;configuration&gt;\n&lt;outputDirectory&gt;${basedir}/target/__PROJECTNAME__&lt;/outputDirectory&gt;\n&lt;encoding&gt;UTF-8&lt;/encoding&gt;\n&lt;resources&gt;\n&lt;resource&gt;\n&lt;directory&gt;${basedir}/../dist&lt;/directory&gt;\n&lt;includes&gt;\n&lt;include&gt;dashboard-embedded.html&lt;/include&gt;\n&lt;/includes&gt;\n&lt;excludes&gt;\n&lt;exclude&gt;MapStore2/*&lt;/exclude&gt;\n&lt;exclude&gt;MapStore2/**/*&lt;/exclude&gt;\n&lt;/excludes&gt;\n&lt;/resource&gt;\n&lt;/resources&gt;\n&lt;/configuration&gt;\n&lt;/execution&gt;\n&lt;execution&gt;\n&lt;id&gt;only geostory-embedded.html&lt;/id&gt;\n&lt;phase&gt;process-classes&lt;/phase&gt;\n&lt;goals&gt;\n&lt;goal&gt;copy-resources&lt;/goal&gt;\n&lt;/goals&gt;\n&lt;configuration&gt;\n&lt;outputDirectory&gt;${basedir}/target/__PROJECTNAME__&lt;/outputDirectory&gt;\n&lt;encoding&gt;UTF-8&lt;/encoding&gt;\n&lt;resources&gt;\n&lt;resource&gt;\n&lt;directory&gt;${basedir}/../dist&lt;/directory&gt;\n&lt;includes&gt;\n&lt;include&gt;geostory-embedded.html&lt;/include&gt;\n&lt;/includes&gt;\n&lt;excludes&gt;\n&lt;exclude&gt;MapStore2/*&lt;/exclude&gt;\n&lt;exclude&gt;MapStore2/**/*&lt;/exclude&gt;\n&lt;/excludes&gt;\n&lt;/resource&gt;\n&lt;/resources&gt;\n&lt;/configuration&gt;\n&lt;/execution&gt;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20200200-to-20210100","title":"Migration from 2020.02.00 to 2021.01.00","text":""},{"location":"developer-guide/mapstore-migration-guide/#update-to-webpack-5-module-federation","title":"Update to webpack 5 - Module federation","text":"<p>MapStore migrated to webpack 5 and provided the extension system using \"Webpack Module Federation\". Here the steps to update the existing files in your project.</p> <p>package.json:</p> <ul> <li>dev server scripts changed syntax. now you need to use <code>webpack serve</code> instead of <code>webpack-dev-server</code>. Replace also all <code>--colors</code> with <code>--color</code> in your scripts that use webpack / webpack-dev-server.</li> <li>Align <code>dependencies</code> and <code>devDependencies</code> with MapStore's one, reading the <code>package.json</code>, as usual.</li> <li>To support extensions in your project, you need to add <code>ModuleFederationPlugin</code> to your <code>prod-webpack.config.js</code> and <code>webpack.config.js</code></li> </ul> <pre><code>const ModuleFederationPlugin = require('./MapStore/build/moduleFederation').plugin; // &lt;-- new line\nmodule.exports = require('./buildConfig')(\nassign({\n\"mapstore2\": path.join(paths.code, \"product\", \"app\"),\n\"embedded\": path.join(paths.code, \"product\", \"embedded\"),\n\"ms2-api\": path.join(paths.code, \"product\", \"api\")\n},\nrequire('./examples')\n),\nthemeEntries,\npaths,\nextractThemesPlugin,\n[extractThemesPlugin, ModuleFederationPlugin], // &lt;-- this parameter has been changed, now it accepts also array of the plugins you want to add bot in prod and dev\n</code></pre> <p>Other the other changes required are applied automatically in <code>buildConfig.js</code>.</p>"},{"location":"developer-guide/mapstore-migration-guide/#eslint-config","title":"Eslint config","text":"<p>Now eslint configuration is shared in a separate npm module. To update your custom project you have to remove the following files:</p> <ul> <li><code>.eslintignore</code></li> <li><code>.eslintconfig</code></li> </ul> <p>And add to <code>package.json</code> the following entry, in the root:</p> <pre><code>        \"eslintConfig\": {\n\"extends\": [\n\"@mapstore/eslint-config-mapstore\"\n],\n\"parserOptions\": {\n\"babelOptions\": {\n\"configFile\": \"./MapStore2/build/babel.config.js\"\n}\n}\n},\n</code></pre> <p>If you have aproject that includes MapStore as a dependency, you can run <code>npm run updateDevDeps</code> to finalize the update. Otherwise make you sure to include:</p> <ul> <li>devDependencies:</li> <li>add <code>\"@mapstore/eslint-config-mapstore\": \"1.0.1\",</code></li> <li>delete <code>babel-eslint</code></li> <li>dependencies:</li> <li>update `\"eslint\": \"7.8.1\"</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#app-structure-review","title":"App structure review","text":"<p>From this version some base components of MapStore App (<code>StandardApp</code>, <code>StandardStore</code>...) has been restructured and better organized. Here a list of the breaking change you can find in a depending project</p> <ul> <li><code>web/client/product/main.jsx</code> has been updated to new <code>import</code> and <code>export</code> syntax (removed <code>require</code> and <code>exports.module</code>). So if you are importing it (usually in your <code>app.jsx</code>) you have to use the <code>import</code> syntax or use <code>require(...).default</code> in your project. The same for the other files.</li> <li>New structure of arguments in web/client/stores/StandardStore.js</li> </ul> <pre><code>const appStore = (\n{\ninitialState = {\ndefaultState: {},\nmobile: {}\n},\nappReducers = {},\nappEpics = {},\nrootReducerFunc = ({ state, action, allReducers }) =&gt; allReducers(state, action)\n},\nplugins = {},\nstoreOpts = {}\n) {\n...\n</code></pre> <ul> <li> <p>Moved standard epics, standard reducers and standard rootReducer function from web/client/stores/StandardStore.js to a separated file web/client/stores/defaultOptions.js</p> </li> <li> <p>loading extensions functionalities inside StandardApp has been moved to an specific withExtensions HOC, so if you are not using <code>main.js</code> but directly <code>StandardApp</code> and you need extensions you need to add this HOC to your StandardApp</p> </li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20200100-to-20200200","title":"Migration from 2020.01.00 to 2020.02.00","text":""},{"location":"developer-guide/mapstore-migration-guide/#new-authentication-rule-for-internal-services","title":"New authentication rule for internal services","text":"<p>With this new version the support for uploading extensions has been introduced. A new entry point needs administration authorization to allow the upload of new plugins by the administrator. So:</p> <ul> <li>In <code>localConfig.json</code> add the following entry in the <code>authenticationRules</code> array:</li> </ul> <pre><code>{\n\"urlPattern\": \".*rest/config.*\",\n\"method\": \"bearer\"\n}\n</code></pre> <p>the final entry should look like this</p> <pre><code> \"authenticationRules\": [{\n\"urlPattern\": \".*geostore.*\",\n\"method\": \"bearer\"\n}, {\n\"urlPattern\": \".*rest/config.*\",\n\"method\": \"bearer\"\n}, ...],\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#translation-files","title":"Translation files","text":"<ul> <li>The translations file extension has been changed into JSON. Now translation files has been renamed from <code>data.&lt;locale&gt;</code> to <code>data.&lt;locale&gt;.json</code>. This change makes the <code>.json</code> extension mandatory for all translation files. This means that depending projects with custom translation files should be renabled in the same name. E.g. <code>data.it-IT</code> have to be renamed as <code>data.it-IT.json</code></li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#database-update_2","title":"Database Update","text":"<p>Database schema has changed. To update your database you need to apply this SQL scripts to your database</p> <ul> <li>Update the user schema run the script available here:</li> </ul> <pre><code>-- Update the geostore database from 1.4.2 model to 1.5.0\n-- It adds fields to gs_security for external authorization\n\n-- The script assumes that the tables are located into the schema called \"geostore\"\n--      if you put geostore in a different schema, please edit the following search_path.\nSET search_path TO geostore, public;\n\n-- Tested only with postgres9.1\n\n-- Run the script with an unprivileged application user allowed to work on schema geostore\n\nalter table gs_security add column username varchar(255);\nalter table gs_security add column groupname varchar(255);\n\ncreate index idx_security_username on gs_security (username);\n\ncreate index idx_security_groupname on gs_security (groupname);\n</code></pre> <ul> <li>Add new categories</li> </ul> <pre><code>-- New CONTEXT category\nINSERT into geostore.gs_category (id ,name) values ( nextval('geostore.hibernate_sequence'),  'CONTEXT') ON CONFLICT DO NOTHING;\n-- New GEOSTORY category (introduced in 2020.01.00)\nINSERT into geostore.gs_category (id ,name) values (nextval('geostore.hibernate_sequence'),  'GEOSTORY') ON CONFLICT DO NOTHING;\n-- New TEMPLATE category\nINSERT into geostore.gs_category (id ,name) values ( nextval('geostore.hibernate_sequence'),  'TEMPLATE') ON CONFLICT DO NOTHING;\n-- New USERSESSION category\nINSERT into geostore.gs_category (id ,name) values ( nextval('geostore.hibernate_sequence'),  'USERSESSION') ON CONFLICT DO NOTHING;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#backend-update","title":"Backend update","text":"<p>For more details see this commit</p> <p>new files have been added:</p> <ul> <li><code>web/src/main/webapp/WEB-INF/dispatcher-servlet.xml</code></li> <li><code>web/src/main/resources/mapstore.properties</code></li> </ul> <p>some files has been changed:</p> <ul> <li><code>web/src/main/webapp/WEB-INF/web.xml</code></li> <li><code>pom.xml</code></li> <li><code>web/pom.xml</code></li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20190201-to-20200100","title":"Migration from 2019.02.01 to 2020.01.00","text":"<p>With MapStore 2020.01.00 some dependencies that were previously hosted on github, have now been published on the npm registry, and package.json has been updated accordingly. Here is the PR that documents how to update local package.json and local webpack if not using the mapstore buildConfig/testConfig common files.</p> <p>After updating package.json run npm install Now you should be able to run locally with npm start</p> <p>For more info see the related issue</p> <p>Moreover a new category has been added for future features, called GEOSTORY.</p> <p>It is not necessary for this release, but, to follow the update sequence, you can add it by executing the following line.</p> <pre><code>INSERT into geostore.gs_category (id ,name) values (nextval('geostore.hibernate_sequence'),  'GEOSTORY') ON CONFLICT DO NOTHING;\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20190100-to-20190101","title":"Migration from 2019.01.00 to 2019.01.01","text":"<p>MapStore 2019.01.01 changes the location of some of the build and test configuration files. This also affects projects using MapStore build files, sp if you update MapStore subproject to the 2019.01.01 version you also have to update some of the project configuration files. In particular:</p> <ul> <li>webpack.config.js and prod-webpack.config.js:</li> <li>update path to themes.js from ./MapStore2/themes.js to ./MapStore2/build/themes.js</li> <li>update path to buildConfig from ./MapStore2/buildConfig to ./MapStore2/build/buildConfig</li> <li>karma.conf.continuous-test.js and karma.config.single-run.js: update path to testConfig from ./MapStore2/testConfig to ./MapStore2/build/testConfig</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20170500-to-20180100","title":"Migration from 2017.05.00 to 2018.01.00","text":"<p>MapStore 2018.01.00 introduced theme and js and css versioning. This allows to auto-invalidates cache files for each version of your software. For custom projects you could choose to ignore this changes by setting version: \"no-version\" in your app.jsx <code>StandardRouter</code> selector:</p> <pre><code>//...\nconst routerSelector = createSelector(state =&gt; state.locale, (locale) =&gt; ({\nlocale: locale || {},\nversion: \"no-version\",\nthemeCfg: {\ntheme: \"mythheme\"\n},\npages\n}));\nconst StandardRouter = connect(routerSelector)(require('../MapStore2/web/client/components/app/StandardRouter'));\n//...\n</code></pre>"},{"location":"developer-guide/mapstore-migration-guide/#support-jstheme-versioning-in-your-project","title":"Support js/theme versioning in your project","text":"<p>Take a look to this pull request as reference. Basically versioning is implemented in 2 different ways for css and js files :</p> <ul> <li>Add at build time the js files inclusion to the files, with proper hashes.</li> <li>Load theme css files appending to the URL the ?{version} where version is the current mapstore2 version The different kind of loading for css files is needed to continue supporting the theme switching capabilities. For the future we would like to unify these 2 systems. See this issue.</li> </ul> <p>You have to:</p> <ul> <li>Add the version file to the root (<code>version.txt</code>).</li> <li>Create a template for each html file you have. These files will replace the html files when you build the final  war file. These files are like the original ones but without the <code>[bundle].js</code> file inclusion and without theme css.</li> <li>Add <code>HtmlWebpackPlugin</code> for production only, one for each js file. This plugin will add to the template file the script inclusion (example).</li> <li>if you have to include the script in the head (e.g. <code>api.html</code> has some script that need the js to be loaded before executing the inline scripts), use the option <code>inject: 'head'</code></li> <li>change each entry point (<code>app.jsx</code>, <code>api.jsx</code>, <code>embedded.jsx</code>, <code>yourcoustomentrypoint.jsx</code>) this way (example):</li> <li><code>version</code> reducer in <code>StandardRouter</code></li> <li><code>loadVersion</code> action in <code>initialActions</code></li> <li><code>version</code> and <code>loadAfterTheme</code> selectors to <code>StandardRouter</code> state.</li> </ul> <pre><code>// Example\nconst {versionSelector} = require('../MapStore2/web/client/selectors/version');\nconst {loadVersion} = require('../MapStore2/web/client/actions/version');\nconst version = require('../MapStore2/web/client/actions/version');\n//...\nStandardRouter = connect ( state =&gt; ({\nlocale: state.locale || {},\npages,\nversion : versionSelector(state),\nloadAfterTheme: loadAfterThemeSelector(state)\n}))(require('../MapStore2/web/client/components/app/StandardRouter'))\nconst appStore = require('../MapStore2/web/client/stores/StandardStore').bind(null, initialState, {\n// ...\nversion: version\n});\n// ...\nconst appConfig = {\n// ...\ninitialActions: [loadVersion]\n}\n</code></pre> <ul> <li>Add to your <code>pom.xml</code> some execution steps to replace html files with the ones generated in 'dist' directory. (example). And copy <code>version.txt</code></li> <li>Override the version file in your build process (e.g. you can use the commit hash)</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20170500-to-20170300-and-previews","title":"Migration from 2017.05.00 to 2017.03.00 and previews","text":"<p>In 2017.03.00 the <code>createProject.js</code> script created only a custom project. From version 2017.04.00 we changed the script to generate 2 kind of projects:</p> <ul> <li>custom: the previous version</li> <li>standard: mapstore standard</li> </ul> <p>Standard project wants to help to generate a project that is basically the MapStore product, where you can add your own plugins and customize your theme (before this you had to create a project similar to MapStore on your own) Depending on our usage of custom project, this may introduce some breaking changes. If you previously included some file from <code>product</code> folder, now <code>app.jsx</code> has been changed to call <code>main.jsx</code>. Please take a look on how the main product uses this to migrate your changes inside your custom project.</p>"},{"location":"developer-guide/mapstore-migration-guide/#migration-from-20170100-to-20170200","title":"Migration from 2017.01.00 to 2017.02.00","text":"<p>The version 2017.02.00 has many improvements and changes:</p> <ul> <li>introduced <code>redux-observable</code></li> <li>updated <code>webpack</code> to version 2</li> <li>updated <code>react-intl</code> to version 2.x</li> <li>updated <code>react</code> to [version 15.4.2] (https://facebook.github.io/react/blog/2016/04/07/react-v15.html)</li> <li>updated <code>react-bootstrap</code> to version 0.30.7</li> </ul> <p>We suggest you to:</p> <ul> <li>align your package.json with the latest version of 2017.02.00.</li> <li>update your webpack files (see below).</li> <li>update your tests to react 15 version. see upgrade guide</li> <li>Update your <code>react-bootstrap</code> custom components with the new one (see below).</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#side-effect-management-introduced-redux-observable","title":"Side Effect Management - Introduced redux-observable","text":"<p>To manage complex asynchronous operations the thunk middleware is not enough. When we started with MapStore there was no alternative to thunk. Now we have some options. After a spike (results available here) we chose to use redux-observable. For the future, we strongly recommend to use this library to perform asynchronous tasks.</p> <p>Introducing this library will allow to :</p> <ul> <li>remove business logic from the components event handlers</li> <li>now all new  <code>actionCreators</code> should return pure actions. All async stuff will be deferred to the epics.</li> <li>avoid bouncing between components and state to trigger side effect</li> <li>speed up development with <code>rxjs</code> functionalities</li> <li>Existing thunk integration will be maintained since all the thunks will be replaced.</li> </ul> <p>If you are using the Plugin system and the StandardStore, you may have only to include the missing new dependencies in your package.json (redux-observable and an updated version of redux).</p> <p>Check the current package.json to get he most recent versions. For testing we included also redux-mockup-store as a dependency, but you are free to test your epics as you want.</p> <p>For more complex integrations check this pull request to see how to integrate redux-observable or follow the guide on the redux-observable site.</p>"},{"location":"developer-guide/mapstore-migration-guide/#webpack-update-to-version-2","title":"Webpack update to version 2","text":"<p>We updated webpack (old one is deprecated), check this pull request to find out how to update your webpack files. here a list of what we had to update:</p> <ul> <li>module.loaders are now module.rules</li> <li>update your package.json with latest versions of webpack, webpack plugins and karma libs and integrations (Take a look to the changes on package.json in the pull request if you want a detailed list of what to update in this case).</li> <li>change your test proxy configuration with the new one.</li> </ul> <p>More details on the webpack site.</p>"},{"location":"developer-guide/mapstore-migration-guide/#react-intl-update-to-2x","title":"react-intl update to  2.x","text":"<p>See this pull request for the details. You should only have to update your package.json</p>"},{"location":"developer-guide/mapstore-migration-guide/#react-update-to-1542","title":"react update to 15.4.2","text":"<p>Check this pull request to see how to:</p> <ul> <li>update your package.json</li> <li>update your tests</li> </ul>"},{"location":"developer-guide/mapstore-migration-guide/#react-bootstrap-update","title":"React Bootstrap update","text":"<p>The version we are using is not documented anymore, and not too much compatible with react 15 (too many warnings). So this update can not be postponed anymore. The bigger change in this case is that the Input component do not exists anymore. You will have to replace all your Input with the proper components, and update the <code>package.json</code>. See this pull request for details.</p>"},{"location":"developer-guide/mapstore-projects/","title":"MapStore Projects","text":"<p>MapStore projects can be created using the Project Creation Script.</p> <p>A MapStore project is a custom WebGis application that uses MapStore as a framework.</p> <p>The MapStore framework is linked as a git submodule in the MapStore2 project subfolder.</p> <p>Note</p> <p>Since MapStore is linked as a submodule, every project custom file should be created outside of it. This allows updating MapStore to a newer version easily, without conflicts. The general rule is: never add / update / modify files directly in the MapStore2 subfolder.</p>"},{"location":"developer-guide/mapstore-projects/#standard-projects","title":"Standard Projects","text":"<p>A Standard MapStore project is a project that is, initially, a perfect copy of the standard MapStore product.</p> <p>To create custom application using the standard projects template, you will start from js/app.jsx that is the project entry point.</p> <p>Editing app.jsx you can start using your own configuration files and add custom behaviours and look and feel to your project, in particular:</p> <ul> <li>You can add your own translation files. Setting an array of paths in the <code>translationsPath</code>, the resources will be loaded in cascade from every directory of the array. So you can keep all the original translations from MapStore (first element of the array) and add your own files in the directory <code>translations</code>, overriding original values of the json or adding new ones (for instance, for your custom plugins). The files in the new directory must follow the same naming convention of the files in the oridinal directory.</li> </ul> <pre><code>ConfigUtils.setConfigProp(\"translationsPath\", [\"./MapStore2/web/client/translations\", \"./translations\"]);\n</code></pre> <ul> <li>Use your own configuration file for plugins and other configurations. You can copy the original <code>localConfig.json</code> in the root of the project and configure the application to load it (instead of the default one, located in <code>MapStore2/web/client/localConfig.json</code>).</li> </ul> <pre><code>ConfigUtils.setLocalConfigurationFile(\"localConfig.json\");\n</code></pre> <p>or you can apply some patch files defining an array of configurations, where the first is the main json file, and the rest are the patch files which must end with \"patch.json\" in the filename</p> <pre><code>ConfigUtils.setLocalConfigurationFile([\"localConfig.json\", \"production.patch.json\"]);\n</code></pre> <p>the patch will be applied using this package</p> <ul> <li>Configure your own pages:</li> </ul> <pre><code>import productAppConfig from \"@mapstore/product/appConfig\";\nimport MapViewer from \"@mapstore/product/pages/MapViewer\";\n\nconst appConfig = {\n...productAppConfig,\npages: [{\nname: \"mapviewer\",\npath: \"/\",\ncomponent: MapViewer\n}]\n};\n</code></pre> <ul> <li>Include the plugins you want in the app (either MapStore plugins or your own):</li> </ul> <pre><code>import plugins from \"./plugins\";\n</code></pre>"},{"location":"developer-guide/mapstore-projects/#organizing-your-code","title":"Organizing your code","text":"<p>Our convention is to use the js folder to store your project code. You should recreate inside it the usual folders to organize your code based on the source code type:</p> <ul> <li>components</li> <li>actions</li> <li>reducers</li> <li>epics</li> <li>plugins</li> </ul> <p>Images and other static assets should be located in the assets folder instead.</p>"},{"location":"developer-guide/plugins-architecture/","title":"Plugins Architecture","text":"<p>The architecture of MapStore based on the concept of plugins. Every tool of MapStore is a plugin, that are the main building blocks of the application.</p> <p>A plugin in MapStore an entity that can be:</p> <ul> <li>rendered in the application (via a React components)</li> <li>connected to a Redux store, so that some properties are automatically wired to the standard MapStore state</li> <li>wired to standard actions for common events to trigger</li> </ul> <p>In addition a plugin:</p> <ul> <li>declares some reducers that adds some parts to the global state, if needed</li> <li>declares some epics that need to be added to the redux-observable middleare, if needed</li> <li>inject in other plugin react components to be rendered (for communication, extensions, etc.)</li> <li>is fully configurable to be easily customized to a certain level</li> </ul> <p>The plugins are managed by <code>PluginContainer</code> (typically a <code>Page</code>, but not necessarily) that is a React component that renders the plugins in the application and handle proper dependencies.</p> <p>Plugins are used in different contexts:</p> <ul> <li>Standard plugins Plugins that are used in the standard MapStore application and that are part of the framework.</li> <li>Custom plugins Plugins developed in a custom MapStore project ( see Setup a MapStore Project)</li> <li>Extensions: Plugins that can be build and installed in an existing instance of MapStore (see Extensions)</li> </ul> <p>For more information about how to create a plugin, see Create your plugins</p>"},{"location":"developer-guide/plugins-documentation/","title":"Configuring plugins","text":"<p>To configure the plugins used by your application, a dedicated section is available in the localConfig.json configuration file:</p> <pre><code>\"plugins\": {\n...\n}\n</code></pre> <p>Inside the plugins section, several modes can be configured (e.g. desktop or mobile), each one with its own list of plugins:</p> <pre><code>\"plugins\": {\n\"mobile\": [...],\n\"desktop\": [...]\n}\n</code></pre> <p>Each plugin can be simply listed (and the default configuration is used):</p> <pre><code>\"plugins\": {\n...\n\"desktop\": [\"Map\", \"MousePosition\", \"Toolbar\", \"TOC\"]\n}\n</code></pre> <p>or fully configured:</p> <pre><code>\"plugins\": {\n...\n\"desktop\": [{\n\"name\": \"Map\",\n...\n}\n},\n...\n]\n}\n</code></pre>"},{"location":"developer-guide/plugins-documentation/#dynamic-configuration","title":"Dynamic configuration","text":"<p>Configuration properties of plugins can use expressions, so that they are dynamically bound to the application state.</p> <p>An expression is anything between curly brackets ({...}) that is a javascript expression, where the monitored state of the application is available as a set of variables.</p> <p>To define the monitored state, you have to add a monitorState property in localConfig.json.</p> <pre><code>{\n...\n\"monitorState\": [{\"name\": \"mapType\", \"path\": \"mapType.mapType\"}]\n...\n}\n</code></pre> <p>Where:</p> <ul> <li>name is the name of the variable that can be used in expressions</li> <li>path is a javascript object path to the state fragment to be monitored (e.g. map.present.zoom)</li> </ul> <p>When you have a monitored state, you can use it in configuration properties this way: Be sure to write a valid javascript expression.</p> <pre><code>\"cfg\": {\n...\n\"myProp\": \"{state('mapType') === 'openlayers' ? 1 : 2}\"\n...\n}\n</code></pre> <p>Expressions are supported in cfg properties and in hideFrom and showIn sections.</p> <p>In addition to monitored state also the page request parameters are available as variables to be used in expressions.</p> <p>Look at the plugin reference page for a list of available configuration properties.</p>"},{"location":"developer-guide/plugins-howto/","title":"Creating a MapStore2 plugin","text":"<p>The MapStore2 plugins architecture allows building your own independent modules that will integrate seamlessly into your project.</p> <p>Creating a plugin is like assembling and connecting several pieces together into an atomic module. This happens by writing a plugin module, a ReactJS JSX file exporting the plugin descriptor.</p>"},{"location":"developer-guide/plugins-howto/#introduction","title":"Introduction","text":"<p>During this tutorial, you will learn how to create and configure plugins in a MapStore project. If you don't know how to work with MapStore projects, please read the Projects Guide. For this tutorial, a \"standard project\" is used.</p>"},{"location":"developer-guide/plugins-howto/#a-plugin-example","title":"A plugin example","text":"<p><code>js/plugins/Sample.jsx</code></p> <p>Plugins are react component exported with the createPlugin function</p> <pre><code>import React from \"react\";\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\n\nconst Sample = () =&gt; {\nconst style = {\nposition: \"absolute\",\ntop: 100,\nleft: 100,\nzIndex: 2000\n};\nreturn (\n&lt;div style={style}&gt;\nSample\n&lt;/div&gt;\n);\n};\n\nexport default createPlugin(\"Sample\", {\ncomponent: Sample\n});\n</code></pre> <p>Being a component with a name (Sample in our case) you can include it in your project by creating a plugins.js file.</p> <p><code>js/plugins.js</code></p> <pre><code>import SamplePlugin from \"./plugins/Sample\";\n\nexport const plugins = {\n// ...\nSamplePlugin,\n// ...\n};\n\nexport default {\nplugins\n};\n</code></pre> <p>Note The chosen component name is always suffixed with Plugin when imported in the plugins.js file.</p> <p>Include the plugin.js from your app.jsx either replacing the plugins import from the product or extending it:</p> <p><code>js/app.jsx</code></p> <pre><code>...\n\nimport m2Plugins from \"@mapstore/product/plugins\";\nimport customPlugins from \"./plugins\";\nimport main from \"@mapstore/product/main\";\n\nconst allPlugins = {\n...m2Plugins,\nplugins: {\n...customPlugins.plugins,\n...m2Plugins.plugins\n}\n};\n\nmain(appConfig, allPlugins);\n</code></pre> <p>Then you have to configure it properly so that is enabled in one or more application modes / pages:</p> <p><code>localConfig.json</code></p> <pre><code>{\n...\n\"plugins\": {\n\"desktop\": [{ \"name\": \"Sample\" }, ...],\n...\n}\n}\n</code></pre> <p>Note: to enable a plugin you need to do two things:</p> <ul> <li>import it in the plugins.js file</li> <li>configure it in localConfig.json (remove the Plugins suffix here)</li> </ul> <p>If one is missing, the plugin won't appear. To globally remove a plugin from your project the preferred way is removing it from plugins.js, because this will reduce the global javascript size of your application.</p> <p>You can also specify plugins properties in the configuration, using the cfg property:</p> <p><code>localConfig.json (2)</code></p> <pre><code>{\n...\n\"plugins\": {\n\"desktop\": [{\n\"name\": \"Sample\",\n\"cfg\": {\n\"myproperty\": \"myvalue\"\n}\n}, ...],\n...\n}\n}\n</code></pre>"},{"location":"developer-guide/plugins-howto/#a-store-connected-plugin-example","title":"A store connected plugin example","text":"<p>A plugin component is a smart component (connected to the Redux store) so that properties can be taken from the global state, as needed.</p> <p><code>js/plugins/Sample.jsx (1)</code></p> <pre><code>import React from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\n\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\n\nconst SampleComponent = ({\nstyle,\nzoom\n}) =&gt; {\nreturn (\n&lt;div style={style}&gt;\nZoom: {zoom}\n&lt;/div&gt;\n);\n};\n\nSampleComponent.propTypes = {\nstyle: PropTypes.object,\nzoom: PropTypes.number\n};\n\nSampleComponent.defaultProps = {\nstyle: {\nposition: \"absolute\",\ntop: 100,\nleft: 100,\nzIndex: 2000\n}\n};\n\nconst Sample = connect((state) =&gt; {\nreturn {\n// connected property\nzoom: state?.map?.present?.zoom\n};\n})(SampleComponent);\n\nexport default createPlugin(\"Sample\", {\ncomponent: Sample\n});\n</code></pre> <p>A plugin can use actions to update the global state.</p> <p><code>js/plugins/Sample.jsx (2)</code></p> <pre><code>import React from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\n\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\nimport { changeZoomLevel } from \"@mapstore/actions/map\";\n\nconst SampleComponent = ({\nstyle,\nzoom,\nonZoom\n}) =&gt; {\nreturn (\n&lt;div style={style}&gt;\nZoom: {zoom}\n&lt;button onClick={() =&gt; onZoom(zoom + 1)}&gt;\nIncrease\n&lt;/button&gt;\n&lt;/div&gt;\n);\n};\n\nSampleComponent.propTypes = {\nstyle: PropTypes.object,\nzoom: PropTypes.number,\nonZoom: PropTypes.func\n};\n\nSampleComponent.defaultProps = {\nstyle: {\nposition: \"absolute\",\ntop: 100,\nleft: 100,\nzIndex: 2000\n},\nonZoom: () =&gt; {}\n};\n\nconst Sample = connect((state) =&gt; {\nreturn {\nzoom: state?.map?.present?.zoom\n};\n}, {\n// connected action\nonZoom: changeZoomLevel\n})(SampleComponent);\n\nexport default createPlugin(\"Sample\", {\ncomponent: Sample\n});\n</code></pre> <p>A plugin can define its own state fragments and the related reducers. You will also be able to define your own actions.</p> <p><code>js/actions/sample.js</code></p> <pre><code>export const UPDATE_SOMETHING = \"SAMPLE:UPDATE_SOMETHING\";\nexport const updateSomething = (payload) =&gt; ({\ntype: UPDATE_SOMETHING,\npayload\n});\n</code></pre> <p><code>js/reducers/sample.js</code></p> <pre><code>import { UPDATE_SOMETHING } from \"@js/actions/sample\";\nfunction sample(\nstate = { text: \"Initial Text\" },\naction\n) {\nswitch (action.type) {\ncase UPDATE_SOMETHING:\nreturn {\ntext: action.payload\n};\ndefault:\nreturn state;\n}\n}\nexport default sample;\n</code></pre> <p><code>js/plugins/Sample.jsx (3)</code></p> <pre><code>import React from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\n\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\n\nimport { updateSomething } from \"@js/actions/sample\";\nimport sample from \"@js/reducers/sample\";\n\nconst SampleComponent = ({\nstyle,\ntext,\nonUpdate\n}) =&gt; {\nreturn (\n&lt;div style={style}&gt;\nText: {text}\n&lt;button\nonClick={() =&gt; onUpdate(\"Updated Text\")}\n&gt;\nUpdate\n&lt;/button&gt;\n&lt;/div&gt;\n);\n};\n\nSampleComponent.propTypes = {\nstyle: PropTypes.object,\ntext: PropTypes.string,\nonUpdate: PropTypes.func\n};\n\nSampleComponent.defaultProps = {\nstyle: {\nposition: \"absolute\",\ntop: 100,\nleft: 100,\nzIndex: 2000\n},\ntext: \"\",\nonUpdate: () =&gt; {}\n};\n\nconst Sample = connect((state) =&gt; {\nreturn {\n// connected property\ntext: state?.sample?.text\n};\n}, {\n// connected action\nonUpdate: updateSomething\n})(SampleComponent);\n\nexport default createPlugin(\"Sample\", {\ncomponent: Sample,\nreducers: {\nsample\n}\n});\n</code></pre>"},{"location":"developer-guide/plugins-howto/#data-fetching-and-side-effects","title":"Data fetching and side effects","text":"<p>Side effects should be limited as much as possible, but there are cases where a side effect cannot be avoided. In particular we need to asynchronously load the data from external web services or files.</p> <p>To handle data fetching a plugin can define Epics. To have more detail about epics look at the Epics developers guide section of this documentation.</p> <p><code>js/actions/sample.js</code></p> <pre><code>// custom action\nexport const LOAD_DATA = \"SAMPLE:LOAD_DATA\";\nexport const LOADED_DATA = \"SAMPLE:LOADED_DATA\";\nexport const LOAD_ERROR = \"SAMPLE:LOAD_ERROR\";\nexport const loadData = () =&gt; ({\ntype: LOAD_DATA\n});\n\nexport const loadedData = (payload) =&gt; ({\ntype: LOADED_DATA,\npayload\n});\n\nexport const loadError = (error) =&gt; ({\ntype: LOAD_ERROR,\nerror\n});\n</code></pre> <p><code>js/reducers/sample.js</code></p> <pre><code>import { LOADED_DATA, LOAD_ERROR } from \"@js/actions/sample\";\nfunction sample(\nstate = { text: \"Initial Text\" },\naction\n) {\nswitch (action.type) {\ncase LOADED_DATA:\nreturn {\ntext: action.payload\n};\ncase LOAD_ERROR:\nreturn {\nerror: action.error\n};\ndefault:\nreturn state;\n}\n}\nexport default sample;\n</code></pre> <p><code>js/epics/sample.js</code></p> <pre><code>import { Observable } from \"rxjs\";\nimport axios from \"axios\";\n\nimport {\nLOAD_DATA,\nloadedData,\nloadError\n} from \"@js/actions/sample\";\n\nexport const loadDataEpic = (action$) =&gt;\naction$.ofType(LOAD_DATA)\n.switchMap(() =&gt; {\nreturn Observable.defer(() =&gt;\naxios.get(\"version.txt\")\n)\n.switchMap((response) =&gt;\nObservable.of(\nloadedData(response.data)\n)\n)\n.catch(e =&gt;\nObservable.of(\nloadError(e.message)\n)\n);\n});\n\nexport default {\nloadDataEpic\n};\n</code></pre> <p><code>js/plugins/Sample.jsx</code></p> <pre><code>import React from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\n\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\n\nimport { loadData } from \"@js/actions/sample\";\nimport sampleEpics from \"@js/epics/sample\";\nimport sample from \"@js/reducers/sample\";\n\nconst SideEffectComponent = ({\nstyle,\ntext,\nonLoad\n}) =&gt; {\nreturn (\n&lt;div style={style}&gt;\nText: {text}\n&lt;button onClick={() =&gt; onLoad()}&gt;\nLoad\n&lt;/button&gt;\n&lt;/div&gt;\n);\n};\n\nSideEffectComponent.propTypes = {\nstyle: PropTypes.object,\ntext: PropTypes.string,\nonLoad: PropTypes.func\n};\n\nSideEffectComponent.defaultProps = {\nstyle: {\nposition: \"absolute\",\ntop: 100,\nleft: 100,\nzIndex: 2000\n},\ntext: \"\",\nonLoad: () =&gt; {}\n};\n\nconst Sample = connect((state) =&gt; {\nreturn {\ntext: state?.sample?.text\n};\n}, {\n// connected action\nonLoad: loadData\n})(SideEffectComponent);\n\nexport default createPlugin(\"Sample\", {\ncomponent: Sample,\nreducers: {\nsample\n},\nepics: sampleEpics\n});\n</code></pre>"},{"location":"developer-guide/plugins-howto/#plugin-containers","title":"Plugin Containers","text":"<p>It is possible to define Container plugins, that are able to receive a list of items from the plugins system automatically. Think of menus or toolbars that can dynamically configure their items / tools from the configuration.</p> <p>In addition to those \"user defined\" containers, there is always a root container. When no container is specified for a plugin, it will be included in the root container.</p> <p><code>js/plugins/Container.jsx</code></p> <pre><code>import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\n\nconst Container = ({\nstyle,\nitems\n}) =&gt; {\nreturn (\n&lt;div style={style}&gt;\n{items.map(item =&gt; {\n// item.plugin is the plugin ReactJS component\nconst Item = item.plugin;\nreturn (\n&lt;Item\nkey={item.id}\nid={item.id}\nname={item.name}\n/&gt;\n);\n})}\n&lt;/div&gt;\n);\n};\n\nContainer.propTypes = {\nstyle: PropTypes.object,\nitems: PropTypes.array\n};\n\nContainer.defaultProps = {\nstyle: {\nposition: \"absolute\",\ntop: 100,\nleft: 100,\nzIndex: 2000\n},\nitems: []\n};\n\nexport default createPlugin(\"Container\", {\ncomponent: Container\n});\n</code></pre>"},{"location":"developer-guide/plugins-howto/#plugins-for-other-plugins","title":"Plugins for other plugins","text":"<p>Since we have containers, we can build plugins that can be contained in one or more container plugins.</p> <p><code>js/plugins/Sample.jsx</code></p> <pre><code>import React from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\n\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\n\nimport sample from \"@js/reducers/sample\";\n\nconst SampleComponent = ({\ntext\n}) =&gt; {\nreturn (\n&lt;div&gt;\nText: {text}\n&lt;/div&gt;\n);\n};\n\nSampleComponent.propTypes = {\ntext: PropTypes.string\n};\n\nSampleComponent.defaultProps = {\ntext: \"\"\n};\n\nconst Sample = connect((state) =&gt; {\nreturn {\ntext: state?.sample?.text\n};\n})(SampleComponent);\n\nexport default createPlugin(\"Sample\", {\ncomponent: Sample,\nreducers: {\nsample\n},\ncontainers: {\n// we support the previously defined Container Plugin as a\n// possible container for this plugin\nContainer: {\nname: \"Sample\",\nid: \"sample-tool\",\npriority: 1\n}\n}\n});\n</code></pre> <p>Each section defines a possible container for the plugin, as the name of another plugin (Container in the example). The properties in it define the plugin behaviour in relation to the container (e.g. id of the item).</p> <p>Containers will receive a list of items similar to this:</p> <pre><code>items = [{ plugin: Sample, name: \"Sample\", id: \"sample-tool\", ... }]\n</code></pre> <p>Notice that also container related properties can be overridden in the application configuration, using the override property:</p> <p><code>localConfig.json</code></p> <pre><code>{\n...\n\"plugins\": {\n\"desktop\": [{\n\"name\": \"Sample\",\n\"override\": {\n\"Container\": {\n\"name\": \"Another Sample\"\n}\n}\n}, ...],\n...\n}\n}\n</code></pre>"},{"location":"developer-guide/plugins-howto/#plugins-configuration","title":"Plugins Configuration","text":"<p>We have already mentioned that plugins can be configured through the localConfig.json file. The simplest configuration needed to include the plugin in a particular application mode is accomplished by listing a JSON object specifying the name property of the plugin in the plugins array of the chosen mode/page:</p> <p><code>localConfig.json</code></p> <pre><code>{\n...\n\"plugins\": {\n\"desktop\": [{ \"name\": \"Sample\" }, ...],\n...\n}\n}\n</code></pre> <p>It is possible to customize a plugin configuration adding a cfg property to the plugin JSON object. All the cfg properties are passed as props to the main component of the plugin.</p> <pre><code>{\n...\n\"plugins\": {\n\"desktop\": [{\n\"name\": \"Sample\",\n\"cfg\": {\n\"text\": \"my text\"\n}\n...\n}, ...],\n...\n}\n}\n</code></pre>"},{"location":"developer-guide/plugins-howto/#dynamic-configuration","title":"Dynamic configuration","text":"<p>Configuration can also dynamically change when the application state changes. This is accomplished by using expressions in configuration values. An expression is a value of the following form:</p> <pre><code>\"property\": \"{expression}\"\n</code></pre> <p>The expression itself is javascript code (supported by the browser, babel transpiled code is not supported here) where you can use the following variables:</p> <ul> <li>request: request URL parsed by the url library</li> <li>context: anything defined in plugins.js requires section</li> <li>state: a function usable to extract values from the application state (e.g. state('map.present.zoom' to get current zoom))</li> </ul> <p>Note that not all the application state is available through the state function, only the monitored state is. To add new fragments the monitored state, you can add the following to localConfig.json:</p> <pre><code>{\n...,\n\"monitorState\": [\n{\"name\": \"router\", \"path\": \"router.location.pathname\"},\n{\"name\": \"browser\", \"path\": \"browser\"},\n{\"name\": \"featuregridmode\", \"path\": \"featuregrid.mode\"}\n],\n...\n}\n</code></pre> <p>The default monitored state is:</p> <pre><code>{\n...,\n\"monitorState\": [\n{\"name\": \"router\", \"path\": \"router.location.pathname\"},\n{\"name\": \"browser\", \"path\": \"browser\"},\n{\"name\": \"geostorymode\", \"path\": \"geostory.mode\"},\n{\"name\": \"featuregridmode\", \"path\": \"featuregrid.mode\"},\n{\"name\": \"userrole\", \"path\": \"security.user.role\"},\n{\"name\": \"printEnabled\", \"path\": \"print.capabilities\"}\n],\n...\n}\n</code></pre>"},{"location":"developer-guide/plugins-howto/#example","title":"Example","text":"<pre><code>{\n...,\n\"plugins\": {\n\"desktop\": [{\n\"name\": \"Sample\",\n\"cfg\": {\n\"text\": \"{state('mapType') === 'leaflet' ? 'Leaflet Map' : 'OpenLayers Map'}\"\n}\n...\n}, ...],\n...\n}\n...\n}\n</code></pre>"},{"location":"developer-guide/plugins-howto/#container-configuration","title":"Container configuration","text":"<p>Each plugin can define a list of supported containers, but it's the plugin system that decides which ones will be used at runtime based on:</p> <ul> <li>container existence: if a container is not configured, it will not be used</li> <li>between the existing ones, the ones with the highest priority property value will be chosen; note that a plugin can be included in more than one container if they have the same priority</li> </ul>"},{"location":"developer-guide/plugins-howto/#example_1","title":"Example","text":"<pre><code>// ...\n\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\n\n// ...\n\nexport default createPlugin(\"Sample\", {\ncomponent: Sample,\ncontainers: {\nContainer1: {\nname: \"Sample\",\nid: \"sample-tool\",\npriority: 1,\n// ...\n},\nContainer2: {\nname: \"Sample\",\nid: \"sample-tool\",\npriority: 2,\n// ...\n},\nContainer3: {\nname: \"Sample\",\nid: \"sample-tool\",\npriority: 3,\n// ...\n}\n}\n});\n</code></pre> <p>If all the containers exist, Container3 will be chosen, the one with highest priority,if not Container2 will be used, and so on.</p> <p>To explicitly configure plugins containment and introduce custom behaviours (overriding default properties), the override configuration property is available. Using it, you can override the relation between a plugin and its supported containers.</p> <p>We can change containers relation like this:</p> <pre><code>{\n...,\n\"plugins\": {\n\"desktop\": [{\n\"name\": \"Sample\",\n\"override\": {\n\"Container1\": {\n\"name\": \"custom name\",\n\"priority\": 4\n}\n}\n...\n}, ...],\n...\n}\n...\n}\n</code></pre> <p>This will force the plugin system to choose Container1 instead of Container3, and will override the name property.</p> <p>There is also a set of options to (dynamically) add/exclude containers:</p> <ul> <li>showIn: can be used to add a plugin to a container or more than one, in addition to the default one (it is an array of container plugin names)</li> <li>hideFrom: can be used to exclude a plugin from a given container or more than one (it is an array of container plugin names)</li> <li>doNotHide: can be used to show a plugin in the root container, in addition to the default one</li> <li>alwaysRender: can be used to always renders the component in the given container, regardless the priority</li> </ul> <p>Note that also these properties accept dynamic expressions.</p> <p><code>js/plugins/Container.jsx</code></p> <pre><code>import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\n\nconst Container = ({\nitems\n}) =&gt; {\nconst style = {\nzIndex: 1000,\nborder: \"solid black 1px\",\nwidth: \"200px\",\nheight: \"200px\",\nposition: \"absolute\",\ntop: \"100px\",\nleft: \"100px\"\n};\nreturn (\n&lt;div style={style}&gt;\n{items.map(item =&gt; {\n// item.plugin is the plugin ReactJS component\nconst Item = item.plugin;\nreturn (\n&lt;Item\nkey={item.id}\nid={item.id}\nname={item.name}\n/&gt;\n);\n})}\n&lt;/div&gt;\n);\n};\n\nContainer.propTypes = {\nitems: PropTypes.array\n};\n\nContainer.defaultProps = {\nitems: []\n};\n\nexport default createPlugin(\"Container\", {\ncomponent: Container\n});\n</code></pre> <p><code>js/plugins/ContainerOther.jsx</code></p> <pre><code>import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\n\nconst ContainerOther = ({\nitems\n}) =&gt; {\nconst style = {\nzIndex: 1000,\nborder: \"solid red 1px\",\nwidth: \"200px\",\nheight: \"200px\",\nposition: \"absolute\",\ntop: \"100px\",\nleft: \"100px\"\n};\nreturn (\n&lt;div style={style}&gt;\n{items.map(item =&gt; {\n// item.plugin is the plugin ReactJS component\nconst Item = item.plugin;\nreturn (\n&lt;Item\nkey={item.id}\nid={item.id}\nname={item.name}\n/&gt;\n);\n})}\n&lt;/div&gt;\n);\n};\n\nContainerOther.propTypes = {\nitems: PropTypes.array\n};\n\nContainerOther.defaultProps = {\nitems: []\n};\n\nexport default createPlugin(\"ContainerOther\", {\ncomponent: ContainerOther\n});\n</code></pre> <p><code>js/plugins/Sample.jsx</code></p> <pre><code>import React from \"react\";\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\n\nconst Sample = () =&gt; {\nreturn (\n&lt;div&gt;Hello&lt;/div&gt;\n);\n};\n\nexport default createPlugin(\"Sample\", {\ncomponent: Sample,\ncontainers: {\nContainer: {\nname: \"Sample\",\nid: \"sample-tool\",\npriority: 1\n},\nContainerOther: {\nname: \"Sample\",\nid: \"sample-tool\",\npriority: 1\n}\n}\n});\n</code></pre> <p>With this configuration the sample plugin will be shown in both Container and ContainerOther plugins (they have the same priority, so both are picked).</p> <p>We can change this using <code>showIn</code> or <code>hideFrom</code> in <code>localConfig.json</code>:</p>"},{"location":"developer-guide/plugins-howto/#localconfigjson-showin-and-hidefrom-examples","title":"localConfig.json - <code>showIn</code> and <code>hideFrom</code> examples","text":"<pre><code>{\n...,\n\"plugins\": {\n\"desktop\": [{\n\"name\": \"Sample\",\n\"showIn\": [\"Container\"]\n...\n}, ...],\n...\n}\n...\n}\n</code></pre> <p>or</p> <pre><code>{\n...,\n\"plugins\": {\n\"desktop\": [{\n\"name\": \"Sample\",\n\"hideFrom\": [\"ContainerOther\"]\n...\n}, ...],\n...\n}\n...\n}\n</code></pre> <p>We can also add the plugin to the root container, using the doNotHide property (note that this is a container property, so we have to use an override for it):</p>"},{"location":"developer-guide/plugins-howto/#localconfigjson-donothide-example","title":"localConfig.json - <code>doNotHide</code> example","text":"<pre><code>{\n...,\n\"plugins\": {\n\"desktop\": [{\n\"name\": \"Sample\",\n\"showIn\": [\"Container\"],\n\"override\": {\n\"Container\": {\n\"doNotHide\": true\n}\n}\n...\n}, ...],\n...\n}\n...\n}\n</code></pre>"},{"location":"developer-guide/plugins-howto/#conditionally-disabling-plugins","title":"Conditionally disabling plugins","text":"<p>Dynamic expression can also be used to enable a plugin only when a specific application state is met, using the disablePluginIf property.</p> <pre><code>{\n...,\n\"plugins\": {\n\"desktop\": [{\n\"name\": \"Sample\",\n\"cfg\": {\n\"disablePluginIf\": \"{state('mapType') === 'cesium'}\"\n}\n...\n}, ...],\n...\n}\n...\n}\n</code></pre> <p>The plugin will be disabled in 3D mode.</p>"},{"location":"developer-guide/plugins-howto/#lazy-loading-plugins","title":"Lazy loading plugins","text":"<p>You can lazy load your plugins components using the react lazy and Suspense API. This is especially useful for plugins that include components with big external libraries.</p> <p><code>js/plugins/Sample.jsx</code></p> <pre><code>import React, { useState, lazy, Suspense } from \"react\";\nimport { createPlugin } from \"@mapstore/utils/PluginsUtils\";\nconst LazySampleComponent = lazy(() =&gt; import(\"@js/components/LazySampleComponent\"));\n\nconst Sample = () =&gt; {\n// this local state could be moved to redux state\n// as explained in previous sections\nconst [enabled, setEnabled] = useState(false);\nconst style = {\nposition: \"absolute\",\ntop: 100,\nleft: 100,\nzIndex: 2000\n};\nreturn (\n&lt;div style={style}&gt;\n&lt;button onClick={() =&gt; setEnabled(enabled)}&gt;Load plugin&lt;/button&gt;\n{enabled\n? &lt;Suspense fallback=\"Loading...\"&gt;\n&lt;LazySampleComponent /&gt;\n&lt;/Suspense&gt;\n: null}\n&lt;/div&gt;\n);\n};\n\nexport default createPlugin(\"Sample\", {\ncomponent: Sample\n});\n</code></pre>"},{"location":"developer-guide/plugins-howto/#testing-plugins","title":"Testing plugins","text":"<p>As we already mentioned a plugin is a collection of entities that should already have unit tests (components, reducers, actions, selectors, epics). We can limit plugins testing to testing the interactions between these different entities, for example:</p> <ul> <li>connection of the redux state to the plugins properties</li> <li>epics that are related to the plugin lifecycle</li> <li>containment relations between plugins</li> </ul> <p>To ease writing a plugin unit test, an helper is available (pluginsTestUtils) that can be used to:</p> <ul> <li>create a plugin connected with a redux store (getPluginForTest), initialized with plugin's defined reducers and epics, and with a given initial state</li> <li>get access to the redux store</li> <li>get access to the list of actions dispatched to the store</li> <li>get access to the list of containers plugins supported by the plugin (you can limit this list by passing your plugins definitions to getPluginForTest)</li> </ul>"},{"location":"developer-guide/plugins-howto/#examples","title":"Examples","text":"<p><code>js/plugins/__tests__/MyPlugin-test.js</code></p> <pre><code>import expect from \"expect\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport MyPlugin from \"../MyPlugin\";\nimport { getPluginForTest } from \"@mapstore/plugins/__tests__/pluginsTestUtils\";\n\nconst initialState = {};\n\ndescribe(\"MyPlugin Test\", () =&gt; {\nbeforeEach((done) =&gt; {\ndocument.body.innerHTML = \"&lt;div id=\\\"container\\\"&gt;&lt;/div&gt;\";\nsetTimeout(done);\n});\n\nafterEach((done) =&gt; {\nReactDOM.unmountComponentAtNode(document.getElementById(\"container\"));\ndocument.body.innerHTML = \"\";\nsetTimeout(done);\n});\n\nit(\"creates MyPlugin with default configuration\", () =&gt; {\nconst {Plugin, store, actions, containers } = getPluginForTest(MyPlugin, initialState);\nReactDOM.render(&lt;Plugin /&gt;, document.getElementById(\"container\"));\nexpect(document.getElementById(\"&lt;my plugin id&gt;\")).toBeTruthy();\nexpect(...);\n});\n// use pluginCfg to override plugins properties\nit(\"creates MyPlugin with custom configuration\", () =&gt; {\nconst {Plugin, store, actions, containers } = getPluginForTest(MyPlugin, initialState);\nReactDOM.render(&lt;Plugin pluginCfg={{\nproperty: \"value\"\n}}/&gt;, document.getElementById(\"container\"));\nexpect(document.getElementById(\"&lt;my plugin id&gt;\")).toBeTruthy();\nexpect(...);\n});\n\n// test connected epics looking at the actions array\nit(\"test plugin epics\", () =&gt; {\nconst {Plugin, store, actions, containers } = getPluginForTest(MyPlugin, initialState);\nReactDOM.render(&lt;Plugin/&gt;, document.getElementById(\"container\"));\nstore.dispatch({\ntype: ACTION_CAPTURED_BY_AN_EPIC,\npayload\n});\nexpect(actions.filter(action =&gt; action.type === ACTION_LAUNCHED_BY_AN_EPIC).length).toBe(1);\n});\n\n// test supported containers\nit(\"test containers\", () =&gt; {\nconst {Plugin, store, actions, containers } = getPluginForTest(MyPlugin, initialState, {\nMyContainerPlugin: {}\n});\nReactDOM.render(&lt;Plugin/&gt;, document.getElementById(\"container\"));\nexpect(Object.keys(containers)).toContain(\"MyContainer\");\n});\n});\n</code></pre>"},{"location":"developer-guide/plugins-howto/#general-guidelines","title":"General Guidelines","text":""},{"location":"developer-guide/plugins-howto/#components","title":"Components","text":"<ul> <li>Define the plugin component(s) into dedicated JSX file(s), so that they can be reused outside of the plugin</li> <li>Connect the component(s) in the plugin JSX file</li> </ul>"},{"location":"developer-guide/plugins-howto/#state","title":"State","text":"<ul> <li>Define your own state fragment (and related actions and reducers) to handle internal state, and use existing actions and state fragments from MapStore2 to interact with the framework</li> </ul>"},{"location":"developer-guide/plugins-howto/#selectors","title":"Selectors","text":"<ul> <li>Use existing selectors when possible to connect the state, eventually using reselect to compose them together or with your own selectors</li> </ul>"},{"location":"developer-guide/plugins-howto/#general","title":"General","text":"<ul> <li>Avoid as much as possible direct interactions between different plugins; plugins are meant to be independent modules, so they should be able to work if other plugins appear / disappear from the application configuration</li> <li>Interact with other plugins and the application itself using actions and state sharing</li> <li>Creating side effects to make plugins interact in more strict ways should not be done at the plugin level, orchestrating different plugins should be delegated at the top (application) level</li> <li>Use containers configuration to combine plugins in containers</li> </ul>"},{"location":"developer-guide/printing-module/","title":"Printing Module","text":"<p>The printing module of MapStore is a back-end service not included by default in the binary package that allows to create a printable PDF from the current map.</p> <p>Note</p> <p>The printing module is required by the Print plugin of MapStore, so if you want to have the Print plugin working in your application, you have to include also the printing module in your MapStore installation.</p>"},{"location":"developer-guide/printing-module/#including-the-printing-module-in-mapstore","title":"Including the printing module in MapStore","text":"<p>Because MapStore doesn't include the printing module by default, to use it you need to build from the source a <code>MapStore.war</code> that includes it or add the missing files to an existing MapStore deployed.</p>"},{"location":"developer-guide/printing-module/#building-from-the-source","title":"Building from the Source","text":"<p>If you want to include the printing module in your MapStore, by building the source code, you have to add the profile <code>printing</code> (profiles can be added as 2nd argument of the <code>build.sh</code> script, after the version that is the 1st. If you have more then one profile, you can add them separated by <code>,</code>):</p> <pre><code>./build.sh [version_identifier] printing\n</code></pre> <p>MapStore projects also allow to use the <code>printing</code> profile to include this module. So you can use the same <code>printing</code> profile to build your custom MapStore project including the printing module.</p>"},{"location":"developer-guide/printing-module/#adding-to-an-existing-mapstore","title":"Adding to an existing MapStore","text":"<p>If you have an existing and deployed instance of MapStore and you want to add the printing module, you can build only the printing extension as a zip running <code>mvn clean install -Pprintingbundle</code> from the official Mapstore project. The zip bundle will created in <code>java/printing/target/mapstore-printing.zip</code>.</p> <p>You can copy the content of this zip bundle into the root of mapstore application (<code>&lt;app_root&gt;</code>, for instance <code>webapps/mapstore</code> in Tomcat):</p> <ul> <li>files from zip directory <code>WEB-INF/classes</code> must be placed in <code>&lt;app_root&gt;/WEB-INF/classes</code></li> <li>files from zip directory <code>WEB-INF/lib</code> must be placed in <code>&lt;app_root&gt;/WEB-INF/lib</code></li> </ul> <p>for the printing configuration files (if they are missing)</p> <ul> <li>these files must be placed in <code>&lt;app_root&gt;/printing</code></li> </ul> <p>Then restart your java container.</p>"},{"location":"developer-guide/printing-module/#configuring-the-print","title":"Configuring the print","text":"<p>This printing module includes the MapStore printing engine, that is a fork of MapPhish print (version 2), with some additional functionalities you can find in the Wiki page.</p> <p>!!! note:     The module was originally written for GeoServer, so on the Github wiki you can find information about downloading and installing it in GeoServer, but if you include the engine directly in MapStore you don't need any other installation.</p>"},{"location":"developer-guide/printing-module/#mapstore","title":"MapStore","text":"<p>The MapStore print module on the front-end is implemented by the <code>Print</code> plugin inside <code>localConfig.json</code>. Make you sure to have this plugin in <code>plugins/(mode)</code> section. If so, this will will automatically check the presence of the back-end module and show the entry in the Burger Menu, if the back-end service is present.</p> <p>In <code>localConfig.json</code> you will find also a <code>printUrl</code> configuration that refers to the (relative) URL where the main entry point of the application is available. (the default should enough)</p>"},{"location":"developer-guide/printing-module/#print-settings","title":"Print Settings","text":"<p>This fork uses the same configuration files of the original library to define the various print layouts and options. This files is in the directory <code>resources/geoserver/print</code>, and they will be copied in <code>WEB-INF/classes</code> in the final <code>war</code> file.</p> <ul> <li><code>config.yml</code>: The main file that configures the layout. More information about this configuration file in the original documentaiton</li> <li><code>print_header.png</code>: The header, referred in <code>config.yml</code></li> <li><code>Arrow_north_CFCF.svg</code> the north indicator, referred in <code>config.yml</code></li> </ul>"},{"location":"developer-guide/printing-module/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/printing-module/#i-can-not-see-the-print-entry-in-the-menu","title":"I can not see the \"Print\" entry in the menu","text":"<p>Please check if:</p> <ul> <li>\"Print\" plugin is present in <code>localConfig.json --&gt; plugins --&gt; desktop</code>.</li> <li>You are using a desktop browser. The plugin is not designed for a mobile devices (tablet, smartphone...), for this reason it is not included in <code>plugins --&gt; mobile</code></li> <li>The service at url <code>http(s)://&lt;your-domain&gt;/&lt;applciation-base-paath&gt;/pdf/info.json</code> is responding. Example: <code>https://example.com/mapstore/pdf/info.json</code>. The URL of this <code>info.json</code> is configured (by default as relative URL) in <code>localConfig.json</code> --&gt; <code>printUrl</code> entry.</li> <li>Looking at the JSON returned by the request above, the URLs in the entries <code>printURL</code> and <code>createURL</code> are reachable, and the domain, (the port) and the schema (http/https) of these URLs are the same of MapStore.</li> </ul>"},{"location":"developer-guide/printing-module/#i-have-an-error-printing-using-reverse-proxyhttps","title":"I have an error printing (using Reverse Proxy/HTTPS)","text":"<p>When you open MapStore from the browser, MapStore do a request to the main entry point (<code>info.json</code>) of the printing module. This entry point provides a set of URLs where to find all the print related services. These URLs are generated starting from the current request.</p> <p>A common practice is to use a reverse proxy in front of a Java Application Server, and so MapStore (this is used also to add https, if the reverse proxy is part of a web server). If this reverse proxy is not properly configured anyway, MapStore will not be able to correctly generate the URLs of the printing services, and this may cause an error when you try to print a PDF.</p> <p>To avoid this problem, you can use several solution, depending on your setup and your reverse proxy.</p>"},{"location":"developer-guide/printing-module/#setting-up-your-proxy","title":"Setting up your proxy","text":"<p>Some typical solutions are:</p> <ul> <li>Using AJP instead of http (this forwards all the information by default)</li> </ul> <pre><code># Example for Apache HTTP server\nProxyPass        /mapstore   ajp://localhost:8010/mapstore\nProxyPassReverse /mapstore   ajp://localhost:8010/mapstore\n</code></pre> <ul> <li>Using rewrite engine to rewrite the requests. (apache web server)</li> </ul> <pre><code># example for Apache HTTP server\nRewriteEngine On\nRewriteCond %{HTTPS} off\nRewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI}\nRedirectMatch ^/$ /mapstore/\nProxyRequests Off\nProxyPreserveHost On\nProxyVia full\n</code></pre> <ul> <li>Using non-standard headers, <code>X-Forwarded-Host</code> and <code>X-Forwarded-Proto</code>.</li> </ul> <pre><code># example for nginx\nproxy_set_header X-Forwarded-Proto https;\n</code></pre>"},{"location":"developer-guide/printing-module/#forcing-print_base_url-of-printing-module","title":"Forcing PRINT_BASE_URL of printing module","text":"<p>If, for any reason, you can not modify the proxy configuration, MapStore printing module provides a system variable <code>PRINT_BASE_URL</code> that you can set to force the URLs returned by <code>info.json</code> to be resolved from it.</p> <p>A useful trick can be to set as a relative URL (relative to MapStore) to make it work in any context (only for MapStore).</p> <pre><code>JAVA_OPTS= \"$JAVA_OPTS -DPRINT_BASE_URL=pdf\"\n</code></pre> <p>or you can use the absolute URL:</p> <pre><code>JAVA_OPTS= \"$JAVA_OPTS -DPRINT_BASE_URL=https://example.com/mapstore/pdf\"\n</code></pre>"},{"location":"developer-guide/project-creation-script/","title":"Create your own MapStore project","text":"<p>Note</p> <p>From version 2021.02.xx MapStore introduced a new project system. Take a look here to learn more about the new project system.</p> <p>To create a new MapStore based project you can use the createProject script. First of all, if you don't have done it before, clone the MapStore2 repository master branch into a local folder:</p> <pre><code>git clone https://github.com/geosolutions-it/MapStore2\n</code></pre> <p>Then, move into the folder that has just been created, containing MapStore2:</p> <pre><code>cd MapStore2\n</code></pre> <p>Choose from which branch you want the mapstore revision to be aligned, we suggest to use latest release or latest stable available (if you know which is)</p> <pre><code>git checkout &lt;stable-branch&gt;\n</code></pre> <p>or</p> <pre><code>git checkout v2022.02.02\n</code></pre> <p>Install dependencies for MapStore:</p> <pre><code>npm install\n</code></pre> <p>Finally, to create the project, use the following command:</p> <pre><code>node ./createProject.js\n</code></pre> <p>The command line will ask some questions about the project to create. (You can press enter to accept the default value, indicated between parenthesis, or type a new one):</p> <ul> <li>projectName: short project name that will be used as the repository name on github, webapp path and name in package.json</li> <li>branch/tag: the base branch/tag to use for the project (e.g. v2022.02.02, or master)</li> <li>projectType: type of project to create, currently one type of projects is supported:</li> <li>standard: is a copy of the standard MapStore project, ready to be used and customized</li> <li>projectVersion: project version in package.json (X.Y.Z)</li> <li>projectDescription: project description, used in sample index page and as description in package.json</li> <li>gitRepositoryUrl: full url to the github repository where the project will be published</li> <li>outputFolder: folder where the project will be created</li> </ul> <p>Usage:</p> <pre><code>node ./createProject.js\n\nProject Type (standard):\nMapStore base branch (master):v2023.01.01\nProject Name: my_project\nProject Version (1.0.0):\nProject Description (Project Name):\nRepository URL:\nOutput folder: ../my_project\n</code></pre> <p>At the end of the script execution, the given outputFolder will be populated by all the configuration files needed to start working on the project. Moreover, the local git repository will be initialized and the MapStore sub-module added and downloaded.</p> <p>If you create a standard project, you can customize it editing js/app.jsx: look at the comments for hints and the MapStore documentation for more details.</p> <p>The following steps are:</p> <ul> <li><code>npm install</code> to download dependencies</li> <li><code>npm start</code> to test the project</li> <li><code>./build.sh</code> to build the full .war</li> </ul>"},{"location":"developer-guide/project-creation-script/#create-a-new-project-type","title":"Create a new project type","text":"<p>If you are not happy with the available project types (standard), you can extend them adding a new folder in project.</p> <p>The folder will contain two sub-folders:</p> <ul> <li>static: for static content, to be copied as is to the project folder</li> <li>templates: for template files, containing project-dependent variables that will be replaced by the createProject script. You can use the following variables:</li> <li>__PROJECTNAME__: \\&lt;projectName&gt; parameter value</li> <li>__PROJECTDESCRIPTION__: \\&lt;projectDescription&gt; parameter value</li> <li>__PROJECTVERSION__: \\&lt;projectVersion&gt; parameter value</li> <li>__REPOURL__: \\&lt;gitRepositoryUrl&gt; parameter value</li> </ul> <p>In addition to static and templates, the following files from the root MapStore folder will be copied:</p> <ul> <li>.babelrc</li> <li>.editorconfig</li> <li>LICENSE.txt</li> </ul>"},{"location":"developer-guide/project-creation-script/#update-mapstore2-version-in-a-project","title":"Update MapStore2 version in a project","text":"<p>To update MapStore2 version enter the MapStore2 folder and pull desired git version. If MapStore2 devDependencies have been changed you can manually update these in the project package.json file or run the script updateDevDeps</p> <pre><code>npm run updateDevDeps\n</code></pre> <p>The script will automatically copy the devDependencies from MapStore2 package.json to the project package.json file. All the project existing devDependencies will be overwritten.</p> <p>To sync MapStore2 dependencies just run npm install from project root folder.</p> <pre><code>npm install\n</code></pre> <p>Also make sure to follow the migration guidelines here.</p>"},{"location":"developer-guide/project-structure/","title":"Folders structure","text":"<p>This is the overall framework folder structure:</p> <pre><code>+-- package.json\n+-- pom.xml\n+-- build.sh\n+-- .editorconfig\n+-- Dockerfile\n+-- ...\n+-- build       (build related files)\n    +-- karma.conf.*.js\n    +-- tests.webpack.js\n    +-- webpack.config.js\n    +-- prod-webpack.config.js\n    +-- docma-config.json\n    +-- testConfig.json\n    +-- ...\n+-- java        (java backend modules)\n    +-- pom.xml\n    +-- services\n    +-- web\n    +-- printing\n+-- translations (i18n localization files)\n    |  +-- data.en-US.json\n+-- utility (general utility scripts and functions)\n    |  +-- eslint\n    |  +-- build\n    |  +-- projects\n    |  +-- translations\n+-- web         (frontend module)\n    +-- client\n    |   +-- index.html (demo application home page)\n        +-- plugins (ReactJS smart components with required reducers)\n        +-- components (ReactJS dumb components)\n        |   +-- category\n        |   |   +-- &lt;component&gt;.jsx (ReactJS component)\n        |   |   +-- ...\n        |   |   +-- __tests__       (unit tests folder)\n        |   |       +-- &lt;component&gt;-test.jsx\n        |   +-- ...\n        +-- actions    (Redux actions)\n        +-- configs    (JSON config files like localConfig.json, pluginsConfig.json, new.json, newgeostory.json, etc)\n        +-- epics      (redux-observable epics)\n        +-- reducers   (Redux reducers)\n        +-- stores     (Redux stores)\n           ...\n           product (the MapStore main application)\n            +...\n</code></pre>"},{"location":"developer-guide/reactjs-and-redux-introduction/","title":"Main Frontend Technologies","text":"<p>The main tecnologies used on the mapstore 2 are:</p> <ul> <li>ReactJS (View)</li> <li>Redux (state management)</li> </ul>"},{"location":"developer-guide/reactjs-and-redux-introduction/#reactjs","title":"ReactJS","text":"<p>ReactJS 0.16.x is used to develop MapStore. The main purpose of ReactJS is to allow writing the View of the application, through the composition of small components, in a declarative way.</p> <p>Components are written using a \"templating\" language, called JSX, that is a sort of composition of HTML and Javascript code. The difference between JSX and older approaches like JSP is that JSX templates are mixed with Javascript code inside javascript files.</p>"},{"location":"developer-guide/reactjs-and-redux-introduction/#reactjs-component-example","title":"ReactJS component example","text":"<p>Component definition:</p> <pre><code>class MyComponent extends React.Component {\nrender() {\nreturn &lt;h1&gt;{this.props.title}&lt;/h1&gt;;\n}\n}\n</code></pre> <p>Component usage:</p> <pre><code>React.render(&lt;MyComponent title=\"My title\"/&gt;, document.body);\n</code></pre>"},{"location":"developer-guide/reactjs-and-redux-introduction/#properties-state-and-event-handlers","title":"Properties, State and Event handlers","text":"<p>Components can define and use properties, like the title one used in the example. These are immutable, and cannot be changed by component's code.</p> <p>Components can also use state that can change. When the state changes, the component is updated (re-rendered) automatically.</p> <pre><code>class MyComponent extends React.Component {\nstate = {\nreturn {\ntitle: 'CHANGE_ME'\n};\n};\nchangeTitle = () =&gt; {\nthis.setState({\ntitle: 'CHANGED'\n});\n};\nrender() {\nreturn &lt;h1 onClick={this.changeTitle}&gt;{this.state.title}&lt;/h1&gt;;\n}\n}\n</code></pre> <p>In this example, the initial state includes a title property whose value is <code>CHANGE_ME</code>.</p> <p>When the h1 element is clicked, the state is changed so that title becomes <code>CHANGED</code>.</p> <p>The HTML page is automatically updated by ReactJS, each time the state changes (each time this.setState is called). For this reason we say that JSX allows to declaratively describe the View for each possible application state.</p>"},{"location":"developer-guide/reactjs-and-redux-introduction/#lifecycle-hooks","title":"Lifecycle hooks","text":"<p>Components can re-define some lifecycle methods, to execute actions in certain moments of the component life. Lifecycle API is changed in react 16 so please refer to the official documentation.</p>"},{"location":"developer-guide/reactjs-and-redux-introduction/#redux","title":"Redux","text":"<p>Redux, and its companion react-redux are used to handle the application state and bind it to ReactJS components.</p> <p>Redux promotes a unidirectional dataflow (inspired by the Flux architecture) and immutable state transformation using reducers, to achieve predictable and reproducable application behaviour.</p> <p>A single, global, Store is delegated to contain all the application state.</p> <p>The state can be changed dispatching Actions to the store.</p> <p>Each action produces a new state (the state is never changed, a new state is produced and that is the new application state), through the usage of one or more reducers.</p> <p>(Smart) Components can be connected to the store and be notified when the state changes, so that views are automatically updated.</p>"},{"location":"developer-guide/reactjs-and-redux-introduction/#actions","title":"Actions","text":"<p>In Redux, actions are actions descriptors, generated by an action creator. Actions descriptors are usually defined by an action type and a set of parameters that specify the action payload.</p> <pre><code>const CHANGE_TITLE= 'CHANGE_TITLE';\n\n// action creator\nfunction changeTitle(newTitle) {\nreturn {\ntype: CHANGE_TITLE,\ntitle: newTitle\n};\n}\n</code></pre>"},{"location":"developer-guide/reactjs-and-redux-introduction/#reducers","title":"Reducers","text":"<p>Reducers are functions that receive an action and the current state and:</p> <ul> <li>produce a new state, for each recognized action</li> <li>produce the current state for unrecognized actions</li> <li>produce initial state, if the current state is undefined</li> </ul> <pre><code>function reducer(state = {title: \"CHANGE_ME\"}, action) {\nswitch (action.type) {\ncase CHANGE_TITLE:\nreturn {title: action.title};\ndefault:\nreturn state;\n}\n}\n</code></pre>"},{"location":"developer-guide/reactjs-and-redux-introduction/#store","title":"Store","text":"<p>The redux store combines different reducers to produce a global state, with a slice for each used reducer.</p> <pre><code>var rootReducer = combineReducers({\nslice1: reducer1,\nslice2: reducer2\n});\nvar initialState = {slice1: {}, slice2: {}};\n\nvar store = createStore(rootReducer, initialState);\n</code></pre> <p>The Redux store receives actions, through a dispatch method, and creates a new application state, using the configured reducers.</p> <pre><code>store.dispatch(changeTitle('New title'));\n</code></pre> <p>You can subscribe to the store, to be notified whenever the state changes.</p> <pre><code>store.subscribe(function handleChange() {});\n</code></pre>"},{"location":"developer-guide/reactjs-and-redux-introduction/#redux-middlewares","title":"Redux Middlewares","text":"<p>Redux data flow is synchronous. To provide asynchronous functionalities (e.g. Ajax) redux needs a middleware. Actually MapStore uses 2 middlewares for this purpose:</p> <ul> <li>Redux thunk (going to be fully replaced by redux-observable)</li> <li>Redux Observable</li> </ul>"},{"location":"developer-guide/reactjs-and-redux-introduction/#redux-thunk","title":"Redux thunk","text":"<p>This middleware allows to perform simple asynchronous flows by returning a function from the action creator (instead of a action object).</p> <pre><code>// action creator\nfunction changeTitleAsync() {\nreturn (dispatch, getState) =&gt; {\nmyAsyncPromise.then( (newTitle) =&gt; {\ndispatch({\ntype: CHANGE_TITLE,\ntitle: newTitle\n};)\n});\n}\n}\n</code></pre> <p>This middleware is there from the beginning of the MapStore history. During the years, some better middlewares have been developed for this purpose. We want to replace it in the future with redux-observable.</p>"},{"location":"developer-guide/reactjs-and-redux-introduction/#redux-observable-and-epics","title":"Redux Observable and epics","text":"<p>This middleware provides support for side-effects in MapStore using rxjs. The core object of this middleware is the <code>epic</code></p> <pre><code>function (action$: Observable&lt;Action&gt;, store: Store): Observable&lt;Action&gt;;\n</code></pre> <p>The epic is a function that simply gets as first parameter an <code>Observable</code> (stream) emitting the actions emitted by redux. It returns another <code>Observable</code> (stream) that emits actions that will be forwarded to redux too.</p> <p>So there are 2 streams:</p> <ul> <li>Actions in</li> <li>Actions out</li> </ul> <p>A simple epic example can be the following:</p> <pre><code>const pingEpic = action$ =&gt;\naction$.filter(action =&gt; action.type === 'PING')\n.mapTo({ type: 'PONG' });\n</code></pre> <p>Every time a 'PING' action is emitted, the epic will emit also the 'PONG' action.</p> <p>See :</p> <ul> <li>Introduction to RxJS for MapStore Developers</li> <li>redux-observable site</li> <li>rxjs Observable as a reference for methods</li> <li>setting up the middleware to integrate epics with your store</li> </ul>"},{"location":"developer-guide/reactjs-and-redux-introduction/#redux-and-reactjs-integration","title":"Redux and ReactJS integration","text":"<p>The react-redux library can be used to connect the Redux application state to ReactJS components.</p> <p>This can be done in the following way:</p> <ul> <li>wrap the ReactJS root component with the react-redux Provider component, to bind the Redux store to the ReactJS view</li> </ul> <pre><code>React.render(\n&lt;Provider store={store}&gt;\n{() =&gt; &lt;App /&gt;}\n&lt;/Provider&gt;,\ndocument.getElementById('container')\n);\n</code></pre> <ul> <li>explicitly connect one or more (smart) components to a all or part of the state (you can also transform the state and have computed properties)</li> </ul> <pre><code>connect(function(state) {\nreturn {\ntitle: state.title,\nname: state.namespace + '.' + state.name,\n};\n})(App);\n</code></pre> <p>The connected component will get automatic access to the configured slice through properties:</p> <pre><code>function render() {\nreturn &lt;div&gt;&lt;h1&gt;{this.props.title}&lt;/h1&gt;&lt;p&gt;{this.props.name}&lt;/p&gt;&lt;/div);\n}\n</code></pre>"},{"location":"developer-guide/release/","title":"How to release","text":"<p>To create a new MapStore release, you need to:</p> <ul> <li>Create an issue of type <code>Mapstore Release</code> on GitHub by clicking here with the title of the release.</li> <li>Follow the checklist in the issue created.</li> </ul> <p>Here below some details about changelog generation and naming conventions.</p>"},{"location":"developer-guide/release/#naming-conventions","title":"Naming conventions","text":""},{"location":"developer-guide/release/#release-and-tag","title":"release and tag","text":"<ul> <li>vYYYY.XX.mm name of the release and tag. (e.g. <code>v2022.01.01</code>)</li> <li>YYYY is the year,</li> <li>XX is the incremental number of the release for the current year (starting from 01)</li> <li>mm is an incremental value (starting from 00) to increment for minor releases</li> </ul>"},{"location":"developer-guide/release/#stable-branch","title":"stable branch","text":"<ul> <li>YYYY.XX.xx name of stable branch (e.g. <code>2022.01.xx</code> )</li> <li>YYYY is the year</li> <li>XX is the incremental number of the release for the current year (starting from 01)</li> <li>xx is the fixed text <code>xx</code></li> </ul>"},{"location":"developer-guide/release/#release-procedure-details","title":"Release procedure details","text":""},{"location":"developer-guide/release/#github-actions","title":"Github actions","text":"<p>The github actions are configured to automate the release process.</p> <p>In particular the process is composed by 4 steps:</p> <ul> <li>Cut Release Branch creates a new branch from master with the name of the stable branch</li> <li>Prepare Release updates the version of the packages and creates the changelog</li> <li>Create Release creates the github draft release</li> <li>Post Release restores the snapshots</li> </ul> <p>In this process the user has to manually finalize the release by adding the release description and the binaries to the release. Everything is listed in the checklist of the issue created at the beginning.</p> <p>Here a flow chart that describes the process:</p> flowchart TD     Issue[Create MapStore Release Issue] --&gt; X[...]     X --&gt; Cut     Cut[[GH Action: Cut Release Branch]] --&gt;|     create branch     PR to master with packages versions update     | Update[[GH Action: Update dependencies versions]] --&gt;|         fix package versions for geostore, http-proxy, print lib         excluding snapshots     | Fixes     Fixes[Fixes...] --&gt; Tests[Tests...]     Tests --&gt; start(((start release)))     start --&gt; PrepareRelease     PrepareRelease[[GH Action: Prepare Release]] --&gt; |     Fix versions     Changelog     Tag     PR to master with changelog updates     | CreateRelease     CreateRelease[[GH Action: Create Release]] --&gt; |         Create github Release         generate binaries to attach to the release     |release     release((release     created)) --&gt;PostRelease[[Post Release]]     PostRelease[[GH Action: Post Release]]  --&gt; |         restores snapshots     | finish(((end)))     release --&gt; FinalizeRelease[Finalize release manually]     FinalizeRelease --&gt;|         refine release description with features         docker         jenkins         communication...     | Publish     finish -- next minor release --&gt; Fixes"},{"location":"developer-guide/release/#git-graph-structure","title":"Git graph structure","text":"<p>The procedure produces the following git graph structure:</p> gitGraph TB:     commit     branch 2023.01.xx     checkout 2023.01.xx     commit id: \"2023.01 initial commit\"     checkout main     commit id: \"feature-1\"     commit id: \"fix-1\"     checkout 2023.01.xx     cherry-pick id:\"fix-1\"     commit id: \"fix-versions-1+changelog\"     commit id: \"2023.01.00-release\" tag: \"v2023.02.00\"     commit id: \"restore-snaphots-1\"     checkout main     commit id: \"Changelog for version v2023.01.00\"     commit id: \"fix-2\"     commit id: \"feature-2\"     commit id: \"feature-3\"     checkout 2023.01.xx     cherry-pick id:\"fix-2\"     commit id: \"fix-versions-2+changelog\"     commit id: \"2023.01.01-release\" tag: \"v2023.02.01\"     commit id: \"restore-snaphots-2\"     checkout main     commit id: \"Changelog for version v2023.02.01\"     commit     commit     branch 2023.02.xx     checkout 2023.02.xx     commit id: \"2023.02 initial commit\"     checkout main     commit id: \"fix-3\"     checkout 2023.02.xx     cherry-pick id:\"fix-3\""},{"location":"developer-guide/release/#changelog-generation","title":"Changelog generation","text":"<p>The changelog generation is now automated. Anyway it is possible to generate the changelog manually by running the following command:</p> <pre><code>npm run generate:changelog &lt;oldReleaseNumber&gt;  &lt;newReleaseNumber&gt;\n\n# usage\n# e.g. npm run generate:changelog 2022.01.00 2022.02.00\n</code></pre> <p>This produces some text that can be used to update the changelog file.</p>"},{"location":"developer-guide/release/#handling-errors","title":"Handling errors","text":"<p>If in a certain point we notice some errors, the separation of the tasks allows to restart the process from the point where the error occurred.</p> <p>For instance if after tag creation we notice some problem or we have some failures, we can fix the problem, delete and recreate the tag manually and recreate the release by running the <code>Create Release</code> action.</p>"},{"location":"developer-guide/release/#testing-and-fixing-release-procedure","title":"Testing and fixing release procedure","text":"<p>For testing and fixing the release procedure it is possible to run the release procedure on your fork. anyway \"Create, Prepare and Post Release\" actions are configured to run only on the main repository. This is done to avoid that the release procedure is triggered automatically by forks in some cases. So on your fork you will need to manually edit the workflow files to enable the actions to run on your fork.</p> <p>In particular you will need to edit some lines like this:</p> <pre><code>if:  ${{ github.event_name == 'push' &amp;&amp; github.repository == 'geosolutions-it/MapStore2' }}\n</code></pre> <p>Removing the condition or changing the repository name.</p>"},{"location":"developer-guide/requirements/","title":"Requirements","text":"<p>In this section you can have a glance of the minimum and recommended versions of the tools needed to build/debug/install MapStore</p>"},{"location":"developer-guide/requirements/#war-installation","title":"War Installation","text":"<p>You can download a java web container like Apache Tomcat from and Java JRE</p> Tool Link Minimum Recommended Maximum Java link 8<sup>1</sup> 11 11<sup>2</sup> Tomcat link 8.5 9 9<sup>2</sup>"},{"location":"developer-guide/requirements/#debug-build","title":"Debug / Build","text":"<p>These tools needs to be installed (other than Java in versions above above):</p> Tool Link Minimum Recommended Maximum npm link 8 10 NodeJS link 16 20 Java (JDK) link 8 9 11<sup>2</sup> Maven link 3.1.0 3.6 python<sup>3</sup> link 2.7.9 3.7 <p>Notes</p> <p>Here some notes about some requirements and reasons for max version indicated, for future improvements and maintenance :</p> <ul> <li><sup>1</sup> Java 8 is the minimum version required for running MapStore, but it is not compatible in case you want to use the print module. In this case, you need to use Java 11.</li> <li><sup>2</sup> About Java and Tomcat maximum versions:<ul> <li>For execution, MapStore is well tested on Java v11.</li> <li>Build with success with v11, only smoke tests passing on v13, errors with v16.(Details on issue #6935)</li> <li>Running with Tomcat 10 causes this issue #7524.</li> </ul> </li> <li><sup>3</sup> Python is only needed for building documentation.</li> </ul>"},{"location":"developer-guide/requirements/#running-in-production","title":"Running in Production","text":""},{"location":"developer-guide/requirements/#system-requirements","title":"System requirements","text":"Resource Minimum Recommended Processor 2 Core 2 Core Memory 2 GB 4 GB"},{"location":"developer-guide/requirements/#database","title":"Database","text":"<p>In production a PostgreSQL database is recommended:</p> Tool Link Minimum Recommended Maximum Postgres link 9.6 13 13"},{"location":"developer-guide/vector-style/","title":"MapStore vector style","text":"<p>The <code>vector</code> and <code>wfs</code> layer types are rendered by the client as GeoJSON features and it possible to apply specific symbolizer using the <code>style</code> property available in the layer options. The style object is composed by these properties</p> <ul> <li><code>format</code> the format encoding used by style body</li> <li><code>body</code> the actual style rules and symbolizers</li> </ul> <p>example:</p> <pre><code>{\n\"type\": \"vector\",\n\"features\": [],\n\"style\": {\n\"format\": \"geostyler\",\n\"body\": {\n\"name\": \"My Style\",\n\"rules\": [\n{\n\"name\": \"My Rule\",\n\"symbolizers\": [\n{\n\"kind\": \"Line\",\n\"color\": \"#3075e9\",\n\"opacity\": 1,\n\"width\": 2\n}\n]\n}\n]\n}\n}\n}\n</code></pre> <p>The default format used by MapStore is \"geostyler\" that is an encoding based on the geostyler-style specification that could include some variations or limitations related to the map libraries used by MapStore app. We suggest to refer to following doc for the rule/symbolizer properties available in MapStore.</p> <p>Ths style <code>body</code> is composed by following properties:</p> <ul> <li><code>name</code> style name</li> <li><code>rules</code> list of rule object that describe the style</li> </ul> <p>A <code>rule</code> object is composed by following properties:</p> <ul> <li><code>name</code> rule name that could be used to generate a legend</li> <li><code>filter</code> filter expression</li> <li><code>symbolizers</code> list of symbolizer object that describe the rule (usually one per rule)</li> </ul> <p>The <code>filter</code> expression define with features should be rendered with the symbolizers listed in the rule</p> <p>example:</p> <pre><code>// simple comparison condition structure\n// [operator, property key, value]\n{\n\"filter\": [\"==\", \"count\", 10]\n}\n\n// mulitple condition with logical operato\n// [logical operator, [condition], [condition]]\n{\n\"filter\": [\n\"||\",\n[\"&gt;\", \"height\", 10],\n[\"==\", \"category\", \"building\"]\n]\n}\n</code></pre> <p>Available logical operators:</p> Operator Description <code>\\|\\|</code> OR operator <code>&amp;&amp;</code> AND operator <p>Available comparison operators:</p> Operator Description <code>==</code> equal to <code>*=</code> like (for string type) <code>!=</code> is not <code>&lt;</code> less than <code>&lt;=</code> less and equal than <code>&gt;</code> grater than <code>&gt;=</code> grater and equal than <p>The <code>symbolizer</code> could be of following <code>kinds</code>:</p>"},{"location":"developer-guide/vector-style/#mark-symbolizer-properties","title":"<code>Mark</code> symbolizer properties","text":"Property Description 2D 3D <code>kind</code> must be equal to Mark x x <code>color</code> fill color of the mark x x <code>fillOpacity</code> fill opacity of the mark x x <code>strokeColor</code> stroke color of the mark x x <code>strokeOpacity</code> stroke opacity of the mark x x <code>strokeWidth</code> stroke width of the mark x x <code>strokeDasharray</code> array that represent the dashed line intervals x x <code>radius</code> radius size in px of the mark x x <code>wellKnownName</code> rendered shape, one of Circle, Square, Triangle, Star, Cross, X, shape://vertline, shape://horline, shape://slash, shape://backslash, shape://dot, shape://plus, shape://times, shape://oarrow or shape://carrow x x <code>msBringToFront</code> this boolean will allow setting the disableDepthTestDistance value for the feature. This would x <code>msHeightReference</code> reference to compute the distance of the point geometry, one of none, ground or clamp x <code>msHeight</code> height of the point, the original geometry is applied if undefined x <code>msLeaderLineColor</code> color of the leading line connecting the point to the terrain x <code>msLeaderLineOpacity</code> opacity of the leading line connecting the point to the terrain x <code>msLeaderLineWidth</code> width of the leading line connecting the point to the terrain x"},{"location":"developer-guide/vector-style/#icon-symbolizer-properties","title":"<code>Icon</code> symbolizer properties","text":"Property Description 2D 3D <code>kind</code> must be equal to Icon x x <code>image</code> url of the image to use as icon x x <code>size</code> size of the icon x x <code>opacity</code> opacity of the icon x x <code>rotate</code> rotation of the icon x x <code>anchor</code> anchor point of the icon, one of: top-left, top, top-right, left, center, right, bottom-left, bottom or bottom-right x x <code>msBringToFront</code> this boolean will allow setting the disableDepthTestDistance value for the feature. This would x <code>msHeightReference</code> reference to compute the distance of the point geometry, one of none, ground or clamp x <code>msHeight</code> height of the point, the original geometry is applied if undefined x <code>msLeaderLineColor</code> color of the leading line connecting the point to the terrain x <code>msLeaderLineOpacity</code> opacity of the leading line connecting the point to the terrain x <code>msLeaderLineWidth</code> width of the leading line connecting the point to the terrain x <p>Experimental: the image property support a custom expression called <code>msMarkerIcon</code> to render default markers, here the expected structure:</p> <pre><code>{\n\"kind\": \"Icon\",\n\"image\": {\n\"name\": \"msMarkerIcon\",\n\"args\": [\n{\n\"color\": \"blue\", // 'red', 'orange-dark', 'orange', 'yellow', 'blue-dark', 'blue', 'cyan', 'purple', 'violet', 'pink', 'green-dark', 'green', 'green-light' or 'black'\n\"shape\": \"circle\", // 'circle', 'square', 'star' or 'penta'\n\"glyph\": \"comment\" // a Font Awesome v4.7.0 icon\n}\n]\n},\n\"opacity\": 1,\n\"size\": 48,\n\"rotate\": 0,\n\"anchor\": \"bottom\"\n}\n</code></pre>"},{"location":"developer-guide/vector-style/#line-symbolizer-properties","title":"<code>Line</code> symbolizer properties","text":"Property Description 2D 3D <code>kind</code> must be equal to Line x x <code>color</code> stroke color of the line x x <code>opacity</code> stroke opacity of the line x x <code>width</code> stroke width of the line x x <code>dasharray</code> array that represent the dashed line intervals x x <code>msClampToGround</code> this boolean will allow setting the clampToGround value for the feature. This would only apply on Cesium maps. x <code>msHeight</code> line height in meters, if undefined the line geometry height is used x <code>msHeightReference</code> reference to compute the distance of the line geometry, one of none, ground or clamp. This is applied also to the <code>msExtrudedHeight</code> property x <code>msExtrudedHeight</code> height of the extrusion in meters x <code>msExtrusionRelativeToGeometry</code> if true the extrusion height is computed as z distance from the line geometry. When false the extrude height is computed as absolute altitude. When <code>msExtrusionType</code> is not <code>undefined</code> the extrusion height will be computed always relative to the geometry so this property has not effect x <code>msExtrusionColor</code> color of the extruded shape x <code>msExtrusionOpacity</code> opacity of the extruded shape x <code>msExtrusionType</code> type of extrusion, one of <code>undefined</code>, Circle or Square. If <code>undefined</code> a vertical wall plane will be extruded. x"},{"location":"developer-guide/vector-style/#fill-symbolizer-properties","title":"<code>Fill</code> symbolizer properties","text":"Property Description 2D 3D <code>kind</code> must be equal to Fill x x <code>color</code> fill color of the polygon x x <code>fillOpacity</code> fill opacity of the polygon x x <code>outlineColor</code> outline color of the polygon x x <code>outlineOpacity</code> outline opacity of the polygon x x <code>outlineWidth</code> outline width of the polygon x x <code>outlineDasharray</code> array that represent the dashed line intervals x x <code>msClassificationType</code> allow setting classificationType value for the feature. This would only apply on polygon graphics in Cesium maps. x <code>msHeight</code> polygon height in meters, if undefined the polygon geometry height is used x <code>msHeightReference</code> reference to compute the distance of the polygon geometry, one of none, ground or clamp. This is applied also to the <code>msExtrudedHeight</code> property x <code>msExtrudedHeight</code> height of the extrusion in meters x <code>msExtrusionRelativeToGeometry</code> if true the extrusion height is computed as z distance from the polygon surface. When false the extrude height is computed as absolute altitude x"},{"location":"developer-guide/vector-style/#text-symbolizer-properties","title":"<code>Text</code> symbolizer properties","text":"Property Description 2D 3D <code>kind</code> must be equal to Text x x <code>label</code> text to show in the label, the {{propertyKey}} notetion allow to access feature properties (eg. 'feature name is {{name}}') x x <code>font</code> array of font family names x x <code>size</code> font size of the label x x <code>fontStyle</code> font style of the label: normal or italic x x <code>fontWeight</code> font style of the label: normal or bold x x <code>color</code> font color of the label x x <code>anchor</code> anchor point of the label, one of: top-left, top, top-right, left, center, right, bottom-left, bottom or bottom-right x x <code>haloColor</code> halo color of the label x x <code>haloWidth</code> halo width of the label x x <code>offset</code> array of x and y values offset of the label x x <code>msBringToFront</code> this boolean will allow setting the disableDepthTestDistance value for the feature. This would x <code>msHeightReference</code> reference to compute the distance of the point geometry, one of none, ground or clamp x <code>msHeight</code> height of the point, the original geometry is applied if undefined x <code>msLeaderLineColor</code> color of the leading line connecting the point to the terrain x <code>msLeaderLineOpacity</code> opacity of the leading line connecting the point to the terrain x <code>msLeaderLineWidth</code> width of the leading line connecting the point to the terrain x"},{"location":"developer-guide/vector-style/#model-symbolizer-properties-custom-symbolizer-to-visualize-3d-model-as-point-geometries","title":"<code>Model</code> symbolizer properties (custom symbolizer to visualize 3D model as point geometries)","text":"Property Description 2D 3D <code>kind</code> must be equal to Model x <code>model</code> url of a 3D .glb file x <code>heading</code> heading rotation x <code>pitch</code> pitch rotation x <code>roll</code> roll rotation x <code>scale</code> scale factor x <code>color</code> color mixed with the mesh texture/material x <code>opacity</code> color opacity x <code>msHeightReference</code> reference to compute the distance of the point geometry, one of none, ground or clamp x <code>msHeight</code> height of the point, the original geometry is applied if undefined x <code>msTranslateX</code> move the model on the x axis with a value in meters (west negative value, east positive value) x <code>msTranslateY</code> move the model on the y axis with a value in meters (south negative value, north positive value) x <code>msLeaderLineColor</code> color of the leading line connecting the point to the terrain x <code>msLeaderLineOpacity</code> opacity of the leading line connecting the point to the terrain x <code>msLeaderLineWidth</code> width of the leading line connecting the point to the terrain x"},{"location":"developer-guide/vector-style/#circle-symbolizer-properties","title":"<code>Circle</code> symbolizer properties","text":"Property Description 2D 3D <code>kind</code> must be equal to Circle x x <code>color</code> fill color of the circle x x <code>opacity</code> fill opacity of the circle x x <code>outlineColor</code> outline color of the circle x x <code>outlineOpacity</code> outline opacity of the circle x x <code>outlineWidth</code> outline width of the circle x x <code>outlineDasharray</code> array that represent the dashed line intervals x x <code>radius</code> radius in meter of the circle x x <code>gedesic</code> if true draws a geodesic circle x x <code>msClassificationType</code> allow setting classificationType value for the feature. This would only apply on polygon graphics in Cesium maps. x <code>msClampToGround</code> this boolean will allow setting the clampToGround value for the feature. This would only apply on Cesium maps. x"},{"location":"developer-guide/vector-style/#legacy-vector-style-deprecated","title":"Legacy Vector Style (deprecated)","text":"<p>The <code>style</code> or <code>styleName</code> properties of vector layers (wfs, vector...) allow to apply a style to the local data on the map.</p> <ul> <li><code>style</code>: a style object/array. It can have different formats. In the simplest case it is an object that uses some leaflet-like style properties:</li> <li><code>weight</code>: width in pixel of the border / line.</li> <li><code>radius</code>: radius of the circle (valid only for Point types)</li> <li><code>opacity</code>: opacity of the border / line.</li> <li><code>color</code>: color of the border / line.</li> <li><code>fillOpacity</code>: opacity of the fill if any. (Polygons, Point)</li> <li><code>fillColor</code>: color of the fill, if any. (Polygons, Point)</li> <li><code>styleName</code>: if set to <code>marker</code>, the <code>style</code> object will be ignored and it will use the default marker.</li> </ul> <p>In case of <code>vector</code> layer, style can be added also to the specific features. Other ways of defining the style for a vector layer have to be documented.</p>"},{"location":"developer-guide/vector-style/#advanced-vector-styles-deprecated","title":"Advanced Vector Styles (deprecated)","text":"<p>To support advanced styles (like multiple rules, symbols, dashed lines, start point, end point) the style can be configured also in a different format, as an array of objects and you can define them feature by feature, adding a \"style\" property.</p> <p>Warning</p> <p>This advanced style functionality has been implemented to support annotations, at the moment this kind of advanced style options is supported only as a property of the single feature object, not as global style.</p>"},{"location":"developer-guide/vector-style/#svg-symbol-deprecated","title":"SVG Symbol (deprecated)","text":"<p>The following options are available for a SVG symbol.</p> <ul> <li><code>symbolUrl</code>: a URL (also a data URL is ok) for the symbol to use (SVG format).     You can anchor the symbol using:</li> <li><code>iconAnchor</code>: array of x,y position of the offset of the symbol from top left corner.</li> <li><code>anchorXUnits</code>, <code>anchorYUnits</code> unit of the <code>iconAnchor</code> (<code>fraction</code> or <code>pixels</code>).</li> <li><code>size</code>: the size in pixel of the square that contains the symbol to draw. The size is used to center and to cut the original svg, so it must fit the svg.</li> <li><code>dashArray</code>: Array of line, space size, in pixels. [\"6\",\"6\"] Will draw the border of the symbol dashed. It is applied also to a generic line or polygon geometry.</li> </ul>"},{"location":"developer-guide/vector-style/#markers-and-glyphs-deprecated","title":"Markers and glyphs (deprecated)","text":"<p>These are the available options for makers. These are specific of annotations for now, so allowed values have to be documented.</p> <ul> <li><code>iconGlyph</code>: e.g. \"shopping-cart\"</li> <li><code>iconShape</code>: e.g. \"circle\"</li> <li><code>iconColor</code>: e.g. \"red\"</li> <li><code>iconAnchor</code>: [0.5,0.5]</li> </ul>"},{"location":"developer-guide/vector-style/#multiple-rules-and-filtering-deprecated","title":"Multiple rules and filtering (deprecated)","text":"<p>In order to support start point and end point symbols, you could find in the style these entries:</p> <ul> <li><code>geometry</code>: \"endPoint\"|\"startPoint\", identify how to get the geometry from</li> <li><code>filtering</code>: if true, the geometry filter is applied.</li> </ul>"},{"location":"developer-guide/vector-style/#example-deprecated","title":"Example (deprecated)","text":"<p>Here an example of a layer with:</p> <ul> <li>a point styled with SVG symbol,</li> <li>a polygon with dashed style</li> <li>a line with start-end point styles as markers with icons</li> </ul> <pre><code>{\n\"type\": \"vector\",\n\"visibility\": true,\n\"id\": \"styled-vector-layer\",\n\"name\": \"styled-vector-layer\",\n\"hideLoading\": true,\n\"features\": [\n{\n\"type\": \"Feature\",\n\"geometry\": {\n\"type\": \"Point\",\n\"coordinates\": [2,0]\n},\n\"properties\": {},\n\"style\": [\n{\n\"iconAnchor\": [0.5,0.5],\n\"anchorXUnits\": \"fraction\",\n\"anchorYUnits\": \"fraction\",\n\"opacity\": 1,\n\"size\": 30,\n\"symbolUrl\": \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30'%3E%3Crect  x='5' y='5' width='20' height='20' style='fill:rgb(255,0,0);stroke-width:5;stroke:rgb(0,0,0)' /%3E%3C/svg%3E\",\n\"shape\": \"triangle\",\n\"id\": \"c65cadc0-9b46-11ea-a138-dd5f1faf9a0d\",\n\"highlight\": false,\n\"weight\": 4\n}\n]\n},{\n\"type\": \"Feature\",\n\"geometry\": {\n\"type\": \"Polygon\",\n\"coordinates\": [[[0, 0],[1, 0],[1, 1],[0,1],[ 0,0]]]\n},\n\"properties\": {},\n\"style\": [\n{\n\"color\": \"#d0021b\",\n\"opacity\": 1,\n\"weight\": 3,\n\"fillColor\": \"#4a90e2\",\n\"fillOpacity\": 0.5,\n\"highlight\": false,\n\"dashArray\": [\"6\",\"6\"]\n}\n]\n},{\n\"type\": \"Feature\",\n\"geometry\": {\n\"coordinates\": [[0, 2],[ 0,3]],\n\"type\": \"LineString\"\n},\n\"properties\": {},\n\"style\": [\n{\n\"color\": \"#ffcc33\",\n\"opacity\": 1,\n\"weight\": 3,\n\"editing\": {\n\"fill\": 1\n},\n\"highlight\": false\n},\n{\n\"iconGlyph\": \"comment\",\n\"iconShape\": \"square\",\n\"iconColor\": \"blue\",\n\"highlight\": false,\n\"iconAnchor\": [ 0.5,0.5],\n\"type\": \"Point\",\n\"title\": \"StartPoint Style\",\n\"geometry\": \"startPoint\",\n\"filtering\": true\n},\n{\n\"iconGlyph\": \"shopping-cart\",\n\"iconShape\": \"circle\",\n\"iconColor\": \"red\",\n\"highlight\": false,\n\"iconAnchor\": [ 0.5,0.5 ],\n\"type\": \"Point\",\n\"title\": \"EndPoint Style\",\n\"geometry\": \"endPoint\",\n\"filtering\": true\n}\n]\n}\n]\n}\n</code></pre> <p>Result:</p> <p></p>"},{"location":"developer-guide/writing-actions-reducers/","title":"Writing Actions and Reducers","text":"<p>\u253b\u2533| \u2533\u253b| _ \u253b\u2533| \u2022.\u2022) \ud83d\udcac \"Hey, Checkout this awesome documentation for actions and reducers!\" \u2533\u253b|\u2282\uff89 \u253b\u2533|  </p>"},{"location":"developer-guide/writing-actions-reducers/#what-are-actions","title":"What are actions?","text":"<p>Quoting the redux documentation they are:</p> <p>Actions are payloads of information that send data from your application to your store.</p> <p>They are simply plain JavaScript objects</p> <pre><code>/* trigger the panning action of the map to a center point */\nconst center = [42.3, 36.5];\nexport const PAN_TO = 'MAP:PAN_TO';\n{\ntype: PAN_TO,\ncenter\n}\n</code></pre> <p>They must have type property, typically a constant with a string value, but any other properties are optional</p>"},{"location":"developer-guide/writing-actions-reducers/#why-we-use-them","title":"Why we use them","text":"<p>We need them to trigger changes to the application's store via reducers. To do that we use Action Creators</p>"},{"location":"developer-guide/writing-actions-reducers/#action-creators","title":"Action Creators","text":"<p>They are simply function that returns actions objects</p> <pre><code>const defaultValue = [42.3, 36.5];\n/*\n * by convention, use an initial name (the action filename)\n * in order to describe better the action type, in this case MAP\n * separated by a colon : and the action constant name\n*/\nexport const PAN_TO = 'MAP:PAN_TO';\nexport const panTo = (center = defaultValue) =&gt; ({\ntype: PAN_TO,\ncenter\n});\n</code></pre> <p>Note: Stick to es6 import/export module system and when possible provide a default value for the parameters</p> <p>These action creators are used in the connected components or in MapStore2 plugins But actions by themselves are not enough we need Reducers that intercepts those actions and change the state accordingly.</p> <p>Note: Remember to put all the actions .js files in the web/client/actions folder or in js/actions if you are working with custom plugins</p>"},{"location":"developer-guide/writing-actions-reducers/#reducers","title":"Reducers","text":"<p>Again quoting redux documentation they are:</p> <p>Reducers specify how the application's state changes in response to actions sent to the store.</p> <p>Reducers are pure functions that take the previous state and an action and return a new state</p> <p>(previousState, action) =&gt; newState</p> <p>let's see an example:</p> <pre><code>// @mapstore is an alias for dir_name/web/client (see webpack.config.js)\nimport {PAN_TO} from '@mapstore/actions/map';\n\nexport default function map(state, action) {\nswitch (action.type) {\ncase PAN_TO: {\nreturn {\n...state,\ncenter: action.center\n};\n}\ndefault: return state;\n}\n}\n</code></pre> <p>As you can see we are changing the center of the map that triggers the panning action of the mapping library</p> <p>And that's it we have wrote an action and a reducers that make the map panning around.</p> <p>Note: Remember to put all the reducers .js files in the web/client/reducers folder or in js/reducers if you are working with custom plugins</p>"},{"location":"developer-guide/writing-actions-reducers/#advanced-usage-and-tips","title":"Advanced usage and tips","text":"<p>Sometimes you need to change a value of an item which is stored inside an array or in a nested object.</p> <p>Let's imagine we have this object in the store:</p> <pre><code>layer: {\nfeatures: [object_1, object_2, ...object_n]\n}\n</code></pre> <p>And we have created an action that holds the id of the object to change and some properties</p> <pre><code>export const UPDATE_LAYER_FEATURE = 'LAYER:UPDATE_LAYER_FEATURE'\nexport const updateFeature = (id, props = {}) =&gt; ({type: UPDATE_LAYER_FEATURE, id, props})\n</code></pre> <p>Then in the reducer we can have different implementations. Here we show the one using arrayUpdate from @mapstore/utils/ImmutableUtils for updating objects in array</p> <pre><code>import {UPDATE_LAYER_FEATURE} from '@mapstore/actions/layer';\nimport {find} from 'lodash';\nconst defaultState = {\nfeatures: [{ id: 1, type: \"Feature\", geometry: { type : \"Point\", coordinates: [1, 2]}}]\n};\n\nexport default function layer(state = defaultState, action) {\nswitch (action.type) {\ncase UPDATE_LAYER_FEATURE: {\n// let's assume that action.props = {newProp: \"newValue\"}\nconst feature = find(state.features, {id: action.id});\n// merging the old feature object with the new prop while replacing the existing element in the array\nconst newFeature = {...feature, ...action.props};\nreturn arrayUpdate(\"features\", newFeature, {id: action.id}, state);\n// after this you expect to find the new properties in the feature specified by the id\n}\ndefault: return state;\n}\n}\n</code></pre>"},{"location":"developer-guide/writing-actions-reducers/#testing","title":"Testing","text":"<p>Tests in mapstore are stored in <code>__tests__</code> folder at the same level where actions/reducer are. The file name is the same of the action/reducer with a '-test' suffix</p> <pre><code>actions/map.js\nactions/__tests__/map-test.js\nor\nreducers/map.js\nreducers/__tests__/map-test.js\n</code></pre> <p>We use expect as testing library, therefore we suggest to have a look there.</p>"},{"location":"developer-guide/writing-actions-reducers/#how-to-test-an-action","title":"How to test an action","text":"<p>Typically you want to test the type and the params return from the action creator</p> <p>let's test the mapTo action:</p> <pre><code>// copyright section\nimport expect from 'expect';\nimport {panTo, PAN_TO} from '@mapstore/actions/map';\ndescribe('Test correctness of the map actions', () =&gt; {\nit('testing panTo', () =&gt; {\nconst center = [2, 3];\nconst returnValue = panTo(center);\nexpect(returnValue.type).toEqual(PAN_TO);\nexpect(returnValue.center).toEqual(center);\n});\n});\n</code></pre> <p>In order to speed up the unit test runner, you can:</p> <ul> <li>change the path in tests.webpack.js (custom/standard project) or build\\tests.webpack.js (framework) to point to the folder parent of tests for example <code>'/js/actions'</code> for custom/standard project or <code>'../web/client/actions'</code> for framework</li> <li>then run this command: <code>npm run test:watch</code></li> </ul> <p>This allows to run only the tests contained to the specified path. Note: When all tests are successfully passing remember to restore it to its original value.</p>"},{"location":"developer-guide/writing-actions-reducers/#how-to-test-a-reducer","title":"How to test a reducer","text":"<p>Here things can become more complicated depending on your reducer but in general you want to test all cases</p> <pre><code>// copyright section\nimport expect from 'expect';\nimport {panTo} from '@mapstore/actions/map';\nimport map from '@js/reducers/map'; // the one created before not the one present in @mapstore/reducers\ndescribe('Test correctness of the map reducers', () =&gt; {\nit('testing PAN_TO', () =&gt; {\nconst center = [2, 3];\nconst state = map({}, panTo(center));\n\n// here you have to check that state has changed accordingly\nexpect(state.center).toEqual(center);\n});\n});\n</code></pre> <p>Here for speedup testing you can again modify the tests.webpack.js (custom/standard project) or build\\tests.webpack.js (framework) in order to point to the reducers folder and then running <code>npm run test:watch</code></p>"},{"location":"developer-guide/writing-actions-reducers/#actions-and-epics","title":"Actions and epics","text":"<p>Actions are not only used by redux to update the store (through the reducers), but also for triggering side effects workflows managed by epics</p> <p>For more details see Writing epics</p>"},{"location":"developer-guide/writing-epics/","title":"Writing Epics","text":"<p>Most of the asynchronous operations we are doing in MapStore2 are implemented using epics. This guide gives the developer the base concepts about epics and provides the best practices to write and add your epics to a MapStore2 project.</p>"},{"location":"developer-guide/writing-epics/#base-concepts","title":"Base Concepts","text":"<p>Epics are the core element of the redux middleware called redux-observable. redux-observable is based on RxJS.</p> <p>RxJS is a library for reactive programming using Observables, to make it easier to compose asynchronous or callback-based code.</p> <p>stream The concept of stream is \"sequence of data made available over time.\".</p> <pre><code>--a---b-c---d---X---|-&gt;\n\na, b, c, d are emitted values\nX is an error\n| is the 'completed' signal\n---&gt; is the timeline\n</code></pre> <p>Observable is the core entity of RxJS and, more generically, of the whole reactive programming paradigm. Basically it is an entity that emits events and can be subscribed to, so that subscribers can intercept the events emitted. This is the entity that implements the concept of stream (so stream and Observable are almost used as synonym).</p> <p>Subscribing to observables can be hard, so RxJs provides a lot of operators to help manipulating and combining observables (so, streams). Here an example of how operators allow manipulating an event stream to count clicks:</p> <pre><code>clickStream:    ---c----c--c----c------c--&gt; &lt;-- Stream of clicks\n                vvvvv map(c becomes 1) vvvv &lt;-- operator that transforms each event into a `1`\n                ---1----1--1----1------1--&gt; &lt;-- new stream returned by the operator\n                vvvvvvvvv scan(+) vvvvvvvvv &lt;-- operator that does the sum\ncounterStream:  ---1----2--3----4------5--&gt; &lt;-- click count stream returned by the operator\n</code></pre> <p>The final stream can be finally subscribed to update, for instance, a counter on the UI.</p>"},{"location":"developer-guide/writing-epics/#versions","title":"Versions","text":"<p>At the time of writing this documentation MapStore2 is using RxJS 5.1.1 and redux-observable 0.19.0. So make you sure to check the correct documentation about the current versions of these libraries.</p>"},{"location":"developer-guide/writing-epics/#what-is-an-epic","title":"What is an epic","text":"<p>An epic is basically nothing more than:</p> <p>a function that returns a stream of redux actions to emit.</p> <p>A simple epic in mapstore can be this one:</p> <pre><code>const fetchUserEpic = (action$, store) =&gt; action$\n.ofType(MAP_CONFIG_LOADED)\n.filter(() =&gt; isMapLoadConfigurationEnabled(store.getState()))\n.map({\ntype: NOTIFICATION,\nmessage: \"Map Loaded\"\n});\n);\n</code></pre> <p>The epic function has 2 arguments:</p> <ul> <li><code>action$</code>: the stream of redux actions. Every time an action is triggered through redux, it is emitted as an event on the <code>action$</code> stream.</li> <li><code>store</code>. A small version of the redux store, that contains essentially only one important method called <code>getState()</code>. This method returns the current redux state object.</li> </ul> <p>This function must return a new stream that emits the actions we want to dispatch to redux. The redux-observable middleware subscribes to the action streams returned by the epics so the actions will be automatically triggered on redux.</p> <p>NOTE: redux-observable middleware is already added to the MapStore2's StandardStore and StandardApp, so a developer should only take care of creating his own epics and add them to MapStore.</p> <p>Typically the stream returned by an epic is always listening for new actions and dispatches other actions:</p> <p>actions in, actions out.</p> <p>Let's analyze the epic reported as first example:</p> <p>It returns a stream ( arrow function (<code>=&gt;</code>) implicit return) manipulating the <code>action$</code> stream. It first filters out all the unwanted actions catching only the <code>MAP_CONFIG_LOADED</code> action types, then another filter checks the state to verify some condition (typically a <code>selector</code> can be used to check the state).</p> <p>NOTE: redux-observable adds an operator to rxjs called <code>ofType</code> that simply filters the actions of certain types, passed as argument, but it is not a part of standard RxJS operators.</p> <p>The events that passed the 2 filters then hit the <code>map</code> operator. The map operator simply returns the (action) object:</p> <pre><code>{\ntype: NOTIFICATION,\nmessage: \"Map Loaded\"\n}\n</code></pre> <p>This object will be emitted on the returning stream and so the action will be triggered in redux.</p> <p>Of course instead of emitting the plain object, you can use an action creator, like this:</p> <pre><code>const notifyMapLoaded = (action$, store) =&gt; action$\n.ofType(MAP_CONFIG_LOADED)\n.filter(() =&gt; isMapLoadConfigurationEnabled(store.getState()))\n.map(info({\nmessage: \"Map Loaded\"\n}))\n);\n</code></pre>"},{"location":"developer-guide/writing-epics/#create-complex-data-flows-triggered-by-actions","title":"Create complex data flows triggered by actions","text":"<p>Typical operators to start creating a complex data flow are:</p> <ul> <li>switchMap</li> <li>mergeMap</li> <li>exhaustMap, forkJoin and many others...</li> </ul> <p>The base concept of all these solutions is to create one or more new streams (using a function passed as argument) and then emit the events on the final Observer.</p> <p>Note: Creating Higher order observables (that are basically streams of streams) and merging their events is a common pattern in RxJs, so, mergeMap and switchMap are simpler shortcuts to increase readability and maintainability of the code:</p> <ul> <li>mergeMap() is just map() + mergeAll()</li> <li>switchMap() is just map() + switch().</li> </ul> <p>Example:</p> <pre><code>const countDown = action$ =&gt; action$\n.ofType(START_COUNTDOWN)\n.switchMap( ({seconds}) =&gt;\nRx.Observable.interval(1000)\n.map( (value) =&gt; updateTime(seconds - value))\n.takeUntil(Rx.Observable.timer(seconds * 1000))\n);\n</code></pre> <pre><code>---{seconds: 5}------------------------&gt; action in\nvv switchMap vvvvvvvvvvvvvvvvvvvvvvvvvv\n--------------{5}--{4}--{3}--{2}--{1}--&gt; action out\n</code></pre> <p>In this epic, every time <code>START_COUNTDOWN</code> action is performed, the <code>switchMap</code> operator's argument function will be executed. The argument function of <code>switchMap</code> must return an Observable. Every value emitted on this stream will be projected on the main flow.</p> <p>So on the first <code>START_COUNTDOWN</code> the timer starts (<code>Rx.Observable.interval(1000)</code>). The timer will emit an incremental value (0, 1, 2, ...) every 1000 milliseconds. This value is used to trigger another action to emit on redux (using an action creator called <code>updateTime</code>, for instance).</p> <p>At the end the stream will be closed after the n seconds because of the takeUntil: <code>.takeUntil(Rx.Observable.timer(seconds * 1000))</code> unsubscribes the observable when the stream passed as function emits a value.</p> <p><code>switchMap</code> operator unsubscribes its observable ( so stops getting events from it ) even if another event comes on the main stream (so in this case another <code>START_COUNTDOWN</code> action).</p> <pre><code>---{seconds: 5}------{seconds: 5}-----------------------&gt;   action in\nvvvvvvvvvvvvvvvvv switchMap vvvvvvvvvvvvvvvvvvvvvvvvvvvv\n--------------{5}-{4}----------{5}--{4}--{3}--{2}--{1}--&gt;   action out\n</code></pre> <p>If you don't want to stop listening you may need to use <code>mergeMap</code> instead.</p> <p>Imagine to have to modify the epic above to manage many countdowns, identified by an <code>id</code>. In this case a START_COUNTDOWN event should not stop the ones already started. You can do it using <code>mergeMap</code>.</p> <pre><code>const countDown = action$ =&gt; action$\n.ofType(START_COUNTDOWN)\n// mergeMap do not stops the flows already created.\n.mergeMap( ({seconds, id}) =&gt; // the id of the new countdown is in the action\nRx.Observable.interval(1000)\n// emit an action that updates the coundown for the specific id\n.map( (value) =&gt; updateTime(seconds - value, id))\n.takeUntil(Rx.Observable.timer(seconds * 1000))\n);\n</code></pre> <p>In this case the streams will look like this:</p> <pre><code>---{sec: 5,id: A}----{sec: 5, id: B}-----------------------------&gt;   action in\nvvvvvvvvvvvvvvvvvvvvvvvvvv switchMap vvvvvvvvvvvvvvvvvvvvvvvvvv\n...............A....A....A....A...B...A...B....B....B....B........    id\n--------------{5}--{4}--{3}--{2}-{5}-{1}-{4}--{3}--{2}--{1}-------&gt;   value\n</code></pre>"},{"location":"developer-guide/writing-epics/#doing-ajax","title":"Doing AJAX","text":"<p>Ajax calls in MapStore should all pass by <code>libs/ajax.js</code>. This is an <code>axios</code> instance that adds the support for using proxies or CORS.</p> <p>Axios is a library that uses ES6 Promises to do ajax calls. Luckily RxJs allows to use Promises instead of streams in most of the cases. In the other cases, there is a specific operator called <code>defer</code> that you can use to wrap your Promise into a stream.</p> <p>NOTE: It is perfectly normal to consider the concept of Promise as a special case of a stream, that emit only one value, then closes.</p> <p>So, every time you have to do an ajax call, you will need to use axios:</p> <p>Example with <code>defer</code>:</p> <pre><code>const axios = require('../libs/ajax');\nconst fetchDataEpic = (action$, store) =&gt; action$\n.ofType(FETCH_DATA)\n.switchMap(\nRx.Observable.defer(() =&gt; axios.get(\"MY_DATA\")) // defer gets a function\nmap(response =&gt; dataFetched(response.data))\n);\n</code></pre>"},{"location":"developer-guide/writing-epics/#epic-state-muted-unmuted","title":"Epic state: muted / unmuted","text":"<p>All the epics attached to plugins or extension will be registered once plugin is loaded.</p> <p>Each registered epic can be in one of two possible states:</p> <p>muted: no reaction to the actions that comes in    unmuted: reacting to the listed actions</p> <ul> <li> <p>Whenever new epic is registered it will be in unmuted state by default.</p> </li> <li> <p>Epic will become muted whenever there is no plugin/extension on the page listing that specific epic in plugin definition. In other words, if there are <code>Extension1</code> and <code>Plugin2</code>, both are adding epic called <code>testEpic</code> and both plugin and extension are not added to the current page plugins in pluginsConfig, then epic will become muted.</p> </li> </ul>"},{"location":"developer-guide/writing-epics/#muted-epics-how-to-mute-internal-streams","title":"Muted epics: how to mute internal streams","text":"<p>MapStore will mute all the epics whenever corresponding plugin or extension is not rendered on the page. Though, it might be the case that one of your epics will return internal stream, like in example below:</p> <pre><code>export const dummyEpic = (action$, store) =&gt; action$.ofType(ACTION)\n.switchMap(() =&gt; {\nreturn Rx.Observable.interval(1000)\n.switchMap(() =&gt; {\nconsole.log('TEST');\nreturn Rx.Observable.empty();\n});\n});\n</code></pre> <p>In this case, internal stream should be muted explicitly.</p> <p>Each epic receives third argument type of object, having property called <code>pluginRenderStream$</code>. Combined with <code>semaphore</code> it allows to mute internal stream whenever epic is muted:</p> <pre><code>export const dummyEpic = (action$, store, { pluginRenderStream$ }) =&gt; action$.ofType(ACTION)\n.switchMap(() =&gt; {\nreturn Rx.Observable.interval(1000)\n.let(semaphore(pluginRenderStream$.startWith(true)))\n.switchMap(() =&gt; {\nconsole.log('TEST');\nreturn Rx.Observable.empty();\n});\n});\n</code></pre>"},{"location":"developer-guide/integrations/auth/","title":"MapStore Authentication - Implementation Details","text":"<p>In this section you can see the implementation details about the login / logout workflow implemented by MapStore.</p>"},{"location":"developer-guide/integrations/auth/#standard-mapstore-login","title":"Standard MapStore login","text":""},{"location":"developer-guide/integrations/auth/#configure-session-timeout","title":"Configure session timeout","text":"<p>By default MapStore session token lives 24 hours and the refresh token last forever. On application reboot anyway all the tokens are cancelled. In order to change these default. the administrator can change these defaults by adding to <code>mapstore-ovr.properties</code> file the following properties:</p> <pre><code># Session timeout\nrestSessionService.sessionTimeout=60 #in seconds\nrestSessionService.autorefresh=false\n</code></pre> <p>Where:</p> <ul> <li><code>restSessionService.sessionTimeout</code> refers to session token expiration time (by default it\u2019s 24 hours)</li> <li><code>restSessionService.autorefresh</code> refers to flag configured to handle automatic refresh process in the backend, enabling/disabling the refresh token usage:</li> <li>when set to <code>false</code>, it avoids the use of refresh token after the session token has expired, meaning, after the timeout the user will have to reconnect</li> <li>when set to <code>true</code>, the refresh token is used and the session extends every time the session timeout is met</li> </ul> <p>Note</p> <p><code>sessionTimeout</code> and <code>autorefresh</code> in <code>mapstore.properties</code> are valid for the default session storage. If you are using openID or keycloak, they will not be used.</p> <p>Additionally, on the client side, in order to configure the interval in which is session <code>refresh</code> action is fired, one can use the <code>tokenRefreshInterval</code> property. It can be configured via <code>localConfig.json -&gt; tokenRefreshInterval</code>, the value is in milliseconds.</p> <pre><code>  tokenRefreshInterval: 60000 // default 30 seconds\n</code></pre> <p>When the above configured <code>Session timeout</code> is in place, the client can exhibit two behaviors based on the <code>tokenRefreshInterval</code> configured on the client side, Disabling the refresh token (setting <code>restSessionService.autorefresh</code> to <code>false</code>) the administrator can use <code>sessionTimeout</code> and <code>tokenRefreshInterval</code> to limit the session duration this way:</p> <ul> <li>when <code>tokenRefreshInterval</code> is less than <code>sessionTimeout</code> configured (e.g <code>tokenRefreshInterval</code> is 30 seconds and <code>sessionTimeout</code> is 24 hours)</li> <li>when application is in use, the client performs a refresh token call before the expiring time and session is prolonged</li> <li>when the application is closed (i.e for any reason) and reopened after <code>sessionTimeout</code> configured, the client cannot perform refresh token call within the timeout window and hence the session expires and the user is asked to reconnect</li> <li>when <code>tokenRefreshInterval</code> is greater than <code>sessionTimeout</code> configured</li> <li>the session expires anyway before the refresh and the client is unable to perform the refresh activity within the configured time interval. The user will have to re-authenticate. In this case the two configuration should be nearly the same value, 30 seconds of difference, for example. This helps the client to perform the refresh activity immediately after the session expires to log out the user.</li> </ul>"},{"location":"developer-guide/integrations/auth/#openid-mapstore-login","title":"OpenID MapStore Login","text":""},{"location":"developer-guide/integrations/geoserver/","title":"GeoServer integrations","text":""},{"location":"developer-guide/integrations/geoserver/#mapstoregeoserver-users-integration","title":"MapStore/GeoServer users integration","text":"<p>MapStore can share users, groups an roles with GeoServer. This type of integration allows to setup a fine grained access to the data and the services based on MapStore groups and roles.</p> <p>This guide explains how to share users, groups and roles between MapStore and GeoServer. Applying this configurations will allow users logged in MapStore to be recognized by GeoServer. So security rules about restrictions on services, layers and so on can be correctly applied to MapStore users (also using GeoFence).</p> <p></p> <p>Note</p> <p>UserGroup Service/Role Service can be MapStore database or LDAP depending on the setup you prefer.</p> <p>With the suggested implementation the MapStore database will be also a UserGroupService and a RoleService for GeoServer. This means that every user of MapStore will be also a user in GeoServer, with the same attributes, the same roles (ADMIN, USER) and the same user groups.</p> <p>For every user-group assigned to a user GeoServer will see also a role of the same name, from the role service, assigned to the members of the user-group (as user-group derived roles).</p> <p>Permission on GeoServer can be assigned using these roles or with more detailed granularity using a custom Resource Access Manager (like GeoFence).</p>"},{"location":"developer-guide/integrations/geoserver/#limits-of-this-solution","title":"Limits of this solution","text":"<p>This solution partially degradates the functionalities of user management UI of GeoServer (for users, groups and roles that belong to MapStore). If you want to use this solution, you should use the MapStore's user manager and avoid the GeoServer's one.</p>"},{"location":"developer-guide/integrations/geoserver/#requirements","title":"Requirements","text":"<ol> <li>GeoServer must have the Authkey Plugin Community Module installed</li> <li>MapStore2 Database must be reachable by GeoServer (H2 will not work, use PostgreSQL or Oracle)</li> <li>MapStore2 must be reachable by GeoServer via HTTP</li> </ol> <p>This example will focus on PostgreSQL database type I am assuming this is a new installation, so no existing user or map will be preserved</p>"},{"location":"developer-guide/integrations/geoserver/#database-preparation","title":"Database preparation","text":"<ol> <li>Follow Geostore wiki to setup a postgresql database (ignore the geostore_test part)</li> <li>Start your Tomcat at least once, so <code>mapstore.war</code>will be extracted in the <code>webapps</code> directory of tomcat instance.</li> <li>Stop Tomcat.</li> <li>Copy from the extracted folder (<code>&lt;TOMCAT_DIR&gt;/webapps/mapstore</code>) the file located at <code>WEB-INF/classes/db-conf/postgres.properties</code> to replace the file <code>WEB-INF/classes/geostore-database-ovr.properties</code>.</li> <li>Edit the new <code>WEB-INF/classes/geostore-database-ovr.properties</code> file with your DB URL and credentials.</li> <li>Start Tomcat</li> </ol>"},{"location":"developer-guide/integrations/geoserver/#default-user-password-couples-are","title":"Default user password couples are","text":"<ul> <li>admin:admin</li> <li>user:user</li> </ul>"},{"location":"developer-guide/integrations/geoserver/#geoserver-setup","title":"GeoServer Setup","text":"<p>Follow this guide</p> <p>Create the empty GeoStore database using scripts as described in GeoStore WIKI.</p> <p>The following procedure will make GeoServer accessible to users stored in the MapStore database. In case of the users on MapStore and GeoServer have the same name, the users of MapStore will have precedence. At the end of the procedure, if you access with the user <code>admin</code>, you will have to use the password of the <code>admin</code> user of MapStore (<code>admin</code> by default).</p>"},{"location":"developer-guide/integrations/geoserver/#user-groups-and-roles","title":"User Groups and Roles","text":"<p>Steps below reference user, group and role service configuration files, as needed download the files from the geostore repository.</p>"},{"location":"developer-guide/integrations/geoserver/#setup-user-group-service","title":"Setup User Group Service","text":"<ul> <li>In GeoServer, Open the page \"Security\" --&gt; \"User Groups Roles\" (from the left menu)</li> <li>In the section \"User Group Services\" click on \"add new\" to a new user group service</li> <li>Select <code>JDBC</code></li> <li>name: <code>geostore</code></li> <li>Password encryption : <code>Digest</code></li> <li>password policy <code>default</code></li> <li>Driver <code>org.postgresql.Driver</code> (or <code>JNDI</code>)</li> <li>connection url <code>jdbc:postgresql://localhost:5432/geostore</code> (or the one for your setup)</li> <li>JNDI only: the JNDI resource name should look like this <code>java:comp/env/jdbc/geostore</code></li> <li>set username and password for the db (user <code>geostore</code> with password <code>geostore</code>)</li> <li>click on \"Save\" button</li> <li>Then, in order to adapt the standard JDBC service to MapStore database, you must place the provided files in the new directory (created by GeoServer for this new user group service) inside the data directory at the following path <code>&lt;gs_datadir&gt;/security/usergroup/geostore</code>. (<code>geostore</code> is the name of the new user group service)</li> <li>Then go back to <code>geostore</code> user group service page in GeoServer (the <code>ddl</code> and <code>dml</code> path should have values in them)</li> <li>click on \"Save\" button again</li> </ul>"},{"location":"developer-guide/integrations/geoserver/#setup-role-service","title":"Setup Role Service","text":"<ul> <li>In GeoServer Open the page \"Security\" --&gt; \"User Groups Roles\" (from the left menu)</li> <li>In the section \"Role Services\" click on \"add new\" to a new role service</li> <li>select <code>JDBC</code></li> <li>name <code>geostore</code></li> <li>db <code>org.postgresql.Driver</code></li> <li>connection url: <code>jdbc:postgresql://localhost:5432/geostore</code> (or JNDI, same as above)</li> <li>set user and password (user <code>geostore</code> with password <code>geostore</code>)</li> <li>click on \"Save\" button</li> <li>add the provided files to the geostore directory under <code>/&lt;gs_datadir&gt;/security/role/geostore</code></li> <li>click on \"Save\" button again</li> <li>go Again in JDBC Role Service <code>geostore</code></li> <li>select Administrator role to <code>ADMIN</code></li> <li>select Group Administrator Role to <code>ADMIN</code></li> </ul>"},{"location":"developer-guide/integrations/geoserver/#use-these-services-as-default","title":"Use these services as default","text":"<ul> <li>In GeoServer \"Security\" --&gt; \"Settings\" section (from the left menu)</li> <li>Set the Active role service to <code>geostore</code></li> <li>go to Authentication Section, scroll to Authentication Providers and Add a new one.</li> <li>select 'Username Password'</li> <li>name it \u201cgeostore\u201d</li> <li>select \u201cgeostore\u201d from the select box</li> <li>Save.</li> <li>Then go to \"Provider chain\" and move geostore on top in the right list.</li> <li>Save again</li> </ul>"},{"location":"developer-guide/integrations/geoserver/#use-the-auth-key-module-with-geostoregeoserver","title":"Use the Auth key Module with GeoStore/GeoServer","text":"<p>These last steps are required to allow users logged in MapStore to be authenticated correctly by GeoServer.</p>"},{"location":"developer-guide/integrations/geoserver/#configure-geoserver","title":"Configure GeoServer","text":"<ul> <li>Install the authkey module in GeoServer if needed (most recent versions of GeoServer already include it).</li> <li>Go to the authentication page and scroll into the 'Authentication Filters' section</li> <li>Click 'Add new'.</li> <li>Inside the 'New authentication Filter' page click on authkey module.</li> <li>Insert the name (i.e. 'geostore').</li> <li>Leave authkey as parameter name.</li> <li>Select the  Web Service as 'Authentication key user mapper'.</li> <li>Select the created geostore's 'User/Group Service'.</li> <li>Input the mapstore2 url: <code>http://&lt;your_hostname&gt;:&lt;mapstore2_port&gt;/mapstore/rest/geostore/session/username/{key}</code>. Examples:</li> </ul> <pre><code>http://localhost:36728/mapstore/rest/geostore/session/username/{key}\nhttp://localhost/mapstore2/rest/geostore/session/username/{key}\nhttp://mapstore.geosolutionsgroup.com/mapstore/rest/geostore/session/username/{key}\n</code></pre> <ul> <li>Save.</li> <li>Go into the authentication page and open default filter chain.</li> <li>Add 'geostore' into the 'Selected' filters and put it on top, and save.</li> </ul> <p>Note</p> <p>in the User Groups and Roles Services available options there are \"AuthKEY WebService Body Response - UserGroup Service from WebService Response Body\" and \"AuthKEY REST - Role service from REST endpoint\". Ignore them as they are not supported from MapStore2.</p>"},{"location":"developer-guide/integrations/geoserver/#configure-mapstore","title":"Configure MapStore","text":"<p>The last step is to configure MapStore to use the authkey with the configured instance of GeoServer. You can do it by adding to <code>localConfig.json</code> like this:</p> <pre><code>//...\n\"useAuthenticationRules\": true,\n\"authenticationRules\": [{\n\"urlPattern\": \".*geostore.*\",\n\"method\": \"bearer\"\n}, {\n\"urlPattern\": \"\\\\/geoserver/.*\",\n\"authkeyParamName\": \"authkey\",\n\"method\": \"authkey\"\n}],\n//...\n</code></pre> <ul> <li>Verify that \"useAuthenticationRules\" is set to <code>true</code></li> <li><code>authenticationRules</code> array should contain 2 rules:<ul> <li>The first rule should already be present, and defines the authentication method used internally in mapstore</li> <li>The second rule (the one you need to add) should be added and defines how to authenticate to GeoServer:<ul> <li><code>urlPattern</code>: is a regular expression that identifies the request url where to apply the rule</li> <li><code>method</code>: set it to <code>authkey</code> to use the authentication filter you just created in Geoserver.</li> <li><code>authkeyParamName</code>: is the name of the authkey parameter defined in GeoServer (set to <code>authkey</code> by default)</li> </ul> </li> </ul> </li> </ul>"},{"location":"developer-guide/integrations/geoserver/#advantages-of-user-integration","title":"Advantages of user integration","text":"<p>Integrating the user/groups database with GeoServer you can allow some users to:</p> <ul> <li> <p>Execute some processes (via WPS security)</p> </li> <li> <p>Download data (setting up the WPS download extension to allow/deny certain users to download data)</p> </li> <li> <p>Edit Styles (by default allowed only to administrators, but you can change it acting on <code>/rest/</code> Filter Chains).</p> </li> <li> <p>Access to layers based on users (using the standard GeoServer security)</p> </li> <li> <p>Filter layers data based on users (GeoFence), see here</p> </li> <li> <p>Allow editing of layers to certain MapStore users (GeoServer Security). The editing can be enabled in the plugin settings of MapStore</p> </li> </ul>"},{"location":"developer-guide/integrations/geoserver/#geoserver-plugins-and-extensions","title":"GeoServer Plugins and Extensions","text":"<p>MapStore supports several plugins for GeoServer. Installing them will expand the functionalities of MapStore, allowing to navigate data with time dimension, styling layers and so on.</p> <p>Here a list of the extensions that MapStore can use:</p> <ul> <li> <p>WMTS Multidimensional despite the name, this service provides multidimensional discovery services for GeoServer in general, not only for WMTS, and it is required to use the timeline plugin of MapStore.</p> </li> <li> <p>SLD Rest Service: this extension can be used by the MapStore styler to classify Vector and Raster data. It can inspect the real layer data to apply classification based on values contained in it. It allows to select various classification types (quantile, equalInterval, standardDeviation\u2026) and to customize the color scales based on parameters</p> </li> <li> <p>CSS Extension: with this extension the MapStore styler allows to edit styles also in CSS format, in addition to the standard SLD format</p> </li> <li> <p>WPS Extension: provides several process that can be executed using the OGC WPS Standard. IT contains some default services very useful for MapStore:</p> <ul> <li>gs:PagedUnique: provide a way to query layer attribute values with pagination and filtering by unique values. It enables autocomplete of attribute values for feature grid, attribute table, filter layer and other plugins.</li> <li>gs:Aggregate: allows aggregation operation on vector layers. This can be used  by the charts (widgets, dashboards) to catch data</li> <li>gs:Bounds: allows to calculate bounds of a filtered layer, used to dynamically zoom in dashboards map, when filtering is active.</li> <li>geo:buffer: provide a way to create a new vector layer around the source layer. This is mandatory for the GeoProcessing plugin buffer option.</li> <li>gs:IntersectionFeatureCollection: allows to return the intersection between two feature collections adding the attributes from both of them. This is mandatory for the GeoProcessing plugin intersection option.</li> <li>gs:CollectGeometries: allows to collect all the default geometries in a feature collection and returns them as a single geometry collection. This can be used by the GeoProcessing plugin to create a new layer.</li> </ul> </li> <li> <p>WPS download community module: this additional module allows to improve the exporter plugin, based by default only on the WFS, providing asynchronous download capabilities. The advanced Download, activated when GeoServer provides the WPS service above, allows to</p> <ul> <li>Download also the raster data</li> <li>Schedule download processes in a download list (and download them later, when post processing is finished).</li> <li>Select Spatial reference system</li> <li>Crop dataset to current viewport</li> <li>For vector layers:<ul> <li>Filter the dataset (based on MapStore filter)</li> </ul> </li> <li>For raster layers:<ul> <li>Select Compression type and quality</li> <li>Define width and height of internal tiles</li> </ul> </li> </ul> </li> <li> <p>CSW Extension: activating this extension, MapStore can browse data of GeoServer using the CSW protocol, improving performances with paginated requests. This is particularly useful when a GeoServer instance contains hundreds or thousands of layers, so the output of the WMS capabilities services can be too slow.</p> </li> <li> <p>Query Layer Plugin: this plugin allows the possibility to do cross-layer filtering. Cross layer filtering is the mechanism of filtering a layer using geometries coming from another layer. The plugin allows this filtering to be performed on the server side in an efficient way.</p> </li> <li> <p>DDS/BIL Plugin: this plugin add to geoserver the possibility to publish raster data in DDS/BIL format (World Wind). This particular plugin is useful if we want to use a raster data as elevation model for MapStore. This elevation model will be used in 3D mode or with the mouse coordinates plugin (displaying the elevation of a point on the map, together with the coordinates).</p> </li> <li> <p>WPS longitudinal profile process: this plugin added to geoserver gives the possibility to calculate an altitude profile on a given path  and it is required to use the Longitudinal Profile plugin of MapStore.</p> </li> <li> <p>WFS FreeMarker Extension: this plugin add to GeoServer the possibility to generate an HTML output for a WFS GetFeature response. As for the WMS Identify settings, it is applicable in MapStore by selecting the HTML format in the Feature Info Form for the Identify Tool.</p> </li> </ul>"},{"location":"developer-guide/integrations/infrastructure-setups/","title":"Possible setups","text":"<p>Accordingly with your infrastructure, there are several setups you can imagine with MapStore and GeoServer.</p>"},{"location":"developer-guide/integrations/infrastructure-setups/#mapstore-geoserver-integration","title":"MapStore-GeoServer integration","text":""},{"location":"developer-guide/integrations/infrastructure-setups/#mapstore-ldap-mapstore-geoserver","title":"MapStore-LDAP + MapStore-GeoServer","text":""},{"location":"developer-guide/integrations/infrastructure-setups/#mapstore-geoserver-mapstore-ldap-geoserver-ldap","title":"MapStore-GeoServer + MapStore-LDAP + GeoServer-LDAP","text":""},{"location":"developer-guide/integrations/infrastructure-setups/#mapstore-geoserver-mapstore-ldap-direct-geoserver-ldap","title":"MapStore-GeoServer + MapStore-LDAP (direct) + GeoServer-LDAP","text":""},{"location":"developer-guide/integrations/users/keycloak-sso-impl/","title":"SSO Workflow in Keycloak","text":"<p>Here in this section some details about keycloak SSO integration</p>"},{"location":"developer-guide/integrations/users/keycloak-sso-impl/#desired-workflow","title":"Desired workflow","text":"<p>If keycloak SSO is configured, we want to implement the following workflow.</p> <p></p> <p>The keycloakJS library implements the following workflow:</p> <p></p> <p>MapStore can:</p> <ul> <li>Re-run <code>init</code></li> <li>Intercept <code>onAuthLogout</code></li> <li>Implement adapter methods <code>login</code>, <code>logout</code>.</li> <li>Intercept <code>init</code> promise resolve with <code>.then</code></li> </ul> <p>Note</p> <p><code>changed</code> is the variable emitted by an internal iframe managed by the keycloak JS API. This technique allows to intercept logout events, anyway refreshing tokens or intercepting login, after first attempt doesn't seem to work well and has some limitations because of security reasons. In particular in the current implementation with <code>openID</code> sync with GeoStore we need to workaround partially the logic of the library to make the tokens work in sync.</p>"},{"location":"developer-guide/integrations/users/keycloak-sso-impl/#implementation","title":"Implementation","text":"<p>The SSO integration in MapStore will reuse the entry points of the JS lib together with the existing openID integration in keycloak, implementing the following workflows:</p>"},{"location":"developer-guide/integrations/users/keycloak-sso-impl/#initialization","title":"Initialization","text":"<p>At the initial page load, we check if the <code>authenticationProviders</code> contains a <code>sso</code> entry (only keycloak)</p> <p></p> <ul> <li><code>LoadJS</code>: loads <code>keycloak.js</code>, that includes the JS support to keycloak, from keycloak instance (only once)</li> <li><code>Init</code> is initialized by MapStore with the current config, adding MapStore's <code>access_token</code> and <code>refresh_token</code>, if present, from openID login.</li> </ul>"},{"location":"developer-guide/integrations/users/keycloak-sso-impl/#monitoring-phase","title":"Monitoring phase","text":"<p>After initialization, we may receive different events or cases. These are the possible cases:</p>"},{"location":"developer-guide/integrations/users/keycloak-sso-impl/#case-1-login-from-mapstore","title":"Case 1 - Login From MapStore","text":"<p>If MapStore is not logged in, the user can click on login button and be redirected to keycloak login form. After that, the init flow will pass the MapStore tokens to the JS interface. They will be used to check session logout.</p> <p>Note</p> <p>If MapStore user is logged in, the <code>init</code>, we may not initially have the token ready. For this reason, on LOGIN_SUCCESS, we re-init the application, or sync operation is triggered from <code>Adapter.login</code> to refresh the tokens.</p>"},{"location":"developer-guide/integrations/users/keycloak-sso-impl/#case-2-login-from-keycloak","title":"Case 2 - Login from keycloak","text":"<p>If MapStore is not logged in, the <code>init</code> function do a <code>check-sso</code> operation and finish. In order to monitor the login on MapStore, we implemented a timer to re-init trigger anytime the <code>check-sso</code> resolves with not authenticated.</p> <p></p> <p>Note</p> <p>Implementation is using <code>messageReceiveTimeout</code> as timeout, the same timeout variable of the keycloak JS library for monitoring logout</p>"},{"location":"developer-guide/integrations/users/keycloak-sso-impl/#case-3-logout-from-keycloak","title":"Case 3 - Logout from keycloak","text":"<p>In this case the library that receives a valid keycloak token monitors the logout autonomously.</p>"},{"location":"developer-guide/integrations/users/keycloak-sso-impl/#case-4-logout-from-mapstore","title":"Case 4 - Logout from MapStore","text":"<p>Logout from MapStore, a bug in keycloak API doesn't correctly check the internal iframe (<code>changed</code> option event), and there is no possibility to trigger it, until you visit the keycloak page. This condition after logout can not be distinguished from a external login (from keycloak) detection. So refreshing the page before the token on client is naturally expired will cause a redirect to Login page, because MapStore find there is an active session on keycloak. In order to avoid this, an hack is necessary. MapStore loads an iframe immediately after logout to allow the cookie session to be catch and to apply the proper reset.</p>"},{"location":"developer-guide/integrations/users/keycloak-sso-impl/#refresh-token","title":"Refresh token","text":"<p>By default keycloak has 5 minutes long lifetime for token, 30 minutes for refresh token. Anyway this can be configured. For this reason, the keycloak support schedules a refresh based on the current token expiration, restarting from <code>init</code>, scheduling a refresh as half of time between expiring time and now. (e.g The token expires 2 minutes from now, a refresh is scheduled in 1 minute).</p>"},{"location":"developer-guide/integrations/users/keycloak/","title":"Keycloak Integrations","text":""},{"location":"developer-guide/integrations/users/keycloak/#general","title":"General","text":"<p>MapStore supports various Keycloak integration features:</p> <ul> <li>OpenID support: Allows to login to MapStore using a keycloak account.</li> <li>Single sign on: Enhances the OpenID support by detecting a session in the keycloak realm and automatically login/logout from MapStore</li> <li>Direct user integration: Enhances the OpenID support making MapStore use keycloak as unique Identity Manager System (IdM), replacing the MapStore DB with Keycloak REST API.</li> </ul>"},{"location":"developer-guide/integrations/users/keycloak/#openid","title":"OpenID","text":"<p>Keycloak OpenID support allows to use a keycloak instance as Identity Provider (IdP) via OpenID Connect (OIDC), so that the user can login to MapStore using an existing account in keycloak.</p> <p>You can find details about how to configure it in the dedicated \"OpenID Connect\" page section dedicated to keycloak</p>"},{"location":"developer-guide/integrations/users/keycloak/#single-sign-on-integration","title":"Single sign on integration","text":"<p>MapStore provides an integration with the keycloak Single Sign On (SSO) system, that allows to automatically login/logout in MapStore when you login/logout from another application in the same keycloak realm, an vice-versa.</p> <p>In order to enable the SSO in keycloak you have to:</p> <ul> <li>Have already configured the openID for keycloak.</li> <li>Create a keycloak client in the same realm of openID integration above.</li> <li>Configure SSO in MapStore's <code>localConfig.json</code></li> </ul>"},{"location":"developer-guide/integrations/users/keycloak/#configure-the-openid-integration","title":"Configure the OpenID integration","text":"<ul> <li>See here openID integration.</li> </ul>"},{"location":"developer-guide/integrations/users/keycloak/#configure-keycloak-client","title":"Configure keycloak client","text":"<p>After configuring the open openID integration, you will have a keycloak client called <code>mapstore-server</code>. In order to enable SSO you have to create another new Client on keycloak. In this guide we will name it <code>mapstore-client</code>.</p> <p> </p> <ul> <li>Configure it as <code>Public</code></li> <li>Insert in  \"Valid Redirect URIs\" your MapStore base root, with a <code>*</code> at the end (e.g. <code>https://my.mapstore.site.com/mapstore/*</code>)</li> <li>Insert in \"Web Origins\" your MapStore base domain name. (e.g. <code>https://my.mapstore.site.com</code>)</li> </ul> <p></p> <ul> <li>Click on Save button, then open the Installation tab, select the <code>Keycloak OIDC JSON</code> format, and copy the JSON displayed below.</li> </ul> <p></p>"},{"location":"developer-guide/integrations/users/keycloak/#configure-sso-in-mapstore","title":"Configure SSO in MapStore","text":"<p>After configuring the open openID integration, you will have an entry named <code>keycloak</code> in <code>authenticationProviders</code>. In this entry, you will have to add <code>\"sso\":{\"type\":\"keycloak\"}</code> and <code>config: \"&lt;configuration coped from keycloak&gt;\"</code>.</p> <p>e.g.</p> <pre><code>{\n\"authenticationProviders\": [\n{\n\"type\": \"openID\",\n\"provider\": \"keycloak\",\n\"config\": {\n\"realm\": \"master\",\n\"auth-server-url\": \"http://localhost:8080/\",\n\"ssl-required\": \"external\",\n\"resource\": \"mapstore-client\",\n\"public-client\": true,\n\"confidential-port\": 0\n},\n\"sso\": {\n\"type\": \"keycloak\"\n}\n}\n],\n}\n</code></pre> <p>Here implementation details about keycloak login workflow.</p>"},{"location":"developer-guide/integrations/users/keycloak/#direct-user-integration","title":"Direct user integration","text":"<p>By default MapStore can integrate openID login with Keycloak and also supports integration with Keycloak SSO.</p> <p>By default users that login with Keycloak are created on the database and their Keycloak roles inserted as MapStore UserGroup. Anyway MapStore can interact with Keycloak REST API to provide a direct integration without persisting anything on the MapStore's database. This provides a stricter integration between the applications, allowing the assignment of roles and groups directly from keycloak, and avoiding any synchronization issue.</p> <p>In this scenario the integration MapStore replaces the user and user-group database tables with the keycloak REST API.</p> <p>Note</p> <p>This integration disables reading and writing to the users' and groups' database and replaces it with the Keycloak REST API, with read-only support. For this reason we suggest to disable the <code>UserManager</code>, <code>GroupManager</code> plugins, and remove the <code>authenticationProviders</code> entry of type <code>geostore</code>, if any, because the standard login with username and password is not allowed for the db users. In case of integration with GeoServer, also GeoServer should be connected to Keycloak for users, and not to the MapStore database.</p>"},{"location":"developer-guide/integrations/users/keycloak/#configure-direct-integration-with-keycloak","title":"Configure direct integration with keycloak","text":"<p>To enable the direct integration with keycloak you will have to:</p> <ol> <li>Create a dedicated client for keycloak.</li> <li>Configure <code>mapstore-ovr.properties</code></li> <li>Activate the functionality via system property</li> </ol>"},{"location":"developer-guide/integrations/users/keycloak/#1-create-a-dedicated-client-for-keycloak","title":"1. Create a dedicated client for keycloak","text":"<ul> <li>Create another client on keycloak, in the same realm of <code>mapstore-server</code> and <code>mapstore-client</code> (where present) called <code>mapstore-users</code>:</li> </ul> <ul> <li> <p>Configure it with:</p> </li> <li> <p>Access Type: <code>public</code></p> </li> <li>Implicit Flow Enabled Set to on On</li> <li>Valid Redirect URIs with your app base URL, with an ending <code>*</code>, e.g. <code>http://localhost:8080/*</code>.</li> </ul> <p></p> <p>And click on Save.</p>"},{"location":"developer-guide/integrations/users/keycloak/#2-configure-mapstore-ovrproperties","title":"2. Configure <code>mapstore-ovr.properties</code>","text":"<p>The <code>autoCreateUser</code> option must be set to false in <code>mapstore-ovr.properties</code>.</p> <pre><code>keycloakOAuth2Config.autoCreateUser=false\n</code></pre> <p>Moreover in <code>mapstore-ovr.properties</code> you have to add the following information (replacing <code>&lt;keycloak-base-url&gt;</code> with your base keycloak base url):</p> <pre><code>## Keycloak as User and UserGroup repository\nkeycloakRESTClient.serverUrl=&lt;keycloak-base-url&gt;\nkeycloakRESTClient.realm=master\nkeycloakRESTClient.username=admin\nkeycloakRESTClient.password=admin\nkeycloakRESTClient.clientId=mapstore-users\n</code></pre> <p>Where:</p> <ul> <li><code>serverUrl</code>: URL of keycloak, (e.g. <code>http://localhost:8080</code> or <code>https://mysite.com/</code>)</li> <li><code>realm</code>: the realm where the client has been created</li> <li><code>username</code>, <code>password</code>: credentials of a user with the role to <code>view-users</code>.<sup>1</sup></li> </ul> <p>Note</p> <p><sup>1</sup> In order to query the keycloak REST API, you need to have in your realm at least one user with <code>realm-admin</code> role permission. Usually the administrator of the realm has these permission. To associate these permissions to a new user dedicated to this purpose, you have to open \"Role Mappings\" tab of keycloak and in \"Client Roles\" select <code>realm-management</code> (or in master realm select <code>master-realm</code>) and add to selected <code>realm-admin</code>. </p>"},{"location":"developer-guide/integrations/users/keycloak/#3-activate-the-functionality-via-system-property","title":"3. Activate the functionality via system property","text":"<p>In order to activate the integration in your instance, you will need to set the Java System Property <code>security.integration</code>  with the value <code>keycloak-direct</code>.</p> <p>One easy and usual way to configure this system property in Tomcat is using the <code>JAVA_OPTS</code>. Like you do with <code>datadir.location</code>, you can set it by adding to <code>JAVA_OPTS</code> variable the entry <code>-Dsecurity.integration=keycloak-direct</code>.</p> <p>Note</p> <p>For old projects or in case you can not set the system property, you can anyway configure it by adding this section to your <code>geostore-spring-security.xml</code> file.</p> <pre><code>    &lt;bean\nid=\"keycloakUserGroupDAO\"\nclass=\"it.geosolutions.geostore.services.rest.security.keycloak.KeycloakUserGroupDAO\"&gt;\n&lt;constructor-arg ref=\"keycloakRESTClient\"/&gt;\n&lt;property name=\"addEveryOneGroup\" value=\"true\"/&gt;\n&lt;/bean&gt;\n&lt;alias name=\"keycloakUserDAO\" alias=\"userDAO\"/&gt;\n&lt;bean\nid=\"keycloakUserGroupDAO\"\nclass=\"it.geosolutions.geostore.services.rest.security.keycloak.KeycloakUserGroupDAO\"&gt;\n&lt;constructor-arg ref=\"keycloakRESTClient\"/&gt;\n&lt;/bean&gt;\n&lt;alias name=\"keycloakUserGroupDAO\" alias=\"userGroupDAO\" addEveryOneGroup=\"true\"/&gt;\n&lt;alias name=\"externalSecurityDAO\" alias=\"securityDAO\"/&gt;\n</code></pre>"},{"location":"developer-guide/integrations/users/ldap/","title":"LDAP integration with MapStore","text":"<p>The purpose of this guide is to explain how to configure MapStore to use an LDAP repository for authentication and accounting (users, roles and user-groups) instead of the standard database.</p>"},{"location":"developer-guide/integrations/users/ldap/#overview","title":"Overview","text":"<p>By default the MapStore backend users service (also known as GeoStore), uses a relational database to store and fetch users details, implement authentication and assign resource access rights to users and groups (for maps, dashboards, etc.).</p> <p>If you already have your users on an LDAP repository you can anyway configure MapStore to connect to your service and use it to authenticate users and associate user groups and roles, instead of using the default database. In this case the relational database will store only resources and accessory data (permissions, attributes ...) referring the users of your service.</p> <p>Notice that the LDAP storage is read-only. This means that the MapStore User/Groups management UI cannot be used to manage users and groups. This makes sense because an LDAP repository is considered an external source and should be managed externally.</p> <p>If this can create confusion, you can eventually fully disable the UI when using LDAP, by removing the corresponding plugin from the MapStore configuration.</p> <p>The LDAP storage can be configured in two different ways:</p> <ul> <li>synchronized mode</li> <li>direct connection mode (experimental)</li> </ul>"},{"location":"developer-guide/integrations/users/ldap/#synchronized-mode","title":"Synchronized mode","text":"<p>In synchronized mode, user data (users, groups, roles) is read from LDAP on every login and copied on the internal database.</p> <p>Any other operation, for example getting user permissions on maps, always uses the internal database.</p> <p>Synchronized mode is faster for normal use, but data may disalign when users are removed from the LDAP repository.</p> <p>In general we suggest to use synchronized mode, since it is the most stable and tested one.</p>"},{"location":"developer-guide/integrations/users/ldap/#direct-connection-mode-experimental","title":"Direct connection mode (experimental)","text":"<p>In direct connection mode, user data is always read from LDAP, for any operation, so there is no risk of misaligned data.</p> <p>Direct connection is still experimental and not tested in all the possible scenarios, but will hopefully become the standard mode in an early future, because the approach is simpler and avoids most the synchronized mode defects (e.g. misalignments).</p>"},{"location":"developer-guide/integrations/users/ldap/#configuration","title":"Configuration","text":"<p>Configuring MapStore to use the LDAP storage requires:</p> <ul> <li>filling out the LDAP configuration properties in the java/web/src/main/resources/ldap.properties file to match your LDAP repository structure</li> <li>invoking the build with the ldap profile</li> </ul> <pre><code>./build.sh &lt;version&gt; ldap\n</code></pre>"},{"location":"developer-guide/integrations/users/ldap/#configuration-properties","title":"Configuration properties","text":"<p>Configurable properties in the ldap.properties file include the following:</p> <pre><code>## name of the LDAP server host\nldap.host=localhost\n## port of the LDAP server\nldap.port=10389\n## root path for all searches\nldap.root=dc=acme,dc=org\n## complete DN of an LDAP user, with browse permissions on the used LDAP tree (optional, if browse is available to anoymous users)\nldap.userDn=\n## password of the userDn LDAP user (optional, if browse is available to anoymous users)\nldap.password=\n## root path for seaching users \nldap.userBase=ou=people\n## root path for seaching groups\nldap.groupBase=ou=groups\n## root path for seaching roles\nldap.roleBase=ou=groups\n## LDAP filter used to search for a given username ({0} is the username to search for)\nldap.userFilter=(uid={0})\n## LDAP filter used to search for groups membership of a given user ({0} is the full user DN)\nldap.groupFilter=(member={0})\n## LDAP filter used to search for role membership of a given user ({0} is the full user DN)\nldap.roleFilter=(member={0})\n\n## enables / disables support for nested (hierarchical) groups; when true, a user is assigned groups recursively if its groups belong to other groups\nldap.hierachicalGroups=false\n## LDAP filter used to search for groups membership of a given group ({0} is the full group DN)\nldap.nestedGroupFilter=(member={0})\n## max number of nested groups that are used\nldap.nestedGroupLevels=3\n\n## if true, all the searches are recursive from the relative root path\nldap.searchSubtree=true\n## if true, all users, groups and roles names are transformed to uppercase in MapStore\nldap.convertToUpperCase=true\n</code></pre>"},{"location":"developer-guide/integrations/users/ldap/#enabling-direct-connection-mode","title":"Enabling direct connection mode","text":"<p>The default configuration enables the synchronized mode. To switch to direct connection mode you have to manually edit the final <code>geostore-spring-security.xml</code> to uncomment the related section at the end of the file:</p> <pre><code>&lt;!-- enable direct connection mode --&gt;\n&lt;bean id=\"ldapUserDAO\" [...]&gt;\n[...]\n    &lt;/bean&gt;\n&lt;bean id=\"ldapUserGroupDAO\" [...]&gt;\n[...]\n    &lt;/bean&gt;\n&lt;!-- --&gt;\n</code></pre>"},{"location":"developer-guide/integrations/users/ldap/#testing-ldap-support","title":"Testing LDAP support","text":"<p>If you don't have an LDAP repository at hand, a very light solution for testing is the acme-ldap java server included in the GeoServer LDAP documentation here.</p> <p>You can easily customize the sample data tree, editing the java code.</p> <p>The sample MapStore LDAP configuration in the default <code>ldap.properties</code> file works seamlessly with acme-ldap.</p>"},{"location":"developer-guide/integrations/users/ldap/#advanced-configuration","title":"Advanced Configuration","text":"<p>More information about the MapStore backend storage and security service, GeoStore, is available here.</p> <p>In particular, more information about LDAP usage with GeoStore is in the following Wiki page.</p>"},{"location":"developer-guide/integrations/users/openId/","title":"Integration with OpenID connect","text":"<p>MapStore allows to integrate with OpenID connect services. This allows to use external services to authenticate users in MapStore. This is useful when you have to integrate MapStore with an existing authentication system, or when you want to use a third-party service to authenticate users.</p>"},{"location":"developer-guide/integrations/users/openId/#customizing-logo-an-text-in-login-form","title":"Customizing logo an text in Login Form","text":"<p>For details about the configuration for a specific service, please refer to the corresponding section below. If you want to customize the icon and/or text displayed, you can refer to the documentation of the LoginPlugin.</p> <p>By default, the <code>authenticationProviders</code> field contains only <code>{\"type\": \"basic\", \"provider\": \"geostore\"}</code>, which represents the standard login on MapStore using a username and password. With this default configuration, when a user tries to log in, MapStore will display the classic login form.</p> <p>You can add additional providers to the list (e.g., <code>openid</code>), and they will be included as options in the login window. If you want to remove the login form and only use the added providers, you can remove the <code>geostore</code> entry from the <code>authenticationProviders</code> list.</p> <p>Info</p> <p>If only one OpenID entry is present in <code>authenticationProviders</code> (and no <code>geostore</code> entry available), clicking on the login entry in the login menu will redirect directly to the OpenID provider login page configured, without showing the login window. If more than one entry is present in the <code>authenticationProviders</code> list, the the login window will be provided in the MapStore UI to be able choose the desired one for the authentication.</p>"},{"location":"developer-guide/integrations/users/openId/#supported-openid-services","title":"Supported OpenID services","text":"<p>MapStore provides a generic OpenID connect provider (<code>oidc</code>) that can be used to configure any OpenID Connect service (Google, Microsoft, Keycloak, Facebook, Github, etc.). In addition, MapStore provides specific configurations for some services. This means that you can configure MapStore to use the following services out of the box:</p> <ul> <li>OpenID connect</li> <li>Google (specific)</li> <li>Keycloak (specific)</li> </ul> <p>For each service you want to include, you have to:</p> <ul> <li>configure the service (e.g., create a new application on Google Console, create a new client on Keycloak, etc.)</li> <li>properly configure the backend (in <code>mapstore-ovr.properties</code>)</li> <li>modify the <code>localConfig.json</code> file by adding a proper entry to the <code>authenticationProviders</code></li> </ul> <p>Moreover the keycloak provider allows to configure advanced features like the Single Sign On (SSO) with other applications and direct user database integration as for LDAP.</p> <p>Note</p> <p>For the moment the generic <code>oidc</code> provider does not support multiple instances. This means that you can configure only one generic <code>oidc</code> provider. You can configure the specific providers (e.g., <code>google</code>, <code>keycloak</code>) in addition to the generic <code>oidc</code> provider, but not multiple instances of the generic <code>oidc</code> provider. So for instance you can configure a generic <code>oidc</code> provider (e.g. connected to Github) plus a <code>google</code> and a <code>keycloak</code> provider, but not two generic <code>oidc</code> providers.</p>"},{"location":"developer-guide/integrations/users/openId/#openid-connect-experimental","title":"OpenID connect (experimental)","text":"<p>In order to configure the generic OpenID provider with a service of your choice you have to:</p> <ul> <li>Configure the OpenID provider client</li> <li>Configure MapStore back-end</li> <li>Configure the MapStore front-end</li> </ul>"},{"location":"developer-guide/integrations/users/openId/#configure-openid-provider-client","title":"Configure OpenID provider client","text":"<p>This step depends on the specific OpenID provider so, please, refer to the specific documentation of the OpenID provider you are using. You can find some examples about how to configure a generic OpenID provider with Microsoft Azure in the following sections. The same information are valid for other OpenID providers, like Google, Keycloak, etc. You have to get the following information:</p> <ul> <li>Client ID: the client id. This is the client id that must be present on the OpenID provider</li> <li>Client Secret: the client secret. This is the client secret for the client id on the OpenID provider</li> <li>Discovery URL: the discovery URL. This is the URL that contains all the information for the specific service.</li> </ul>"},{"location":"developer-guide/integrations/users/openId/#configure-the-mapstore-back-end","title":"Configure the MapStore back-end","text":"<p>In order to configure the generic OpenID provider you have to:</p> <ul> <li>create/edit <code>mapstore-ovr.properties</code> file (in data-dir or class path) to configure the generic provider this way:</li> </ul> <pre><code># enables the keycloak OpenID Connect filter\noidcOAuth2Config.enabled=true\n\n# note: this is the client id have to be present on the OpenID provider\noidcOAuth2Config.clientId=mapstore-server\noidcOAuth2Config.clientSecret=&lt;THE_CLIENT_SECRET&gt;\n# the discovery URL\noidcOAuth2Config.discoveryUrl=http://keycloak:8080/auth/realms/mapstore/.well-known/openid-configuration\noidcOAuth2Config.sendClientSecret=true\n# create the user if not present\noidcOAuth2Config.autoCreateUser=true\noidcOAuth2Config.redirectUri=http://localhost:8080/mapstore/rest/geostore/openid/oidc/callback\n# Internal redirect URI (you can set it to relative path like this `../../..` to make this config work across domain)\noidcOAuth2Config.internalRedirectUri=http://localhost:8080/mapstore\n# user name attribute (default is `email`)\n# oidcOAuth2Config.principalKey=email\n# Optional role claims, if a claim contains roles, you can map them to MapStore roles. (roles can be only ADMIN or USER)\n# oidcOAuth2Config.rolesClaim=roles\n# Optional group claims, if a claim contains groups, you can map them to MapStore groups.\n# oidcOAuth2Config.groupsClaim=groups\n# Enables global logout from SSO, if properly confugred. false by default\n# oidcOAuth2Config.globalLogoutEnabled=true\n# Optional scopes parameter, that allows to customize the scopes to reqeuest. If empty, MapStore will use the one present in the discovery document\n# oidcOAuth2Config.scopes=email,profile\n</code></pre> <ul> <li><code>oidcOAuth2Config.clientId</code>: the client id. This is the client id that must be present on the OpenID provider</li> <li><code>oidcOAuth2Config.clientSecret</code>: the client secret. This is the client secret for the client id on the OpenID provider</li> <li><code>oidcOAuth2Config.discoveryUrl</code>: the discovery URL. This is the URL that contains all the information for the specific service.</li> <li><code>oidcOAuth2Config.sendClientSecret</code>: if <code>true</code>, the client secret will be sent to the OpenID provider. If <code>false</code>, the client secret will not be sent.</li> <li><code>oidcOAuth2Config.autoCreateUser</code>: if <code>true</code>, the user will be created, if not present, in the MapStore database. If <code>false</code>, the user will not be created (useful if the user is managed by an external service like Keycloak or LDAP).</li> <li><code>oidcOAuth2Config.redirectUri</code>: the redirect URI. This is the URI that the OpenID provider, and it must be the effective URI of the MapStore application, with the path <code>/rest/geostore/openid/oidc/callback</code>.</li> <li><code>oidcOAuth2Config.internalRedirectUri</code>: the internal redirect URI. This is the URI that the MapStore will redirect to after the login. It must be the effective URI of the MapStore application.</li> <li><code>oidcOAuth2Config.principalKey</code>: (optional) the user name attribute. This is the attribute that will be used as user name. The default is <code>email</code>.</li> <li><code>oidcOAuth2Config.rolesClaim</code>: (optional) the role claims. If a claim contains roles, you can map them to MapStore roles. The roles can be only <code>ADMIN</code> or <code>USER</code>. If the claim is not present, the default role will be <code>USER</code>.</li> <li><code>oidcOAuth2Config.groupsClaim</code>: (optional) the group claims. If a claim contains groups, you can map them to MapStore groups. If the claim is not present, no group will be assigned (except the default <code>everyone</code> group).</li> <li><code>oidcOAuth2Config.globalLogoutEnabled</code>: (optional): if true (and the server supports it) invokes global logout on MapStore logout</li> </ul> <p>Note</p> <p>The <code>rolesClaim</code> and <code>groupsClaim</code> are optional. If you don't need to map roles or groups, you can omit them. At the moment, there is no mapping for roles and groups for the generic OIDC provider. If you need to map roles and groups, you can use the <code>keycloak</code> provider.</p>"},{"location":"developer-guide/integrations/users/openId/#configure-the-mapstore-front-end","title":"Configure the MapStore front-end","text":"<ul> <li>Add an entry for <code>oidc</code> in <code>authenticationProviders</code> inside <code>localConfig.json</code> file.</li> </ul> <pre><code>{\n\"authenticationProviders\": [\n{\n\"type\": \"openID\",\n\"provider\": \"oidc\",\n\"title\": \"My custom identity provider\"\n},\n{\n\"type\": \"basic\",\n\"provider\": \"geostore\"\n}\n]\n}\n</code></pre> <p>You can customize the <code>title</code> to be displayed in the login form, add an <code>imageURL</code> or use only one <code>authenticationProviders</code>, removing the <code>geostore</code> entry, if you want to use only the OpenID provider. In this case the user will be redirected directly to the OpenID provider without showing the login form.</p>"},{"location":"developer-guide/integrations/users/openId/#example-with-microsoft-azure","title":"Example with Microsoft Azure","text":"<p>Microsoft Azure provides OpenID Connect support. This is an example of how to configure MapStore to use Microsoft Azure as an OpenID provider. The same steps can be applied to other OpenID providers. Please refer to the specific documentation of the OpenID provider you are using. Here the one for Microsoft Azure.</p> <p>Here a quick summary of the steps to configure Microsoft Azure as an OpenID provider and get the information needed to configure MapStore:</p> <ol> <li>Create a new application </li> <li>Set the proper valid redirect URLs  to: <code>https://&lt;your-domain&gt;/mapstore/rest/geostore/openid/oidc/callback</code></li> <li>Create and copy the client secret </li> <li>Add optional claims if needed </li> <li>Copy endpoints and data to configure MapStore </li> </ol> <p>These steps are based on the Microsoft Azure documentation. Please refer the official documentation for any detail or additional configuration.</p> <p>Here below are also some other sample configurations for MapStore:</p> <p><code>mapstore-ovr.properties</code>:</p> <pre><code># enables the OpenID Connect filter\noidcOAuth2Config.enabled=true\n\n# note: this is the client id you have created in Keycloak\noidcOAuth2Config.clientId=&lt;CLIENT_ID&gt;\noidcOAuth2Config.clientSecret=&lt;CLIENT_SECRET&gt;\n\n# DISCOVERY_URL something like https://login.microsoftonline.com/abc-dfe-ghi-123-345-567-789/v2.0/.well-known/openid-configuration\noidcOAuth2Config.discoveryUrl=&lt;DISCOVERY_URL&gt;\noidcOAuth2Config.sendClientSecret=true\n# create the user if not present\noidcOAuth2Config.autoCreateUser=true\n# Here you have to set your redirect URI (here is configured for localhost)\noidcOAuth2Config.redirectUri=http://localhost:8080/mapstore/rest/geostore/openid/oidc/callback\n# Internal redirect URI (you can set it to relative path like this `../../..` to make this config work across domain)\noidcOAuth2Config.internalRedirectUri=http://localhost:8080/mapstore\n</code></pre> <p><code>localConfig.json.patch</code> ( with a custom title and an image with the Microsoft logo to show in the login form)</p> <pre><code>    {\n\"authenticationProviders\": [\n{\n\"type\": \"openID\",\n\"provider\": \"oidc\",\n\"title\": \"Microsoft\",\n\"imageURL\": \"data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgdmlld0JveD0iMCAwIDI1IDI1IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGl0ZW1wcm9wPSJsb2dvIiBpdGVtc2NvcGU9Iml0ZW1zY29wZSI+CgkJCTxwYXRoIGQ9Ik0xMS41MjE2IDAuNUgwVjExLjkwNjdIMTEuNTIxNlYwLjVaIiBmaWxsPSIjZjI1MDIyIj48L3BhdGg+CgkJCTxwYXRoIGQ9Ik0yNC4yNDE4IDAuNUgxMi43MjAyVjExLjkwNjdIMjQuMjQxOFYwLjVaIiBmaWxsPSIjN2ZiYTAwIj48L3BhdGg+CgkJCTxwYXRoIGQ9Ik0xMS41MjE2IDEzLjA5MzNIMFYyNC41SDExLjUyMTZWMTMuMDkzM1oiIGZpbGw9IiMwMGE0ZWYiPjwvcGF0aD4KCQkJPHBhdGggZD0iTTI0LjI0MTggMTMuMDkzM0gxMi43MjAyVjI0LjVIMjQuMjQxOFYxMy4wOTMzWiIgZmlsbD0iI2ZmYjkwMCI+PC9wYXRoPgoJCTwvc3ZnPgo=\"\n},\n{\n\"type\": \"basic\",\n\"provider\": \"geostore\"\n}\n]\n\n}\n</code></pre>"},{"location":"developer-guide/integrations/users/openId/#google","title":"Google","text":"<p>The Google OpenID Connect provider allows to use Google as an authentication provider. This is useful when you want to use Google as an authentication provider for your application.</p>"},{"location":"developer-guide/integrations/users/openId/#create-oauth-20-credentials-on-google-console","title":"Create Oauth 2.0 credentials on Google Console","text":"<p>In order to setup the openID connection you have to setup a project in Google API Console to obtain Oauth 2.0 credentials and configure them. Here a quick summary of the steps to configure Google as an OpenID provider. For more details, please refer to the Google documentation.</p> <ul> <li>Open the Google developer console and, from credentials section, create a new credential of type Oauth client ID</li> </ul> <p></p> <ul> <li>Set the Application Type to Web Application, name it as you prefer and configure the root of the application as an authorized redirect URI. Then click on Create</li> </ul> <p></p> <ul> <li>After creation you will obtain ClientID and Client Secret to use to configure MapStore.</li> </ul> <p>Please follow the Google documentation for any detail or additional configuration.</p>"},{"location":"developer-guide/integrations/users/openId/#configure-mapstore-back-end-for-google-openid","title":"Configure MapStore back-end for Google OpenID","text":"<p>After the setup, you will have to:</p> <ul> <li>create/edit the <code>mapstore-ovr.properties</code> file (in data-dir or class path) to configure the Google OpenID integration by inserting in particular the <code>clientId</code> and the <code>clientSecret</code> obtained from Google Console. You have also to set the <code>autoCreateUser</code> to <code>true</code> to create the user if not present in the MapStore database:</li> </ul> <p>Here an example of the configuration, documented inline:</p> <pre><code># enables the google OpenID Connect filter\ngoogleOAuth2Config.enabled=true\n\n#clientId and clientSecret\ngoogleOAuth2Config.clientId=&lt;the_client_id_from_google_dev_console&gt;\ngoogleOAuth2Config.clientSecret=&lt;the_client_secret_from_google_dev_console&gt;\n\n# create the user if not present\ngoogleOAuth2Config.autoCreateUser=true\n\n# Redirect URL (needs to be configured in the Google Console too)\ngoogleOAuth2Config.redirectUri=https://&lt;your-appliction-domain&gt;/mapstore/rest/geostore/openid/google/callback\n# Internal redirect URI (you can set it to relative path like this `../../..` to make this config work across domain)\ngoogleOAuth2Config.internalRedirectUri=https://&lt;your-appliction-domain&gt;/mapstore/\n\n## discoveryUrl: contains all the information for the specific service.\ngoogleOAuth2Config.discoveryUrl=https://accounts.google.com/.well-known/openid-configuration\n</code></pre>"},{"location":"developer-guide/integrations/users/openId/#configure-mapstore-front-end-for-google-openid","title":"Configure MapStore front-end for Google OpenID","text":"<ul> <li>Add an entry for <code>google</code> in <code>authenticationProviders</code> inside <code>localConfig.json</code> file.</li> </ul> <pre><code>{\n\"authenticationProviders\": [\n{\n\"type\": \"openID\",\n\"provider\": \"google\"\n},\n{\n\"type\": \"basic\",\n\"provider\": \"geostore\"\n}\n]\n}\n</code></pre>"},{"location":"developer-guide/integrations/users/openId/#keycloak","title":"Keycloak","text":"<p>Keycloak is an open source identity and access management application widely used. MapStore has the ability to integrate with keycloak:</p> <ul> <li>Using the standard OpenID Connect (OIDC) protocol to login/logout in MapStore</li> <li>Supporting Single Sign On (SSO) with other applications.</li> <li>Mapping keycloak roles to MapStore groups, as well as for ldap.</li> </ul> <p>In this section you can see how to configure keycloak as a standard OpenID provider. For other advanced functionalities, you can see the dedicated section of the documentation</p>"},{"location":"developer-guide/integrations/users/openId/#configure-keycloak-client","title":"Configure keycloak Client","text":"<p>Create a new Client on keycloak. In this guide we will name it <code>mapstore-server</code> (because if you need to configure SSO, we may need another key to call <code>mapstore-client</code>)</p> <p> </p> <ul> <li>Configure it as <code>Confidential</code> setting the Redirect-URL with your MapStore base root, with a <code>*</code> at the end (e.g. <code>https://my.mapstore.site.com/mapstore/*</code>)</li> </ul> <p></p> <ul> <li>Click on Save button, then open the Installation tab, select the <code>Keycloak OIDC JSON</code> format, and copy the JSON displayed below.</li> </ul> <p></p>"},{"location":"developer-guide/integrations/users/openId/#configure-mapstore-back-end-for-keycloak-openid","title":"Configure MapStore back-end for Keycloak OpenID","text":"<p>Create/edit <code>mapstore-ovr.properties</code> file (in data-dir or class path) to configure the keycloak provider this way:</p> <pre><code># enables the keycloak OpenID Connect filter\nkeycloakOAuth2Config.enabled=true\n\n# Configuration\nkeycloakOAuth2Config.jsonConfig=&lt;copy-here-the-json-config-from-keycloak-removing-all-the-spaces&gt;\n\n\n# Redirect URLs\n# - Redirect URL: need to be configured to point to your application at the path &lt;base-app-url&gt;/rest/geostore/openid/keycloak/callback\n# e.g. `https://my.mapstore.site.com/mapstore/mapstore/rest/geostore/openid/keycloak/callback`\nkeycloakOAuth2Config.redirectUri=https://my.mapstore.site.com/mapstore/rest/geostore/openid/keycloak/callback\n# - Internal redirect URL when logged in (typically the home page of MapStore, can be relative)\nkeycloakOAuth2Config.internalRedirectUri=https://my.mapstore.site.com/mapstore/\n\n# Create user (if you are using local database, this should be set to true)\nkeycloakOAuth2Config.autoCreateUser=true\n\n# Comma separated list of &lt;keycloak-role&gt;:&lt;geostore-role&gt;\nkeycloakOAuth2Config.roleMappings=admin:ADMIN,user:USER\n\n# Comma separated list of &lt;keycloak-role&gt;:&lt;geostore-group&gt;\nkeycloakOAuth2Config.groupMappings=MY_KEYCLOAK_ROLE:MY_MAPSTORE_GROUP,MY_KEYCLOAK_ROLE2:MY_MAPSTORE_GROUP2\n\n# Default role, when no mapping has matched\nkeycloakOAuth2Config.authenticatedDefaultRole=USER\n</code></pre> <ul> <li><code>keycloakOAuth2Config.jsonConfig</code>: insert the JSON copied, removing all the spaces</li> <li><code>keycloakOAuth2Config.redirectUri</code>: need to be configured to point to your application at the path <code>&lt;base-app-url&gt;/rest/geostore/openid/keycloak/callback</code>, e.g. <code>https://my.mapstore.site.com/mapstore/rest/geostore/openid/keycloak/callback</code></li> <li><code>keycloakOAuth2Config.internalRedirectUri</code> can be set to your application root, e.g. <code>https://my.mapstore.site.com/mapstore/</code></li> <li><code>keycloakOAuth2Config.autoCreateUser</code>: true if you want MapStore to insert a Keycloak authenticated user on the DB. UserGroups will be inserted as well and kept in synch with the roles defined for the user in Keycloak. The option must be set to false if MapStore is using a read-only external service for users and groups (i.e. Keycloak or LDAP).</li> <li><code>keycloakOAuth2Config.forceConfiguredRedirectURI</code>: optional, if <code>true</code>, forces the redirect URI for callback to be equal to teh redirect URI. This is useful if you have problems logging in behind a proxy, or in dev mode.</li> <li><code>keycloakOAuth2Config.roleMappings</code>: comma separated list of mappings with the following format <code>keycloak_admin_role:ADMIN,keycloak_user_role:USER</code>. These mappings will be used to map Keycloak roles to MapStore roles. Allowed values <code>USER</code> or <code>ADMIN</code>.</li> <li><code>keycloakOAuth2Config.authenticatedDefaultRole</code>: where the role has not been assigned by the mappings above, the role here will be used. Allowed values <code>USER</code> or <code>ADMIN</code>.</li> <li><code>keycloakOAuth2Config.groupMappings</code>: comma separated list of mappings with the following format <code>keycloak_role_name:mapstore_group_name,keycloak_role_name2:mapstore_group_name2</code>. These mappings will be used to map Keycloak roles to MapStore groups.</li> <li><code>keycloakOAuth2Config.dropUnmapped</code>: when set to false, MapStore will drop Keycloak roles that are not matched by any mapping role and group mapping. When set to true all the unmatched Keycloak roles will be added as MapStore UserGroups.</li> </ul>"},{"location":"developer-guide/integrations/users/openId/#configure-mapstore-front-end-for-keycloak-openid","title":"Configure MapStore front-end for Keycloak OpenID","text":"<ul> <li>Add an entry for <code>keycloak</code> in <code>authenticationProviders</code> inside <code>localConfig.json</code> file.</li> </ul> <pre><code>{\n\"authenticationProviders\": [\n{\n\"type\": \"openID\",\n\"provider\": \"keycloak\"\n},\n{\n\"type\": \"basic\",\n\"provider\": \"geostore\"\n}\n]\n}\n</code></pre>"},{"location":"user-guide/adding-widgets/","title":"Adding Widgets","text":"<p>With a click on the  button in Side Toolbar the Widget panel opens, showing the list of the available widget types that can be added to the dashboard:</p> <p></p> <p>In particular, it is possible to choose between:</p> <ul> <li> <p>Chart</p> </li> <li> <p>Text</p> </li> <li> <p>Table</p> </li> <li> <p>Counter</p> </li> <li> <p>Map</p> </li> </ul> <p>Creating Chart, Text, Table and Counter widgets the procedure is almost the same as that described for create widgets in maps. The only minor differences are the following:</p> <ul> <li>In dashboards as soon as the user selects the widget type, a panel appears to select the layer from which the widget will be created. MapStore allows you to choose between CSW, WMS and WMTS GeoSolutions Services, present by default, or by accessing WMS, WFS, CSW, WMTS and TMS Remote Services as explained in the Managing Remote Services section</li> </ul> <p></p> <ul> <li>In dashboards the possibility to connect/disconnect widgets to the map is replaced with the possibility to connect/disconnect the Map widgets together or with other widget types (this point will be better explained in Connecting Widgets section)</li> </ul> <p>Creating Map type widgets, otherwise, is a functionality present only in dashboards.</p>"},{"location":"user-guide/adding-widgets/#map-widget","title":"Map Widget","text":"<p>In dashboards, selecting the Map type widget, the following panel appears:</p> <p></p> <p>Here the user can:</p> <ul> <li> <p>Go back to widget type selection through the  button</p> </li> <li> <p>Search for a map by writing its title</p> </li> <li> <p>Select one or more maps from the list of maps (mandatory in order to move forward)</p> </li> <li> <p>Move forward to the next step through the  button</p> </li> </ul> <p>Once a map has been selected, the panel display the layers present in the map in the preview and lists the layer associated with the map.</p> <p>Note</p> <p>If user has selected more than one map, the map wizard displays the map switcher dropdown allowing user to select and configure the map.</p> <p></p> <p>Note</p> <p>If the Empty Map has been selected the user can:</p> <ul> <li> <p>Create a map widget using an empty map</p> </li> <li> <p>If the map selection has an empty map, then the user is prompted with an option to enter map name</p> </li> <li> <p>Upon adding the name, the map wizard displays the map switcher allowing user to select and configure the map</p> </li> <li> <p>Add layers to the map through the  button, as follows:  /&gt;</p> </li> </ul> <p>On the Configure map options panel the user can toggle the layer visibility and set layers transparency, as explained in Display options section. Furthermore, the user can manage the layer with the new buttons present on the layer toolbar by selecting the layer on the layers list.</p> <p></p> <p>Here, the user is allowed to:</p> <ul> <li> <p>Zoom to layers though the  button</p> </li> <li> <p>Access Layer Settings through the  button</p> </li> <li> <p>Remove layers through the  button</p> </li> <li> <p>Disable/Enable the Floating Identify Tool to retrieve Identify information about layers available on the map through the  button</p> </li> </ul> <p>Warning</p> <p>The Floating Identify tool is active by default (the button is green)</p> <p>Once the  button is clicked, the last step of the process is displayed like the following:</p> <p></p> <p>Here the user has the possibility to insert a Title and a Description for the widget (optional fields) and to complete its creation by clicking on the  button. After that, the widget is added to the viewer space:</p> <p></p>"},{"location":"user-guide/adding-widgets/#legend-widget","title":"Legend widget","text":"<p>When at least one Map widget is created and added to the dashboard, there's the possibility to add also the Legend widget, available in the widget types list:</p> <p></p> <p>Selecting the Legend widget, the user can choose the Map widget to which the legend will be connected (when only a Map widget is present in the dashboard this step is skipped):</p> <p></p> <p>Once a Map widget is connected, the preview panel is similar to the following:</p> <p></p> <p>Here the user can go back  to the widget types section, connect  or disconnect the legend to a map and move forward  to widget options.  If the last option is selected, a configuration panel similar to the Map widgets one gives the possibility, before save, to set the Title and the Description for the Legend widget.  An example of a Map widgets and a Legend widget is the following:</p> <p></p>"},{"location":"user-guide/annotations/","title":"Annotations","text":"<p>MapStore lets you enrich the map with special features which expose additional information, mark particular position on the map and so on. Those features make up the so-called Annotations layers.</p> <p>Within the map viewer,  the editor can access the Annotations  tool button from the TOC  panel on the top-left corner of the map viewer.</p> <p></p> <p>The annotation panel will open and the editor can insert a Title (required) and a Description (optional).</p> <p></p> <p>From the Geometries tab, the editor can choose between five different types of Geometries:</p> <ul> <li>Marker </li> <li>Line </li> <li>Polygon </li> <li>Text </li> <li>Circle </li> </ul> <p></p> <p>After selecting a geometry type, the editor can:</p> <ul> <li>Draw a Geometry on the map.</li> </ul> <ul> <li>Enter the vertices of the geometry or modify the existing ones through the Coordinates editor using <code>Decimal</code> or <code>Aeronautical</code> formats.</li> </ul> <ul> <li>For Line and Polygon, add new vertices using the  button and typing the <code>latitude</code> and <code>longitude</code> values.</li> </ul> <p>Note</p> <p>If the vertices are invalid, they are notified with a red exclamation point and the geometry field is outlined in red.  In this case, it is not possible to save the annotation, as follows: </p> <ul> <li>Customize the Style of the annotation, as explained in the following paragraph.</li> </ul> <p>For each geometry created, the editor can perform the following operations:</p> <ul> <li> <p>Zoom to the annotation geometry on map through the  button</p> </li> <li> <p>Delete the geometry annotation through the  button</p> </li> </ul> <p>Once all the geometries are created, the user can go back to the TOC by clicking the  button. A new annotation layer will appear here.</p> <p></p> <p>From the TOC, the Annotations toolbar allows the user to:</p> <p></p> <ul> <li> <p>Zoom to annotation extent through the  button</p> </li> <li> <p>Delete the annotation through the  button</p> </li> <li> <p>Edit the annotation through the  button</p> </li> <li> <p>Download the annotation through the  button</p> </li> </ul>"},{"location":"user-guide/annotations/#styling-annotations","title":"Styling Annotations","text":"<p>Based on which type of annotation is chosen, MapStore allows to customize the annotation style through a powerful style editor. It is accessible from the Style tab of the annotation viewer.</p> <p></p> <p>Note</p> <p>For each style symbolizer there are many 3D style options available, as shown in the Styling on 3D section below.</p> <p>Marker</p> <p>MapStore provides different Marker annotation style:</p> <ul> <li>The Mark type: clicking on the  button, the Mark symbolizer panel opens.</li> </ul> <p></p> <p>The Mark can have different <code>Shape</code>, <code>Fill color</code> and <code>Stroke</code> with different, <code>Stroke color</code>, <code>Width</code>, <code>Stoke style</code> and customizable <code>Radius</code> and <code>Rotation</code>. Take a look at the following example.</p> <p></p> <ul> <li>The Icon type: clicking on the  button, the Icon symbolizer panel opens. The icon can have different <code>Image</code>. Clicking on it, the user can choose a Marker and a Glyph, as follows:</li> </ul> <p>The icon is also customizable with different <code>Opacity</code>, <code>Size</code>, <code>Rotation</code> and <code>Anchor point</code>.</p> <p>Note</p> <p>For Marker annotation, in 3D Navigation, the 3D model symbolizer type is also available, as shown in the Styling on 3D section below.</p> <p>Line</p> <p>The Line annotation has a dedicated styling panel with a customizable <code>Stroke</code> with different <code>Color</code>, <code>Width</code> and <code>Style</code> and different <code>Line cap</code> (Butt, Round, Square) and the <code>Line join</code> (Bevel, Round, Miter). Take a look at the following image.</p> <p></p> <p>The line annotation is also customizable adding a Mark symbolizer by clicking on the  button or the Icon one with the  button and choose Start Point, Center or End Point from the <code>Geometry transformation</code> option.</p> <p>Polygon</p> <p>The Polygon annotation can have different <code>Fill</code> color and <code>Outline</code> with different <code>Color</code>, <code>Width</code> and <code>Style</code>. Take a look at the following example.</p> <p></p> <p>Also for the polygon itis possible to add a Mark  or an Icon  symbolizer in the same way as for Line annotations.</p> <p>Text</p> <p>Defining a point geometry with an associated text, the Text annotation allows to customize label trough many options such as: <code>Font Family</code> (DejaVu Sans, Serif, etc), the font <code>Color</code>, <code>Size</code>, <code>Style</code> (Normal or Italic) and <code>Halo weight</code> (Normal or Bold) and it allows also to select the desired <code>Anchor point</code>(Center, Bottom left, etc), <code>Halo color</code> and <code>Halo weight</code>. It is also possible to choose the text <code>Rotation</code> and <code>Offset</code> (x and y). En example can be the following one.</p> <p></p> <p>Circle</p> <p>The Circle annotation has its own symbolizer panel to customize the <code>Color</code> and the <code>Outline</code> with different <code>Color</code>, <code>Width</code> and <code>Style</code>. Take a look at the following example.</p> <p></p> <p>The Center of a Circle annotation can be also customized by adding a Mark  or an Icon  symbolizer in the same way as Line and polygon annotations.</p>"},{"location":"user-guide/annotations/#settings-annotations","title":"Settings Annotations","text":"<p>Once all the annotation Geometries are created, the user can customize the usual Visibility limits by clicking on the Settings tab.</p> <p></p> <p>The\u00a0Visibility limits\u00a0allow the annotation to be displayed only within certain scale limits. The user can set the Max value and the Min value and select the Limits type choosing between <code>Scale</code> or <code>Resolution</code>.</p>"},{"location":"user-guide/annotations/#annotations-on-the-3d-navigation","title":"Annotations on the 3D navigation","text":"<p>MapStore allows the visualization of the Annotations also for the 3D Navigation.</p> <p></p>"},{"location":"user-guide/annotations/#geometries-on-3d","title":"Geometries on 3D","text":"<p>On the 3D Navigation, after selecting a geometry type and drawing the geometry on the map, the user can also modify the geometry Height for each coordinate.</p>"},{"location":"user-guide/annotations/#styling-on-3d","title":"Styling on 3D","text":"<p>For Marker annotations, on the 3D Navigation the 3D model symbolizer type is also available. From the Style tab, by clicking on  button, the 3D model option opens to allow adding a 3D model (based on glTF, GLB is also allowed) as an external graphic by specifying its URL (see also the Cesium documentation). Furthermore, it is possible to customize the 3D model <code>Scale</code>, <code>Rotation</code> and <code>Color</code>. Take a look at the following example.</p> <p></p> <p>Furthermore, for the 3D Navigation, MapStore adds some additional styling options such as:</p> <ul> <li>Bring to front (available for Point and Text geometries) to bring in front and so to make visible (if set to true) the annotation covered by 3D Tile layers and the Terrain layer (for this last case when the depth test against terrain option is enabled in Global Settings).</li> </ul> <p></p> <ul> <li>Height reference from ground (available for Point and Text geometries) to indicate the reference for the point height between <code>None</code> (to the absolute zero of the ground), <code>Relative</code> (to the terrain layer level) or <code>Clamp</code> (the annotation is clamped to the Terrain, if present, or to the ground). It is also possible to finely configure the Height value of the point.</li> </ul> <p></p> <ul> <li>Leader line (available for Point and Text geometries) to add a line to connect the point symbol with the Terrain/Ground to have a more clear reference of the effective point position when the camera orientation change. The editor can choose the Width of the line and the Color through the usual color picker.</li> </ul> <p></p> <ul> <li>Clamp to ground to enable/disable the boolean property specifying whether the line or polygon should be clamped to the ground (this option is available for Line and Polygon geometries).</li> </ul> <p></p> <ul> <li>Clamp to ground reference to choose whether the drape effect, should affect <code>3D Tiles</code>, <code>Terrain</code> or <code>Both</code>. This option is available for Line, Polygon and Circle geometries and it is only enabled when the Clamp to ground option is set to <code>True</code>.</li> </ul> <p></p> <ul> <li>Extrusion Height (available for Line and Fill geometries) to configure the height value of the feature to be extruded. It is also possible to enable/disable the Extrusion relative to geometry (from the highest point of the feature geometry) and, only for the Line geometries, the user can customize the Extrusion color and the Extrusion type, choosing between <code>Wall</code>, <code>Circle</code> and <code>Square</code> options, for the extruded features.</li> </ul> <p></p>"},{"location":"user-guide/application-context/","title":"Application Context","text":"<p>In order to create a context, the Admin can click on the New Context button  in the Contexts page and he will be addressed directly to a wizard. The wizard is composed by the following four steps:</p> <p></p> <p>You can move through the steps of the wizard with the dedicated buttons located at the bottom right of the page.</p> <p></p> <p>In this way the admin can:</p> <ul> <li> <p>Move forward on the different steps through the Next button </p> </li> <li> <p>Go back to the previous step through the Back button </p> </li> <li> <p>Closed the context wizard through the Close button </p> </li> </ul>"},{"location":"user-guide/application-context/#general-settings","title":"General Settings","text":"<p>This first step allows to configure the Name and the Window title of the new context.</p> <p></p> <p>Warning</p> <p>The name and the window title are both mandatory fields. Note that it is not allowed to choose a name that has already been assigned to another MapStore's resource (like maps, dashboards, stories): a warning message appears in this case to notify the user.</p> <p>Note</p> <p>The Window title is the name of the browser window.</p> <p>MapStore allows the user to Import an application context  by selecting the  button. The import screen appears so that it is possible to drag and drop a previously exported context file there or select it from the local machine through the  button.</p> <p>Once a valid context name is specified in General settings, it is possible to Export the context with all the configurations introduced up to that point; this is possible through the  button. The export screen appears and the user exports the context, in <code>JSON</code> format, by clicking the  button.</p> <p>Note</p> <p>The  button is only available on the first step of the application context wizard (the General settings) while the  button is always available with the only condition that a valid context name has been specified.</p>"},{"location":"user-guide/application-context/#configure-map","title":"Configure Map","text":"<p>To create the context viewer, the map configuration like the one described here opens so that the admin can set the initial state of the context map.</p> <p></p> <p>In particular the admin can configure the context map using the following MapStore tools:</p> <ul> <li> <p>Catalog, present in Burger Menu , to configure the supported remote services (like CSW, TMS, WMS and WMTS) and add layers to the map.</p> </li> <li> <p>Import, present in Burger Menu , to import map files and import vector file.</p> </li> <li> <p>Annotations, present in Burger Menu  button, to add annotations to the map.</p> </li> <li> <p>Table of Contents, through the  button where the admin can use all the available functionalities to manage context layers.</p> </li> <li> <p>Background Selector, at the bottom left of the viewer, allows the user to add, manage and remove map backgrounds</p> </li> <li> <p>CRS Selector, through the  button at the bottom right of the Footer, to switch the Coordinate Reference System of the map</p> </li> <li> <p>The Navigation Toolbar, at the bottom right of the viewer, is useful to the admin to explore the map.</p> </li> </ul> <p>An example of a context viewer with a new background and a layer, added to the map, can be the following:</p> <p></p>"},{"location":"user-guide/application-context/#configure-plugins","title":"Configure Plugins","text":"<p>This wizard step allows to select the extensions that will be available in the context viewer: the user of a context will use only the plugins enabled by the administrator. Within this wizard step, all the available plugins in MapStore are present in the left side list ready to be selected for the context . The right side list contains the list of plugins selected by the administrator for the context.</p> <p></p> <p>Through the central vertical bar the administrator can select the plugins to include in the context viewer by moving them from the Available Plugins  list to the Enabled Plugins list.</p> <p></p> <p>In particular, the admin can:</p> <ul> <li>Add an extension from the Available Plugins list to the Enabled Plugins list, using the Add Extension button . Instead, remove an extension from the Enabled Plugins list using the Remove Extension button , as follows:</li> </ul> <ul> <li>Bring all extensions from one list to another using the Add all extensions button  or remove all extensions using the Remove all extensions button , as follows:</li> </ul> <p>To search for an extension listed, the admin can use the Search bar.</p> <p></p>"},{"location":"user-guide/application-context/#add-extensions-to-mapstore","title":"Add extensions to MapStore","text":"<p>The MapStore administrator can also install a custom plugin by using the Add extension to MapStore button , at the top right of the Available Plugins list.</p> <p>Here the admin, in order to upload the plugin's package, can drag and drop it inside the import screen or select it from the folders of the local machine through the  button.</p> <p>Warning</p> <p>A plugins package must be provided as .zip archives that contains:</p> <ul> <li> <p>An <code>index.json</code> file with a plugin definition</p> </li> <li> <p>A plugin file with the extension code in <code>JavaScript</code></p> </li> <li> <p>All mandatory translations files in MapStore.</p> </li> </ul> <p>A sample extension for testing purposes is available here. More extensions will be available in the future versions of MapStore.</p> <p>Through the Add button  the plugin is inserted in the Available Plugins list.</p> <p></p> <p>A plugin so installed can be included in the context viewer by moving it in the Enabled Plugins list or uninstalled through the Delete button .</p> <p></p>"},{"location":"user-guide/application-context/#optional-tools-for-enabled-plugins","title":"Optional tools for enabled plugins","text":"<p>In the Enabled Plugins list, the following buttons are displayed for each extension:</p> <p></p> <ul> <li>The Enable selection of current plugin for user button  allows the admin to configure which extensions will be present in the Extension Library and not activated by default.</li> </ul> <p>Note</p> <p>Once a plugin has been included in a context, it is active by default and available inside the viewer. The administrator can click on Enable loading this plugin on startup button  to make that plugin not active by default: clicking on this button the plugin will not be available in the context viewer until explicitly activated by the end user through the Extension Library.</p> <ul> <li>The Edit Plugin Configuration button  allows the admin to interact with a text area to specify the plugin configuration and to override the default one.</li> </ul> <p></p> <ul> <li>The Open plugin configuration documentation button  opens the Plugins Documentation in another page.</li> </ul>"},{"location":"user-guide/application-context/#how-to-update-extensions","title":"How to update extensions","text":"<p>Extension can be updated using two steps:</p> <ul> <li> <p>Old extension removal.</p> </li> <li> <p>Uploading and installation of the new version of extension.</p> </li> </ul> <p>As previously stated, extension can be removed on \"Configure Plugins\" step of wizard using Delete button .</p> <p></p> <p>At this point extension will be removed from application completely. Save context after extension removal only if you want to be sure that extension will not be activated for the context if it's reinstalled at some point.</p> <p>Do not save context and upload new version of extension right away after old version removal. Context don't need to be saved after new version installation.</p> <p>With all stated above, complete workflow is:</p> <ul> <li> <p>Open context editing and jump to the \"Configure Plugins\" step of the wizard.</p> </li> <li> <p>Delete old version of extension using Delete button .</p> </li> <li> <p>Upload and install new version of extension using the Add extension to MapStore button </p> </li> <li> <p>Do not save context, close wizard.</p> </li> </ul> <p>Existing configuration of extension (default or customized) will be preserved for all the contexts using extension.</p>"},{"location":"user-guide/application-context/#configure-theme","title":"Configure Theme","text":"<p>The last wizard steps allows to configure the theme to use for a context. A dropdown allows to select one of the available themes (see the Styling and Theming section of the online documentation to know how to create and include additional themes to MapStore). By default in MapStore a default and a dark themes are available.</p> <p></p>"},{"location":"user-guide/application-context/#default-theme","title":"Default Theme","text":"<p>The default theme is always available for a context and it is the MapStore default one. This theme is automatically applied to the context if the Configure Theme wizard step is skipped during the context creation or when the theme selection drop-down is cleared. An example of a default context can be the following:</p> <p></p>"},{"location":"user-guide/application-context/#dark-theme","title":"Dark Theme","text":"<p>MapStore also provides by default an additional theme, the dark one, that can be selected from the drop-down menu to be used as an alternative theme for application contexts.</p> <p></p> <p>An example of the dark theme applied to a context is the following one:</p> <p></p>"},{"location":"user-guide/application-context/#custom-theme","title":"Custom Theme","text":"<p>After selecting a theme from the drop-down, it is also possible to customize it from UI by enabling Custom Variables.</p> <p></p> <p>Once Custom Variables is enabled, the context editor can modify main, primary and secondary colors for both backgrounds and texts (an helper clarifies the UI elements involved for each field in the form). Clicking on the Change Color button  a color picker is displayed to allow the selection of the desire color, as follows:</p> <p>The colors that can be customized are the following ones:</p> <ul> <li> <p>Main Text Color to choose the color used in panel or dialog texts</p> </li> <li> <p>Main Background Color to choose the color used in panel or dialog backgrounds</p> </li> <li> <p>Primary Text Color to choose the color used for icons inside toolbar, header and button texts</p> </li> <li> <p>Primary Color to choose the color used for icons inside toolbar, header and button backgrounds</p> </li> <li> <p>Secondary Text Color to choose the color used as button text when a button is active or selected</p> </li> <li> <p>Secondary Color to choose the color used as button background when a button is active or selected</p> </li> </ul> <p>Warning</p> <p>To ensure a good and well readable color contrast between each UI component, make sure to not use a secondary color too similar to the primary one and obviously the primary text color with its counterpart (the same applies for the other couples of colors: main, secondary).</p> <p>An example of a custom context can be the following:</p> <p></p>"},{"location":"user-guide/attributes-table/","title":"Attribute Table","text":"<p>In GIS, the Attribute Table associated to a vector layer is a table that stores tabular information related to the layer. The columns of the table are called fields and the rows are called records. Each record of the attribute table corresponds to a feature geometry of the layer. This relation allows to find records in the table (information) by selecting features on the map and viceversa. In MapStore, through the  button in Layers Toolbar it is possible to access the Attribute table:</p> <p></p> <p>Accessing this panel the user can perform the following main operations:</p> <ul> <li> <p>Edit records through the  button</p> </li> <li> <p>Filter records in Attribute Table in different ways as described in the Set filter section below</p> </li> <li> <p>Open the Advanced Search tool through the  button</p> </li> <li> <p>Activate the filter by the current viewport, through the  button</p> </li> <li> <p>Activate the filtering capabilities by clicking on map, through  button</p> </li> <li> <p>Using the quick filter by attribute</p> </li> <li> <p>Download the grid data through the  button</p> </li> <li> <p>Create Widgets through the  button</p> </li> <li> <p>Customize the attribute table display through the  button</p> </li> <li> <p>Zoom to features through the  button available on each record or zoom to the page max extent through the  button (available only if the virtual scrolling is disabled, it is enabled by default in MapStore).</p> </li> </ul> <p>Warning</p> <p>When GeoServer is set to strict CITE compliance for WFS (by default), the feature grid do not work correctly. This is because MapStore uses by default WFS 1.1.0 with startIndex/maxFeatures. This is not strict compliant with WFS 1.1.0 (GeoServer supports it but the request in strict mode is invalid). To solve it un-check the CITE compliance checkbox in the \"WFS\" page of GeoServer \"Services\" configurations using the GeoServer web interface</p>"},{"location":"user-guide/attributes-table/#set-filters","title":"Set filters","text":"<p>In the Attribute Table it is possible to apply different types of filter, in particular the Advanced search tool and the Quick filter options are available</p>"},{"location":"user-guide/attributes-table/#advanced-search","title":"Advanced Search","text":"<p>This filter, applicable from Advanced Search button  in the Attribute Table toolbar, opens the Query Panel which, in the Attribute Table, behaves as follows:</p> <ul> <li>It can be used to apply a filter to a layer for search purposes: this filter is applied in <code>AND</code> to the Layer Filter if it is already been set on layer side.</li> </ul> <p></p> <ul> <li>It is possible to sync this filter with the map through the  icon:</li> </ul> <ul> <li>It will be automatically removed/reapplied by closing/opening the Attribute Table</li> </ul>"},{"location":"user-guide/attributes-table/#quick-filter","title":"Quick Filter","text":"<p>The user can perform three type of quick filters:</p> <ul> <li> <p>Filter by attributes</p> </li> <li> <p>Filter by clicked point in the map</p> </li> <li> <p>Filter by viewport</p> </li> </ul>"},{"location":"user-guide/attributes-table/#quick-filter-by-attributes","title":"Quick Filter by attributes","text":"<p>This filter is available for each colum in the Attribute Table just below the field names and it can be also used in combination with other filter applied:</p> <p>The user has the possibility to apply simple filters by attributes typing the filter's value in the available input fields (Date or Time pickers are available according to the attributes data types). Filtering by one or more attributes, layer records in Attribute Table are automatically filtered accordingly.</p> <p>If the user wants to filter by an attribute, he can simply write the desired filter value inside the input box and the list of records in table will be automatically filtered by matching with the input text.</p> <p></p> <p>The user can also filter an attribute using the input box. From the dropdown menu it is possible to choose the operator to use (for the String attribute it can be <code>=</code>, <code>like</code>, <code>ilike</code> or <code>isNull</code>, for the Integer, Data or Time attribute, it can be instead <code>=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>&lt;&gt;</code>, <code>&gt;&lt;</code> or <code>isNull</code>)</p> <p></p> <p>In order to filter a numerical filed matching the records greater than or equal to a certain threshold value, an example can be:</p> <p></p> <p>The user can also filter the records, of the Date, Time and DateTime attributes, through the Date Picker option by clicking on the  button for Date attributes, the  button for Time attributes and the  button for DateTime attributes. To filter a DateTime attribute using the Date Picker option, an example can be the following:</p> <p>In the Date Picker option, with the <code>&gt;&lt;</code> operator selected, the Time Range picker is supported. Here the user can select the Start Date and the End Date to filter the attribute, an example can be the following:</p>"},{"location":"user-guide/attributes-table/#quick-filter-by-map-interaction","title":"Quick Filter by map interaction","text":"<p>It is possible to filter records in the Attribute Table by clicking on the map or doing a selection directly in a map of multiple features. The user can activate the  Filter on the map  button (once clicked the button turns blue) and then:</p> <ul> <li> <p>Click on the map over the features he wants to select</p> </li> <li> <p>Add multiple features to the selection by pressing Ctrl and clicking again over other features in map</p> </li> </ul> <ul> <li>Add multiple features to the selection by pressing Ctrl + Alt and drawing a selection box in map</li> </ul> <p>The list of records in the Attribute Table will be automatically filtered according to such user selection and then the user can disable the geometry filter through the Remove filter  button.</p>"},{"location":"user-guide/attributes-table/#quick-filter-by-viewport","title":"Quick Filter by viewport","text":"<p>From the Attribute Table the user can filter data by map viewport through the Filter by viewport  button. Once clicked, the toggle button turns its state to green and the list of records in the Attribute Table is filtered by showing only records corresponding to layer features present in the current map viewport.</p> <p>The list of records in the Attribute Table is automatically updated when the user pan/zoom the map view. It is possible to deactivate the Filter by viewport  by clicking again the same toggle button.</p> <p>Note</p> <p>The Quick Filter remains active as long as the Attribute Table is open but, unlike the Advanced Search, closing the Attribute Table it will not reappear anymore if the Attribute Table is re-opened in a second time.</p>"},{"location":"user-guide/attributes-table/#manage-records","title":"Manage records","text":"<p>The basic Web Feature Service allows querying and retrieval of features. Through Transactional Web Feature Services (WFS-T) MapStore allows creation, deletion, and updating of features.</p> <p>Warning</p> <p>By default editing functionalities are available only for MapStore Admin users. Other users can use these tools only if explicitly configured in the plugin configuration (see the APIs documentation for more details). In any case, the user must have editing rights on the layer to edit it (see for example the GeoServer Security Settings).</p> <p>The Edit mode can be reached from the  button in Attribute Table panel, allowing to menage only the layer which the table refers to:</p> <p></p> <p>Note</p> <p>When the Edit mode is enabled only the editing functionalities are available to the user, all other tools are deactivated.</p> <p>By default, in Edit mode, you can see a panel like that following:</p> <p></p> <p>Through the Quit edit mode button  you can stop the editing session to make the other functionalities available again.</p>"},{"location":"user-guide/attributes-table/#create-new-features","title":"Create new features","text":"<p>Once the Edit mode is enabled it is possible to create a new feature by clicking on the Add New Feature button . After clicking on it the user can fill out the fields and edit the geometry of the new feature:</p> <p></p> <p>To edit attributes MapStore provides some input fields based on the attribute type, that forces the user to insert a valid value. If the attribute is of type <code>text</code>, MapStore will also show a dropdown menu with the list of the existing values for that attribute to allow a quick selection.</p> <p>Note</p> <p>the dropdown menu is available only if the server provides the WPS process <code>gs:PagedUnique</code></p> <p>The Missing geometry exclamation point  in the second column of the Attribute Table means that the feature doesn't have a geometry yet. It's possible to add it later or draw it on the map before saving:</p> <p></p> <p>In order to save the changes made until now, there's the  button, whereas to undo the changes there's the  button.  Once a new record is created, it's possible to draw a geometry for it, by clicking on the  button that appears once that feature is selected. The process of drawing a new geometry is a little different depending on the layer type:</p> <ul> <li>For Polygons and Multipolygons layers, each click on the map add a new vertex (the minimum is 3). Once the vertex are set, it is possible to change the shape by creating new vertices or dragging the existing ones:</li> </ul> <ul> <li>For Lines and Multilines layers the shape drawing function works more or less in the same way. The only difference is that you need at least two vertices to draw a line and not three like for polygons:</li> </ul> <ul> <li>For Points layers a point is drawn for each click on the map</li> </ul> <p>The user is always allowed to delete the drawn shape through the  button.</p>"},{"location":"user-guide/attributes-table/#create-new-geometry-with-snapping","title":"Create new geometry with Snapping","text":"<p>To fine tune the vertex position while editing or creating a new feature geometry, it is possible to leverage on the Snapping functionality. Through this function  it is possible to snap to other vertices of features belonging to the same layer or to others while editing a feature.</p> <p>The tool provides the ability to tune the snapping function so that the user can:</p> <ul> <li>Choose one of the visible map layers in TOC to be used for the snapping</li> </ul> <ul> <li> <p>Choose where to snap the layer, enabling/disabling the Edge or/and the Vertex</p> </li> <li> <p>Set Tolerance for considering the pointer close enough to a segment or vertex for snapping</p> </li> <li> <p>Choose the Loading strategy of features to snap with by choosing one of the available options from the dropdown menu. Available options are:</p> </li> <li>bbox: only features in the current viewport are loaded</li> <li>all: all layer features are loaded</li> </ul> <p>Note</p> <p>The snapping functionality is by default set to work with the same layer in editing mode. By default, the Edge and the Vertex are enabled, the Tolerance is set to 10 <code>pixel</code> and the Loading strategy is set to bbox.</p>"},{"location":"user-guide/attributes-table/#editing-and-removing-existing-features","title":"Editing and removing existing features","text":"<p>In order to edit an existing feature, it is necessary to switch the Attribute Table in editing mode by clicking the Edit mode  button. If the goal is to edit the Attribute Table records, the user can simply select them and type the desired value into the input field. However, it is also possible to modify the geometry associated with a record by editing it on the map (adding or changing its vertices).</p> <p>Note</p> <p>It is possible to edit the value of an attribute for multiple records at once by selecting the corresponding cell in the table and dragging the content onto the multiple cells, as follows: </p> <p>With a click on Save changes  these changes will be persistent. In Edit mode, the user can also delete some features by selecting them in the table and clicking on the  button.</p>"},{"location":"user-guide/attributes-table/#download-the-grid-data","title":"Download the grid data","text":"<p>Form the Attribute table it is also possible to download the grid data through the  button. The following window opens:</p> <p></p> <p>From this window it is possible to set:</p> <ul> <li> <p>The File Format (<code>GML2</code>, <code>Shapefile</code>, <code>GeoJSON</code>, <code>KML</code>, <code>CSW</code>, <code>GML3.1</code> or <code>GML3.2</code>)</p> </li> <li> <p>The Spatial Reference System (by default <code>Native</code> or <code>WGS84</code>)</p> </li> </ul> <p>With a click on the  button and the browser will download the file.</p>"},{"location":"user-guide/attributes-table/#customize-attribute-table-display","title":"Customize Attribute table display","text":"<p>MapStore allows the user to customize the fields displayed in Attribute table mainly in two way:</p> <ul> <li>Ordering the records in alphabetic order (if it's a text field) or from the minimum to the maximum value and viceversa (if it's a numerical field):</li> </ul> <ul> <li>Deciding which columns to show and which to hide through the  button:</li> </ul>"},{"location":"user-guide/background/","title":"Background Selector","text":"<p>The background selector, located in the bottom left corner of the Viewer, allows the user to add, manage and remove map backgrounds.</p> <p></p> <p>By clicking on the background selector several miniatures will be displayed. Those miniatures can be selected in order to switch from a background to another (the map backgrounds set by default in MapStore are Open Street Map, NASAGIBS, OpenTopoMap, Sentinel 2 and the Empty Background).</p> <p></p> <p>For example choosing OpenTopoMap, the map background will change like in the following image:</p> <p></p> <p>If the user has editing permissions on the map (independently on the role, see Resource Properties section for more information about permissions), it is also possible to add, edit or remove backgrounds.</p>"},{"location":"user-guide/background/#add-background","title":"Add background","text":"<p>A new background can be added through the  button on the top of the background selector main card. Performing this operation the Catalog panel opens with the possibility to access the Remote Services:</p> <p></p> <p>Warning</p> <p>Default Backgrounds service is available only accessing the Catalog from the background selector, but if you add a new Remote Service from there, it will be available also accessing Catalog from the Side Toolbar or from TOC. Default Backgrounds represent a list of backgrounds that can be configured from MapStore's configuration files (more information about that can be found in Developer Guide's Map Configuration section).</p> <p>From the Catalog the user can choose the layers to add to the list of backgrounds:</p> <p></p> <p>As soon as a WMS layer is selected, the Add New Background window opens:</p> <p></p> <p>In particular, from this window, the user can perform the following operations:</p> <ul> <li> <p>Add a Thumbnail choosing the desired local file by clicking on image preview area, or simply with the drag and drop function</p> </li> <li> <p>Set the Title</p> </li> <li> <p>Set the Format (between <code>png</code>, <code>png8</code>, <code>jpeg</code>, <code>vnd.jpeg-png</code> or <code>gif</code>)</p> </li> <li> <p>Choose the Style, between the ones available for that layer</p> </li> <li> <p>Enable/disable the use of the layer cached tiles. If checked, the Tiled=true URL parameter will be added to the WMS request to use tiles cached with GeoWebCache. When the Use cache options is enabled, more controls are enabled so that it is possible for the user to check if the current map settings match any GWC standard Gridset defined on the server side for the given WMS layer (Check available tile grids information ). At the same time, it is also possible to change the setting strategy (based on the WMTS service response) to strictly adapt layer settings on the client side to the ones matching any remote custom Gridset defined for the current map settings (Use remote custom tile grids  button). (More details on Layer Settings section.)</p> </li> <li> <p>Add Additional Parameters of three different types: String, Number or Boolean (these parameters will be added to the WMS request).</p> </li> </ul> <p>Warning</p> <p>The thumbnail image size should be a square of 98x98px or 128x128px, max 500kb and the supported format are <code>jpg</code> (or <code>jpeg</code>) and <code>png</code></p> <p>Once the options are chosen, with the  button the new background layer is definitively added to the background selector as a card and automatically set as the current one.</p>"},{"location":"user-guide/background/#add-wmts-background","title":"Add WMTS background","text":"<p>In case of a WMTS layer added as a background layer, the Add New Background window is a bit different:</p> <p></p> <p>The user can perform the following operations:</p> <ul> <li> <p>Add a Thumbnail choosing the desired local file by clicking on image preview area, or simply with the drag and drop function</p> </li> <li> <p>Set the Title</p> </li> <li> <p>Set the Attribution visible at the bottom left of the footer in the map viewer.</p> </li> </ul>"},{"location":"user-guide/background/#edit-background","title":"Edit background","text":"<p>It is possible to edit backgrounds by clicking on settings icon on top of each background card:</p> <p></p> <p>Warning</p> <p>Default Backgrounds layers can't be edited, with an exception for Sentinel 2: only WMS Layers can be edited&amp;/configured through the Background Selector.</p> <p>The Edit Current Background window opens, allowing the user to customize the same set of information when adding a new background (see previous section).</p>"},{"location":"user-guide/background/#remove-background","title":"Remove background","text":"<p>It is possible to remove a background from the background selector by clicking on remove icon on top-right of each card</p> <p></p> <p>Note</p> <p>By default, for new maps, all backgrounds from Default Backgrounds Service are added to the background selector, and in Catalog they appear grayed (it's not allowed to add the same default background twice): as soon as you remove one from the background selector, it becomes selectable from the Catalog.</p> <p></p>"},{"location":"user-guide/banner-section/","title":"Banner Section","text":"<p>The Banner Section is similar to the Title Section and it is useful to easily create a story banner without the title text content.</p> <p></p> <p>From the background editing toolbar the user can do the following actions:</p> <ul> <li> <p>Add a media content as a background opening the Media Editor through the Change media source button  and choose between images, videos or maps.</p> </li> <li> <p>Change the height of the section through the Fit/adapt content button </p> </li> <li> <p>Remove the banner section through the Remove button </p> </li> </ul> <p>Once the media content has been added as a background of the section, the editing toolbar changes to enable different functionality depending on the content inserted: as explained here.</p> <p>Below is an example of an image added as background in the Banner Section:</p> <p></p>"},{"location":"user-guide/catalog/","title":"Catalog Services","text":"<p>The Catalog Service for the Web (CSW) is an OGC Standard used to publish and search geospatial data and related metadata on the internet. It describes geospatial services such as Web Map Service (WMS) and Web Map Tile Service (WMTS).</p> <p>In MapStore the Catalog offers the possibility to access WMS, WFS, CSW, WMTS and TMS Remote Services and to add the related layers to the map. By default, as soon as a user opens the Catalog, a CSW a WMS and a WMTS Demo Services are available, allowing to import layers from the GeoSolutions GeoServer. The user can access the Catalog with a click on the  button from the Side Toolbar. As soon as you open it, the first display is like the following:</p> <p></p>"},{"location":"user-guide/catalog/#adding-layers-from-remote-services","title":"Adding Layers from Remote Services","text":"<p>In order to add a layer, the user can first of all open the catalog and choose from the following dropdown menu the Remote Service from where the layer is going to be added:</p> <p></p> <p>Once the Remote Service is set, it is possible to search the desired layer by typing a text on the search bar:</p> <p></p> <p>By clicking on the  button, the layer is finally added to the TOC and rendered to the map viewer:</p> <p></p> <p>Note</p> <p>For those layers which have long descriptions or long metadata information, the content is truncated in order to fit the Layer Card size. In order to access the complete information, the user can expand the card using the  button:</p> <p></p>"},{"location":"user-guide/catalog/#managing-remote-services","title":"Managing Remote Services","text":"<p>MapStore allows also to add new Remote Services to the map project () or Edit/Remove the existing ones ().</p> <p></p> <p>The adding/editing process is very similar and the only difference is that editing an existing Service the input fields will be already filled with its settings, while adding a new one all the fields will be empty. Moreover only editing an existing Service, it will be possible to remove it from the Services list. Editing an existing Service, for example, the first display is the following:</p> <p></p> <p>From here the user is allowed to set the Service options, that can be divided into:</p> <ul> <li> <p>General settings</p> </li> <li> <p>Advanced Settings</p> </li> </ul> <p>Once the options are properly set, it is possible to  the Service. If the user wants to discard the edits, instead, there's the  button. An existing Service can finally be removed from the Services list through the  button (this option is not available creating a new Remote Service).</p>"},{"location":"user-guide/catalog/#general-settings","title":"General settings","text":"<p>The general settings are three mandatory fields that each Remote Service needs to have:</p> <p></p> <p>In particular:</p> <ul> <li> <p>Url: the URL of the remote source service</p> </li> <li> <p>Type: the type of the remote source service (between WMS, WFS, CSW, TMS, WMTS and 3D Tiles)</p> </li> <li> <p>Title: the title to assign to the catalog. This text will be used in the service selection dropdown menu for this service.</p> </li> </ul>"},{"location":"user-guide/catalog/#advanced-settings","title":"Advanced settings","text":"<p>The Advances settings section opens by clicking on the  icon:</p> <p></p> <p>The content of Advanced settings depends on the catalog type, but some options are common to all the services types:</p> <ul> <li> <p>Search on service selection that allow to enable/disable the automatic loading of the catalog records when the user opens that Service</p> </li> <li> <p>Show preview that can show/hide layers thumbnails in Catalog</p> </li> </ul>"},{"location":"user-guide/catalog/#catalog-types","title":"Catalog Types","text":""},{"location":"user-guide/catalog/#csw-catalog","title":"CSW Catalog","text":"<p>The Catalog Service for the Web (CSW) is an OGC Standard used to publish and search geospatial data and related metadata on the internet. It describes geospatial services such as Web Map Service (WMS), Web Map Tile Service (WMTS) and so on... MapStore actually supports only the Dublin Core metadata schemas. ISO Metadata Profile is not supported yet.</p> <p>In general settings of  CSW service the user can specify the title to assign to this service and the URL of the service.</p> <p></p> <p>Note</p> <p>If the CSW service, responds with metadata records that can hold more than just one type of OGC service (WMS and WFS are currently supported for this), MapStore allows the user to choose from which service the layer should be added to the TOC. An example can be the following: </p>"},{"location":"user-guide/catalog/#advanced-settings_1","title":"Advanced Settings","text":"<ul> <li>Server Type: to specify the server type of WMS online resources referred by metadata exposed by the CSW service URL. Possible options are two: <code>Geoserver</code> or <code>No Vendor</code> which can be for example MapProxy, MapServer or other.</li> </ul> <p>Note</p> <p>If the No Vendor is set, then MapStore will not use any vendor option supported only by GeoServer in the OGC requests where this source is involved.</p> <ul> <li> <p>Interactive legend: if checked, allows to set by default the legend filter when a layer is added to the map from this source as described in Layer Settings.</p> </li> <li> <p>Format: to assign the default Tile format for the layers added to the map (e.g. <code>png</code>, <code>png8</code>, <code>jpeg</code>, <code>vnd.jpeg-png</code>, <code>vnd.jpeg-png8</code> or <code>gif</code>) and to define the default Information sheet format for the layers added to the map (<code>text/plain</code>, <code>text/html</code>, <code>application/json</code> or <code>application/geo+json</code>). The list of available formats is automatically retrieved from the ones supported by the WMS server and can be also manually fetched through the Fetch supported formats  button when necessary.</p> </li> </ul> <p>Note</p> <p>The Tile and the Information sheet configured through this option will be automatically used for all layers loaded from the involved catalog source (if not configured the default Tile used is <code>image/png</code> and the default Information sheet used is<code>text/plain</code>). For layers already loaded on the map, it is possible to change the format through the Layer Settings tool as usual.</p> <ul> <li> <p>Tile size (WMS): it represents tile size (width and height) to be used for tiles of all layers added to the map from the catalog source (<code>256x256</code> or <code>512x512</code>). For layers already loaded on the map, it is possible to change the tile size through the Layer Settings tool as usual.</p> </li> <li> <p>Sorty By: to retrieve the catalog result in ascending or descending order, it is possible to enter the <code>propertyName</code> of the metadata attributes and select the desired sort type (<code>ASC</code> or <code>DESC</code>).</p> </li> <li> <p>Set Visibility Limit: if checked and scale limits present in the WMS Capabilities (eg. MinScaleDenominator and/or MaxScaleDenominator), these will be automatically applied to the layer settings when a layer is added to the map from this source.</p> </li> <li> <p>Show metadata template: this can be enabled when the user wants to insert in the layer description a text with metadata information</p> </li> </ul> <p>Warning</p> <p>The Metadata Template function is available for CSW Services only.</p>"},{"location":"user-guide/catalog/#metadata-templates","title":"Metadata templates","text":"<p>In order to better understand this function, let's make an example supposing to edit the <code>GeoSolutions GeoServer CSW</code> service:</p> <ul> <li> <p>Change the Format of the image that will be rendered on the map (<code>png</code>, <code>png8</code>, <code>jpeg</code>, <code>vnd.jpeg-png</code>,<code>vnd.jpeg-png8</code> or <code>gif</code>) for layers belonging to the selected source</p> </li> <li> <p>Show metadata template can be enabled when the user wants to insert in the layer description a text with metadata information</p> </li> </ul> <p>Enabling the Show metadata template option appears a text editor through witch it is possible to insert the custom metadata information for that service. In order to dynamically parse each layer's metadata value the user can insert the desired properties name with the format <code>${property_name}</code>:</p> <p></p> <p>In this case it is possible to add a text like the following, in order to present desired metadata properties:</p> <pre><code>title: ${title}\n-------------------\ndescription: ${description}\n-------------------\nabstract: ${abstract}\n-------------------\nboundingBox: ${boundingBox}\n-------------------\ncontributor: ${contributor}\n-------------------\ncreator: ${creator}\n-------------------\nformat: ${format}\n-------------------\nidentifier: ${identifier}\n-------------------\nreferences: ${references}\n-------------------\nrights: ${rights}\n-------------------\nsource: ${source}\n-------------------\nsubject: ${subject}\n-------------------\ntemporal: ${temporal}\n-------------------\ntype: ${type}\n-------------------\nuri: ${uri}\n</code></pre> <p>Inserting this text and saving, the result should be that each layer will show its properties in catalog with the format we set:</p> <p>Note</p> <p>If some metadata are missing, the server response will be <code>source Not Available</code></p>"},{"location":"user-guide/catalog/#static-filter-and-dynamic-filter","title":"Static Filter and Dynamic Filter","text":"<p>From the Advanced Settings of the CSW catalog the user has the possibility to configure a Static Filter and a Dynamic Filter to customize the search request.</p> <p>In order to better understand this function, let's make an example supposing to edit the <code>GeoSolutions GeoServer CSW</code> service:</p> <ul> <li>From the Static Filter text area it is possible to insert the custom filter for that service.</li> </ul> <p></p> <p>In order to present desired\u00a0Static Filter\u00a0configuration,\u00a0it is possible to add a text like the following:</p> <pre><code>&lt;ogc:Or&gt;\n&lt;ogc:PropertyIsEqualTo&gt;\n&lt;ogc:PropertyName&gt;dc:type&lt;/ogc:PropertyName&gt;\n&lt;ogc:Literal&gt;dataset&lt;/ogc:Literal&gt;\n&lt;/ogc:PropertyIsEqualTo&gt;\n&lt;ogc:PropertyIsEqualTo&gt;\n&lt;ogc:PropertyName&gt;dc:type&lt;/ogc:PropertyName&gt;\n&lt;ogc:Literal&gt;http://purl.org/dc/dcmitype/Dataset&lt;/ogc:Literal&gt;\n&lt;/ogc:PropertyIsEqualTo&gt;\n&lt;/ogc:Or&gt;\n</code></pre> <p>Inserting this text and saving. The filter is applied, even in empty search.</p> <ul> <li>From the Dynamic Filter text area it is possible to insert the custom filter to applied in AND with Static Filter. The template is used with ${searchText} placeholder to append search string</li> </ul> <p></p> <p>In this case it is possible to add a text like the following:</p> <pre><code>&lt;ogc:PropertyIsLike wildCard='*' singleChar='_' escapeChar='\\\\'&gt;\n&lt;ogc:PropertyName&gt;csw:AnyText&lt;/ogc:PropertyName&gt;\n&lt;ogc:Literal&gt;${searchText}*&lt;/ogc:Literal&gt;\n&lt;/ogc:PropertyIsLike&gt;\n</code></pre> <p>Inserting this text and saving, the filter is applied when text is typed into the service search tool.</p>"},{"location":"user-guide/catalog/#wmswmts-catalog","title":"WMS/WMTS Catalog","text":"<p>WMS and WMTS Services are OGC Standards protocol for publishing maps (and tile maps) on the Internet. The user can add these kind of services as catalogs to browse and add to the map the layers published using these protocols.</p> <p>In General Settings the user can set the title he wants to assign to this service and the URL of the service to configure the service and its URL.</p>"},{"location":"user-guide/catalog/#advanced-settings_2","title":"Advanced Settings","text":"<p>In addition to the standard options, only for WMS catalog sources, through the Advanced Settings the user can configure also the following options:</p> <p></p> <ul> <li> <p>Localized styles (only for the WMS service) if enabled allows to include the MapStore's locale in each GetMap, GetLegendGraphic and GetFeatureInfo requests to the server so that the WMS server, if properly configured, can use that locale to:</p> <ul> <li> <p>Use localized lables for Tiles in case of vector layers (the layer's style must be properly configured for this using the ENV variable support)</p> </li> <li> <p>Produce a localized layer legend in case of vector layers (the layer's style must be properly configured to use the Localized tag for rule titles)</p> </li> <li> <p>Produce a localized output for GetFeatureInfo requests (the freemarker template need to be properly configured to retrieve the locale from the request)</p> </li> </ul> </li> </ul> <p>Enabling that option, all layers added to the map from this catalog source will be localized as described above (it is possible to tune again that setting for each single layer by opening the Layer Settings in TOC).</p> <ul> <li> <p>Set Visibility Limit: available only for WMS layers coming from CSW or WMS catalog sources type. If checked and scale limits present in the WMS Capabilities (eg. MinScaleDenominator and/or MaxScaleDenominator), these will be automatically applied to the layer settings when a layer is added to the map from this source</p> </li> <li> <p>Single Tile (only for the WMS service): if checked, the layers loaded from the involved catalog source are rendered as a single tile. For layers already loaded on the map, it is possible to disable this option through the Layer Settings tool as usual.</p> </li> <li> <p>Allow not secure layers: if enabled allows the unsecure catalog URLs to be used (http only). Adding layers from WMS sources with this option active will also force the layer to use the proxy for all the requests, skipping the mixed content limitation of the browser.</p> </li> <li> <p>Server Type: to specify the server type of the used WMS service URL. Possible options are two: <code>Geoserver</code> or <code>No Vendor</code> which can be for example MapProxy, MapServer or other.</p> </li> </ul> <p>Note</p> <p>If the No Vendor is set, then MapStore will not use any vendor option supported only by GeoServer in the OGC requests where this source is involved.</p> <ul> <li> <p>Interactive legend: if checked, allows to set by default the legend filter when a layer is added to the map from this source as described in Layer Settings.</p> </li> <li> <p>Use remote custom tile grids: if checked, allows to set by default the custom tile grid caching strategy when a layer is added to the map from this source as described in Layer Settings.</p> </li> <li> <p>Format: to define the default Tile format for the layers added to the map (<code>png</code>, <code>png8</code>, <code>jpeg</code>, <code>vnd.jpeg-png</code>, <code>vnd.jpeg-png8</code> or <code>gif</code>) and to define the default Information sheet format for the layers added to the map (<code>text/plain</code>, <code>text/html</code>, <code>application/json</code> or <code>application/geo+json</code>). The list of available formats is automatically retrieved from the ones supported by the WMS server and can be also manually fetched through the Fetch supported formats  button when necessary.</p> </li> </ul> <p>Note</p> <p>The Tile and the Information sheet configured through this option will be automatically used for all layers loaded from the involved catalog source (if not configured the default Tile used is <code>image/png</code> and the default Information sheet used is<code>text/plain</code>). For layers already loaded on the map, it is possible to change the format through the Layer Settings tool as usual.</p> <ul> <li> <p>Tile size (WMS): it represents tile size (width and height) to be used for tiles of all layers added to the map from the catalog source (<code>256x256</code> or <code>512x512</code>). For layers already loaded on the map, it is possible to change the tile size through the Layer Settings tool as usual.</p> </li> <li> <p>Domain aliases: available only for WMS catalogs type. This option is used to improve the performances of the application for tiled layer requests when multiple domains can be defined server side for the configured catalog source in MapStore (domain sharding). The user can configure multiple URLs referring to the same WMS service through the Add alias  button. Useful information about other kind of performance improvements can be found in the MapStore online training documentation.</p> </li> </ul>"},{"location":"user-guide/catalog/#tms-catalog","title":"TMS Catalog","text":"<p>The Tile Map Service (TMS) specifications include some not official/not standard protocol for serving maps as tiles (i.e. splitting map up into a pyramid of images at multiple zoom levels). MapStore allows to add to the map the following services providers:</p> <ul> <li>Custom TMS service, specifying the URL template for the tiles.</li> <li>TMS 1.0.0 , setting the URL</li> <li>Select from a list of known TMS services, with all the variants.</li> </ul> <p></p> <p>Select provider for TMS. The list of providers contains \"custom\", \"TMS 1.0.0\" and other resources</p> <p>Note</p> <p>Since some of these services are not standard, using them in different CRSs may cause problems. Therefore, keep in mind that changing CRS can cause problems when these levels are on the map.</p>"},{"location":"user-guide/catalog/#custom-tms","title":"Custom TMS","text":"<p>Selecting the custom provider the user can insert the tile URL template manually. The URL template is an URL with some placeholder that will be replaced with variables. The placeholder are identified by strings between brackets. e.g.: <code>{variable_name}</code>.</p> <p></p> <p>Edit a custom TMS</p> <p>Allowed placeholder are:</p> <ul> <li><code>{x}</code>,<code>{y}</code>,<code>{z}</code>: coordinates of the tiles</li> <li><code>{s}</code>: subdomains, this provides support for domain sharding. By default this is <code>[\"a\", \"b\", \"c\"]</code>. User can customize the default by adding options.subdomains.</li> </ul> <p>example:</p> <pre><code>{\n\"options\": {\n\"subdomains\": [\"a\", \"b\", \"c\", \"d\", \"e\"]\n}\n}\n</code></pre> <p>When the user saves this custom catalog service and clicks on search, he will see only one result, that can be added on the map: variants are not currently sopported in MapStore for this provider type.</p> <p></p> <p>Browse custom TMS service. It contains only one result</p>"},{"location":"user-guide/catalog/#sample-custom","title":"Sample custom","text":"<pre><code>url: https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png\n</code></pre>"},{"location":"user-guide/catalog/#sample-custom-with-advanced-options","title":"Sample custom with advanced options","text":"<pre><code>url: https://nls-{s}.tileserver.com/nls/{z}/{x}/{y}.jpg\n</code></pre> <pre><code>{\n\"options\": {\n\"subdomains\": [\n\"0\",\n\"1\",\n\"2\",\n\"3\"\n]\n}\n}\n</code></pre>"},{"location":"user-guide/catalog/#tms-100","title":"TMS 1.0.0","text":"<p>Selecting the \"TMS 1.0.0\" provider the user can insert the URL of the Tile Map Service (see TMS Specification). For instance, in GeoServer, it is the URL of the \"TMS\" link in the home page.</p> <p></p> <p>TMS 1.1.0 URL from GeoServer</p> <p>When saved this, the user will be allowed to browse and add to the map the TMS layers provided by the service. MapStore will filter the layers published showing only the tile maps in the current EPSG.</p> <p></p> <p>Edit a TMS 1.0.0 provider</p> <p></p> <p>Browse TMS 1.0.0 layers</p>"},{"location":"user-guide/catalog/#sample-tms-100-services","title":"Sample TMS 1.0.0 services","text":"<pre><code>https://public.sig.rennesmetropole.fr/geowebcache/service/tms/1.0.0\nhttps://osm.geobretagne.fr/gwc01/service/tms/1.0.0\nhttps://gs-stable.geosolutionsgroup.com/geoserver/gwc/service/tms/1.0.0\n</code></pre>"},{"location":"user-guide/catalog/#tms-known-services","title":"TMS Known Services","text":"<p>The other known services are listed as providers below \"custom\" and \"TMS 1.0.0\". They are a static list configured inside the application. Selecting one of the provider listed and saving the new catalog service allows to browse al the variants known for that service. For more information about the list of available providers, see the developer documentation about Tile Providers</p> <p></p> <p>Select a known TMS provider</p> <p></p> <p>Browse the TMS variants</p>"},{"location":"user-guide/catalog/#3d-tiles-catalog","title":"3D Tiles Catalog","text":"<p>3D Tiles is an OGC specification designed for streaming and rendering massive 3D geospatial content such as Photogrammetry, 3D Buildings, BIM/CAD, and Point Clouds across desktop, web and mobile applications.</p> <p>MapStore allows to publish 3D Tiles contents in its 3D mode on top of the CesiumJS capabilities. Through the Catalog tool, a specific source type to load 3D Tiles in the Cesium Map can be configured as follows by specifying the URL of a reachable <code>tileset.json</code>.</p> <p>In General Settings of 3D Tiles service, the user can specify the title to assign to this service and the URL of the service.</p> <p></p> <p>Warning</p> <p>MapStore allows you to load also Google Photorealistic 3D Tiles and some constraints need to be respected in this case. Since the Google Photorealistic 3D Tiles are not \u2018survey-grade\u2019 at this time, the use of certain MapStore tools could be considered derivative and, for this reason, prohibited. Please, make sure you have read the Google conditions of use (some FAQs are also available online for this purpose) before providing Google Photorealistic 3D Tile in your MapStore maps in order to enable only allowed tools (e.g. Measurement and Identify tools should be probably disabled). For this purpose it is possible to appropriately set the configuration of MapStore plugins  to exclude tools that could conflict with Google policies. Alternatively, it is possible to use a dedicated application context to show Photorealistic 3D Tiles by including only the permitted tools within it.</p> <p>Note</p> <p>The tool capabilities currently available for 3D Tiles layers are:</p> <ul> <li>Zoom to selected layer extent : in order to zoom the map to the layer's extent</li> <li>Access the Layer Settings  to view/edit the General Information, the Display options and Style</li> <li>Remove the layer </li> </ul>"},{"location":"user-guide/catalog/#cog-catalog","title":"COG Catalog","text":"<p>A Cloud Optimized GeoTIFF (COG) is a regular GeoTIFF file, aimed at being hosted on a HTTP file server, with an internal organization that enables more efficient workflows on the cloud environment. It does this by leveraging the ability of clients issuing \u200bHTTP GET range requests to ask for just the parts of a file they need.</p> <p>MapStore allows to add COG layers (also as a background) through its Catalog tool where a specific source type can be configured as follows by specifying the URL of a reachable COG <code>.tif</code> resource.</p> <p>In General Settings of a COG source type, it is possible to specify the service <code>Title</code> and its <code>URL</code>.</p> <p></p> <p>Note</p> <p>To properly display COG layers in your MapStore map, it is necessary to add the reference system definition supported by the COG in the MapStore projectionDefs configuration</p> <p>Warning</p> <p>The COG catalog type in MapStore is still in experimental state and for this reason not directly available in the default service types list of the Catalog tool. In order to enable this service, update the default Catalog tool configuration in <code>localConfig.json</code>  or inside the application context wizard as shown below:</p> <pre><code>{\n    \"name\": \"MetadataExplorer\",\n    \"cfg\": {\n        ...\n        serviceTypes: [\n            ...\n+           { name: \"cog\", label: \"COG\" }\n       ]\n    }\n}\n</code></pre>"},{"location":"user-guide/catalog/#advanced-settings_3","title":"Advanced Settings","text":"<p>In addition to the standard options, only for COG catalog sources, through the Advanced Settings the user can configure also the following option:</p> <p></p> <ul> <li>Download file metadata on search: this option will fetch metadata to support the zoom to layer when the layer is added to the TOC.</li> </ul> <p>Note</p> <p>The tool capabilities currently available for COG layers are:</p> <ul> <li>Zoom to selected layer extent : in order to zoom the map to the layer's extent</li> <li>Access the Layer Settings  to view/edit the General Information, the Display options and the Style</li> <li>Remove the layer </li> </ul>"},{"location":"user-guide/catalog/#ifc-model-catalog","title":"IFC Model Catalog","text":"<p>An Industry Foundation Classes (or IFC) is a 3D model file created to provide a standardized, digital description of the built asset industry. MapStore allows to add IFC model through its Catalog tool where a specific source type can be configured as follows by specifying the URL of a reachable <code>.ifc</code> resource on the web.</p> <p>In General Settings of a IFC source type, it is possible to specify the service <code>Title</code> and its <code>URL</code>.</p> <p></p> <p>Note</p> <p>To properly display georeferenced IFC 3D model layers in MapStore, ensure to have its coordinate reference system definition defined in the MapStore projectionDefs configuration. Non-georeferenced IFC models are added by default in the center of the map viewport.</p> <p>Note</p> <p>The tool capabilities currently available for IFC model layers are:</p> <ul> <li>Zoom to selected layer extent : in order to zoom the map to the layer's extent</li> <li>Access the Layer Settings  to view/edit the General Information and the Display options</li> <li>Remove the layer </li> </ul>"},{"location":"user-guide/catalog/#arcgis-catalog","title":"ArcGIS Catalog","text":"<p>An ArcGIS Server Services Directory is a RESTful representation of all the services running on an ArcGIS Server site. MapStore allows adding ArcGIS Map Service and Image Service types through its Catalog tool where a specific source type can be configured.</p> <p>In General Settings of a ArcGIS source type, it is possible to specify the service <code>Title</code> and its <code>URL</code>.</p> <p></p> <p>Warning</p> <p>The <code>URL</code> could have one of the following structures:</p> <ul> <li> <p><code>https://&lt;catalog-url&gt;/rest/services/</code></p> </li> <li> <p><code>https://&lt;catalog-url&gt;/rest/services/&lt;serviceName&gt;/MapServer</code></p> </li> <li> <p><code>https://&lt;catalog-url&gt;/rest/services/&lt;serviceName&gt;/ImageServer</code></p> </li> </ul> <p>Note</p> <p>The tool capabilities currently available for layers come from ArcGIS service are:</p> <ul> <li>Zoom to selected layer extent : in order to zoom the map to the layer's extent</li> <li>Access the Layer Settings  to view/edit the General Information and the Display options</li> <li>Remove the layer </li> </ul>"},{"location":"user-guide/configure-map/","title":"Configure the map","text":"<p>With the Edit map configuration button  the Map Inline Editor opens to give the opportunity to do quick customizations (like basic map settings, layer opacity and something more) to the map (more advanced customizations then, are allowed only through the Advanced Map Editor).</p> <p></p>"},{"location":"user-guide/configure-map/#layers","title":"Layers","text":"<p>The Map Inline Editor opens with the Layers section available, where it is possible to edit the layers settings (by selecting a layer in the TOC) and the visibility of layers present in the map:</p> <p></p> <ul> <li> <p>Control the layer transparency by scrolling left and right the transparency bar .</p> </li> <li> <p>Toggle the layer visibility by switching off  and on  the \"eye\" icon.</p> </li> </ul>"},{"location":"user-guide/configure-map/#setting","title":"Setting","text":"<p>The Setting section allows the user to:</p> <p></p> <ul> <li> <p>Enable/disable the Zoom in/out on the map</p> </li> <li> <p>Change the position of the Zoom in/out by choosing one of the options available in the dropdown menu</p> </li> </ul> <p></p> <ul> <li> <p>Enable/disable the Pan interaction on the map</p> </li> <li> <p>Enable/disable the Identify on the map. As reported in the Identify tool section, also for map sections in a story it is possible to enable the Identify tool in one of the format supported by MapStore (TEXT, HTML or PROPERTIES)</p> </li> </ul> <p></p> <p>Note</p> <p>The Identify request is performed as usual when the user clicks on a layer in the map, as follows: </p>"},{"location":"user-guide/configure-map/#advanced-map-editor","title":"Advanced map editor","text":"<p>Inside the Map Inline Editor Toolbar the Advanced map editor button is also available to allow advanced customization to the map: clicking on that button, a MapStore viewer opens for this purpose.</p> <p></p> <p>The available tools to modify the map are the following:</p> <ul> <li> <p>Adding the Layers by using the  button in the Option menu  as it is explained in the Catalog Services.</p> </li> <li> <p>Adding  Annotations by clicking on the  button in the Option menu  as it is explained in the Adding Annotations.</p> </li> <li> <p>Import a map or a vectorial file by clicking on the  button in the Option menu  as it is explained in the Import files.</p> </li> <li> <p>Change Background as it is explained in the Background Selector</p> </li> <li> <p>Edit Layers by clicking on the Layers button  as it is explained in the Table of Contents</p> </li> </ul> <p>Once the advanced map editing is complete, it is possible click on Apply to see the final result in the story.</p> <p></p>"},{"location":"user-guide/connecting-widgets/","title":"Connecting Widgets","text":"<p>In dashboards it is possible to connect the added widgets allowing the user to inspect and interact with more than one of them at the same time.</p> <p>Once at least one connection between widgets is set, it is possible to identify the connected widgets turning on the connections button in the dashboard Side Toolbar making it green . This will highlight the connected elements with a colored bar on their upper side.</p> <p>In general, you can connect:</p> <ul> <li> <p>Map widgets with other widgets</p> </li> <li> <p>Table widgets with other widgets</p> </li> </ul>"},{"location":"user-guide/connecting-widgets/#connecting-map-widgets-with-other-widgets","title":"Connecting Map widgets with other widgets","text":"<p>In dashboards it is possible to connect Map widgets with:</p> <ul> <li> <p>Other Map widgets</p> </li> <li> <p>Chart widgets</p> </li> <li> <p>Table widgets</p> </li> <li> <p>Counter widgets</p> </li> <li> <p>Legend widgets</p> </li> </ul>"},{"location":"user-guide/connecting-widgets/#maps-with-other-maps","title":"Maps with other Maps","text":"<p>As soon as more than one Map widget is added to the dashboard, the connect/disconnect button appears inside the Configure map options panel (accessible by adding a new Map widget or editing an existing one).</p> <p></p> <p>With a click on it, if only another Map widget is present, by default the connection will be made towards that Map widgets. When more than one Map widget is present in the dashboard, instead, it is possible choose one through a page like the following:</p>"},{"location":"user-guide/connecting-widgets/#maps-with-charts-tables-and-counters","title":"Maps with Charts, Tables and Counters","text":"<p>In order to connect Charts, Tables or Counters widget with Maps widget, the procedure is similar to that seen in the previous section. The result is that the information displayed in the Chart, Table or Counter changes accordingly with the map portion displayed in the connected Map widget. For example the result could be:</p> <ul> <li>Connecting Charts with Maps:</li> </ul> <ul> <li>Connecting Tables with Maps:</li> </ul> <ul> <li>Connecting Counters with Maps:</li> </ul> <p>When a pan or zoom operation is performed in the Map widget, the other connected widgets are spatially filtered according to the Map viewport.</p>"},{"location":"user-guide/connecting-widgets/#maps-with-legends","title":"Maps with Legends","text":"<p>Also in this case the connecting procedure is similar to those seen previously, but now the information contained in the Legend widget doesn't change according with the map extension. An example can be the following:</p> <p></p>"},{"location":"user-guide/connecting-widgets/#connecting-table-widgets-with-other-widgets","title":"Connecting Table widgets with other widgets","text":"<p>With the same procedure used for maps (see previous section) the user can connect Table widgets with:</p> <ul> <li> <p>Map widgets</p> </li> <li> <p>Other table widgets, only if it refers to the same layer</p> </li> <li> <p>Chart widgets, only if it refers to the same layer</p> </li> <li> <p>Counter widgets, only if it refers to the same layer</p> </li> </ul> <p>When a table is connected with other widgets, it became a Parent Table and a filter appears on the top.</p> <p></p> <p>It is possible to apply a filter in the Parent Table simply by typing a text in the input field present at the top of each column:</p> <p>A Map widget that is connected to a Parent Table receives the alphanumeric filter of the Table and:</p> <ul> <li> <p>Performs a zoom to the extent that contains all the Table widget records (the result of the filter in the Table)</p> </li> <li> <p>If the Map widget contains the same dataset (layer) of the Parent Table, also the layer on map is filtered accordingly</p> </li> </ul> <p>Once a widget is connected to a map widget that is connected to a Parent Table at the same time:</p> <ul> <li>If the widget has been created on the same dataset (layer) of the Parent Table then two filters will be applied in AND to the widget itself: the spatial filter of the Map widget and the attribute filter defined in the Parent Table</li> </ul> <ul> <li>If the dataset isn't the same, only the spatial filter of the Map widget will be applied as usual: in the following example, the Counter refers to a level other than that configured for the Parent Table</li> </ul> <p>There are different combinations of connections, the image below illustrates the allowed ones by reporting also the kind of filters applied for each case</p> <p></p>"},{"location":"user-guide/content-image-toolbar/","title":"Image Content Toolbar","text":"<p>As soon as an image content is added, the Image Content Toolbar appears on top of the image:</p> <p></p> <p>Through this toolbar, the story editor is able to perform the following operation:</p> <ul> <li> <p>Change media source  accessing the Media Editor</p> </li> <li> <p>Change size  choosing between Small, Medium, Large</p> </li> <li> <p>Hide caption button  to show/hide the description under the image: this button is present only if a description has been provided for the image resource (see the Media Editor tool for example)</p> </li> <li> <p>Remove  the image content</p> </li> </ul>"},{"location":"user-guide/content-map-toolbar/","title":"Map Content Toolbar","text":"<p>As soon as a map content is added, the Map Content Toolbar appears on top of the map component:</p> <p></p> <p>In particular, through this toolbar, the story editor is able to perform the following operation:</p> <ul> <li> <p>Change media source  accessing the Media Editor</p> </li> <li> <p>Edit map configuration  through which it is possible Configure the map</p> </li> <li> <p>Change size  choosing between Small, Medium, Large</p> </li> <li> <p>Hide caption button  to show/hide the description under the map: this button is present only if a description has been provided for the map resource (see the Media Editor tool for example)</p> </li> <li> <p>Remove  the map content</p> </li> </ul>"},{"location":"user-guide/content-video-toolbar/","title":"Video Content Toolbar","text":"<p>As soon as a video content is added, the Video Content Toolbar appears on top of the video:</p> <p></p> <p>Through this toolbar, the story editor is able to perform the following operation:</p> <ul> <li> <p>Change media source  to open the Media Editor and change (or configure) the media content</p> </li> <li> <p>Mute video  to disable the video audio</p> </li> <li> <p>Enable Autoplay  to play the video automatically once the user is on it</p> </li> <li> <p>Enable Loop  to continuously repeat the video</p> </li> <li> <p>Hide caption button  to show/hide the description under the video: this button is present only if a description has been provided for the video resource (see the Media Editor tool for example)</p> </li> <li> <p>Remove  the video content</p> </li> </ul> <p>Note</p> <p>Inside the Media Editor you can watch a preview of the video before adding it to the story. The video play will be available only in View Mode of the story: it is not available in edit mode except in the media editor as a preview.</p>"},{"location":"user-guide/content-web-toolbar/","title":"Web Page Content Toolbar","text":"<p>As soon as a Web Page Content is added, the toolbar appears on top of the content itself:</p> <p></p> <p>In particular, through this toolbar, the editor is able to perform the following operation:</p> <ul> <li> <p>Change horizontal size  choosing between Small, Medium, Large and Full</p> </li> <li> <p>Edit web page URL  accessing the web page windows to change the web URL</p> </li> <li> <p>Change vertical size  choosing between Small, Medium, Large</p> </li> <li> <p>Remove  the Web Page content</p> </li> </ul>"},{"location":"user-guide/exploring-dashboards/","title":"Exploring Dashboards","text":"<p>In MapStore, a Dashboard is a space where the user can add many Widgets, such as charts, maps, tables, texts and counters, and can create connections between them in order to:</p> <ol> <li> <p>Provide an overview to better visualize a specific data context</p> </li> <li> <p>Interact spatially and analytically with the data by creating connections between widgets</p> </li> <li> <p>Perform analysis on involved data/layers</p> </li> </ol> <p>In order to create a new dashboard, the New Dashboard button  appears in MapStore Homepage once logged as Administrator or Normal user. With a click on it, an empty dashboard workspace appears. This page is composed of a Topbar, a Sidebar and a Viewer:</p> <p></p>"},{"location":"user-guide/exploring-dashboards/#top-toolbar","title":"Top Toolbar","text":"<p>Through the Top Toolbar it is possible to:</p> <ul> <li> <p>Access GeoSolutions website with a click on the  icon</p> </li> <li> <p>Set the language, with the Language switcher:</p> </li> </ul> <p></p> <ul> <li> <p>Go back to the Homepage by clicking the  button</p> </li> <li> <p>Login/Logout by clicking the  button (for more information see the Managing Users and Groups section)</p> </li> </ul>"},{"location":"user-guide/exploring-dashboards/#side-toolbar","title":"Side Toolbar","text":"<p>From the Side Toolbar the user can:</p> <p></p> <ul> <li> <p>Add new widgets with the  button</p> </li> <li> <p>See the connections between widgets with the  button, available when connections are present (more information about this option are available in Connecting Widgets section)</p> </li> <li> <p>See the About this dashboard panel by clicking the  button, when Details are present</p> </li> <li> <p>Export dashboard in <code>json</code> format by clicking the  button</p> </li> <li> <p>Import <code>json</code> dashboard files from your computer by clicking the  button (it will replace the current dashboard directly)</p> </li> <li> <p>Save the dashboard by clicking the  button, in order to apply the changes made in an existing dashboard. Selecting this option, the Resources Properties window opens, already filled with the current dashboard properties</p> </li> <li> <p>Save as when the user needs to save a copy of a dashboard or save one for the first time by clicking the  button. Selecting this option an empty Resources Properties window opens.</p> </li> <li> <p>Delete dashboard in order to delete the current dashboard by clicking the  button</p> </li> <li> <p>Share the dashboard by clicking the  button</p> </li> <li> <p>Start the Tutorial by clicking the  button</p> </li> <li> <p>Know more information About MapStore and the deployed Version of MapStore by clicking the  button</p> </li> </ul> <p></p>"},{"location":"user-guide/exploring-dashboards/#viewer","title":"Viewer","text":"<p>Once the widgets are added in the viewer it is possible to:</p> <ul> <li>Change widgets position by moving them with a simple Drag and Drop and resize them:</li> </ul> <ul> <li> <p>Access widgets menu  from which the user can choose between several options (more information about this menu's options can be found in Map's Access Widget Menu section)</p> </li> <li> <p>Take a look at the widget Description (more information about widget Description can be found in Map's Access Widgets Info section)</p> </li> </ul>"},{"location":"user-guide/exploring-maps/","title":"Exploring Maps","text":"<p>In cartography, a map is any two-dimensional graphic representation of the spatial relationships of the whole or a part of the earth. In digital cartography as in MapStore, a map consists in overlaying various layers of geographic data and their styles in data frames, and it contains various map elements such as a legend and a scale bar.</p> <p>In order to create a map, the user can click on the New Map button  in Homepage and will be addressed directly to the map viewer (by default only Administrators and Normal Users can create a new map, as explained before in Homepage section):</p> <p></p> <p>Once a map is created and saved, it will be available in Homepage content section.</p>"},{"location":"user-guide/exploring-maps/#mapstore-webgis-portal-interface","title":"MapStore WebGIS Portal Interface","text":"<p>The Mapstore WebGIS Portal interface is composed by the following main blocks:</p> <p></p> <p>In particular:</p> <ul> <li> <p>The Table of Contents (TOC) shows the layers and the layers groups on the map and allows to remove or edit them, and add some new ones</p> </li> <li> <p>The MapStore Toolbars includes the Search Bar and the Side Toolbar, an important list of options that contains several functions and information</p> </li> <li> <p>The Navigation Toolbar that is mainly a navigation panel</p> </li> <li> <p>The Background Selector allows to add, remove or edit map's background</p> </li> <li> <p>The Footer includes the CRS selector, the coordinates, the scale and the credits of the layer</p> </li> <li> <p>The Data Frame is the space where the layers are displayed</p> </li> </ul>"},{"location":"user-guide/exploring-stories/","title":"Exploring Story","text":"<p>In MapStore, GeoStory is a tool that allows to create inspiring and immersive stories by combining text, interactive maps, and other multimedia content like images and video or other third party contents. Through this tool you can simply tell your stories on the web and then publish and share them with different groups of MapStore user or make them public to everyone around the world.</p> <p>The user can approach a story in two different ways:</p> <ul> <li>Creating a new story or editing an existing one through the Edit Mode</li> <li>Enjoy the story and interact with it, through the View Mode</li> </ul>"},{"location":"user-guide/exploring-stories/#edit-mode","title":"Edit Mode","text":"<p>The Edit Mode allows the user to edit a story by adding, removing or modifying the elements inside it. This mode and its tools are used both to edit an existing story and to create a new one.  In order to create a new story, the user can click on the New GeoStory button  on MapStore home page. As soon as the user clicks on that button in home page the story editor opens, it is composed of three main elements: the Topbar, the Builder and the Sections Container (later simply called Container).</p> <p></p> <p>The Story content is organized in Sections, that can be added with the  button in the Container area. In particular, the user can add to the story the following kind of sections:</p> <p></p> <ul> <li>Title Section</li> <li>Banner Section</li> <li>Paragraph Section</li> <li>Immersive Section</li> <li>GeoCarousel Section</li> <li>Media Section</li> <li>Web Page Section</li> </ul>"},{"location":"user-guide/exploring-stories/#view-mode","title":"View Mode","text":"<p>The View Mode corresponds to the final result of your story composition that will be visible to end users on the web.  The user can access the View Mode also during the Story editing in order to have a preview of its work on the Story itself. The Show preview button in Builder's toolbar allows to do that and the first display looks like the following:</p> <p></p> <p>On top of the page there is a Top bar in which the story's informations (if properly configured in edit mode) are displayed.</p> <p></p> <p>The elements available in the top bar can be the following:</p> <ul> <li>Edit Story button  that allows to switching back to the Edit Mode</li> <li>Navigation bar allows to navigate between different sections of the story</li> <li>The Title of the story configured in the story settings (edit mode)</li> <li>The Logo of the story chosen by the story editor in the story settings</li> </ul> <p>Warning</p> <p>In order to set up this information the story editor neededs to go back in Edit Mode and open the Setting button  as explained in Story Setting.</p> <p>The Story layout allows to navigate contents by scrolling up and down the Story page by using the mouse or the Navigation bar.</p>"},{"location":"user-guide/export-data/","title":"Export Layer Data","text":"<p>MapStore allows to export both vector and raster layers present in  TOC. In order to provide advanced export capabilities the WPS Download process must be installed and available in GeoServer. MapStore performs a preventive check for this as soon as the user opens the tool: if the WPS Download process is not available, MapStore uses the WFS service as fallback and the export options are limited (eg. only vector data can be exported). Once a layer is selected in the TOC, the user can open the Export Data tool by clicking the  button available in the layer toolbar.</p> <p></p> <p>Note</p> <p>If the <code>WFS</code> service is the only one available, once the Export Data opens, the user can only select the File Format and the Spatial Reference System (as explained below). </p> <p>Note</p> <p>Only for the Vector layer, the user can also download data by opening the Attribute Table  from the TOC and clicking the  button.</p> <p>From the Export Data panel the user can:</p> <ul> <li> <p>Select the Service, choosing between <code>WPS</code>and <code>WFS</code> (this option is present in the form only if the WPS Download process is available, otherwise the WFS service is used directly).</p> </li> <li> <p>Select the File Format. The list of formats depends on the availability of the WPS Download process in GeoServer. If the WPS process is available, the user can choose between <code>GeoJSON</code>, <code>wfs-collection-1.0</code>, <code>wfs-collection-1.1</code>, <code>Shapefile</code> and <code>CSV</code> for vector layers, and between <code>ArcGrid</code>, <code>TIFF</code>, <code>PNG</code>, <code>JPEG</code>, in case of raster layers. If the WPS Download process is not available for some reasons, MapStore provides the list of formats valid for the WFS service by looking at the ones offered by the services capabilities (WFS Capabilities).</p> </li> <li> <p>Select the Spatial Reference System (By default <code>Native</code> or <code>WGS84</code>)</p> </li> <li> <p>Enable the Crop dataset to current viewport for downloading only the part of the layer visible on the map at that moment (this option is present in the form only if the WPS Download process is available)</p> </li> <li> <p>Only for Vector layer, allows to consider for the download also an eventual filter applied to the layer using the Filter layer tool  (this option is present in the form only if the WPS Download process is available)</p> </li> </ul> <p></p> <ul> <li> <p>Only for Raster layer (and if the WPS Download process is available) the user can open the Advanced options to choose:</p> </li> <li> <p>The Compression type used to store internal tiles (<code>CCITT RLE</code>, <code>LZW</code>, <code>JPEG</code>, <code>ZLip</code>, <code>PackBits</code> or <code>Deflate</code>)</p> </li> <li>The Compression quality for lossy compression (JPEG). Value is in the range [0 : 1] where 0 is for worst quality/higher compression and 1 is for best quality/lower compression</li> <li>Tile Width of internal tiles, in pixels</li> <li>Tile Height of internal tiles, in pixels</li> </ul> <p></p> <p>With a click on the  button MapStore performs the export request. In case of WPS Download process available, multiple export requests can be performed from MapStore asynchronously. An information popup informs the user when an export process starts and the user can check the status of the process itself by opening the Export Data Result panel with a clicking on the  button available on the right side of the footer.\u00a0\u00a0</p> <p></p> <p>The Export Data Result provides the list of exports processes started by the user and their status: as soon as the WPS completes the export operation, its status is reported by MapStore to the user (in progress, completed, and so ready for download, or failed). Therefore, the user can:</p> <p></p> <ul> <li> <p>Check for eventual reported errors: a specific icon informs the user that the process failed with a popup message.</p> </li> <li> <p>Download the final <code>zip</code> file: clicking the  button</p> </li> <li> <p>Remove the final <code>zip</code> file: clicking the  button</p> </li> </ul>"},{"location":"user-guide/extension-library/","title":"Extension Library","text":"<p>The  button, present in the Side Toolbar, provide to the user the list of extensions ready to be activated for the viewer: that list of available extensions for the user has been defined by the the administrator during the Application Context creation.</p> <p></p> <p>The User Extensions panel opens allows the user to choose which extension to add to the viewer through the Add Extension button , as follows:</p> <p>Note</p> <p>The User Extensions is enabled by the admin in the Application Context wizard.</p>"},{"location":"user-guide/filtering-layers/","title":"Filtering Layers","text":"<p>When using vector layers it might be useful to work with a subset of features. About that, MapStore let the user set up a Layer Filter that acts directly on a layer with WFS available and filter its content upfront. The map will immediately update when a filter is applied.</p> <p>Warning</p> <p>The MapStore's filtering capabilities are working on top of the WFS specifications so that service must be enabled if you want to filter a layer using the tools described in this section.</p>"},{"location":"user-guide/filtering-layers/#filter-types","title":"Filter types","text":"<p>In MapStore it is possible to apply filters on layers in three different ways:</p> <ul> <li> <p>With the Layer Filter tool available in TOC</p> </li> <li> <p>With the Advanced Search tool available from the Attribute Table</p> </li> <li> <p>With the Quick Filter available in the Attribute Table</p> </li> </ul>"},{"location":"user-guide/filtering-layers/#layer-filter","title":"Layer Filter","text":"<p>This filter is applicable from the Filter layer button  in TOC's Layers Toolbar and it will persist in the following situations:</p> <ul> <li>Using other tools like the Identify tool:</li> </ul> <ul> <li>Applying another type of filter</li> </ul> <ul> <li>Opening the map next time (you need to Save the map from the Side Toolbar after applying a filter)</li> </ul> <p>Once a Layer filter is set, it is possible to enable/disable it simply by clicking on the button that will appear near the layer name in TOC:</p> <p></p> <p>This filter is applied through the Query Panel. Once the settings are chosen, it is possible to Apply  them. After that the user can:</p> <ul> <li> <p>Undo  the last changes</p> </li> <li> <p>Reset  the filter to the initial situation</p> </li> <li> <p>Save  the filter in order to make it persistent</p> </li> </ul>"},{"location":"user-guide/filtering-layers/#query-panel","title":"Query Panel","text":"<p>This tool is used to define advanced filters in MapStore. It includes three main sections:</p> <ul> <li> <p>Attribute Filter</p> </li> <li> <p>Area of Interest</p> </li> <li> <p>Layer Filter</p> </li> </ul> <p></p>"},{"location":"user-guide/filtering-layers/#attribute-filter","title":"Attribute filter","text":"<p>This filter allows to set one or more conditions referred to the Attribute Table fields.  First of all it is possible to choose if the filter will match:</p> <ul> <li> <p>Any conditions</p> </li> <li> <p>All conditions</p> </li> <li> <p>None conditions</p> </li> </ul> <p>After that, the user can insert one or more conditions, that can also be grouped in one or more condition groups (use the  button in order to create a group). A condition can be set by selecting a value for each of the three input boxes:</p> <ul> <li> <p>The first input box allows to choose a layer field</p> </li> <li> <p>In the second input box it is possible to choose the operation to perform (selecting a text field can be =, like, ilike or isNull, selecting a numerical field, can be =, &gt;, &lt;, &gt;=, &lt;=, &lt;&gt; or &gt;&lt;)</p> </li> <li> <p>The third input box (in case of fields of type String) provides a paginated list of available field values already present in the layer's dataset (a GeoServer WPS process is used for this). In case of numeric fields, the user can simply type a value to use for the filter or use instead the Date Picker tool for the Date, Time and DateTime attributes as described above in the Quick Filter by attributes section.</p> </li> </ul> <p>Note</p> <p>For the Query Panel, the Date Picker tool also allows the user to perform select Quick Date Selections such as: <code>Now</code>, <code>Yesterday</code> for single Date or DateTime and <code>Tomorrow</code> or also quick date ranges like <code>Now</code>, <code>This week</code>, <code>This month</code>, <code>7 days from now</code>, <code>30 days from now</code> and <code>90 days from now</code> for Date or DateTime intervals depending on the operator selected. An example can be the following: </p> <p>Note</p> <p>the \"paginated list of available field values\" above is available only if the server provides the WPS process <code>gs:PagedUnique</code></p> <p>A simple Attribute Filter applied for a numerical field can be, for example:</p>"},{"location":"user-guide/filtering-layers/#area-of-interest","title":"Area of interest","text":"<p>In order to set this filter the user can:</p> <ul> <li> <p>Select the Filter type by choosing between Viewport, Rectangle, Circle, Polygon (selecting Rectangle, Circle or Polygon it is necessary to draw the filter's geometry on the map)</p> </li> <li> <p>Select the Geometric operation by choosing between Intersects, Is contained, Contains</p> </li> </ul> <p>Applying a Rectangle filter with Intersect operation, for example, the process could be similar to the following:</p> <p>Once this filter is set, it is always possible to edit the coordinates and the dimensions of the drawn filter's geometry by clicking on the Details button . Editing a circle, for example, it is possible to change the center coordinates (x, y) and the radius dimension (m):</p> <p></p> <p>Note</p> <p>Also for Dashboard widgets (charts, table and counter) it is possible to define a spatial filter without necessarily connect the widget to the map widget by using the usual Area of interest filtering section. The example below sows how:  </p>"},{"location":"user-guide/filtering-layers/#layer-filter_1","title":"Layer filter","text":"<p>This tool allows to set cross-layer filters for a layer by using another layer or even the same one.</p> <p>Warning</p> <p>This filter tool requires the Query Layer plugin installed in GeoServer</p> <p>In order to set up a cross-layer filter the options below are required:</p> <ul> <li> <p>Target layer (between those present in the TOC)</p> </li> <li> <p>Operation to be chosen between Intersects, Is contained or Contains</p> </li> <li> <p>Optionally some Conditions (see Attribute filter)</p> </li> </ul> <p>In order to better understand this type of filter, let's make an example. We suppose that the user want to filter the Italian Regions with the Unesco Item's one:</p> <p></p> <p>In particular, if our goal is to take a look at the Italian Regions that contain the Unesco sites with serial code=1, the operations to perform can be the following:</p> <p>Note</p> <p>The Layer Filter option is only available for widgets defined in Map viewer and not for Dashboards widgets.</p>"},{"location":"user-guide/footer/","title":"Footer","text":"<p>In MapStore some of the map information are reported in the Footer. By default, as soon as the user opens the map, the scale bar and the scale switcher are showed so that the user can change the scale bar by zooming in/out the map or by selecting a map scale through the scale switcher.</p> <p></p> <p>In order to visualize the map coordinates corresponding to the mouse pointer in the selected Coordinate Reference System of the map, the user can click on the button </p> <p></p>"},{"location":"user-guide/footer/#crs-selector","title":"CRS Selector","text":"<p>MapStore allows also to change the Coordinate Reference System of the map by clicking on the Select Projection button . A CRS selector opens to select one of the available CRSs, as follows:</p> <p>Note</p> <p>The list of available CRSs depends on the CRS Selector configuration.</p> <p>In order to search a desired CRS, the user can also filter the CRS list by typing in a search input field.</p> <p></p>"},{"location":"user-guide/geocarousel-section/","title":"GeoCarousel Section","text":"<p>The GeoCarousel section allows another kind of immersive experience than the Immersive Section. The story editor can define a list of carousel cards to be presented with an accompanying descriptive content and a geographic location. In edit mode it is composed of three elements: the background  map, the descriptive panel and the carousel panel where the editor can manage carousel items.</p> <p></p>"},{"location":"user-guide/geocarousel-section/#background","title":"Background","text":"<p>The background editing toolbar allows to add a map as a background of the section, with the Change media source button  that opens the Media Editor as usual.</p> <p></p> <p>Note</p> <p>In the GeoCarousel Section the story editor, unlike the Immersive Section and the Title Section, can only add a map as a background.</p> <p>Once a map is selected for the background, the editing toolbar appears in the upper left corner of the section allowing the story editor to manage the background content.</p> <p></p> <p>The Background editing toolbar allows the following actions:</p> <p></p> <ul> <li> <p>Change media source  allows to select the media content to use for the section, clicking on this button the Media Editor opens.</p> </li> <li> <p>The Edit map configuration allows to Configure the Map</p> </li> <li> <p>Change size  of the section between Small, Medium, Large or Full</p> </li> <li> <p>Align content  on the Left, Center or Right</p> </li> <li> <p>Change the background theme  to set the colour of the empty background between Default (same default theme settings of the story, see Story Settings), Bright, Dark or Custom (allows to customize the color of the background).</p> </li> </ul> <p>Warning</p> <p>The Align content and the Change field theme buttons are disabled if the map size is full screen.</p>"},{"location":"user-guide/geocarousel-section/#descriptive-panel","title":"Descriptive panel","text":"<p>The Descriptive panel allows to put descriptive content such as text, image, video or map for the different cards composing the GeoCarousel section. The story editor can customize it through the Content Toolbar, as it is explained in the Content section.</p> <p></p>"},{"location":"user-guide/geocarousel-section/#carousel","title":"Carousel","text":"<p>The carousel is composed of a list of cards to be associated with a geographic location. It is located at the bottom of the GeoCarousel section and as soon as the section is added to the story, it has by default the following empty card ready to be configured:</p> <p></p> <p>Once a card is selected in edit mode, the story editor can perform the following operations through the Cards editing toolbar:</p> <p></p> <ul> <li>Edit  the card: clicking on this button the Edit Card panel opens to allow adding Thumbnail and Title. An example can be the following:</li> </ul> <p></p> <ul> <li> <p>Delete  the card</p> </li> <li> <p>Add marker  on map or modify the current marker position: clicking on this button the Map Inline Editor opens, and the story editor can click a point on map to add a new marker or change its position as follows:</p> </li> </ul> <p>In the upper left corner of the Carousel panel, a Carousel toolbar allows to:</p> <p></p> <ul> <li> <p>Add card  to the carousel</p> </li> <li> <p>Remove  the GeoCarousel Section</p> </li> </ul> <p>Note</p> <p>Each carousel item as well as its marker on the map is numbered to be better identified.</p>"},{"location":"user-guide/geocarousel-section/#geocarousel-section-in-view-mode","title":"GeoCarousel section in View Mode","text":"<p>In a GeoCarousel section, in view Mode, the user can perform the following operations:</p> <ul> <li>Select a carousel card to view related descriptive content</li> </ul> <ul> <li>Select a marker on the map to display its carousel card name popup and view its descriptive content</li> </ul> <ul> <li>Use the left and right arrows  to browse the different geocarousel content</li> </ul>"},{"location":"user-guide/geoprocessing-tool/","title":"GeoProcessing Tool","text":"<p>This tool aims to provide a set of geo-processing utilities on layers present in map. WPS calls are made by the tool to produce the result to be displayed in the map. Supported WPS processes are geo:buffer and gs:IntersectionFeatureCollection (the WPS plugin need to be installed for your GeoServer version in order to use this tool).</p> <p>Note</p> <p>The GeoProcessing Tool is not included by default in the MapStore configuration but it can be configured within an application contexts if needed or directly included in the standard application configuration.</p> <p>Warning</p> <p>To prevent possible errors in geometry overlay methods due to complex and heavy geometries, the JTS system property must be added to the GeoServer in use (the <code>-Djts.overlay=ng</code> should be enabled in JAVA properties).</p> <p>By clicking the GeoProcessing Tool  button, available in the Side Toolbar, a panel opens so that the user can choose the geographic operations between Buffer and Intersection.</p> <p></p> <p>Note</p> <p>All the following layer types in MapStore are supported and can be used in the GeoProcessing tool:</p> <ul> <li>WMS and WFS layers in the TOC</li> <li>Measurements</li> <li>GeoJSON map imported</li> <li>Imported ShapeFiles</li> <li>Annotations</li> </ul>"},{"location":"user-guide/geoprocessing-tool/#buffer-tool","title":"Buffer tool","text":"<p>The Buffer tool allows to create a buffer around the input geometries and when it is selected, the user can:</p> <ul> <li> <p>Select a layer from the Source Layer option drop down menu. The dropdown shows the layers available for the process from the ones present in TOC.</p> </li> <li> <p>Select one of the layer features from the Source Feature option. The feature can be selected from the dropdown menu or directly clicking on map by activating the  button.</p> </li> </ul> <ul> <li>Insert the desired Distance for the buffer (supported are m and km).</li> </ul> <p>When all mandatory process parameters have been provided, it is possible to click on   button to start the process to generate and visualize the buffer layer.</p> <p>The buffer layer is added in TOC inside a new group created for the purpose.</p>"},{"location":"user-guide/geoprocessing-tool/#advanced-settings","title":"Advanced Settings","text":"<p>Enabling the Advanced options the user can include further (not mandatory) parameters for the Buffer process:</p> <p></p> <ul> <li> <p>Enter the Quadrant Segments, that is the number of line segments used to approximate a quarter circle.</p> </li> <li> <p>Select the Style for the buffer end caps choosing between <code>Round</code>, <code>Flat</code> or <code>Square</code></p> </li> </ul>"},{"location":"user-guide/geoprocessing-tool/#intersection-tool","title":"Intersection tool","text":"<p>Once Intersection is selected as a process to be used from the first dropdown, the user can also select the layer to use as Source Layer for the intersection as well as the layer to be intersected with the given source (Intersection Layer option). For both options it is possible to select a feature to use for the intersection process; this is possible by enabling the  buttons in order to select the layer features directly with a click on the map. If no layer feature is provided for one of the to layer options, the operation will be performed on the entire layer.</p> <p>The user can then:</p> <ul> <li> <p>Select the Source Layer from the drop down menu.</p> </li> <li> <p>Select the layer feature from the Source Feature. The feature can be selected from the drop down menu or by clicking directly on the map by activating the  button.</p> </li> </ul> <p>In the same way it is possible to select the Intersection Layer and the corresponding Intersection Feature to obtain the new intersected layer by clicking on  button.</p> <p>The new layer, result of the intersection of the features selected, will be added to the TOC inside a dedicated group and visible in the map viewer.</p> <p></p>"},{"location":"user-guide/geoprocessing-tool/#advanced-settings_1","title":"Advanced Settings","text":"<p>Enabling the Advanced options the user can include further (not mandatory) parameters for the Intersection process:</p> <p></p> <ul> <li> <p>Enter the First attribute to retain, which is the first attribute to display</p> </li> <li> <p>Enter the Second attribute to retain, which is the second attribute to display</p> </li> <li> <p>Select the Intersection mode choosing between <code>INTERSECTION</code>, <code>FIRST</code> or <code>SECOND</code></p> </li> <li> <p>Select the Percentages, choosing between <code>False</code> or <code>True</code>, to indicate whether to generate area percentages.</p> </li> <li> <p>Select the Areas enabled, choosing between <code>False</code> or <code>True</code>, to indicate whether to generate area</p> </li> </ul>"},{"location":"user-guide/home-page/","title":"Home Page","text":"<p>In order to get started, let's take a look at the portal interface and get an idea of how to navigate around it. First of all it's necessary to specify that the user can take advantage of different tools and sections according to his authentication in MapStore. In particular, a user can access the MapStore application by:</p> <ul> <li> <p>Anonymous user</p> </li> <li> <p>Normal user</p> </li> <li> <p>Administrator user</p> </li> </ul>"},{"location":"user-guide/home-page/#anonymous-user","title":"Anonymous user","text":"<p>Accessing MapStore as anonymous user, the Homepage shows up as in the figure below:</p> <p></p> <p>The anonymous user is allowed to:</p> <ul> <li> <p>Access GeoSolutions website with a click on the  icon</p> </li> <li> <p>Navigate through the Featured and Contents sections</p> </li> </ul> <p></p> <ul> <li>Set the application language, with the Language switcher:</li> </ul> <p></p> <ul> <li> <p>Login  (more information about Login can be found in Managing Users and Groups section)</p> </li> <li> <p>Perform a search for resources, through the Search bar:</p> </li> </ul> <p></p> <ul> <li>Open the Advanced Filters, through the  button, to select one or more Contexts from the dropdown menu and find all maps created from them</li> </ul> <p></p> <ul> <li> <p>Share a resource </p> </li> <li> <p>Take a look at map Details when available </p> </li> <li> <p>Open resources and navigate inside them according to their Permissions</p> </li> </ul>"},{"location":"user-guide/home-page/#normal-user","title":"Normal user","text":"<p>With a login as normal user, the Homepage displays as below:</p> <p></p> <p>The normal user, in addition to what the anonymous user can do, is allowed to:</p> <ul> <li>Create new resources like Map, Dashboard and GeoStory:</li> </ul> <p></p> <ul> <li>View, edit and remove resources according to their Permissions </li> </ul>"},{"location":"user-guide/home-page/#administrator-user","title":"Administrator user","text":"<p>Once logged in as Administrator, the Homepage it's like the following:</p> <p></p> <p>The admin can see and edit everything. In particular, in addition to what normal user can do, an administrator can also:</p> <ul> <li> <p>Access the Manager button  for Manage Accounts and Manage Contexts</p> </li> <li> <p>Manage the resources by including  or excluding  them from Featured section</p> </li> <li> <p>View, edit and remove any resource</p> </li> </ul>"},{"location":"user-guide/immersive-section/","title":"Immersive Section","text":"<p>The immersive section is composed of two elements: the background and the immersive content. As soon as you add an immersive section to your story, an empty background with an empty text content will be displayed.</p> <p></p>"},{"location":"user-guide/immersive-section/#content","title":"Content","text":"<p>Inside an Immersive Section the story editor can customize the content area through the Immersive Content Toolbar:</p> <p></p> <p>In particular, it possible to:</p> <ul> <li> <p>The Change size button   allows to change the size of the text window in Small, Medium, Large or Full.</p> </li> <li> <p>The Align content button   allows to align the text window, inside the Container, on the Left, Center or Right.</p> </li> <li> <p>The Change field theme button  allows to change the text window theme in Default (same default theme settings of the story, see Story Settings), Bright, Dark or Custom (allows to customize background and text colors and enable or disable the shadow)</p> </li> </ul> <p>Below is an example of a small Immersive Content, aligned to the Right and with a Dark field theme:</p> <p></p> <p>As soon as you add a text content, it appears available just below the current one. With a simple click inside it, the user can write the text and customize the text formatting through the Text Editor Toolbar. An example of a text content can be the following:</p> <p></p> <p>The immersive content can include text, media contents or web pages. A new content can be added inside the immersive content column through the  button, or it can be removed through the  button.</p> <p></p> <p>Adding a media content, the Media Editor appears to allow the story editor to add an Image, a Map or a Video. It is also possible to add a Web Page content as it is explained in the Web Page Section.  An example of immersive content with a text and an image can be the following:</p> <p></p>"},{"location":"user-guide/immersive-section/#background","title":"Background","text":"<p>For Immersive sections, it is possible to customize the background through the background editing toolbar:</p> <p></p> <p>The background editing toolbar, when no media are applied, allows to:</p> <ul> <li>Add a media as a background of the section, with the Change media source button  that opens the Media Editor</li> </ul> <p>Once a media (image, video or map) is added to the background, an editing toolbar appears in the upper left corner of the section allowing the user to manage the background content.</p> <p></p> <p>The Background editing toolbar changes depending on the type of media added to the background, as it is explained in the Background section.</p> <p>Note</p> <p>Only for Immersive Section, when the user try to add another section of the same type just below the current one, the added section is actually another immersive content, that fits inside the same immersive section.</p>"},{"location":"user-guide/import/","title":"Import Files","text":"<p>In MapStore it is possible to add map context files or vector files to a map. This operation can be performed by clicking   from the Side Toolbar. Following these steps the import screen appears:</p> <p></p> <p>Here the user, in order to import a file, can drag and drop it inside the import screen or select it from the folders of the local machine through the  button. Actually there's the possibility to import two different types of files:</p> <ul> <li> <p>Map context files (supported formats: MapStore legacy format, WMC)</p> </li> <li> <p>Vector layer files (supported formats: shapefiles, KML/KMZ, GeoJSON and GPX)</p> </li> </ul> <p>Warning</p> <p>Shapefiles must be contained in .zip archives.</p>"},{"location":"user-guide/import/#export-and-import-map-context-files","title":"Export and Import map context files","text":"<p>A map context is, for example, the file that an user download selecting the  button from the Side Toolbar. Map contexts can be exported in two different format:</p> <ul> <li>The  file, is an export in <code>json</code> format of the current map context state: current projections, coordinates, zoom, extent, layers present in the map, widgets and more (additional information can be found in the Maps Configuration section of the Developer Guide).</li> </ul> <p>Adding a MapStore configuration file the behavior is similar to the following:</p> <ul> <li>The  (Web Map Context) file, is a <code>xml</code> format where only WMS layers present in the map are exported including their settings related to projections, coordinates, zoom and extension (additional information can be found in the  Maps Configuration section of the Developer Guide).</li> </ul> <p>Adding a WMC configuration file the behavior is similar to the following:</p> <p>Warning</p> <p>Adding a map context file the current map context will be overridden.</p>"},{"location":"user-guide/import/#import-vector-files","title":"Import vector files","text":"<p>Importing vector files, the Add Local Vector Files window opens:</p> <p></p> <p>In particular, from this window, it is possible to:</p> <ul> <li> <p>Choose the layer (when more than one layer is import at the same time)</p> </li> <li> <p>Set the layer style or keep the default one</p> </li> <li> <p>Toggle the Zoom on the vector files</p> </li> </ul> <p>Once the settings are complete, the vector files can be finally added to the map with the  button that makes them available as new vector layers in TOC.</p> <p>Warning</p> <p>Currently is not possible to read the Attribute Table of the imported vector files and for this reason also the Layer Filter and the creation of Widgets are not allowed for those layers.</p>"},{"location":"user-guide/layer-settings/","title":"Layer Settings","text":"<p>In this section, you will learn how to manage the layer settings in terms of general information, display mode, style and feature Info.  Since a layer is added to the TOC it is possible to access its settings with the dedicated button  that appears selecting a layer:</p> <p></p> <p>The layer settings panel is composed of four sections:</p> <p></p> <ul> <li> <p>General information</p> </li> <li> <p>Display</p> </li> <li> <p>Fields</p> </li> <li> <p>Style</p> </li> <li> <p>Feature Info</p> </li> </ul> <p>Warning</p> <p>For WMTS layers the Fields, the Style and the Feature Info sections are not implemented. Moreover the Display section is limited to the Transparency layer parameter.</p>"},{"location":"user-guide/layer-settings/#general-information","title":"General information","text":"<p>By default, as soon as the user opens the layer settings panel the General information section appears:</p> <p></p> <p>In this page it is possible to:</p> <ul> <li> <p>Change the Title</p> </li> <li> <p>Set the translation of the layer title by opening the Localize Text popup through the  button. This way the language of the title changes according to the  current language setting in MapStore</p> </li> </ul> <ul> <li> <p>Take a look at the Name of the layer</p> </li> <li> <p>Edit the layer's Description</p> </li> <li> <p>Set the layer Group</p> </li> <li> <p>Configure the Tooltip that appears moving the cursor over the layer's item in TOC. In this case the user can decide that the Title, the Description, both or nothing will be displayed. Moreover you can set the Placement of the tooltip, choosing between Top, Right or Bottom:</p> </li> </ul> <p></p> <p>Setting a tooltip that shows the Title and the Description on the Right, for example, it can be similar to the following:</p> <p></p> <ul> <li>Disable editing on attribute table. This option allows to disable the editing function in Attribute Table. In case a layer has been set as read-only through this option, the  icon will not be available in the Attribute Table and in theIdentify panel for the selected layer. This option is unchecked by default and it can be controlled only by users with editing permissions on the map.</li> </ul>"},{"location":"user-guide/layer-settings/#display","title":"Display","text":"<p>Through the second section of the layer settings panel it is possible to change the display settings:</p> <p></p> <p>In particular, the user is allowed to:</p> <ul> <li>Set the image format: choosing between <code>png</code>, <code>png8</code>, <code>jpeg</code>, <code>vnd.jpeg-png</code>, <code>vnd.jpeg-png8</code> and <code>gif</code></li> </ul> <p>Note</p> <p>The list of available format is the same of the related catalog source. Therefore, for WMS services, the updated list of formats supported by the WMS server is used.</p> <ul> <li>Set the size of layer tiles: choosing between <code>256</code> or <code>512</code></li> </ul> <p>Warning</p> <p>The Format and Layer tile size options are available only for the layers added from CSW and WMS catalog sources.</p> <ul> <li> <p>Set the opacity value of the layer (in %)</p> </li> <li> <p>Enable/disable the Visibility limits to display the layer only within certain scale limits. The user is allowed to request the <code>MinScaleDenominator</code> and  <code>MaxScaleDenominator</code> value present on the WMS GetCapabilities of the layer though the  button or set the Max value and the Min value and select the Limits type choosing between <code>Scale</code> or <code>Resolution</code>.</p> </li> <li> <p>Enable/disable the transparency for that layer</p> </li> <li> <p>Decide to display the image as a single tile or as multiple tiles</p> </li> <li> <p>Enable/disable the localized style. If enabled allows to include the MapStore's locale in each GetMap, GetLegendGraphic and GetFeatureInfo requests to the server, as explained in the WMS Catalog Settings</p> </li> <li> <p>Enable/disable the Force proxy layer option. If enabled, forces the application to check the source and applies proxy if needed.</p> </li> <li> <p>Enable/disable the use of the layer cached tiles. If checked, the Tiled=true URL parameter will be added to the WMS request to use tiles cached with GeoWebCache. When the Use cache options is enabled, more controls are enabled so that it is possible for the user to check if the current map settings match any GWC standard Gridset defined on the server side for the given WMS layer (Check available tile grids information ). At the same time, it is also possible to change the setting strategy (based on the WMTS service response) to strictly adapt layer settings on the client side to the ones matching any remote custom Gridset defined for the current map settings (Use remote custom tile grids  button).</p> </li> </ul> <p>Note</p> <p>When the Check available tile grids information  button is clicked, an info icon  appears to inform the user if the current map settings (Projection, Tile size, Image Format) are properly matching the ones of the given Tile Grids defined on the server side configuration for the layer.</p> <p></p> <p>When the Use remote custom tile grids button is enabled, it turns green  and a WMTS request is performed by MapStore to fetch precise information to more finely adapt the layer settings on the client side to the ones of the matching Tile Grid defined on the server. The scope of the info icon  in this case is still the same but through this strategy MapStore provides a finer tuning of the client side layer settings to better fit the tile grid defined on the server side and so provide better accuracy of cache matching.</p> <p></p> <p>In case the current map/layer settings (Projection, Tile size, Image Format) do not match any of the server-side defined Tile Grids for the given layer the Info panel shows a warning message to indicate the reason for the mismatch so that it is possible for the user to change the needed setting accordingly (for example changing the map projection or selecting a different tile size and/or tile format).</p> <p></p> <p>Warning</p> <p>The Gridset compatibility check made by MapStore whose result is shown by the Info tooltip, is usually quite reliable but should be considered anyway only to provide general matching indicators aimed at highlighting possible compatibility issues between the current layer/map settings and the remote Tile Grid. Due to the cache tolerance considered on the server side by GWC, it might even happen in some cases that the settings available on the client side don't HIT the tile cache even if all the checks listed are successful. At the same time, when the standard gridset is used, gridsets check may fail even if all WMS request are effectively HITTING the cache (e.g. because the WMTS reports a list of origins).</p> <ul> <li>Enable/disable the Interactive legend. If this option is enabled, legend entries with an associated valid filter are displayed as toggleable items inside the TOC, a user can click on these legend items to filter the content of the layer. An example can be the following one:</li> </ul> <p>Note</p> <p>Any type of Filter applied to the layer remains active when the legend filter is activated on the same layer.</p> <p>Warning</p> <p>The Interactive legend is an experimental option and it is disabled by default. The flag <code>miscSettings.experimentalInteractiveLegend</code> inside localConfig must be set to true to enable this functionality. The Interactive legend is available only for GeoServer WMS layers that support the json format for GetLegendGraphic requests.</p> <ul> <li> <p>Set the layer Legend with custom Width and Height options. Both of these field values if greater than the default legend's size of 12, then the custom values gets applied on the legend width and height display property</p> </li> <li> <p>A preview of the legend is shown with the applied custom values from Legend fields above.</p> </li> </ul> <p>Warning</p> <p>The Format and Layer tile size options are available only for the layers added from CSW and WMS catalog sources.</p>"},{"location":"user-guide/layer-settings/#display-tab-for-other-layer-types","title":"Display tab for other layer types","text":""},{"location":"user-guide/layer-settings/#3d-tiles-layer","title":"3D Tiles layer","text":"<p>On the Display tab, only the following options are available for a 3D Tile layer:</p> <p></p> <ul> <li> <p>The Visibility limits to display the layer only within certain scale limits, as reported above.</p> </li> <li> <p>The Height Offset above the ground.</p> </li> <li> <p>The Format choosing between <code>3D Model</code> and <code>Point Cloud</code>. The Point Cloud option allows the user to customize the <code>Maximum Attenuation</code> of the points based on the distance from the current viewpoint and customize the <code>Lighting strength</code> and the <code>Lighting radius</code> to improve visualization of the point cloud.</p> </li> </ul> <p></p>"},{"location":"user-guide/layer-settings/#cog-layer","title":"COG layer","text":"<p>On the Display tab, only the following options are available for a COG layer:</p> <p></p> <ul> <li> <p>The Opacity to change the layer opacity.</p> </li> <li> <p>The Visibility limits to display the layer only within certain scale limits, as reported above.</p> </li> </ul>"},{"location":"user-guide/layer-settings/#ifc-layer","title":"IFC layer","text":"<p>On the Display tab, only the following options are available for a IFC layer:</p> <p></p> <ul> <li> <p>The Visibility limits to display the layer only within certain scale limits, as reported above.</p> </li> <li> <p>The Center Longitude to change the center longitude of the layer (<code>DD</code>).</p> </li> <li> <p>The Center Latitude to change the center latitude of the layer (<code>DD</code>).</p> </li> <li> <p>The Height to set the layer height from the ground (<code>m</code>).</p> </li> <li> <p>The Heading to set the layer heading (<code>DD</code>).</p> </li> </ul>"},{"location":"user-guide/layer-settings/#fields","title":"Fields","text":"<p>From this section of the Settings panel, MapStore allows the user to add aliases to layer fields.</p> <p></p> <p>The panel shows the fields (feature attributes) of the layer. For each field the following are specified:</p> <ul> <li>the Name of the field</li> <li>the Alias of the field, which by default is empty</li> <li>the Type of field</li> </ul> <p>The Name and the Type of the field cannot be modified, while the alias can be specified by the user.</p> <p>Using the Localize  button, a popup opens so that it is possible to configure the alias of the field as well as its translations.</p> <p></p> <p>Setting the aliases, it is possible to configure the desired attribute names to be shown in all supported MapStore tools for this functionality and manage related translations accordingly.</p> <p>The aliases configured in Layers Settings will be used for the following supported MapStore tools:</p> <ul> <li>Attribute Table</li> </ul> <ul> <li>Filter layer</li> </ul> <ul> <li>Identify (only <code>properties</code> output format)</li> </ul> <ul> <li>Visual Style Editor</li> </ul> <ul> <li>Charts Widget and Table Widget</li> </ul> <p>Through the toolbar available on the top-center of the Fields panel, it is possible to:</p> <p></p> <ul> <li> <p>Reload the list of fields from the data source using the  button</p> </li> <li> <p>Clear all customization in the UI by using the  button</p> </li> </ul>"},{"location":"user-guide/layer-settings/#style","title":"Style","text":"<p>The third section, dedicated to the layer style, displays like the following:</p> <p></p> <p>In this case the user is allowed to:</p> <ul> <li> <p>Search through the available layer styles and select the desired one</p> </li> <li> <p>Create a new style</p> </li> <li> <p>Edit an existing style</p> </li> <li> <p>Delete an existing style</p> </li> </ul> <p>Note</p> <p>By the default service security rules the GeoServer's REST APIs are available only for the GeoServer administrators, so a basic authentication form will appears in MapStore to enter the Admin credentials. Without Admin rights, the editing capabilities on styles are not available and only the list of available styles will appear to allow the user to select one of them to the layer.</p> <p>Take a look at the User Integration with GeoServer section of Developer Guide in order to understand how to configure the way MapStore and GeoServer share users, groups and roles. If the users integration between GeoServer and MapStore is configured, the editing functionalities of the styles will be available according to the role of the authenticated user in MapStore in a more transparent way.</p>"},{"location":"user-guide/layer-settings/#create-a-new-style","title":"Create a new style","text":"<p>It is possible to create a new style with a click on the  button. At this stage the user can choose between different types of template from which the customization will start:</p> <ul> <li> <p>CSS - Cascading Style Sheet (a language used for describing the presentation of a document written in a markup language like the HTML)</p> </li> <li> <p>SLD - Styled Layer Descriptor (an XML schema specified by the Open Geospatial Consortium OGC for describing the appearance of map layers)</p> </li> </ul> <p></p> <p>Note</p> <p>The availability of the style formats depends, firstly, from the GeoServer. MapStore, by default, will add all the supported format that the server provides. To edit or create styles using the CSS format the CSS extension must be installed in GeoServer</p> <p>Once the new style is chosen, with a click on the  button the following window opens:</p> <p></p> <p>Here the user can set the Title and the Abstract (optional), and through the Save button the new style will be automatically added to the styles list.</p>"},{"location":"user-guide/layer-settings/#edit-an-existing-style","title":"Edit an existing style","text":"<p>Existing styles can be edited clicking on the  button. The page that opens allows the user to customize the style in the related format:</p> <p>The editor is easy to approach thanks also to the following functions:</p> <ul> <li>The sintax control highlights any possible error with a red underline (if error are detected an icon with a red exclamation point  will be shown in the top-right side of the editor)</li> </ul> <p></p> <ul> <li>The autocomplete function suggests the possible style's properties in order to prevents syntax errors:</li> </ul> <p></p> <ul> <li>The color picker, that can be activated through the square filled icon () near the color code, helps in choosing colors directly from the editor, showing an interface like the following:</li> </ul> <p></p> <p>Warning</p> <p>The autocomplete and the color picker functions are available only in the CSS editor.</p>"},{"location":"user-guide/layer-settings/#visual-editor-style","title":"Visual Editor Style","text":"<p>MapStore also allows to edit the layers style using a Visual editor with a most user friendly UI.Clicking on the  button a section opens so that the user can customize the style through with a visual style editor by adding/editing symbolizers, which can be: Mark, Icon, Line, Fill and Text. It is anyway possible to switch to the text editor mode if necessary for a more complex styling.</p> <p></p> <p>Once a symbolizer has been added and customized, you can:</p> <p></p> <ul> <li> <p>Filter the style rule, as explained here, in order to apply the style only to certain layer features. It is possible clicking on the  button.</p> </li> <li> <p>Add a Scale denominator filter (<code>max</code> and <code>min</code> scale) to visualize the style rule only within certain scale limits. This is possible by clicking the  button.</p> </li> <li> <p>Remove the symbolizer by clicking the  button.</p> </li> </ul>"},{"location":"user-guide/layer-settings/#mark","title":"Mark","text":"<p>The mark type allows you to add a mark to the layer: clicking on the  button a mark panel appears:</p> <p></p> <p>The mark can have different <code>Shape</code>, <code>Color</code>, <code>Stroke</code> with different <code>Color</code> and <code>Width</code> and customizable <code>Radius</code> and <code>Rotation</code>. Take a look at the following example.</p> <p></p>"},{"location":"user-guide/layer-settings/#icon","title":"Icon","text":"<p>With the icon panel, which opens by clicking on  button, the style editor is allowed to add an image as an icon (by specifying its URL) and customize the icon <code>Opacity</code>, <code>Size</code> and <code>Rotation</code> angle:</p> <p></p>"},{"location":"user-guide/layer-settings/#line","title":"Line","text":"<p>The line rule is used to style linear features of the layer: clicking on the   button a panel allows the user to edit the corresponding properties.</p> <p></p> <p>The editor can change the <code>Stroke color</code>, the <code>Stroke width</code>, the <code>Line style</code> (continuous, dashed, etc), the <code>Line cap</code> (Butt, Round, Square) and the <code>Line join</code> (Bevel, Round, Miter). An example can be the following one:</p> <p></p>"},{"location":"user-guide/layer-settings/#fill","title":"Fill","text":"<p>The Fill rule is used to style polygon features. Clicking on  button, the editor is allowed to customize the <code>Fill color</code>, the <code>Outline color</code> and the <code>Outline width</code>:</p>"},{"location":"user-guide/layer-settings/#text","title":"Text","text":"<p>The Text rule is used to style features as text labels. Text labels are positioned either at points or along linear paths derived from the geometry being labelled. Clicking on the  button a specific panel opens:</p> <p></p> <p>The editor is allowed to type the name of the layer attribute to use for the <code>Label</code> and the dropdown list is filtered accordingly to show the existing attributes that are matching the entered text (the user can anyway directly select an attribute from the list). Moreover, the style editor can customize the <code>Font Family</code> (DejaVu Sans, Serif, etc), choose the font <code>Color</code>, <code>Size</code>, <code>Style</code> (Normal or Italic) and <code>Halo weight</code> (Normal or Bold) and select the desired <code>Halo color</code> and <code>Halo weight</code>. It is also possible to choose the text <code>Rotation</code> and <code>Offset</code> (x and y). En example can be the following one</p>"},{"location":"user-guide/layer-settings/#style-methods-for-vector-layer","title":"Style Methods for Vector layer","text":"<p>Different styles methods can be used for each style rule. Clicking on the  button, available on top of the panel of each symbolizer, the editor can choose one of the following depending on the rule type:</p> <ul> <li> <p>Simple style</p> </li> <li> <p>Classification style</p> </li> <li> <p>Pattern mark style  (available only for rules of type Line and Fill)</p> </li> <li> <p>Patter icon style  (available only for rules of type Line and Fill)</p> </li> </ul>"},{"location":"user-guide/layer-settings/#simple-style","title":"Simple style","text":"<p>The Simple style is the default style described above for each symbolizer.</p>"},{"location":"user-guide/layer-settings/#classification-style","title":"Classification style","text":"<p>MapStore allows you to classify the style based on the attributes of the layer. The Classification style is available for Marker, Line, Fill and Text by clicking on the  button and choosing the Classification style options from the dropdown menu.</p> <p></p> <p>It this case the editor is allowed to choose a <code>Color ramp</code> and the order (with <code>Reverse order</code>) of the classification intervals colors. It is obviously possible to select the layer <code>Attribute</code> to use for the classification along with the classification <code>Method</code> (Quantile, Equal interval, Natural breaks and Standard deviation), the number of classification <code>Intervals</code> and the <code>Opacity</code> (%) of each interval range. An example of the Classification style for a Fill rule type can be the following one:</p> <p></p> <p>Note</p> <p>The Classification style method is available for WMS,  WFS and Vector layers. In case of WMS layers the Classification style can work only against GeoServer where the SLD Service module need to be installed. In case of WFS and Vector layers, the same classification capabilities are entirely managed client.</p> <p>Note</p> <p>From the Classification style options, it is also possible to manage Custom Parameter thought the  button. That's really useful to style SQL Views defined in GeoServer by using one of the available viewparams </p> <p>Here the user can add custom parameters that will be visible in the Visual Style Editor, above the Color Palette option. The Custom Parameters requires an array of fields to be configured according to the available viewparams defined in the SQL View. </p> <p></p>"},{"location":"user-guide/layer-settings/#pattern-mark-style","title":"Pattern mark style","text":"<p>With the Pattern mark style it is possible to represent Line or Fill  style rules with a mark by clicking on the  button and choosing the Pattern mark style options from the dropdown menu.</p> <p></p> <p>The style editor can configure a Mark as explained here along with the usual options available for rules of type line or fill depending on the selected symbolizer. Take a look at the following example of the Pattern mark style for the Line rule sample.</p> <p></p>"},{"location":"user-guide/layer-settings/#patter-icon-style","title":"Patter icon style","text":"<p>With the Pattern icon style  it is possible to represent Line or Fill style rules with an icon by clicking on the  button and choosing the Pattern icon style options from the dropdown menu.</p> <p></p> <p>The style editor can configure the Icon as explained here along with the usual options available for rules of type line or fill depending on the selected symbolizer. Take a look at the following example of Pattern icon style for a Fill rule sample.</p> <p></p>"},{"location":"user-guide/layer-settings/#style-with-property-value","title":"Style with property value","text":"<p>MapStore allows you to use a property of the layer feature as value for a symbolizer property. The Property value function is available for Marker, Icon, Line, Fill, Text and 3D model by clicking on the  button of each symbolizer property supporting it.</p> <p></p> <p>By default, Constant value is selected. If the user chooses Property value, a drop-down menu appears so that the desired layer attribute can be selected to use its values for the styling property.</p> <p>Warning</p> <p>As a Property value only attributes of type <code>string</code> or <code>number</code> are currently supported.</p> <p>Note</p> <p>The Style with property method is available only for WFS and Vector layers.</p>"},{"location":"user-guide/layer-settings/#style-methods-for-raster-layer","title":"Style Methods for Raster layer","text":"<p>MapStore also allows to edit the Raster Layers style using a Visual editor. Through the  button, available on top of the panel, the editor can choose one of the following styles methods:</p> <ul> <li>Single band</li> <li>RGB bands</li> <li>Pseudo color</li> </ul>"},{"location":"user-guide/layer-settings/#single-band","title":"Single band","text":"<p>The Single band is the default one and here the user can  choose the Channel to customize selecting the Contrast enhancement choosing between <code>None</code>, <code>Normalize</code> and <code>Histogram</code> and the change the Opacity. Take a look at the following example.</p> <p></p>"},{"location":"user-guide/layer-settings/#rgb-bands","title":"RGB bands","text":"<p>With the RGB bands the user can customize the three Channels of the layer, if they are available, and for each one selecting the Contrast enhancement choosing between <code>None</code>, <code>Normalize</code> and <code>Histogram</code> and the change the Opacity. Take a look at the following example.</p> <p></p>"},{"location":"user-guide/layer-settings/#pseudo-color","title":"Pseudo color","text":"<p>With the Pseudo color the user has the possibility to customize the Single band with a Color ramp. In this case, in addition to choosing Channels, Contrast enhancement and Opacity, the user can select Color ramp, enable Reverse order and the Continuous Colors, choose the Color map type (<code>Ramp</code>, <code>Intervals</code> and <code>Values</code>), the Method (<code>Quantile</code>, <code>Natural breaks</code>, <code>Equal interval</code> and <code>Unique interval</code>) and modify the Intervals. Take a look at the following example.</p> <p></p>"},{"location":"user-guide/layer-settings/#styling-for-cog-layer","title":"Styling for COG layer","text":"<p>With the Visual Style Editor, the editor has the ability to customize the style of COG layers:</p> <p></p> <p>Enabling the Band styling section, here the editor can associate the Channels (<code>Red</code>, <code>Green</code>, <code>Blue</code> and <code>Alpha</code>) to the Bands of the COG layer and set the minimum (Min) and maximum (Max) source data value. Take a look at the following example.</p>"},{"location":"user-guide/layer-settings/#styling-on-the-3d-navigation","title":"Styling on the 3D navigation","text":"<p>Thanks to the new improvements made to the Visual Style Editor editor, when 3D Navigation is enabled, the editor has the ability to customize the style of 3D Tiles and vector layers.</p>"},{"location":"user-guide/layer-settings/#styling-of-3d-tiles-layer","title":"Styling of 3D Tiles layer","text":"<p>With MapStore it is possible to customize the style of a 3D Tiles layer client side. The MapStore support is working in respect of the 3D Tiles Specification 1.0 and on top of the Cesium Styling capabilities. Below is an example of how the Style Editor of a 3D Tiles layer is appearing in the MapStore UI.</p> <p></p> <p>For the 3D Tiles styling, while with the Code Text Editor it is possible to leverage completely on the styling specifications:</p> <p></p> <p>The MapStore Visual Style Editor supports for now only a limited set of capabilities:</p> <ul> <li>Customization of the Fill color</li> </ul> <ul> <li>Style Rule filtering based on the available properties dictionary defined in the tileset.json</li> </ul> <p></p> <ul> <li>Possibility to customize the radius in case of point cloud features</li> </ul> <p></p> <p></p>"},{"location":"user-guide/layer-settings/#styling-of-vector-layer","title":"Styling of Vector layer","text":"<p>In 3D mode MapStore allows to customize the style of the Vector layer through the Visual Style Editor using the same styling options available in 2D mode as described in the previous chapter.</p> <p>In addition the 3D model rule type is also available. From the Visual Style Editor, by clicking on  button, the 3D model symbolizer panel opens to allow adding a 3D model (based on glTF, GLB is also allowed) as an external graphic by specifying its URL (see also the Cesium documentation). Furthermore, it is possible to customize the 3D model <code>Scale</code>, <code>X/Y/Z Rotation</code>, <code>Color</code> and <code>X/Y Translation</code> of the model's external graphic. Take a look at the following example.</p> <p>Warning</p> <p>For the Vector layer, the Visual Style Editor have some limitations:</p> <ul> <li> <p>It's possible to apply only one type of symbolizer at the time, so if the rule editor shows multiple rule with the same filter, only the first one is used.</p> </li> <li> <p>For the Line symbolizers: the Line cap and Line join options are not available as properties in Cesium</p> </li> </ul> <p>Furthermore, for WFS layers, MapStore adds some additional styling options in the Visual Style Editor such as:</p> <ul> <li>Bring to front (available for Icon, Mark and 3D model symbolizers) to bring in front and so to make visible (if enabled) all features covered by 3D Tile layers and the Terrain layer (for this last case when the depth test against terrain option is enabled in Global Settings).</li> </ul> <p></p> <ul> <li>Height reference from ground (available for Mark, Icon, 3D Model and Text symbolizers) to indicate the reference for the point height between <code>None</code> (to the absolute zero of the ground), <code>Relative</code> (to the terrain layer level) or <code>Clamp</code> (the feature is clamped to the Terrain, if present, or to the ground). It is also possible to finely configure the Height value of the point symbols by choosing between one of the attributes of the feature (where Point height indicates the intrinsic height of the feature geometry) selecting Attribute Value or choosing Constant Value that allows to set the raw value of the height.</li> </ul> <p></p> <ul> <li>Leader line (available for Mark, Icon, 3D Model and Text symbolizers) to add a line to connect the point symbol with the Terrain/Ground to have a more clear reference of the effective point position when the camera orientation change. The editor can choose the Width of the line and the Color through the usual color picker.</li> </ul> <p></p> <ul> <li>Clamp to ground to enable/disable the boolean property specifying whether the line or polygon features should be clamped to the ground (this option is available for Line and Fill symbolizers).</li> </ul> <p></p> <ul> <li>Clamp to ground reference to choose whether the drape effect, should affect <code>3D Tiles</code>, <code>Terrain</code> or <code>Both</code>. This option is available for Fill symbolizers and it is only enabled when the Clamp to ground option is set to <code>True</code></li> </ul> <p></p> <ul> <li>Extrusion Height (available for Line and Fill symbolizers) to configure the height value of the feature to be extruded. It is also possible to enable/disable the Extrusion relative to geometry (from the highest point of the feature geometry) and, only for the Line symbolizers, the user can customize the Extrusion color and the Extrusion type, choosing between <code>Wall</code>, <code>Circle</code> and <code>Square</code> options, for the extruded features.</li> </ul> <p></p>"},{"location":"user-guide/layer-settings/#feature-info-form","title":"Feature Info Form","text":"<p>Through the last section of the layer settings panel, it is possible to decide the information format that appears querying a layer with the Identify Tool:</p> <p></p> <p>In particular, the user can choose between:</p> <ul> <li> <p>Disable Identify to disable the Identify for the layer</p> </li> <li> <p>Text</p> </li> <li> <p>HTML</p> </li> <li> <p>Properties</p> </li> <li> <p>Template</p> </li> </ul> <p>Note</p> <p>Without selecting any format here, the Identify Tool will return the layers information with the format chosen in Map Settings ( in the Side Toolbar). Once a user specifies the information format in layers settings, instead, that format will take precedence over the map settings only for that specific layer.</p> <p>Note</p> <p>From the Layer Settings panel, MapStore allows users to choose the Information format for <code>WMS</code> and <code>WFS</code> layer types. The Text option is only available for <code>WMS</code> layers, while the HTML option for <code>WFS</code> layers is available only with GeoServer and if the <code>wfs-freemarker</code> extension is installed on the GeoServer side.</p>"},{"location":"user-guide/layer-settings/#text_1","title":"Text","text":"<p>An example of layer information in text format can be:</p> <p></p>"},{"location":"user-guide/layer-settings/#html","title":"HTML","text":"<p>An example of layer information in HTML format can be:</p> <p></p>"},{"location":"user-guide/layer-settings/#properties","title":"Properties","text":"<p>An example of layer information in properties format can be:</p> <p></p>"},{"location":"user-guide/layer-settings/#templates","title":"Templates","text":"<p>In this case the user can customize the information format:</p> <p></p> <p>In particular, by clicking on the  button, the following text editor appears:</p> <p></p> <p>Note</p> <p>Clicking on the  button, the Identify Template editor allows to insert images in different ways:</p> <ul> <li> <p>Using direct URLs of resources available on the web</p> </li> <li> <p>Using URIs encoded in base64</p> </li> <li> <p>Parsing needed image URLs from available feature attributes (eg. attributes with URL value). The usual syntax can be used in this case to refer the attribute value (eg. <code>${properties.IMAGE}</code>)</p> </li> <li> <p>Parsing image URIs encoded in base64 from available feature attributes (eg. attributes with base64 URIs values). The usual syntax can be used in this case to refer the attribute value (eg. <code>${properties.IMAGE}</code>)</p> </li> </ul> <p></p> <p>Here it is possible to insert the text to be displayed through the Identify Tool, with the possibility to wrap the desired properties.  Let's make an example: we assume to have a layer where each record corresponds to a USA State geometry in the map. In the Attribute Table of this layer there's the <code>STATE_NAME</code> field that, for each record, contains a text value with the name of the State.  If the goal is to show, performing the Identify Tool, only the State name, an option could be to insert the following text on the Template text editor:</p> <p></p> <p>In this case, by clicking on the map, the Identify Tool returns:</p> <p></p> <p>Using the <code>${properties.NAME_OF_THE_FIELD}</code> syntax, MapStore is able to parse the response to the Identify Tool request by matching the configured placeholder.</p>"},{"location":"user-guide/longitudinal-profile/","title":"Longitudinal Profile","text":"<p>Given a DEM or a bathymetric layer as a source and a provided path on it, this tool allows to calculate the Longitudinal Profile and display it within an interactive chart.</p> <p>Note</p> <p>The Longitudinal Profile is not included by default in the MapStore configuration but it can be configured within an application contexts if needed. The plugin works only if the Longitudinal Profile WPS process is properly installed in GeoServer. Look at the official online documentation to learn more about this process and how to install it. The GeoServer module of the Longitudinal profile is available from Geoserver v2.20.x of Aug 2023.</p> <p>By clicking the Longitudinal Profile  button, available in the Side Toolbar, a drop down menu opens so that the user can manage the available options including different ways to calculate the profile:</p> <p></p> <ul> <li>It is possible to draw a line directly on the map through  button</li> </ul> <ul> <li>In alternative it is also possible to import a linear profile as a vector file (available formats for this are <code>GeoJSON</code>, <code>ShapeFile</code> or <code>DXF</code>),  through  button</li> </ul> <ul> <li>Finally, through  button, the user can also select a vector linear layer in TOC and then select the line feature representing the desired profile path on map.</li> </ul>"},{"location":"user-guide/longitudinal-profile/#chart","title":"Chart","text":"<p>When the geometry of the profile path has been drawn on the map, the Longitudinal Profile panel opens and the  chart appears in the Chart tab.</p> <p></p> <p>While the X axis indicates the distance from the starting point of the provided path, the Y axis indicates instead the height of points along the profile calculated from the provided path.  The user can hover over the chart to interact between the chart and the line of the map as follows:</p> <p>The Chart toolbar, displayed in the right corner of the chart, allows the user to:</p> <p></p> <ul> <li> <p>Download the chart as a <code>png</code> through the  button.</p> </li> <li> <p>Zoom the chart through the  button.</p> </li> <li> <p>Pan the chart through the  button.</p> </li> <li> <p>Zoom in the chart through the  button.</p> </li> <li> <p>Zoom out the chart through the  button.</p> </li> <li> <p>Autoscale to autoscale the axes to fit the plotted data automatically through the  button.</p> </li> <li> <p>Reset axes to return the chart to its initial state through the  button.</p> </li> </ul> <p>MapStore also allows to Export the Longitudinal Profile as<code>DXT</code>,<code>CSV</code>,<code>GeoJSON</code>,<code>PNG</code>,<code>PDF</code> or <code>CSV</code> file.</p> <p></p>"},{"location":"user-guide/longitudinal-profile/#information","title":"Information","text":"<p>In the Information tab are reported all relevant indicators related to the longitudinal profile calculation. In particular it is reported:</p> <p></p> <ul> <li> <p>The  layer used to calculate the profile</p> </li> <li> <p>Total linear length of the profile</p> </li> <li> <p>Cumulative elevation gain</p> </li> <li> <p>Cumulative elevation loss</p> </li> <li> <p>Number of points processed (the number of points varies according to the pitch chosen).</p> </li> </ul>"},{"location":"user-guide/longitudinal-profile/#setting-parameters","title":"Setting Parameters","text":"<p>Through the  button it is possible to tune the profile properties. The available parameters used to calculate the longitudinal profile are:</p> <p></p> <ul> <li> <p>The Profile layer choosing between the available layer on the dropdown menu</p> </li> <li> <p>The Distance choosing the maximum distance between two points along the profile (in <code>m</code>)</p> </li> <li> <p>The Chart Title to be used  in the UI on the top of the chart.</p> </li> </ul> <p></p>"},{"location":"user-guide/managing-contexts/","title":"Managing Contexts","text":"<p>In MapStore the Application Context Manager is an administrative tool designed to build and configure MapStore's viewers: the administrator is able to configure a custom MapStore viewer by choosing:</p> <ul> <li>The name of the context (the viewer will have its own specific URL)</li> <li>The default map configuration and map contents (like layers, backgrounds, catalogs, CRSs etc)</li> <li>The set of plugins available for the viewer</li> </ul> <p>The Admin can access the Application Context Manager through the  button available in the Manager  option menu  in Homepage.</p> <p></p> <p>In this page the administrator can:</p> <ul> <li>Perform a search among the existing contexts</li> </ul> <p></p> <ul> <li>Create an Application context through the  button</li> </ul> <p>In each context's card the administrator can:</p> <p></p> <ul> <li> <p>Remove the context through the Delete button </p> </li> <li> <p>Edit the context through the Edit context button </p> </li> <li> <p>Open the Edit properties through the Edit properties button  </p> </li> <li> <p>Sharing the context through the Share button </p> </li> </ul>"},{"location":"user-guide/managing-groups/","title":"Managing Groups","text":"<p>The Groups Manager section displays like the following:</p> <p></p> <p>Similar to what happens for the Users Manager, in this page the Admin can:</p> <ul> <li>Perform a search among the existing groups</li> </ul> <p></p> <ul> <li> <p>Create a new group with the New Group button </p> </li> <li> <p>Edit or remove an existing one, through the Edit group  and Delete group  buttons on each group card:</p> </li> </ul> <p></p> <p>Both the New Group  and the Edit group  buttons, open the Group editor window that is composed of two sections:</p> <ul> <li> <p>Group ID</p> </li> <li> <p>Members manager</p> </li> <li> <p>&gt;Attributes</p> </li> </ul>"},{"location":"user-guide/managing-groups/#group-id","title":"Group ID","text":"<p>As soon as the New Group window opens, the Group ID section is displayed:</p> <p></p> <p>In this section the Admin is allowed to:</p> <ul> <li> <p>Set the Group Name</p> </li> <li> <p>Set the group Description</p> </li> </ul> <p>Warning</p> <p>The Group Name is the only mandatory field.</p>"},{"location":"user-guide/managing-groups/#members-manager","title":"Members manager","text":"<p>Through the Members manager section it is possible to choose which users are part of the group:</p>"},{"location":"user-guide/managing-groups/#attributes","title":"Attributes","text":"<p>On the Attributes tab the admin can associate some attributes to user groups. By default MapStore allows to enter a \"notes\" attribute for each group. The attributes list can be configured by editing the plugin configuration in <code>localConfig.json</code>.</p> <p></p>"},{"location":"user-guide/managing-users-and-groups/","title":"Managing Users and Groups","text":"<p>Accessing MapStore as anonymous user the Login button in Homepage is blue . With a click on it, the following window appears:</p> <p></p> <p>Once the login is made, the same button displays in green  and a click on it opens a list of options:</p> <p></p> <p>Through these options it is possible to:</p> <ul> <li>Get the following Account info: Name, Role, E-mail, Company, Notes and Groups (in order to understand how these info are set see the Managing Users section)</li> </ul> <p></p> <ul> <li>Change Password</li> </ul> <p></p> <ul> <li>Logout</li> </ul> <p>Once logged as Admin, become possible to manage users and groups and the Manage Accounts option appears in Homepage:</p> <p></p> <p>Selecting Manage Accounts options, the Account Manager opens:</p> <p></p> <p>In this page it is possible to switch between Manage Users or Manage Groups sections:</p> <p></p>"},{"location":"user-guide/managing-users/","title":"Managing Users","text":"<p>Switching to Users Manager, the page displayed is the following:</p> <p></p> <p>In this page the Admin can:</p> <ul> <li>Perform a search among the existing users</li> </ul> <p></p> <ul> <li> <p>Create a new user with the New User button </p> </li> <li> <p>Edit or remove an existing one, through the Edit user  and Delete user  buttons on each user card:</p> </li> </ul> <p></p> <p>Both the New User  and the Edit user  buttons, open the User editor window that is composed of three sections:</p> <ul> <li> <p>User ID</p> </li> <li> <p>Other information</p> </li> <li> <p>Group membership</p> </li> </ul>"},{"location":"user-guide/managing-users/#user-id","title":"User ID","text":"<p>As soon as the New User window opens, the User ID section is displayed:</p> <p></p> <p>In this section the Admin is allowed to:</p> <ul> <li> <p>Set the Username</p> </li> <li> <p>Set the Password</p> </li> <li> <p>Select the User role (Normal user or Admin)</p> </li> <li> <p>Choose if an user is Enabled or not. Enabled users will have a green status icon under their profile, otherwise disabled users will have a red status and will not be able to log in.</p> </li> </ul> <p></p> <p>Warning</p> <p>Username and Password are the only mandatory fields. The password must contain at least 6 characters.</p>"},{"location":"user-guide/managing-users/#other-information","title":"Other information","text":"<p>Switching to Other information section, it display the following:</p> <p></p> <p>Here the Admin can set:</p> <ul> <li> <p>Email</p> </li> <li> <p>Company</p> </li> <li> <p>Notes</p> </li> </ul>"},{"location":"user-guide/managing-users/#group-membership","title":"Group membership","text":"<p>Through the last section of the window it is possible to manage the groups in which the user belongs to:</p> <p>Note</p> <p>The everyone group, set by default, it is impossible to remove since it must be attributed to all users.</p>"},{"location":"user-guide/map-catalog/","title":"Map Catalog","text":"<p>The Map Catalog is an extension that can be included in the step #3 of the application context wizard to allow the end user to browse the existing MapStore maps directly inside the viewer itself. The  button, present in the Side Toolbar, provides to the user the list of the MapStore maps that are also available in Homepage.</p> <p></p> <p>The Map Catalog panel allows the user to select a map and loaded it in the same browser page, as follows:</p> <p>Note</p> <p>Selecting a map card in the Map Catalog list, the map currently in use will be replaced. In addition, if the selected map has been created in a context, also the viewer will be replaced with the one of the related map context.</p> <p>For each map in the Map Catalog list the following buttons are displayed:</p> <p></p> <ul> <li> <p>The Delete button  allows the user to remove the map</p> </li> <li> <p>The Edit Properties button  allows the user to Edit Properties of the map</p> </li> <li> <p>The Share button  allows the user to Share the map</p> </li> </ul>"},{"location":"user-guide/map-templates/","title":"Map Templates","text":"<p>This extension allows to browse Map Templates in a MapStore's viewer. Supported Map Templates formats in MapStore are WMC and MapStore's native JSON. The  button, present in the Side Toolbar, provides to the user the list of the available templates.</p> <p></p> <p>For each template in the Map Templates list the following buttons are displayed:</p> <p></p> <ul> <li>The Replace button  allows the user to entirely replace the current map with the one defined in the template, as follows:</li> </ul> <ul> <li>The Add Template button  allows the user to add the map template contents (layers) to current map without replacing it (by default a new group is created in that case in TOC, on top of the other ones, to contains layers coming from the template to better identify them), as follows:</li> </ul> <ul> <li>The Add to favorites button  allows the user to add the template to favorites on top of the list</li> </ul>"},{"location":"user-guide/map-templates/#enabling-the-map-templates-in-a-context","title":"Enabling the Map templates in a context","text":"<p>The Map templates extension is enabled by the admin in the Application Context wizard. In particular, this is possible in the third step of the wizard and after the extension is added to the Enabled Plugins list.</p> <p></p> <p>As soon as the Configure templates button  is selected the Configure templates modal window opens, it allows the admin to manage the map templates.</p> <p></p> <p>Through the Configure Template tool, the administrator can browse existing templates in MapStore and enable them for the context simply by moving the desired ones from the Available Templates list to the Enabled Templates list: this is possible with the central bar, as follows:</p> <p></p>"},{"location":"user-guide/map-templates/#uploading-the-template","title":"Uploading the template","text":"<p>It is possible for the administrator to create new Map Templates in MapStore by uploading new template files. In order to upload a new template the admin can select the Upload new template button  to open the Upload new template window:</p> <p></p> <p>Here the admin, in order to import a template file, can drag and drop it inside the import area or simply click on that area to select it from the folders of the local machine.</p> <p></p> <p>Warning</p> <p>The file that the admin can upload are:</p> <ul> <li> <p>The MapStore native map definition <code>json</code> format</p> </li> <li> <p>The WMC (Web Map Context) file in <code>xml</code> format</p> </li> </ul> <p>The admin can also add Thumbnail, Name, Description and Groups permissions as describe here</p>"},{"location":"user-guide/map-templates/#customize-the-template","title":"Customize the template","text":"<p>The admin can also delete or modify an existing template through the buttons that are available on the left side of each templates item inside the Configure templates UI.</p> <p></p> <p>In particular, the admin can:</p> <ul> <li> <p>Modify the template using the Edit properties that opens by clicking on the Edit properties button </p> </li> <li> <p>Delete the template through the Delete button </p> </li> </ul>"},{"location":"user-guide/map-views/","title":"Map Views","text":"<p>The Map Views is a MapStore tool useful to set up multiple map views differently configured and switch between them. A navigation functionality is also provided to automatically activate each view one after the other in temporal sequence.</p> <p>Note</p> <p>The Map Views plugin works both in 2D and 3D modes, but the 3D mode has advanced options including the Mask, the Globe Translucency and the Clipping (see next paragraph).</p>"},{"location":"user-guide/map-views/#add-new-view","title":"Add new view","text":"<p>Once the user opens a map, the Map Views tools can be opened through the  button available in the Side Toolbar.</p> <p></p> <p>To create a new simple view the user can simply move the map to the interested area, enable the desired layers in TOC to be displayed in the map and finally click on the  button. The view will be created and visible in the Views list by clicking the  button.</p> <p>MapStore allows to customize and edit the new view by opening the Edit panel through the  button. Here the user is allowed to:</p> <ul> <li>Add a text, images, videos or hyperlinks through the Description section. The description is visible during the Views Navigation. Take a look at the following example.</li> </ul> <p></p> <ul> <li>Capture the view positions through the  button or change the longitude, latitude and height of the Camera Position and Center Position  (only available for the 3D mode) by using the Position section.</li> </ul> <p></p> <ul> <li>Modify the duration of the animation and enable/disable the transition effect during the Views Navigation by using the Animation section.</li> </ul> <p></p> <ul> <li>When in 3D mode, use the Mask section to select a WFS or Vector layer available in TOC to create a mask on all the 3D tiles visible in map. The mask layer need to be added to the map before using this functionality so that it is possible to use the layer features as masking areas: if multiple WFS or Vector layers (with polygonal features) are present in the map, these are used all merged together to represent the final masking areas.</li> </ul> <p></p> <p>If the user enables the Inverse option, simply the inverse mask is applied using the same layer so that each feature is used to produce an hole on all visible 3D Tiles.</p> <p></p> <ul> <li>Enable the translucency of the globe through Globe Translucency section so that it is possible to see layers under the globe's surface.</li> </ul> <p></p> <ul> <li>Choose which layer should be visible when the view is active through the Layer Options section. In 2D mode the user can simply enable or disable all the layers present on TOC and change the opacity.</li> </ul> <p></p> <p>Warning</p> <p>In 2D mode, the 3D Tiles and the Terrain layers are not displayed in the Layer Options.</p> <p>In 3D mode, using the same logic described above for the Masking option, it is also possible to Clip (not Mask) each 3D Tiles or Terrain layers using a WFS or a vector layer as a clipping source. Furthermore, in this case the user can also choose which layer feature can be used as Clipping feature.</p> <p>Warning</p> <p>The clipping layer must have polygon convex features. Concave polygons are not supported by this type of clipping.</p> <p>Note</p> <p>Unlike the Mask option, described above, the Clip function is a more narrowly focused tool because:</p> <ul> <li> <p>The clipping are is visible only on the selected 3D Tiles layer and not on the whole view</p> </li> <li> <p>It is possible to select the feature of the WFS or Vector layer that you want to use for the clipping</p> </li> </ul>"},{"location":"user-guide/map-views/#3d-views-navigations","title":"3D Views navigations","text":"<p>Once multiple views are added to the Map Views tool it allows to visualize them in sequence by clicking on the  button. Doing that the presentation mode starts and each view is displayed in the Map Viewer, together with its descriptive panel (if configured) on the left side of the screen, for a time depended on the duration previously configured.</p> <p>The user can also choose to navigate each view manually using the navigation toolbar provided by the tool.</p> <p></p>"},{"location":"user-guide/mapstore-toolbars/","title":"MapStore Toolbars","text":"<p>The main toolbar of MapStore, used by the user to interact on the map viewer, are:</p> <ul> <li> <p>The Search bar</p> </li> <li> <p>The Side toolbar</p> </li> </ul> <p></p>"},{"location":"user-guide/mapstore-toolbars/#search-bar","title":"Search Bar","text":"<p>The search bar is a tool that allows the user to query the layers in order to find a specific information. In MapStore it is possible to perform the search in four different ways:</p> <ul> <li> <p>By Location name</p> </li> <li> <p>By Configuring a search service</p> </li> <li> <p>By Coordinates</p> </li> <li> <p>By Current map CRS</p> </li> <li> <p>By Bookmarks</p> </li> </ul> <p></p>"},{"location":"user-guide/mapstore-toolbars/#search-by-location-name","title":"Search by location name","text":"<p>The Search by location name, set by default when a new map is created, allows the user to search places asking the OpenStreetMap Nominatim search engine. Typing the desired place, the Nominatim seach engine is queried; selecting then the desired record in the list of results, the map is automatically re-center/zoomed to the chosen area that is also highlighted:</p> <p></p>"},{"location":"user-guide/mapstore-toolbars/#configuring-a-search-service","title":"Configuring a search service","text":"<p>MapStore allows the user also to extend or replace the default OSM results with additional WFS Search Services. Selecting the Configure Search Services option , the following window opens:</p> <p></p> <p>In order to create a new custom service, the  button brings the user to a page where he can set the WFS service properties, for example:</p> <p></p> <p>In particular, the information to be entered are:</p> <ul> <li> <p>Name of the service</p> </li> <li> <p>WFS Service URL the user want to call</p> </li> <li> <p>Layer to be queried</p> </li> <li> <p>Specific Attributes (comma separeted fields) the user wants to query</p> </li> </ul> <p>When all the options are set, by clicking on the  button a new panel opens, where it is possible to choose the properties for the displayed results:</p> <p></p> <p>In this case, the user can define the following settings:</p> <ul> <li> <p>The Title displayed on the top of each results row (in the previous image, for  example, the chosen title for the results is the one corresponding to the attribute NAME of the feature)</p> </li> <li> <p>The Description to report in the results just below the title</p> </li> <li> <p>The Priority, a parameter which determines the position of the records in the results list. Lower values imply a higher positions in the results list and vice versa. By default the OpenStreetMap Nominatim search engine result has priority equals to 5, therefore in order to see the custom results in a higher position a lower priority value is needed</p> </li> <li> <p>The Launch Info panel allows the user to chose if and how the custom search interact with the Identify tool. In particular, with the No Info option, the Info panel doesn't show up once a record from the search results is selected. Selecting All Layers or Single Layer the Identify tool is triggered, and the related panel opens displaying the information of all/single layer(s) visible in the map. With Single Layer instead, the Identify tool is triggered only for the layer (if it is present and visible in the map) related to the selected record in the search result list.</p> </li> </ul> <p></p> <p>Note</p> <p>Note that, selecting All Layers or Single Layer options, the point used for Identify request is a point belonging to the surface of the geometry of the selected record. Moreover, using Single Layer, the Identify request will filter results to the selected record and to its layer, using <code>featureid</code> which might be ignored by other servers, but can be used by GeoServer to select the specific feature of the results, when info_format is other than application/json. In order to achieve filtering of feature on servers other than GeoServer, one can select the format (info_format) as application/json for the layer to GetFeatureInfo from the layer settings in TOC to allow filtering features by using the ID of the selected record.</p> <p>Once all the option are set, it is possible to move forward with the Next button  that opens the Optional properties panel:</p> <p></p> <p>Here the user can choose:</p> <ul> <li> <p>To Sort the results by the specified attribute</p> </li> <li> <p>The Max number of features (items) displayed in the custom search results</p> </li> <li> <p>The Max level of zoom to be set for the map when opening from the custom search result</p> </li> <li> <p>The text to insert as placeholder in the Search input when the search service is selected in the Service Menu</p> </li> <li> <p>The text to be inserted as tooltip in the Service Menu is visible by moving the mouse over the search service</p> </li> </ul> <p>After the  it is possible to see the custom WFS search service inside the Available services list:</p> <p></p> <p>Once a search service is created, it is always possible to Edit it  or Remove it  from the list. By default the Override default services option is disabled, in that case performing a search not only the custom search service results are shown, but also the Nominatim ones:</p> <p></p> <p>Once the Override default services option is enabled, only the custom search service results are shown:</p> <p></p> <p>When there are multiple search services defined, by default MapStore performs the search operation on all of them according to the priority configured for each service (see above). Therefore, it is also possible for the user to select the desired search service from the menu to perform the search only on it. Selecting the Search Service Menu button , the following window opens:</p> <p></p> <p>In the Search Menu, the user can choose one of the search services to use to carry out the search by clicking on one of them. An example could be the following:</p>"},{"location":"user-guide/mapstore-toolbars/#search-by-coordinates","title":"Search by coordinates","text":"<p>Performing a Search by coordinates the user can zoom to a specific point and place a marker in its position. That point can be specified typing the coordinates in two different formats:</p> <ul> <li>Decimal (the default format)</li> </ul> <p></p> <ul> <li>Aeronautical (that can be chosen through the  button)</li> </ul> <p></p> <p>Once the coordinates are set, it is possible to perform the search with the  button. The displayed result is similar to the following:</p> <p></p>"},{"location":"user-guide/mapstore-toolbars/#search-by-current-map-crs","title":"Search by current map CRS","text":"<p>MapStore allows the user to Search by current map CRS, which can zoom to a specific point and place a marker in its position. That point can be specified typing the X and Y coordinates of the map. Once the coordinates are set, it is possible to perform the search with the  button. The displayed result is similar to the following:</p> <p></p> <p>Warning</p> <p>The Search by current map CRS is available only if the the current map CRS is not the one normally used by Decimal and Aeronautical coordinates, which means <code>EPSG:4326</code>.</p>"},{"location":"user-guide/mapstore-toolbars/#search-by-bookmark","title":"Search by bookmark","text":"<p>MapStore allows the user to search by the preconfigured bookmarks, which can zoom to a specific bounding box area or zoom along with reloading the visibility of the layers. Selecting the Bookmark settings  icon, the following window opens:</p> <p></p> <p>In order to create a new bookmark, the  button brings up Add new bookmark page where the user set the Bookmark properties, for example:</p> <p></p> <p>In particular, the information to be entered are:</p> <ul> <li> <p>Title of the bookmark</p> </li> <li> <p>Bounding Box property the user wish to zoom to</p> </li> <li> <p>West, South, East and North</p> </li> <li> <p>Toggle layer visibility reload,  to enable/disable the layer visibility reload when searched by bookmark</p> </li> </ul> <p>Note: The user can define bounding box value either manually or by selecting Use current view as bounding box  to fetch the current bounding box values from the map view to populate the fields</p> <p>When all the properties have been set, selecting the  it is possible to see the newly added bookmark in the View bookmarks list:</p> <p></p> <p>Once a bookmark has been created, it is always possible to Edit it  or Remove it  from the list.</p>"},{"location":"user-guide/mapstore-toolbars/#side-toolbar","title":"Side toolbar","text":"<p>The Side Toolbar is an important component, positioned on the right side of the map viewer, that provides to the user the access to different tools of MapStore. The following tools are the ones available by default:</p> <p></p> <p>In particular, with these options it is possible to:</p> <ul> <li> <p>Go back to the Homepage by clicking the  button</p> </li> <li> <p>Login/Logout by clicking the  button (for more information see the Managing Users and Groups section)</p> </li> <li> <p>Print the map by clicking the  button</p> </li> <li> <p>Export map in <code>json</code> format by clicking the  button</p> </li> <li> <p>Import files from your computer by clicking the  button</p> </li> <li> <p>Open the Catalog in order to connect to a remote service and add layers to the map by clicking the  button</p> </li> <li> <p>Perform a Measure on the map by clicking the  button</p> </li> <li> <p>Save the map by clicking the  button, in order to apply the changes made in an existing map. Selecting this option, the Resources Properties window opens, already filled with the current map properties</p> </li> <li> <p>Save as when the user needs to save a copy of a map or save one for the first time by clicking the  button. Selecting this option an empty Resources Properties window opens.</p> </li> <li> <p>Delete Map in order to delete the current map by clicking the  button</p> </li> <li> <p>Access the map Settings by clicking the  button, where the user can change the current Language and select the Identify options</p> </li> </ul> <p></p> <p>Note</p> <p>When the 3D navigation is enabled, opening the Settings panel, the editor is allowed to configure some options related to the Cesium viewer. </p> <p>In particular, from the Map Settings it is possible to:</p> <ul> <li> <p>Enable the Show sky atmosphere to see the atmosphere around the globe</p> </li> <li> <p>Enable the Show ground atmosphere to view the ground atmosphere on the globe when the camera is far away</p> </li> <li> <p>Enable the Show fog to allow additional performance by rendering less geometry and dispatching less terrain requests</p> </li> <li> <p>Enable the Depth test against terrain if primitives such as billboards, polylines, labels, etc. should be depth-tested against the terrain surface instead of always having them drawn on top of terrain unless they're on the opposite side of the globe</p> </li> </ul> <ul> <li> <p>See the About this map panel by clicking the  button, when Details are present</p> </li> <li> <p>Share the map by clicking the  button</p> </li> <li> <p>Open the MapStore Documentation by clicking the  button</p> </li> <li> <p>Start the Tutorial by clicking the  button</p> </li> <li> <p>Know more information About MapStore and the deployed Version of MapStore by clicking the  button</p> </li> </ul> <p></p> <p>Warning</p> <p>The Save, the Delete Map and the Share buttons are present in the Options Menu only when the map has already been saved once.</p>"},{"location":"user-guide/measure/","title":"Performing Measurements","text":"<p>The Measure tool in MapStore allows the user to perform different kind of measurements (like distance, area and bearing etc.) on the map. It also provides some additional functionalities that are described in this section of the documentation. The tool is accessible from the Side Toolbar by selecting the  button that opens the following toolbar:</p> <p></p> <p>Through this window it is possible to:</p> <ul> <li> <p>Measure distance </p> </li> <li> <p>Measure Area </p> </li> <li> <p>Measure Bearing </p> </li> <li> <p>Clear measures </p> </li> <li> <p>Export the measures to GeoJSON </p> </li> <li> <p>Add the measure as a layer in TOC </p> </li> <li> <p>Add the measure as an Annotation </p> </li> </ul> <p>Note</p> <p>The user can perform more than one measurement simultaneously on the map and then cancel it with the Clear Measures button </p>"},{"location":"user-guide/measure/#measure-distance","title":"Measure distance","text":"<p>As soon as the measure window opens, by default the measure distance option is selected . In order to perform a distance measure, each click on the map correspond to a segment of the line (at least one segment is needed) while the double click inserts the last line segment and ends the drawing session.</p> <p>The available units of measure are:</p> <p></p> <p>Note</p> <p>The length of a line segment is shown on the map together with the measurement of the overall distance of all segments.</p>"},{"location":"user-guide/measure/#measure-area","title":"Measure area","text":"<p>Once the Measure Area button is selected , it is possible to start the drawing session (in this case at least 3 vertices need to be indicated). Same as measuring the distance, each click correspond to a vertex and the double click will indicate the last one.</p> <p>In this case the available units of measure are:</p> <p></p> <p>Note</p> <p>Each side's length of the polygon is reported in map along with its perimeter and the area.</p>"},{"location":"user-guide/measure/#measure-bearing","title":"Measure bearing","text":"<p>The Bearing measurements allows you to measure directions and angles. In the quadrant bearing system, the bearing of a line is measured as an angle from the reference meridian, either the north or the south, toward the east or the west. Bearings in the quadrant bearing system are written as a meridian, an angle and a direction. For example, a bearing of N 30 W defines an angle of 30 degrees west measured from north. A bearing of S 15 E defines an angle of 15 degrees east measured from the south. After selecting the Measure Bearing button  the user can draw a line with only two vertices that indicates respectively the starting and the ending point.</p>"},{"location":"user-guide/measure/#export-the-measure","title":"Export the measure","text":"<p>Measurements drawn on the map can be exported in <code>GeoJson</code> format through the  button.</p>"},{"location":"user-guide/measure/#add-the-measure-as-layer","title":"Add the measure as layer","text":"<p>Once a measure is drawn, it is possible to add it as a layer through the  button. The created layer is added to the Table of Contents as follows:</p> <p></p>"},{"location":"user-guide/measure/#add-measure-as-annotation","title":"Add measure as annotation","text":"<p>Once a measure is drawn, it is possible to add it as an Annotation through the  button. The following panel opens:</p> <p></p> <p>From this step the creation process is the same described in the Annotations section.</p>"},{"location":"user-guide/measure/#measurement-on-the-3d-navigation","title":"Measurement on the 3D navigation","text":"<p>When the 3D Navigation is enabled, the user has the ability to perform distance, area, point coordinates, height from terrain, angle and slope measurements on the 3D map.</p> <p>Note</p> <p>The MapStore 3D works on top of CesiumJS mapping library where the ellipsoidal coordinate system is used to represents mapping features. For this reason all measurements performed with the MapStore measurement tool should be interpreted as having a height calculated above the ellipsoid.</p>"},{"location":"user-guide/measure/#measure-distance-on-the-3d-navigation","title":"Measure distance on the 3D navigation","text":"<p>As soon as the measure window opens, by default the Measure distance in 3D space option is selected . In order to perform a distance measure, each click on the map correspond to a segment of the line (at least one segment is needed) while the double click inserts the last line segment and ends the drawing session.</p>"},{"location":"user-guide/measure/#measure-geodesic-distance","title":"Measure geodesic distance","text":"<p>Once the Measure geodesic distance button is selected , it is possible to start the drawing session. Same as measuring the distance, each click corresponds to a vertex (at least two vertices are needed) and the double click will indicate the last one. With this measurement type it is possible also in 3D mode to have the geodesic distance calculated at the absolute zero of the WGS84 ellipsoid.  </p>"},{"location":"user-guide/measure/#measure-area-on-the-3d-navigation","title":"Measure area on the 3D navigation","text":"<p>Once the Measure Area in 3D space button is selected , it is possible to start the drawing session (in this case, at least 3 vertices need to be indicated). Same as measuring the distance, each click corresponds to a vertex and the double click will indicate the last one.</p>"},{"location":"user-guide/measure/#measure-point-coordinates","title":"Measure point coordinates","text":"<p>After selecting the Measure point coordinates button  the editor can click on a point on the map and know latitude, longitude and altitude of that point.</p>"},{"location":"user-guide/measure/#measure-height-from-terrain","title":"Measure height from terrain","text":"<p>Once the Measure height from terrain button is selected , it is possible to click on a point on the map and know the distance from the point to the terrain.</p>"},{"location":"user-guide/measure/#measure-angle","title":"Measure angle","text":"<p>Once the Measure angle in 3D space button is selected , the editor can draw three points on the map and get the angle value.</p>"},{"location":"user-guide/measure/#measure-slope","title":"Measure slope","text":"<p>Once the Measure slope button is selected , the editor can draw three points on the map to create a triangular surface and get the slope value.</p>"},{"location":"user-guide/media-editor-window/","title":"Media Editor Window","text":"<p>The Change media source  button  allows to access the Media Editor:</p> <p></p> <p>Through this window, you can add or edit three different types of media:</p> <ul> <li> <p>Images</p> </li> <li> <p>Videos</p> </li> <li> <p>Maps</p> </li> </ul>"},{"location":"user-guide/media-editor-window/#images","title":"Images","text":"<p>In order to add an image, the stroy editor can click on the Images tab  in order to switch to the images section. In this section of the media editor window, with a click on the Add button , it is possible to define the image settings.</p> <p></p> <p>In particular, it is possible to insert the following parameters:</p> <ul> <li> <p>The Source of the image (its URL)</p> </li> <li> <p>The Title of the image</p> </li> <li> <p>The Alternative text, that appears if the link is broken</p> </li> <li> <p>A Description, used to explain the contents of the image. The description is available in the images preview list and, if the image is added as content in the Pharagraph section, in the Immersive section or in the Media section, under the image, as follows:</p> </li> </ul> <p></p> <ul> <li>The Credits, displayed on the bottom-right of the image</li> </ul> <p>Warning</p> <p>Source and Title are mandatory fields.</p> <p>With a click on Save , the image is included in the list of the available images ready to be selected for the current story. The image also becomes immediately available on preview.</p> <p></p> <p>Note</p> <p>It is always possible to change the image settings through the Edit button  also in a second time.</p> <p>Once selectd in the list, the image can be included in the story by clicking on the Apply button .</p>"},{"location":"user-guide/media-editor-window/#videos","title":"Videos","text":"<p>In order to add a video, the stroy editor can click on the Video tab  in order to switch to the videos section. In this section of the media editor window, with a click on the Add button , it is possible to define the video settings.</p> <p></p> <p>In particular, it is possible to insert the following parameters:</p> <ul> <li> <p>The URL of the video</p> </li> <li> <p>The Title of the video</p> </li> <li> <p>A Description, used to explain the contents of the video. The description is available in the viedos preview list  and it can appear under the video itself if the video is added as a content of a section (Pharagraph section, Immersive section or Media section)</p> </li> <li> <p>The Credits, displayed on the bottom-right of the video</p> </li> </ul> <p>Warning</p> <p>Video URL and Title are mandatory fields.</p> <p>With a click on Save , the video is included in the list of the available videos ready to be selected for the current story. The video also becomes immediately available on preview.</p> <p></p> <p>Once selectd in the list, the video can be included in the story by clicking on the Apply button .</p>"},{"location":"user-guide/media-editor-window/#maps","title":"Maps","text":"<p>To add a map to the story, the story editor can click on the Maps tab  and so swich to the map section of the Media Editor. Here the list of maps ready to be used for the story is available: the editor can search and select a map in the list to apply it in the story or create a map from scratch by clicking on the Add button  to open the Map Editor.</p> <p></p> <p>Once the map is ready, the story editor can click on Ok button  to proceed with the next step and therefore insert the related map metadata like Thumbnail, Title and Description.</p> <p></p> <p>Note</p> <p>The description is available in the maps preview list and it can appear under the map itself if the map is added as a content of a section (Pharagraph section, Immersive section or Media section).</p> <p>With a click on Save button  the map is saved and it will be available in the list of the Current Story maps. The story editor can select it to be used as a map component in the story by clicking on Apply button .</p> <p></p> <p>Note</p> <p>By default a drop down list on the top right corner of the Media Editor allows to switch between maps currently used in the story (so the story editor can use again a map already present in the story if needed) and existing maps already available inside the MapStore catalog (that means that also classic maps created in MapStore can be used inside a Story). </p> <p>Below is an example of a Map used as a background of a Title Section:</p> <p></p>"},{"location":"user-guide/media-section/","title":"Media Section","text":"<p>Media Sections are similar to Paragraph Sections but the main difference is that as soon as the story editor try to add a new Media Section, the Media Editor appears, asking to define the media that is going to be added. An example of a new Media Section with an image added can be like the following:</p> <p></p> <p>Once the first media is added to the Media Section it is possible to add new media, text contents or web page contents or remove the existing ones as decribed also in the Paragraph Sections.</p> <p></p>"},{"location":"user-guide/navigation-toolbar/","title":"Navigation Toolbar","text":"<p>The Navigation Toolbar is a navigation panel containing various elements that help the user to explore the map. In particular, it is possible zooming, changing the extent, navigating in 3D mode and querying objects on the map. Moreover, the following icon  is used to expand/collapse the navigation toolbar.</p> <p></p>"},{"location":"user-guide/navigation-toolbar/#geolocation-tool","title":"Geolocation tool","text":"<p>Through the Show my position  the user can center the map on his position. Therefore the button turns green.</p> <p></p> <p>The position is still active even when the user interacts with the map; with a single click on the button it is possible re-center the map on his position. To disable the position the button needs to be duble clicked.</p>"},{"location":"user-guide/navigation-toolbar/#zooming-tools","title":"Zooming tools","text":"<p>MapStore provides several tools allows the user to:</p> <ul> <li> <p>Increase the map zoom by using the zoom in icon </p> </li> <li> <p>Decrease the map zoom by using the zoom out icon </p> </li> <li> <p>Switch to full screen  view</p> </li> <li> <p>Go back  to the previous map extent in the map navigation history</p> </li> <li> <p>Go forward  to the next map extent in the map navigation history</p> </li> <li> <p>Zoom to the maximum extent  the map</p> </li> </ul>"},{"location":"user-guide/navigation-toolbar/#3d-navigation","title":"3D Navigation","text":"<p>The 3D navigation in MapStore is based on CesiumJS. If the 3D button  in the Navigation Toolbar is clicked, the map switch in 3D mode so map contents are displayed on a 3D globe and it is possible to orbit around it through the compass place in the upper right corner of the map.</p> <p></p> <p>Note</p> <p>The 3D mode in MapStore support also the rendering 3D Tiles layers once they are added through the Catalog tool as explained here.</p>"},{"location":"user-guide/navigation-toolbar/#identify-tool","title":"Identify Tool","text":"<p>The Identify tool  allows to retrieve information about layers on the map. The tool is active by default (the button is green). Therefore if the user click on a layer in the map, the identify panel opens containing the layers information corresponding to the clicked point in the map (also the coordinates of the clicked point are reported in the identify panel).</p> <p></p> <p>The layers information are reported in plain text by default. It is possible to change the format by selecting the  button in Side Toolbar where the user can select, through the Identify response format menu, three different formats like: TEXT, HTML and PROPERTIES.</p> <p></p> <p>The information will be returned in the format chosen by the user. For exaple with PROPERTIES format as follows:</p> <p></p> <p>Warning</p> <p>This global settings could be overwritten by a layer-specific configuration (see Feature Info Form).</p> <p>In addition to the layers information, the following are provided by the Identify Tool:</p> <ul> <li>The point address  through the More Info button  </li> </ul> <p></p> <ul> <li>The coordinates  of the point</li> </ul> <p></p> <p>Note</p> <p>The point coordinates are visualized in decimal or areonautical format. It is possible to change the format by the setting button </p> <ul> <li>The Highlight Features button  allows to highlights on the map the layers features corresponding to the retrieved information in the clicked point.</li> </ul> <ul> <li>The Edit button  allows the user to open the Attribute Table  in edit mode showing only layers records corresponding to the clicked point on the map.</li> </ul>"},{"location":"user-guide/navigation-toolbar/#using-the-coordinates-editor","title":"Using the Coordinates Editor","text":"<p>In order to Identify layers features by typing coordinates instead of clicking on the map, you can use the Coordinate Editor.</p> <p>The coordinates can be in decimal or areonautical format depending on the user needs. It is possible to change the format by the setting button </p> <p>An example of search with <code>Decimal</code> coordinates as follows:</p> <p>An example of search with <code>Aeronautical</code> coordinates as follows:</p>"},{"location":"user-guide/navigation-toolbar/#identify-tool-with-more-than-one-layer","title":"Identify Tool with more than one layer","text":"<p>In a map it is possible to have several overlapping layers. With the Identify tool the user can retrieve information on one or more overlapping layers at the same time in a certain point.</p> <p>If the user clicks on the map where one or more overlapping layers are present, the identify panel opens. The panel provides the layers information, therefore the user can navigate different layers information from the layer select drop-down menu where the layer options have been sorted as in TOC.</p> <p></p> <p>In order to have information about one layer only the user can select the layer on the Table of Contents, through the TOC button , and then click on the layer in the map to perform the identify operation only for that selected layer in TOC. The identify panel opens containing the layer information corresponding to the clicked point in the map, as follows:</p>"},{"location":"user-guide/navigation-toolbar/#floating-identify-tool","title":"Floating Identify Tool","text":"<p>In MapStore the user can set the Identify tool in floating mode (Floating Identify tool) instead of having the default one available through a click on the map. In that case an identify popup will appears on the map as soon as the user hover over a layer in the map.</p> <p>In order to activate the Floating Identify Tool the user can select the   button in Side Toolbar. Here he can select the Hover option through the Trigger event for Identify dropdown menu.</p> <p></p> <p>As soon as the option Hover is selected, the user can hover the mouse over a layer in the map in order to show the popup containing the identify information.</p>"},{"location":"user-guide/paragraph-section/","title":"Paragraph Section","text":"<p>The Paragraph Section allows to insert a textual content to the story. The story editor can also click on the  button to add additional contents to this section (like media, other paragraphs or embed third party contens). It is possible to choose between:</p> <p></p> <ul> <li> <p>Text Content  to add another text content just below the current one</p> </li> <li> <p>Media Content  to open the Media Editor to add an image, a map or a video.</p> </li> <li> <p>Web Page Content  to add an external web page</p> </li> </ul>"},{"location":"user-guide/paragraph-section/#text-content","title":"Text Content","text":"<p>By default, as soon as a Paragraph is added, an empty text content is already present as a placeholder and the content toolbar allows to:</p> <p></p> <ul> <li>Change the size of the text content: clicking on the Change Size button  a dropdown menu appears to allow selecting between Small, Medium or Full size:</li> </ul> <p></p> <ul> <li>Delete the Paragraph  Section through the Remove button </li> </ul> <p>The editor can write a text by clicking on the text content and customize it through the Text Editor Toolbar. A possible result of adding and formatting the text can be the following:</p> <p></p>"},{"location":"user-guide/paragraph-section/#media-content","title":"Media Content","text":"<p>Adding a media content, the Media Editor opens to allow adding the supported media (like Image, Map or Video).</p>"},{"location":"user-guide/paragraph-section/#images","title":"Images","text":"<p>An image added inside the paragraph section can be customized through the Image Content Toolbar. Below is an example of a small, center-aligned image, just below a text content:</p> <p></p>"},{"location":"user-guide/paragraph-section/#videos","title":"Videos","text":"<p>A video added inside the paragraph section can be customized through the Video Content Toolbar. Below is an example of a video, just below an image content:</p>"},{"location":"user-guide/paragraph-section/#maps","title":"Maps","text":"<p>A map added inside the paragraph section can be customized through the Map Content Toolbar. Below is an example of a large, center-aligned map, just below an Image content:</p> <p></p>"},{"location":"user-guide/paragraph-section/#web-page-content","title":"Web Page Content","text":"<p>Adding a web page content, the Web Page Windows opens allowing the user to add the URL of an extenal web page. A web page added inside the paragraph section can be customized through the Web Page Content Toolbar. Below is an example of a medium, center-aligned web content, just below a map one:</p> <p></p>"},{"location":"user-guide/print/","title":"Printing a Map","text":"<p>In MapStore it is possible to print a map by selecting the Print  button from Side Toolbar. The print process is composed by two main steps:</p> <ul> <li> <p>Print Settings definition</p> </li> <li> <p>Result checking in Preview before download the printed file</p> </li> </ul>"},{"location":"user-guide/print/#print-settings","title":"Print settings","text":"<p>As soon as the Print  button is chosen, the following window opens:</p> <p></p> <p>Through this window it is possible to:</p> <ul> <li> <p>Enter a Title and a Description, that will be shown on the print page</p> </li> <li> <p>Change the Format (<code>PDF</code>, <code>PNG</code>, <code>JPEG</code>)</p> </li> <li> <p>Change the Coordinates System (<code>EPSG:3857</code>, <code>EPSG:4326</code>)</p> </li> <li> <p>Change the Rotation of the map (value in degrees)</p> </li> <li> <p>Change the Resolution of the print (<code>96 dpi</code>, <code>150 dpi</code>, <code>300 dpi</code>)</p> </li> <li> <p>Accessing Layout settings</p> </li> <li> <p>Accessing Legend options</p> </li> </ul> <p>Note</p> <p>In Print settings preview there's the map portion that will be displayed on the print sheet. In order to center the map the user can pan it until the preview displays the desired extension</p> <p></p>"},{"location":"user-guide/print/#layout","title":"Layout","text":"<p>Opening the Layout settings menu, the following menu appears:</p> <p></p> <p>From here, in particular, it is possible to:</p> <ul> <li> <p>Select the Sheet size (choosing between A3 and A4 format)</p> </li> <li> <p>Choose to Include legend</p> </li> <li> <p>Choose to place the Legend on distinct page from the map</p> </li> <li> <p>Select the page orientation between Landscape and Portrait</p> </li> </ul>"},{"location":"user-guide/print/#legend-options","title":"Legend options","text":"<p>The Legend can be customized through the Legend options menu:</p> <p></p> <p>Through this menu the user is allowed to:</p> <ul> <li> <p>Configure labels by choosing font type and size, and by adding Bold and Italic style</p> </li> <li> <p>Enable the Force Labels option, that force the display of labels even if only one rule is present (by default, if only one rule is present, the label is not displayed)</p> </li> <li> <p>Enable the Font Anti Aliasing (when Anti Aliasing is on, the borders of the labels font are smoothed improving the image quality)</p> </li> <li> <p>Enable the Override icon size option to have the ability to change the Height and Width of the icons (by default, the icon sizes are <code>24x24</code>)</p> </li> <li> <p>Set the Dpi resolution of the legend</p> </li> </ul>"},{"location":"user-guide/print/#preview","title":"Preview","text":"<p>When the print settings are chosen, it is possible to access the preview by clicking on the  button. A window similar to the following appears:</p> <p></p> <p>Here it is possible to:</p> <ul> <li> <p>Zoom in/out int the preview </p> </li> <li> <p>Navigate between pages (when more than one page is present) </p> </li> <li> <p>Download the file in .pdf format </p> </li> </ul> <p>A simple printed map could be, for example, like the following:</p> <p></p>"},{"location":"user-guide/resources-properties/","title":"Resource Properties","text":"<p>In order to customize the properties of a resource, the Admin or a normal user with permission can access the Edit properties window from the Edit properties button  in Homepage or from the Save and the Save as buttons inside the resource viewer.</p> <p></p> <p>Through the Edit properties window the user can perform the following operations:</p> <ul> <li>Add an image as a Thumbnail dropping it or clicking inside the Thumbnail box.</li> </ul> <p>Warning</p> <p>The image to be added must not be larger than 500 kb and its best dimensions are 300x180 px. The supported formats are <code>jpg</code> (or <code>jpeg</code>) and <code>png</code>.</p> <ul> <li>Add a Name and a Description</li> </ul> <p>Note</p> <p>The name of a resource is the only mandatory field. Note that is not allowed to choose a name that has already been assigned to another resource.</p> <ul> <li> <p>Enable the Unadvertised option to make the owner of the resource or the MapStore admin the only ones who can see and search that resource in the Home Page or in the Map Catalog tool.</p> </li> <li> <p>Add a Permission rule</p> </li> <li> <p>Add Details (only for Maps and Dashboard)</p> </li> </ul> <p>Once a resource is saved, the Edit properties panel shows the creation and the last modification dates. An example in the image below:</p> <p></p> <p>Admin users can also see who created and modified the resource. An example in the image below:</p> <p></p>"},{"location":"user-guide/resources-properties/#permission-rules","title":"Permission rules","text":"<p>In the Add a rule... section you can set one ore more permission rules in order to allow a group to access the resource. In particular it is possible to choose between a particular group of authenticated users or the everyone group that includes all authenticated users but also anonymous users (more information about different user types can be found in Homepage section).  Moreover it is possible to choose between two different ways with which the selected group can approach the resource:</p> <ul> <li> <p>View the map and save a copy</p> </li> <li> <p>Edit the map and re-save it</p> </li> </ul> <p>In order to add a rule, the user can select the group and set permissions inside the Add a rule... section. Once the rule is set, with the  Add button  it is possible to add it to the Permissions Groups list.  For example, a resource that can be seen by everyone, should have a rule like the following:</p> <p></p> <p>Once a rule is set, the user can always remove it through the Remove button .  How to manage users and groups is a topic present in the Managing Users and Managing Groups sections.</p>"},{"location":"user-guide/resources-properties/#details","title":"Details","text":"<p>Only for resources of type map and dashboard, it is possible to add details as additional information in form of descriptive content for the resource itself. This is useful to associate some information to the resource and provide an overview of its content. In this case the Edit properties window is the following:</p> <p></p> <p>With a click on the Add new details button  a panel opens and the user can write the details of the resource.</p> <p></p> <p>The text can be edited and some links and images can be added through the Text Editor Toolbar. Once the editing is done, the map details can be saved with the Save button  and other buttons appear on the Edit properties panel.</p> <p></p> <p>Here, the user is allowed to:</p> <ul> <li> <p>Show the details preview </p> </li> <li> <p>Edit the details </p> </li> <li> <p>Enable the Show as modal  button, to show the details on a modal when the user clicks on  button, which is listed in the Side Toolbar options</p> </li> </ul> <p></p> <p>Note</p> <p>If the Show as modal button is not activated once the user opens the About this map button, the details are displayed on a panel. </p> <p>Warning</p> <p>The About this map button is visible in the Side Toolbar only when the details are present on the map.</p> <ul> <li> <p>Enable the Show at startup  button. If active, when the user opens a resource with defined details, these are visualized in a descriptive panel.</p> </li> <li> <p>Delete the details sheet </p> </li> </ul> <p>Once the details are saved, the Show details button  appears also on the map card in Homepage</p> <p></p> <p>Through this, it is possible to open the details panel also from the home page.</p> <p></p>"},{"location":"user-guide/share/","title":"Sharing Resources","text":"<p>MapStore provides the possibility to share resources (maps, dashboards and geostories) through two different ways:</p> <ul> <li>Directly from the MapStore Homepage by clicking on the Share button  present in the toolbar of each resource card</li> </ul> <p></p> <ul> <li>Inside the resource by selecting the  option from the Side Toolbar</li> </ul> <p>From the Share panel the user is allowed to share a resource in different ways:</p> <ul> <li> <p>With a Direct Link</p> </li> <li> <p>Through a Social Network</p> </li> <li> <p>Through a Permalink to shares current user session (only available from the Side Toolbar)</p> </li> <li> <p>With Embedded code or APIs (only available for maps)</p> </li> </ul>"},{"location":"user-guide/share/#link","title":"Link","text":"<p>As soon as the Share panel opens, the Link section is the one visible by default:</p> <p></p> <p>Here, the user can copy the resource URL link or share it through the QR code.</p>"},{"location":"user-guide/share/#social","title":"Social","text":"<p>The Social section allows the user to share the resource on the most common social networks like Facebook, Twitter and LinkedIn simply by clicking on the social icon.</p> <p></p>"},{"location":"user-guide/share/#permalink","title":"Permalink","text":"<p>The Permalink section allows to save the current overall viewer state of the resource and share it as a permalink.</p> <p></p> <p>A permalink is a new resource belonging to a dedicated category in MapStore for which the user must enter the Title and Description (the last one is not mandatory) and choose whether the resource will be public by checking the Public option (this will generate a public map permalink so that everyone can access it).</p> <p>Warning</p> <p>Map Details as well as other resources connected to a map or context, if present, will not be available in the final permalink resource.</p> <p>When all options are filled, the user can Generate permalink through the  button to get the Permalink URL or the QR code to share it.</p> <p></p>"},{"location":"user-guide/share/#embed","title":"Embed","text":"<p>The Embed section provides to the user the needed snippets, embedded code or the MS APIs (only available for maps) to embed MapStore in a third party web page.</p> <p></p> <p>In addition, MapStore provides options to customize a bit the embedded code:</p> <ul> <li>The user can configure height and width of the embedded resource by choosing <code>Small</code> (600x500), <code>Medium</code> (800x600), <code>Large</code> (1000x800) and <code>Custom</code> (it is possible to choose the desired size).</li> </ul> <p></p> <ul> <li>For maps, the user can choose to show the TOC in the embedded map by enabling the Shown TOC option</li> </ul> <p></p> <ul> <li>For dashboards, the user can show the connections between widgets on the embedded dashboard by enabling the Show connections</li> </ul> <p></p>"},{"location":"user-guide/share/#advanced-options","title":"Advanced options","text":"<p>Some Advanced options are available for maps and geostories inside the Share tool.</p> <p>Note</p> <p>Some Advanced options are available only opening Share tool from the Side Toolbar and not from the MapStore home page.</p>"},{"location":"user-guide/share/#advanced-options-for-sharing-maps","title":"Advanced options for sharing maps","text":"<p>In case of maps, enabling the Advanced options in the Share tool the user can include the following to the share URL:</p> <p></p> <ul> <li> <p>The bounding box parameter to share the current viewport of the map visualized by the user</p> </li> <li> <p>The desired center and zoom of the map by enabling the Add center and zoom</p> </li> </ul> <p></p> <p>The related available options allow the user to:</p> <ul> <li> <p>Center the shared map to specific coordinates by typing them in two different formats (Decimal or Aeronautical that can be chosen through the  button) or by clicking on the map to set automatically the coordinate fields.</p> </li> <li> <p>Share the map at a specific Zoom level (<code>Min:1</code> and <code>Max:35</code>)</p> </li> <li> <p>Add marker on loaded map to show the center point in the shared map</p> </li> </ul>"},{"location":"user-guide/share/#advanced-options-for-sharing-3d-maps","title":"Advanced options for sharing 3D maps","text":"<p>Once the 3D Navigation is active on map, the user can include the following to the share URL by enabling the Advanced options in the Share tool:</p> <p></p> <ul> <li>The desired center and zoom of the map by enabling the Add center and zoom to sharing link</li> </ul> <p></p> <p>The related available options allow the user to:</p> <ul> <li> <p>Center the shared map to specific coordinates by typing them in two different formats (Decimal or Aeronautical that can be chosen through the  button) or by clicking on the map to set automatically the coordinate fields.</p> </li> <li> <p>Share the map at a specific Zoom level (<code>Min:1</code> and <code>Max:35</code>), Heading (<code>Min:0\u00b0</code> and <code>Max:360\u00b0</code>), Roll (<code>Min:-90\u00b0</code> and <code>Max:90\u00b0</code>) and Pitch (<code>Min:-90\u00b0</code> and <code>Max:90\u00b0</code>)</p> </li> </ul>"},{"location":"user-guide/share/#advanced-options-for-sharing-geostories","title":"Advanced options for sharing GeoStories","text":"<p>In case of GeoStories, enabling the Advanced options in the Share tool the user can include the following to the share URL:</p> <p></p> <ul> <li>The Home button to allow the possibility to bring the user to the MapStore Home Page if needed: that button will be automatically included in view mode inside the story toolbar just beside the navigation bar.</li> </ul> <p></p> <ul> <li>The scroll position allows to share the URL of the current section of the story visualized by the user</li> </ul> <p></p>"},{"location":"user-guide/story-setting/","title":"Story Settings","text":"<p>The Story Settings panel allows the editor to customize the theme of the story and configure which additional components should appear to end users in the story view.</p> <p>The Story settings panel is available in Edit Mode and it can be opened by clicking on the Settings button .</p> <p></p>"},{"location":"user-guide/story-setting/#story-theme","title":"Story Theme","text":"<p>The editor can customize the different components of the story through the following sections:</p> <ul> <li>The Theme to choose the default background and text color and the default font of the whole story: clicking on the Change Color button  a color picker appears to allow selecting the desired color:</li> </ul> <ul> <li>The Font Family to choose the default text font present in the whole story: clicking on the search bar a dropdown menu opens to allow selecting the desired font (Inherit, Arial, Georgia, Impact, Tahoma, Time New Roman, Verdana). The default list of Font Families can be customized in the MapStore configuration file.</li> </ul> <ul> <li>The Overlay to choose the default background and text color of overlay contents present in the Title Section and in the Immersive Section as well: clicking on the Change Color button  a color picker appears to allow selecting the desired color:</li> </ul> <ul> <li>The Shadow of overlay contents present in the Title Section and in the Immersive Section: to enable or disable the shadow:</li> </ul> <ul> <li>The color of Links. The story editor can choose the default color of the hyperlink that may be present in the Text Contents.</li> </ul>"},{"location":"user-guide/story-setting/#story-header","title":"Story Header","text":"<p>In the top bar of the story, if the editor enables them, the following components are added:</p> <p></p> <ul> <li> <p>The Title of the story, the default value is the title given to the story's resource in MapStore.</p> </li> <li> <p>The Font Size of the title: clicking on the search bar a dropdown menu opens to allow selecting the desired size (14 px, 16 px, 18 px, 24 px, 28 px).</p> </li> <li> <p>The story Logo, that can be for example an image that represents your organization or something connected to the story itself.</p> </li> <li> <p>The Navigation Toolbar to improve the story navigation for end users. Each section of the story is reported in a tree and the editor can establish which section should appear in the toolbar to allow end users to quickly navigate the story.</p> </li> </ul> <p>Saving the story settings and going back in View Mode, the top bar looks like this:</p> <p></p>"},{"location":"user-guide/street-view/","title":"Street View","text":"<p>The Street View tool allows the user to browse 360 imagery in MapStore from different supported providers such as Google Street View or  Cyclomedia Street Smart.</p> <p>Note</p> <p>The Street View plugin is not active by default in MapStore due to licensing reasons. It is anyway ready to be configured for application contexts using the desired provider.</p>"},{"location":"user-guide/street-view/#google-street-view","title":"Google Street View","text":"<p>Through the  button available in the Side Toolbar, the tool can be activated so that it is possible to navigate the map with Google Street View.</p> <p></p> <p>When the tool is activated, a window opens and the streets highlighted on the map so that the user can select one of them with a simple click of the mouse.</p> <p>By clicking on a street in the map, the tool window displays the Street View and the user can navigate it.</p> <ul> <li>Zoom in/out on the street</li> </ul> <ul> <li>Use the Pan Interaction to navigate all-around the street</li> </ul> <ul> <li>Enable/disable the Full Screen </li> </ul>"},{"location":"user-guide/street-view/#cyclomedia-street-smart","title":"Cyclomedia Street Smart","text":"<p>If the Cyclomedia Street Smart has been configured as a provider for the MS Street View tool, the user experience is the same: the tool can be activated through the same button  in Side Toolbar.</p> <p></p> <p>Note</p> <p>The Cyclomedia Street Smart provider can be configured on the Street View plugin as documented here</p> <p>When the tool is activated, the user must enter Username and Password and click .</p> <p></p> <p>Warning</p> <p>The credentials are necessary to visualize the street layer while the usual authkey is needed in plugin config to interact with the street smart APIs (see plugin config page here)</p> <p>After that a window opens and the street layer is visualized in form of dots to highlight streets on the map so that the user can select one of them with a simple click of the mouse.</p> <p>By clicking on a highlighted point on the map, the tool window displays the Street View and the user can navigate it as usual or interact with the Navigation Toolbar.</p> <p></p> <p>Through the navigation toolbar it is possible to:</p> <ul> <li> <p>Open the Overlays pop-up, through the  button, to: - View and enable/disable the layers present in the view from the Layers tab - Enable/disable the Show Mouse position and the Show Compass from the Viewer tab</p> </li> <li> <p>Open the Display pop-up, through the  button, to: - Set the Brightness of the view - Set the Contrast of the view</p> </li> <li> <p>See the Object Information through the  button.</p> </li> <li> <p>Open the Cross Section pop-up, through the  button.</p> </li> <li> <p>See the Elevation through the  button.</p> </li> <li> <p>Open the Report issue pop-up, through the  button.</p> </li> <li> <p>Open the Point Cloud pop-up, through the  button.</p> </li> <li> <p>Open the Oblique viewer pop-up, through the  button.</p> </li> <li> <p>Open the Measurements pop-up, through the  button.</p> </li> <li> <p>Download the cyclorama image in <code>png</code> format through the  button.</p> </li> <li> <p>Open the Image Info pop-up, through the  button to access image metadata such as: general image information as well as geospatial references of the image itself.</p> </li> </ul>"},{"location":"user-guide/text-editor-toolbar/","title":"Text Editor Toolbar","text":"<p>With the Text Editor Toolbar it is possible to customize the text by modifying the following aspects:</p> <p></p> <ul> <li> <p>Font to choose the text font (Inherit, Arial, Georgia, Impact, Tahoma, Time New Roman, Verdana)</p> </li> <li> <p>Block Type by choosing between the available ones (Normal, H1, H2, H3, H4, H5, H6, Blockquote, Code)</p> </li> <li> <p>Text style to insert text in Bold , Italic , Underline  or Strikethrough </p> </li> <li> <p>Monospace  to insert the same space between words</p> </li> <li> <p>Alignment  inside the text window (Left, Center, Right or Justify)</p> </li> <li> <p>Color Picker  to change the text color</p> </li> <li> <p>Bullet list to create a Unordered list  or Ordered list </p> </li> <li> <p>Indent/Outdent  to  indent the text in relation to the left margin or to the right margin</p> </li> <li> <p>Link  to configure a hyperlink for the selected portion of text. The GeoStory editor can define hyperlinks to external web pages by choosing the External link option in the Link target dropdown menu and entering the related URL. As an alternative, it is also possible to define a hyperlink to other sections of the same GeoStory by choosing one of the sections available in the Link target dropdown menu.  </p> </li> </ul> <p></p> <p>Note</p> <p>In order to setup an hyperlink to an external website, the protocol must be specified (e.g., <code>http://</code> or <code>https://</code>).</p> <ul> <li>Remove  to remove the formatting</li> </ul>"},{"location":"user-guide/timeline/","title":"Timeline","text":"<p>The Timeline is a MapStore tool for managing layers with a time dimension. It makes possible to observe the layers' evolution over time, to inspect the layer configuration at a specific time instant (or in a time range) and to view different layer configurations time by time dynamically through animations.</p> <p>Warning</p> <p>The Timeline tool currently works only with WMS layers from GeoServer where the WMTS-Multidim extension is installed (WMS time values in WMS Capabilities is not supported yet). To use the MapStore Timeline at least GeoServer 2.14.5 is required, but the recommended version is GeoServer 2.15.2 to have a complete support for all of the features the Timeline tool can provide (e.g. the filter by viewport). From now on, the layers that the Timeline can manage will be addressed as time layers. From now on, the layers that the Timeline can manage will be addressed as time layers.</p> <p>When a layer with a time dimension is added to the map, the Timeline panel becomes automatically visible and it allows the user to browse the layer over time.</p> <p></p> <p>Note</p> <p>Widgets and Timeline cannot be expanded on the same map at the same time. See this section to learn more about this.</p>"},{"location":"user-guide/timeline/#timeline-histogram","title":"Timeline histogram","text":"<p>The Histogram panel opens through the Expand time slider button .</p> <p></p> <p>In the Histogram panel some of the most relevant elements are the following ones:</p> <ul> <li> <p>A list of layers present in map with the time dimension available. It is possible to hide this list with the Hide layers names button </p> </li> <li> <p>The relative histogram that shows the layer' data for each time in which it is defined. In order to manage the panel the user can zoom in/out on the histogram, scroll the time axis and drag the current time cursor along it</p> </li> </ul> <p>Note</p> <p>The highlighted layer is the one whose histogram is displayed on the panel.</p> <p>Note</p> <p>The highlighted layer in the time layers ' list drives the time management, from now on it will be addressed as guide layer (See in the Animation Settings &gt; Timeline Settings &gt;  Snap to guide layer option ).</p>"},{"location":"user-guide/timeline/#set-a-time-range","title":"Set a Time Range","text":"<p>In order to see a layer in a specific time instant the user can insert a data and a time in the panel, as follows:</p> <p></p> <p>Note</p> <p>The current time cursor changes its position according to the selected date and viceversa: when the user drag that cursor along the time axis the date/time cells will update their values.</p> <p>In order to observe the layers in a finite fixed time interval the user can set a time range through the Time range button . A date/time control panel opens to set the range limits either by directly entering values in those cells or by dragging the limits cursors along the histogram time axis, as follows:</p> <p></p>"},{"location":"user-guide/timeline/#reset-timeline","title":"Reset timeline","text":"<p>Based on the timeline configuration, the reset button  can be made visible on the timeline toolbar. It allows the user to reset the time data based on the current mode of the timeline</p> <ul> <li> <p>When the current mode is single, the icon is represented as , and the layer is selected in timeline, the time is set to <code>nearest of now</code> and when the layer is not selected, the time is set to <code>now</code></p> </li> <li> <p>When the current mode is range, the icon is represented as , the time is set to the full range of the layer</p> </li> </ul> <p>Note</p> <p>Reset button is made visible through plugin configuration i.e. <code>resetButton: true</code></p>"},{"location":"user-guide/timeline/#show-times-available-on-map","title":"Show times available on map","text":"<p>Sometimes you might be interested to show in the timeline histogram only the times instants currently visible on the map, especially when you are exploring a big data set. This feature can be enabled by clicking the Map Sync button  . When this tool is active the timeline will show only the times of the features available in the current map viewport.</p> <p></p> <p>Note</p> <p>Map Sync feature need at least GeoServer 2.15.2</p>"},{"location":"user-guide/timeline/#animations","title":"Animations","text":"<p>The user can start a time animation by using the timeline tool through the following buttons (by default the animation of layers in map is based on time values related the guide layer, see the Animation Settings section &gt; Timeline Settings &gt; Snap to guide layer option):</p> <p></p> <p>In order to start the animation the user can click on Play button .  Once the animation is started, the temporal layers in map are updated accordingly and the user can see the animation progress also in the timeline histogram. Following the sequence of steps, the cursor will shift each time to the next step in a certain time interval, the frame duration.  Through the Stop button  the user can stop the animation and the current time cursor remains in the last position reached.  The Step backward button  and the Step forward button  allow the user to change the current time. Therefore, by clicking on one of them, the cursor changes its position (to the previous or the next step) on the histogram, the date/time values of the control cells will be updated accordingly and the layers in map are updated too.  The user can pause the animation through the Pause button , as follows:</p> <p>Note</p> <p>The user can also specify a time range. During the animation, the whole range will be shifted step by step along the time axis and, in each step, the layers in map will show data corresponding to that range of time. </p>"},{"location":"user-guide/timeline/#animation-settings","title":"Animation Settings","text":"<p>The animation behavior can be customized through the Settings button . It allows the user to tune the Timeline and the Playback options.</p> <p></p> <p>By default, the Snap to guide layer is enabled. It allows to force the time cursor to snap to the selected layer's data.</p> <p></p> <p>If the time dimension of the layer has time ranges defined (start/end time) instead of time instants, the user can choose the Time interval snap point by selecting the option <code>Start</code> or <code>End</code>. An example of snapping to the <code>End</code> point could be the following:</p> <p>The user can disable Snap to guide layer to select the preferred time step through the Animation Step option. For example, the process could be similar to the following one:</p> <p></p> <p>The user can set the number of second between one animation frame and another through the Frame Duration and enable the Follow the animation to visualize the animation process also inside the histogram: the histogram will automatically move to follow the animation.</p> <p></p> <p>Enabling the  Animation Range the user can bound the animation execution to a fixed time interval, the green range. The green range can be defined both dragging the play/stop cursors directly on the histogram or filling the date/time control cells of the extra panel displayed, as follows:</p> <p>In order to properly set the Animation Ranger, some controls are available to help the user:</p> <ul> <li> <p>Zoom the histogram until it fits the animation's green range time extension through the  Zoom to the current playback range button </p> </li> <li> <p>Extend the animation's green range until it fits the current view range of the histogram through the Set to current view range button </p> </li> <li> <p>Extend the animation's green range until it fits the guide layer time extension through the Fit to selected layer's range button </p> </li> </ul>"},{"location":"user-guide/timeline/#layers-setting","title":"Layers Setting","text":"<p>The layers tab lists all the available time layers present in the map. The user can toggle a layer to be shown/hidden in the timeline by clicking on the checkbox next to the layer title.</p> <p></p>"},{"location":"user-guide/title-section/","title":"Title Section","text":"<p>As soon as you create a new Story, by default, only a Title Section (the cover) is present in the workspace. In this section the story editor can customize two different elements: the title text and the cover's background.</p>"},{"location":"user-guide/title-section/#content","title":"Content","text":"<p>By default, the title section has the following placeholder with an empty background behind it:</p> <p></p> <p>With a click inside the text area, it expands and the Text Editor Toolbar appears allowing the story editor to type and/or edit the title text:</p> <p></p> <p>Once the text has been written, it is possible to configure the text area position and its style from the component's toolbar:</p> <p></p> <p>The text window toolbar allows the user to change the following settings:</p> <ul> <li> <p>The Change size button   allows to change the size of the text window in Small, Medium, Large or Full.</p> </li> <li> <p>The Align content button   allows to align the text window, inside the Container, on the Left, Center or Right.</p> </li> <li> <p>The Change field theme button  allows to change the text window theme in Default (same default theme settings of the story, see Story Settings), Bright, Dark or Custom (allows to customize background and text colors and enable or disable the shadow)</p> </li> <li> <p>The Remove button  allows delete the title section.</p> </li> </ul> <p>Note</p> <p>When a section has only one content, and the story editor remove that content, the entire section will be also automatically deleted.</p> <p>Setting a title with Large size, aligned on the Center of the Container and with a Bright theme, the result is something like:</p> <p></p>"},{"location":"user-guide/title-section/#background","title":"Background","text":"<p>For a Title sections it is possible to customize the background through the background editing toolbar:</p> <p></p> <p>In case of an empty background, the background editing toolbar allows to:</p> <ul> <li> <p>Add a media content as a background, with the Change media source button  that opens the Media Editor</p> </li> <li> <p>Change the height of the section through the Fit/adapt content button </p> </li> </ul> <p>It is possible to add three types of media contents as a background: images, videos or maps.</p>"},{"location":"user-guide/title-section/#images","title":"Images","text":"<p>Once an image is added for the background, the result is something like this:</p> <p></p> <p>In this case the background editing toolbar allows to customize the image background through the following settings:</p> <p></p> <ul> <li> <p>Change media source  allows to select the media content to use for the section, clicking on this button the Media Editor opens</p> </li> <li> <p>Change the content height through the Fit/adapt content button </p> </li> <li> <p>Change the relation image/container, choosing between making the background cover the whole container or making the whole background visible inside the container </p> </li> <li> <p>Change size  between Small, Medium, Large or Full</p> </li> <li> <p>Align content  on the Left, Center or Right</p> </li> <li> <p>Change the background theme  to set the colour of the empty background between Default (same default theme settings of the story, see Story Settings), Bright, Dark or Custom (allows to customize the color of the background).</p> </li> </ul> <p>Warning</p> <p>The Align content and the Change field theme buttons are disabled if the image size is full screen</p>"},{"location":"user-guide/title-section/#videos","title":"Videos","text":"<p>Once a video is added for the background, the result is something like this:</p> <p></p> <p>The background toolbar, in this case, changes a little bit by including an additional button:</p> <p></p> <ul> <li>The Audio, enabled by default, through which you can enable or mute the video.</li> </ul> <p>By clicking on the Make the whole background visible inside the container button  other two buttons appear to perform the following operations:</p> <p></p> <ul> <li> <p>Enable Autoplay  to play the video automatically once the user is on it</p> </li> <li> <p>Enable Loop  to continuously repeat the video</p> </li> </ul> <p>Note</p> <p>The video play will be available only in View Mode of the story: it is not available in edit mode except in the media editor as a preview.</p>"},{"location":"user-guide/title-section/#maps","title":"Maps","text":"<p>In this case, adding a map as background, the result will be like this:</p> <p></p> <p>The background toolbar, in this case, changes a little bit by including an additional button:</p> <p></p> <ul> <li>The Edit map configuration through which it is possible to Configure the Map</li> </ul>"},{"location":"user-guide/toc/","title":"Table of Contents","text":"<p>The Table of Contents, briefly TOC from now on, is a space where all the layers and the layers groups are listed. Through this panel it is also possible to carry out the following operations:</p> <ul> <li> <p>Add and remove layers and groups</p> </li> <li> <p>Perform a search between layers</p> </li> <li> <p>Change the position (and consequently the display order in map) of layers and groups</p> </li> <li> <p>Set some display options directly from the panel</p> </li> <li> <p>Manage layers and groups and query layers through the toolbar actions</p> </li> </ul>"},{"location":"user-guide/toc/#toc-settings-and-toolbar","title":"TOC Settings and Toolbar","text":"<p>The user can access the TOC with the  button on the top-left corner of the map viewer. Once this is done, the following panel will appear:</p> <p></p> <p>With the TOC Toolbar the user can:</p> <ul> <li>Add new layer through the  button: the Catalog panel opens and the user can choose the desired layer to add it to the map, through the  button.</li> </ul> <ul> <li>Add new group, through the  button: the following window opens where the user can enter the group title and add it to the TOC, through the  button.</li> </ul> <ul> <li>Add new Annotations through the  button as explained in the Annotations section.</li> </ul> <p>MapStore allows the user to customize the display of groups and layers within the TOC by enabling/disabling some options, through the  button:</p> <p></p> <p>Here the user can:</p> <ul> <li> <p>Enable/disable the opening of the TOC on map initialization, through the  button.</p> </li> <li> <p>Change the TOC theme by choosing between Default Theme or Legend Theme, through the  button. With the Legend Theme the user does not have the ability to drag and drop the position of groups/layers. This mode provides a simplified and lighter TOC when necessary.</p> </li> <li> <p>Enable/disable the possibility to display the entire title of groups/layers, through the  button.</p> </li> <li> <p>Show/hide the opacity slider for layers, through the  button.</p> </li> <li> <p>If the Opacity Slider is enabled, Show/hide the opacity tooltip for layers, through the  button.</p> </li> </ul> <p>When right-clicking on the TOC body, in addition to the options available in the TOC Settings menu described above, the user can access some more settings such as:</p> <ul> <li> <p>Show all groups and layers present in the TOC by enabling the Show all child nodes through the  button.</p> </li> <li> <p>Hide all groups and layers present in the TOC by enabling the Hide all child nodes through the  button.</p> </li> <li> <p>Collapse all groups present in the TOC by enabling the Collapse all child nodes through the  button.</p> </li> <li> <p>Expand all groups present in the TOC by enabling the  Expand all child nodes through the  button. Each layer legend is also expanded.</p> </li> <li> <p>Add a new group in TOC, through the  button.</p> </li> <li> <p>Zoom the map to the extent covering all TOC layers, through the  button.</p> </li> </ul>"},{"location":"user-guide/toc/#search-for-layers","title":"Search for layers","text":"<p>With the TOC it is also possible to perform a search between the added layers. This operation can be done simply by typing the name (o part of it) of the layer in the search bar:</p> <p></p>"},{"location":"user-guide/toc/#choose-layers-and-groups-position","title":"Choose layers and groups position","text":"<p>The user can decide to change the position of a Layer within the TOC by clicking on the layer's drag and drop icon .  It is possible to change the position of a layer within its group or move it into a different groups. Once this is done, also the order of the layer in the map changes accordingly.  Below is an example of changing the layer position through the drag and drop function.</p> <p>The same operation can also be done with any Group of layers.</p> <p>Layers position can also be changed by clicking on the Layer settings button  available in the toolbar. It appears once a layer is selected in TOC. This button opens a panel where the user can choose the destination group:</p> <p></p>"},{"location":"user-guide/toc/#display-options-in-panel","title":"Display options in panel","text":"<p>Directly from the TOC UI, the user can access different kind of display options. In particular, for layers, it is possible to:</p> <p></p> <ul> <li> <p>Enable/disable the layer visibility by using the check box to the left side of the layer leaf</p> </li> <li> <p>Expand  or collapse  the layer legend.</p> </li> <li> <p>Tune the layer transparency in map by scrolling the opacity slider.</p> </li> </ul> <p>For groups the user can instead:</p> <p></p> <ul> <li> <p>Expand  or collapse  layers or groups inside.</p> </li> <li> <p>Enable/disable the group visibility by using the check box to the left of the group leaf </p> </li> </ul> <p>Note</p> <p>When the user turns off the visibility of a group, the visibility in map of all layers and groups inside it changes accordingly but their original visibility state in TOC remain untouched; simply all nested elements are grayed out to indicate they are not visible on map and other functions (e.g. via context menu) remain available.</p>"},{"location":"user-guide/toc/#group-settings-and-toolbar","title":"Group Settings and Toolbar","text":"<p>Once a group is selected the following toolbar appears and the user can:</p> <p></p> <ul> <li> <p>Add layer to selected group through the  button (it is possible to add one or more layers to the group)</p> </li> <li> <p>Add subgroup to the selected group through the  button (it is possible to add one or more subgroups to the selected group)</p> </li> <li> <p>Zoom to selected layers extent in order to zoom the map to the extent covering all layers belonging to the given group, through the  button</p> </li> <li> <p>Open the Group settings through the  button: the Settings panel opens and the user can: - Change the Title - Set the translation of the group title by opening the Localize Text popup through the  button. This way the language of the title changes according to the  current MapStore language  - Edit the group's Description - Configure the Tooltip that appears moving the cursor over the group's item in TOC. In this case the user can decide that the Title, the Description, both or nothing will be displayed. Moreover you can set the Placement of the tooltip, choosing between Top, Right or Bottom. In all circumstances the title is fully visible in TOC the tooltip doesn't appear.</p> </li> </ul> <p></p> <ul> <li>Remove selected group and its content through the  button</li> </ul> <p>By right clicking on a group, the user can change some properties of the group such as:</p> <ul> <li> <p>Show all groups and layers present in the selected group, enabling the Show all child nodes through the  button.</p> </li> <li> <p>Hide all groups and layers present in the selected group, enabling the Hide all child nodes through the  button.</p> </li> <li> <p>Activate a mutually exclusive visibility of groups and layers inside the selected group, enabling the Activate mutually exclusive visibility of child nodes through the  button. In this way, only one layer or subgroup within it at a time can be visible on map.</p> </li> <li> <p>Collapse all groups present in the selected group, enabling the Collapse all child nodes through the  button.</p> </li> <li> <p>Expand all groups present in the selected group, enabling the  Expand all child nodes through the  button. Each layer legend is also expanded.</p> </li> <li> <p>Add a subgroup under the selected group, through the  button.</p> </li> <li> <p>Zoom the map to the selected group layers extent, through the  button.</p> </li> <li> <p>Remove the selected group, through the  button.</p> </li> </ul>"},{"location":"user-guide/toc/#layer-settings-and-toolbar","title":"Layer Settings and Toolbar","text":"<p>Selecting a layer, the toolbar is the following one:</p> <p></p> <p>In this case the user is allowed to:</p> <ul> <li> <p>Zoom to selected layer extent : in order to zoom the map to the layer's extent</p> </li> <li> <p>Access the selected Layer Settings </p> </li> <li> <p>Set a Filter for that layer </p> </li> <li> <p>Access the Attribute Table </p> </li> <li> <p>Remove the selected layer </p> </li> <li> <p>Create Widgets for the selected layer </p> </li> <li> <p>Export the data of the selected layer </p> </li> <li> <p>Open the Layer Metadata  (if configured), to retrieve layer metadata from the remote catalog source.</p> </li> </ul> <p></p> <p>Note</p> <p>The Metadata Tool is not configured by default in MapStore. A complete documentation to configure it is available as part of the TOC Plugins documentation (see metadataOptions). Once the Metadata Tool has been configured, MapStore is able to load the layer metadata from the remote CSW service and parse it to be presented to the user according to the provided plugin configuration. This functionality automatically works in case of WMS layers coming from a CSW catalog source, while for layers coming directly from a WMS catalog source the Metadata Link must be present in the WMS Layer GetCapabilities.</p> <p>By right clicking on a layer, the user can manage some layer properties such as:</p> <ul> <li> <p>Zoom the map to the selected layer extent, through the  button.</p> </li> <li> <p>Remove the selected layer, through the  button.</p> </li> <li> <p>Enable the Swipe tool on the map for the selected layer, through the  button.</p> </li> </ul> <p></p> <p>The user can change the orientation of the swipe from Vertical to Horizontal by clicking the  button that appeared to the right of the layer title.</p> <ul> <li>Enable the Spy glass tool on the map for the selected layer, through the  button.</li> </ul> <p></p> <p>The user can change the size of the spy glass (the <code>radius</code>) by clicking the  button that appeared to the right of the layer title.</p>"},{"location":"user-guide/web-section/","title":"Web Page Section","text":"<p>Through this kind of sections the story editor can embed third party contents in the story (like other web pages available on the web). The Web Page Section is similar to the Paragraph Section and the Media Section: adding this section a modal window opens to specify the URL of the web page that is going to be added.</p> <p></p> <p>Below an example of a Web Page Section that embed a Wikipedia site page:</p> <p></p> <p>It is possible to add or remove multiple Web Page contents in the same way of text and media contents as it is explained in the Paragraph Sections.</p> <p></p>"},{"location":"user-guide/widgets/","title":"Widgets","text":"<p>In MapStore it is possible to create widgets from the layers added to the map. Widgets are components such as charts, texts, tables and counters, useful to describe and visualize qualitatively and quantitatively layers data and provide the user the opportunity to analyze information more effectively.</p> <p>Note</p> <p>Some widgets (in maps or in dashboards) need some WPS back-end support to work:</p> <ul> <li> <p>The <code>map widgets</code> (dashboards) needs the WPS process <code>gs:Bounds</code> to zoom to filtered data, if connected to a table.</p> </li> <li> <p>For aggregate operations, <code>chart</code> and <code>counter</code> widgets need the WPS process <code>gs:Aggregate</code> available in GeoServer to work.</p> </li> </ul>"},{"location":"user-guide/widgets/#add-a-widget","title":"Add a Widget","text":"<p>Once at least one layer is present in the map (see Catalog section for more information about adding layers), it is possible to create a widget by selecting that layer in the TOC and by clicking on the  button from the Layer Toolbar or from the Attribute Table. Performing these operations the Widget panel appears:</p> <p></p> <p>From here the user can choose between four different types of widget:</p> <ul> <li> <p>Chart</p> </li> <li> <p>Text</p> </li> <li> <p>Table</p> </li> <li> <p>Counter</p> </li> </ul>"},{"location":"user-guide/widgets/#chart","title":"Chart","text":"<p>Charts widget allow multi-selection of layer to create a widget that allows user to configure chart options for each layer. And switch between multiple charts in a widget.</p> <p></p> <p>Selecting a Layer or Layers, the following Chart options is presented to user:</p> <p></p> <p>From the top toolbar of this panel the user is allowed to:</p> <ul> <li> <p>Going back  to the widget type section.</p> </li> <li> <p>Connect  or disconnect  the widget to the map. When a widget is connected to the map, the widget is automatically spatially filtered with the map viewport. When a widget is not linked, it displays the entire dataset of that layer regardless of the map viewport.</p> </li> <li> <p>Move forward  to the next step when the settings are complete. The button prevents the user from proceeding to the next step of the wizard if the setting of some fields in the chart form is invalid</p> </li> </ul> <p>From the chart configuration page, the user can first perform the following operation:</p> <ul> <li> <p>Edit the Chart Title through the  button</p> </li> <li> <p>Add new chart to the current widget through the  button</p> </li> <li> <p>Delete the selected chart and its configuration from the widget through the  button</p> </li> </ul>"},{"location":"user-guide/widgets/#traces","title":"Traces","text":"<p>For each chart MapStore allows to define multiple Traces. With a Trace it is possible to define an additional chart representation (for the same layer by default) to be displayed in the same chart view: all traces are displayed together in the same chart. Just below the chart's preview, there is the Traces tab, where the user can:</p> <p></p> <ul> <li> <p>Choose between Bar Chart, Pie Chart or Line Chart. By default, the Bar Chart is selected.</p> </li> <li> <p>Edit the current Trace Title through the  button</p> </li> <li> <p>Add new trace through the  button</p> </li> <li> <p>Delete the current trace through the  button</p> </li> </ul> <p>Once the chart type is chosen, it is possible to set up the trace with the following options:</p> <ul> <li>Trace data</li> <li>Trace style</li> <li>Trace axes</li> <li>Trace value formatting</li> </ul>"},{"location":"user-guide/widgets/#trace-data","title":"Trace Data","text":"<p>The Trace data is displayed as follows:</p> <p></p> <p>In this section the user can:</p> <ul> <li> <p>Change the trace layer through the  button (by default the layer is automatically the same of the first trace defined)</p> </li> <li> <p>Open the Query Panel to configure a Layer Filter for the selected layer through the  button.</p> </li> <li> <p>Define the X Attribute of the chart (or Group by for Pie Charts) choosing between layer fields</p> </li> <li> <p>Define the Y Attribute of the chart (or Use for Pie Charts) choosing between layer fields</p> </li> <li> <p>Define the aggregate Operation to perform for the selected attribute choosing between <code>No Operation</code>, <code>COUNT</code>, <code>SUM</code>, <code>AVG</code>, <code>STDDEV</code>, <code>MIN</code> and <code>MAX</code></p> </li> </ul> <p>Note</p> <p>The No operation option is used when the aggregation method is not needed for the chart. If No Operation is selected, no aggregation will be carried out for the chart and the WFS service will be used to generate the chart without using the WPS process <code>gs:Aggregate</code> in GeoServer.</p>"},{"location":"user-guide/widgets/#trace-style","title":"Trace Style","text":"<p>The Trace style is displayed as follows:</p> <p></p> <p>The user can customize the style with the following options choosing between <code>Simple style</code> or <code>Classification style</code></p> <p>With the Simple style, the editor is allowed to customize the <code>Fill color</code>, the <code>Outline color</code> and the <code>Outline width</code></p> <p></p>"},{"location":"user-guide/widgets/#classification-style","title":"Classification style","text":"<p>For Bar Charts and Pie Charts, MapStore provides the possibility to customize the colors of the charts bars and slices. It is possible to classify the style based on the attributes of the layer. In this case it is possible to select the <code>Attribute</code> to use for the classification along with the classification <code>Method</code> (Quantile, Equal interval, Natural breaks and Unique interval) and select whether to <code>Sort</code> the classification by Attribute X or Attribute Y. Choose a <code>Color ramp</code>, the number of classification <code>Intervals</code> and the order (with <code>Reverse order</code>) of the classification intervals colors. Finally customize the <code>Outline color</code> and the <code>Outline width</code>.</p> <p></p> <p>From the Color Ramp option, the user can select the Custom colors option and open the Custom Colors Settings modal through the  button. Inside this modal, the user is allowed to:</p> <ul> <li>Change the default Color of bars or slices (depending on the chart type) through the Color Picker. This color will be applied for all values for which a Class Color has not been configured.</li> </ul> <ul> <li>Enter a Default Class Label to be used in the legend for all values that will not be specifically classified in the following list.</li> </ul> <p></p> <p>Note</p> <p>For both Default Class Label and  Class Label '${legendValue}' can be used as a placeholder for the Y Attribute (that can be further customized through the usual Advanced Option).</p> <ul> <li>Classify Classification Attribute values to assign a specific color in the chart along with its Class Label to use for the chart legend. Only values of type String or Number are currently supported.</li> </ul>"},{"location":"user-guide/widgets/#classification-attribute-of-type-string","title":"Classification Attribute of type String","text":"<p>When the values of a classification attribute are of type String, the user can:</p> <p></p> <ul> <li> <p>Change the Class Color through the Color Picker.</p> </li> <li> <p>Change the value of the Classification attribute through the dropdown menu Class Value</p> </li> <li> <p>Enter a Class Label to be used in the legend for the value entered in the Class Value</p> </li> </ul> <p>Note</p> <p>For Class Label,  '${legendValue}' can be used as a placeholder for the Y Attribute (that can be further customized through the usual Advanced Option).</p> <p>Through the  button the user can add new values before through the  button or after through  button.</p>"},{"location":"user-guide/widgets/#classification-attribute-of-type-number","title":"Classification Attribute of type Number","text":"<p>When the values of a classification attribute are numbers, the user can configure a color ramp and so:</p> <p></p> <ul> <li> <p>Change the Class Color through the Color Picker</p> </li> <li> <p>Change the Min value of the Classification attribute</p> </li> <li> <p>Change the Max value of the Classification attribute</p> </li> <li> <p>Enter a Class Label to be used in the legend for the value entered in the Class Value</p> </li> </ul> <p>Note</p> <p>For Class Label two placeholders can be used in this case: ${minValue}, can be used as a placeholder for Min Value and  ${maxValue}, can be used as a placeholder for Max Value; the ${legendValue} can be used in the same way as specified above.</p>"},{"location":"user-guide/widgets/#trace-axes","title":"Trace axes","text":"<p>If Axes have been customized in the Axes tab, the user can choose which custom axes to use for the current trace.</p> <p></p>"},{"location":"user-guide/widgets/#trace-value-formatting","title":"Trace Value Formatting","text":"<p>The user can customize trace value tooltips by adding a Prefix (e.g. <code>~</code>), a custom Format (e.g. <code>0%: rounded percentage, '12%'</code> or more) or a Suffix (e.g. <code>Km</code>). It is also possible to configure a Formula to transform tick values as needed (e.g. <code>value + 2</code> or <code>value / 100</code> or more)</p> <p></p> <p>Note</p> <p>More information about the syntax options allowed for Format are available here and the allowed expression to be used as Formula are available here in the online documentation.</p> <p>An example of a custom trace value tooltip can be the following:</p> <p></p>"},{"location":"user-guide/widgets/#trace-legend-options","title":"Trace legend options","text":"<p>For the Pie Charts, the Trace legend options is available and it is displayed as follows:</p> <p></p> <p>The user can:</p> <ul> <li>Show/Hide the percentages in legend with the Include percentages in legend control. An example with the percentages in legend can be the following:</li> </ul> <p></p>"},{"location":"user-guide/widgets/#axes","title":"Axes","text":"<p>MapStore allows to customize the Y axis and the X axis for the Bar Charts and the Line Charts through the Axes tab.</p> <p></p> <p>Through this section, for each axis, the user is allowed to:</p> <ul> <li> <p>Edit the current Axis Title through the  button</p> </li> <li> <p>If there is more than one Trace, Add new axis through the  button</p> </li> <li> <p>If there is more than one Trace, Delete the current axis through the  button</p> </li> <li> <p>Choose the Type (between <code>Auto</code>, <code>Linear</code>, <code>Category</code>, <code>Log</code> or <code>Date</code>): the axis type is auto-detected by looking at the data (Auto option is automatically managed and selected by the tool and it is usually good as default setting).</p> </li> <li> <p>Change the Color through the color picker</p> </li> <li> <p>Change the Font size</p> </li> <li> <p>Select the Font family (<code>Inherit</code>, <code>Arial</code>, <code>Georgia</code>, <code>Impact</code>, <code>Tahoma</code>, <code>Times New Roman</code> or <code>Verdana</code>)</p> </li> <li> <p>Customize Y axis label by adding a Prefix (e.g. <code>~</code>), a custom Format (e.g. <code>0%: rounded percentage, '12%'</code> or more) or a Suffix (e.g. <code>Km</code>).</p> </li> </ul> <p>Note</p> <p>More information about the syntax options allowed for Format are available here in the online documentation.</p> <ul> <li> <p>Choose the Side of the chart on which to display the axis labels (between <code>Left</code> or <code>Right</code>)</p> </li> <li> <p>Choose how to Anchor the axis labels (between <code>Axis</code> or <code>Free</code>)</p> </li> <li> <p>Tune the rendering of tick labels by enabling the Never skip labels (it forces all ticks available in the chart to be rendered instead of simplifying the provided set based on chart size)</p> </li> </ul> <p>Warning</p> <p>The Never skip label option is available only for the X axis and the tick labels available by enabling the option cannot be more than 200 in order to provide a clear chart and for performance reasons.</p> <ul> <li> <p>Enable Label rotation to better adapt axis tick labels on the charts depending on the needs.</p> </li> <li> <p>Choose to completely hide labels through the Hide labels control.</p> </li> </ul>"},{"location":"user-guide/widgets/#layout","title":"Layout","text":"<p>Through the Layout tab, the user can also customize the Layout of the chart and the default Font for all the labels present in the chart.</p> <p></p> <p>Here the user can:</p> <ul> <li> <p>Show/Hide the chart's grid in background with the Hide Grid control (only for the Bar Charts and the Line Charts)</p> </li> <li> <p>Enable the chart's legend by activating Display Legend</p> </li> <li> <p>Choose the Color for all chart texts through the color picker (only for the Bar Charts and the Line Charts)</p> </li> <li> <p>Change the Font size for all chart texts</p> </li> <li> <p>Select the Font family (<code>Inherit</code>, <code>Arial</code>, <code>Georgia</code>, <code>Impact</code>, <code>Tahoma</code>, <code>Times New Roman</code> or <code>Verdana</code>) for all chart texts</p> </li> </ul> <p>If the Classification attribute is added to the Bar Chart, in the Trace Style,  the Bar Chart Type option is displayed.</p> <p></p> <p>The user can customize the bars by choosing between:</p> <ul> <li>Grouped. An example can be the following:</li> </ul> <p></p> <ul> <li>Stacked. An example can be the following:</li> </ul> <p></p> <p>Note</p> <p>By default, the bar chart type is Stacked</p>"},{"location":"user-guide/widgets/#configure-chart-info","title":"Configure Chart Info","text":"<p>Once the settings are done, the next step of the chart widget creation/configuration is displayed as follows:</p> <p></p> <p>The user can:</p> <ul> <li> <p>Go back to the chart option with the  button</p> </li> <li> <p>Add the widget to the map with the  button</p> </li> </ul> <p>Just below the chart's preview, the user is allowed to set:</p> <ul> <li> <p>The widget Title</p> </li> <li> <p>The widget Description</p> </li> </ul> <p>Note</p> <p>None of these fields are mandatory, it is possible to save/add the widget to the map without filling them.</p> <p>An example of chart widget could be:</p> <p></p> <p>The Chart toolbar, displayed in the right corner of the chart allows the user to:</p> <p></p> <ul> <li> <p>Download the chart as a <code>png</code> through the  button.</p> </li> <li> <p>Zoom the chart through the  button.</p> </li> <li> <p>Pan the chart through the  button.</p> </li> <li> <p>Zoom in the chart through the  button.</p> </li> <li> <p>Zoom out the chart through the  button.</p> </li> <li> <p>Autoscale to autoscale the axes to fit the plotted data automatically through the  button.</p> </li> <li> <p>Reset axes to return the chart to its initial state through the  button.</p> </li> <li> <p>Toggle Spike Lines to show dashed lines for X and Y values by hovering the mouse over the chart. This is useful to better see domain values on both axis in case of complex charts. It is possible to activate that option through the  button.</p> </li> </ul>"},{"location":"user-guide/widgets/#text","title":"Text","text":"<p>Creating a new text widget the following window opens:</p> <p></p> <p>Through the toolbar it is possible to:</p> <ul> <li> <p>Go back to the widget type selection with the  button</p> </li> <li> <p>Add the widget to the map with the  button</p> </li> </ul> <p>Here the user can:</p> <ul> <li> <p>Write the title of the widget</p> </li> <li> <p>Write the text of the widget</p> </li> <li> <p>Format the text through the Text Editor Toolbar</p> </li> </ul> <p>Note</p> <p>From the Text Editor Toolbar the user can also add an URL Image through the  button and add an Embedded Link through the  button.</p> <p>Note</p> <p>None of these options are mandatory, you can add the widget to the map without filling in these fields.</p> <p>An example of text widget could be:</p> <p></p>"},{"location":"user-guide/widgets/#table","title":"Table","text":"<p>Adding a table widget to the map, a panel like the following opens:</p> <p></p> <p>From the top toolbar of this panel the user is allowed to:</p> <ul> <li> <p>Going back  to the widget type section.</p> </li> <li> <p>Connect  or disconnect  the widget to the map. When a widget is connected to the map, the widget is automatically spatially filtered with the map viewport. When a widget is not linked, it displays the entire dataset of that layer regardless of the map viewport.</p> </li> <li> <p>Open the Query Panel to configure a Layer Filter for the selected layer through the  button.</p> </li> <li> <p>Move forward  to the next step when the settings are complete. The button prevents the user from proceeding to the next step of the wizard if the setting of some fields in the chart form is invalid</p> </li> </ul> <p>In the Table Widget the user can:</p> <ul> <li>Enable/Disable the layer fields that will be displayed in the widget as columns.</li> </ul> <p>Warning</p> <p>At least one field must be selected in order to move to the next configuration step.</p> <ul> <li>Enter a Title for each column to be displayed as the table header in place of the Name of the layer field</li> </ul> <ul> <li>Enter a Description for each field to be displayed as a tooltip, visible moving the mouse on the column header.</li> </ul> <p>Once the desired fields are selected, a click on the  button opens the following panel:</p> <p></p> <p>In this last step of the widget creation, the toolbar and the information to be inserted are similar to the ones in Chart section.  An example of table widget could be:</p> <p></p> <p>Note</p> <p>If the Table is connected to a map or if maps are connected to a Table, the user can Zoom to feature through the  button available on each record.</p>"},{"location":"user-guide/widgets/#counter","title":"Counter","text":"<p>Selecting the counter option, the following window opens:</p> <p></p> <p>The top toolbar of this panel is similar to the one present in Table section.  Here the user is allowed to:</p> <ul> <li> <p>Select the attribute to Use</p> </li> <li> <p>Select the Operation to perform</p> </li> </ul> <p>From the Trace value formatting section, the user is allowed to:</p> <ul> <li> <p>Customize the labels by adding a Prefix (e.g. <code>~</code>), a custom Format (e.g. <code>0%: rounded percentage, '12%'</code> or more) or a Suffix (e.g. <code>Km</code>).</p> </li> <li> <p>Configure a Formula to transform tick values as needed (e.g. <code>value + 2</code> or <code>value / 100</code> or more).</p> </li> </ul> <p>Note</p> <p>More information about the syntax options allowed for Format are available here and the allowed expression to be used as Formula are available here in the online documentation.</p> <ul> <li> <p>Choose the Color of the Counter text using the color picker</p> </li> <li> <p>Select the Font family (<code>Inherit</code>, <code>Arial</code>, <code>Georgia</code>, <code>Impact</code>, <code>Tahoma</code>, <code>Times New Roman</code> or <code>Verdana</code>) of the Counter text</p> </li> </ul> <p>Warning</p> <p>In order to move forward to the next step, only the Use and the Operation are considered as mandatory fields.</p> <p>Once the  button is clicked, the panel of the last step appears:</p> <p></p> <p>Also in this case the toolbar and the information to be inserted are similar to the ones in Chart section, with the only exception that the Filtering button  is missing.  An example of counter widget could be:</p> <p></p>"},{"location":"user-guide/widgets/#manage-existing-widgets","title":"Manage existing widgets","text":"<p>Once widgets have been created, they will be placed on the bottom right of the map viewer and the Widgets Tray appears:</p> <p></p> <p>Through the buttons available on each widget the user can\u00a0 perform the following operations:</p> <p></p> <ul> <li>Drag and drop the widget to move it within the map area of the viewer and resize it through the  button (also available for widgets present in a dashboard)</li> </ul> <ul> <li> <p>Pin the position and the dimension of the widget through the  button</p> </li> <li> <p>Collapse the widget through the  button and expand it again by clicking the related button in the Widgets Tray</p> </li> </ul> <p>Note</p> <p>The Widgets Tray allows the user to expand/collapse each single widget individually  or all of them at once by using the  button.</p> <p>Warning</p> <p>When both Timeline and widgets are present in a map, the Timeline button appears in the Widgets Tray  allowing the user to expand and collapse it (widgets and Timeline can't anyhow be expanded at the same time).</p> <ul> <li>Make the widget Full screen through the  button (also available for widgets present in a dashboard)</li> </ul> <ul> <li>Access to the Title and Description info through the  button, if this information has been provided during the widget configuration/creation</li> </ul> <p></p>"},{"location":"user-guide/widgets/#access-widgets-menu","title":"Access widgets menu","text":"<p>Once a widget is added to the map, it is possible to access its Menu through the  button. For Text, Table and Counter widgets, the following menu appears:</p> <p></p> <p>From here the user can:</p> <ul> <li> <p>Edit the widget</p> </li> <li> <p>Delete the widget</p> </li> </ul> <p>Only for Charts, the menu is like the following:</p> <p></p> <p>In particular, the user can also:</p> <ul> <li> <p>Show chart data in tabular representation</p> </li> <li> <p>Download data in .csv format</p> </li> <li> <p>Export Image in .jpg format</p> </li> </ul>"}]}